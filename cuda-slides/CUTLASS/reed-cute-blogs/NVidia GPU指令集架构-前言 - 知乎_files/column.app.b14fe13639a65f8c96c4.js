(self.webpackChunkheifetz=self.webpackChunkheifetz||[]).push([[8593],{49978:function(e,t){"use strict";t.Z={Popover:"ddLajxN_Q0AuobBZjX9m",arrow:"W329ne7r9Ot4gzRWR_AA","arrow--top":"w2j9r5Z9lHt9PvAmRayf","arrow--bottom":"cApyvfK_BuxctlL0gXe_","arrow--left":"saunLECwfTBPsqThUWtO","arrow--right":"RhQaE5TkssFiFDfVK18R",content:"Hd4HpgivEXthJjQIraJI","content-enter":"ANnfP2VN3I39bhxQBO6U","content-enter-active":"IJ34IiXWG8RSIazVpj4O","content-leave":"i5jbKhy30Rl2CfXvIatH","content-leave-active":"MOQr6PlCSuOsv44V0nUy","content--fixed":"iu6FC73GJyA4U_F5hVlW","content--top":"Q3aW4lGNloPwsNZozG74","content--arrowed":"ppT2GYHiMrV3Rj29VP7O","content--enter":"qNMJ8yjaJck7PqHKsACa","content--bottom":"PyIzdhf5t6OptzHvhQKO","content--left":"J1kFp8NPNRphbsX0iU3g","content--right":"w7Vrabm02QLkRZ5iseWC"}},86045:function(e,t,n){"use strict";var r,o,i,a,c,s,l,u,d,p,h,f,_,m,v=n(85879),g=n(49899);n(59449);var T=n(82452),E=n(61763),C=n(51384),y=n(53862),S=n(54231),I=n(84286),b=n(87363),A=n.n(b),Z=n(78193),w=n.n(Z),R=n(59590),N=n(79855),k=n(67516),O=n.n(k),x=n(80714);n(97476);var P=n(66263),D=n(25834),L=n(23113),B=n(55164),U=n(57477),M=n(74135),G=n(54422),F=function(e){if(204===e.status||"0"===e.headers.get("content-length"))return!1;var t=e.headers.get("content-type");return t&&-1!==t.indexOf("application/json")};function z(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e(t,n).catch(function(e){throw e.fetchOptions=n,e}).then(function(e){return n.responseProcessor?n.responseProcessor(e):F(e)?e.json().then(function(t){return{json:t,res:e}}):e.text().then(function(t){return{text:t,res:e}})}).then(function(e){var t=e.json,r=e.text,o=e.res,i=e.payload,a=(0,M.camelizeKeys)(t),c=a||r||i,s=t||r||i,l=a&&a.code;if(o.status>=300||l&&!n.ignoreCode){var u,d=new E.VL(o,n);throw d.payload=null!==(u=null==c?void 0:c.error)&&void 0!==u?u:c,d.res=o,d}return a&&Array.isArray(a)&&(c={count:Number(o.headers.get("x-result-count")),data:a},s=(0,U._)((0,B._)({},c),{data:t})),Object.assign(o,{res:o,payload:c,payloadOrigin:s})})}}function H(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=(0,E.SQ)(fetch,e);return function(e,r){return e=e.replace("zhuanlan.zhihu.com/api/api","zhuanlan.zhihu.com/api"),!(0,G.sD)(e)&&t&&(e="".concat(/zhihu.(com|dev)$/.test(t)?"":"http".concat("s",":"),"//").concat(t).concat(e)),n(e,r)}}var q=n(22107),V=n(94707),X=n(87320),W=n(15030),K=n(71728),j=n(94009),Y=n(18837),Q=n.n(Y);function J(e){return e.replace(/(members|people|roundtables?)\/(\w+)/g,"$1").replace(/(\/appview|\/api|\/v4|\/\d+|-|\w{32})/g,"").substring(1).replace(/\//g,"-")||"Unknown"}var $=function(){function e(){var t=this;(0,q._)(this,e),(0,X._)(this,"_apiStatus",void 0),(0,X._)(this,"_timer",null),(0,X._)(this,"prefer",function(e,n){var r=(0,j._)(t._getApiStatus(e),2),o=r[0];return!1===r[1]?(en("checking_again",o),t.check(o),n):e}),(0,X._)(this,"check",function(e){var n=(0,j._)(t._getApiStatus(e),2),r=n[0];!1===n[1]&&t._timer||(t._deactivate(r),t._ticktock())}),(0,X._)(this,"_getApiStatus",function(e){var n=ee(e);return[n,t._apiStatus.get(n)]}),(0,X._)(this,"_healing",function(e){t._apiStatus.delete(e),en("healing",e)}),(0,X._)(this,"_deactivate",function(e){t._apiStatus.set(e,!1)}),(0,X._)(this,"_ticktock",function(){if(!t._timer){var e=1e3*(Math.floor(7*Math.random())+8);console.log("HealthCheckProbe will check after ".concat(e,"ms.")),t._timer=setTimeout(function(){Promise.all(Array.from(t._apiStatus.entries()).map(function(e){return(0,j._)(e,1)[0]}).map(function(e){return fetch(e).then(function(t){return[e,t.ok]},function(){return[e,!1]})})).then(function(e){e.forEach(function(e){var n=(0,j._)(e,2),r=n[0];t[n[1]?"_healing":"_deactivate"](r),en("checked",r)})}).finally(function(){t._timer&&clearTimeout(t._timer),t._timer=null})},e)}}),this._apiStatus=new Map}return(0,V._)(e,null,[{key:"instance",value:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();function ee(e){return e.split("?")[0]}(0,X._)($,"_instance",null);var et=Q()(J);function en(e,t){var n=new URL(t,"https://www.zhihu.com");S.ZP.increment("HCP.".concat(e,".").concat(et(n.pathname),".count"))}var er=n(57045),eo="UNAUTHORIZED_RELOAD",ei=Object.values(P.AW);function ea(e){var t=e.payload,n=e.res,r=t||{},o=r.code,i=r.message,a=n&&n.status;if(401===a&&100===o){var c=O().get(eo);(!c||Date.now()-c.time>36e4)&&(O().set(eo,{time:Date.now()}),location.reload())}if(403===a&&ei.includes(o)){var s=Object.keys(P.AW).find(function(e){return P.AW[e]===o});location.href="/account/unhuman?".concat(er.stringify({type:s,message:i,next:location.href}))}throw e}var ec=n(4667),es=n.n(ec),el=es()(function(){var e,t={xZst81:void 0};try{window.addEventListener("wdfs1",function(e){var n;t.xZst81=null==e?void 0:null===(n=e.detail)||void 0===n?void 0:n.xzst81}),n.e(1243).then(n.t.bind(n,80177,23)).then(function(e){var n=e.wdfs1;t.xZst81=n()})}catch(t){null===(e=window.Raven)||void 0===e||e.captureException(t,{fingerprint:["zswsdid-sdk"],level:"warning"})}return t}),eu=n(62082);function ed(e){var t=e.protocol,n=e.host;return[t?t.replace(":",""):"",n?n.replace(/\.|:/g,"-"):""].join("-")}var ep=function(e,t){var n,r=null==t?void 0:t();if(r){var o={type:"ZERR_NO_AUTH_TOKEN",appName:"heifetz",spanName:"default",error:{name:e.name,message:e.message,payload:e.payload||"Unknown"},currentUser:r};(0,eu.zB)(o),null===(n=window.Raven)||void 0===n||n.captureMessage("ZERR_NO_AUTH_TOKEN",{extra:o})}},eh=n(10840),ef=n(20382),e_={skipAutoSign:function(e){return!1},captureException:function(e,t){var n;null===(n=window.Raven)||void 0===n||n.captureException(e,{fingerprint:["ZsAutoSignature"],extra:t})}},em=function(e){var t=e.ua,n=e.authInfo,r=e.passVars,o=e.xUDId;return t.ZhihuHybrid||t.Zhihu?(0,E.jO)({userAgent:t,authInfo:n,xUDId:o,xAppVersion:null==r?void 0:r["x-app-version"],xZst81:null==r?void 0:r["x-zst-81"]},e_):(0,E.OB)({},e_)},ev=function(){if(!new URLSearchParams(location.search).has("utm_id")){var e=new URL(location.href);e.searchParams.append("utm_id","0"),history.replaceState({},"",e.toString())}},eg=function(){return null},eT=n(39288),eE=n(58909),eC=n(7407),ey=n(54826),eS=n(63315),eI=n(29065),eb=function(e,t){var n=Object.keys(t).map(function(e){var n=t[e];return"".concat(e,"=").concat(n)}).join("&"),r=e.includes("?")?"&":"?";return"".concat(e).concat(r).concat(n)},eA=function(e,t){try{var n=new URL(e,"https://www.zhihu.com"),r=new URLSearchParams(n.search),o=r.get("member_id"),i=r.get("creator_token"),a={};return!o&&t.member_id&&(a.member_id=t.member_id),!i&&t.creator_token&&(a.creator_token=t.creator_token),eb(e,a)}catch(e){console.error(e)}return e},eZ=["Creator","OrgAnalyticsWork"],ew=function(e){var t=e.query,n=t.member_id,r=t.creator_token,o=e.spanName,i=e.isOffice,a=(n||r)&&eZ.some(function(e){return o.includes(e)});return function(e){return a?function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=a.method;return"GET"===(void 0===c?"GET":c)&&(t=eA(t,i?{member_id:n,creator_token:r}:"OrgAnalyticsWork"===o?{creator_token:r}:{})),e(t,a)}:e}},eR=n(61533),eN=n.n(eR),ek=n(39658),eO=n(44259),ex=n(83697),eP=n(26144),eD=n(6080),eL=n(10644),eB=n(41402),eU=n(77349),eM=n(36695),eG=n(43384),eF=n(35374),ez=(0,b.createContext)({totalOffset:0}),eH=function(e){var t=e.children,n=(0,j._)((0,b.useState)(function(){return new Map}),2),r=n[0],o=n[1],i=(0,b.useCallback)(function(e,t){return o(function(n){return new Map(n.set(e,t))})},[]),a=(0,b.useCallback)(function(e){return o(function(t){return t.delete(e),new Map(t)})},[]),c=(0,b.useMemo)(function(){var e=0;return r.forEach(function(t){return e+=t}),{totalOffset:e,addOffset:i,removeOffset:a}},[i,r,a]);return(0,v.tZ)(ez.Provider,{value:c,children:t})},eq=(0,b.createContext)(),eV=(0,b.createContext)(),eX=n(67689),eW=n(90381),eK=n(70400),ej=function(e){var t=e.store,n=e.canaryConfig,r=e.children,o=t.getState().env,i=o.theme,a=o.userAgent,c=o.ctx,s=(0,j._)((0,b.useState)("dark"===i),2),l=s[0],u=s[1],d=(0,j._)((0,b.useState)(function(){return(0,eL.Z)()}),1)[0];return(0,b.useEffect)(function(){if(a.ZhihuHybrid)return(0,R.Z)("base/themeChange").listen(function(e){u("dark"===e.theme)})},[a.ZhihuHybrid]),(0,v.tZ)(eM.Provider,{store:t,children:(0,v.tZ)(eU.HK,{children:(0,v.BX)(eG.PU,{children:[(0,v.tZ)(ek.ql,{htmlAttributes:{"data-theme":l?"dark":"light"}}),(0,v.tZ)(ex.I.Provider,{value:a,children:(0,v.tZ)(eq.Provider,{value:l,children:(0,v.tZ)(eV.Provider,{value:u,children:(0,v.tZ)(eB.nq,{value:d,children:(0,v.tZ)(eP.d,{isDarkMode:l,ua:a,children:(0,v.tZ)(eH,{children:(0,v.tZ)(eX.j,{children:(0,v.tZ)(eD.a,{value:n,children:(0,v.tZ)(eu.ZP,{appName:"heifetz",fallback:(0,v.tZ)(eK.ds,{}),release:x.Z.release,children:(0,v.tZ)(eO.c6,{preProxyUrl:null,useDevProxy:!0,children:(0,v.tZ)(eF.iH,{children:(0,v.tZ)(eW.Ho,{path:c.path,children:r})})})})})})})})})})})})]})})})},eY=n(85456),eQ=n.n(eY),eJ=[],e$=function(e){eJ.push(e)},e0=eQ()(function(){if(console.groupCollapsed){var e,t=eJ.reduce(function(e,t){return e+t.actualDuration},0);console.groupCollapsed("[Click to expand]: React Profiler, ".concat(eJ.length," updates in ").concat(t.toFixed(2),"ms"))}for(;e=eJ.shift();)e.actualDuration>=5?console.warn(e):console.info(e);console.groupEnd&&console.groupEnd()},300);function e1(e,t,n,r,o,i,a){e$({id:e,phase:t,actualDuration:n,baseDuration:r,startTime:o,commitTime:i,interactions:a}),e0()}var e2=n(81956),e3=n(75597),e4=n(74128),e5=n(93206),e6=n(31252),e7=(0,e5.combineReducers)({global:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{count:0},t=arguments.length>1?arguments[1]:void 0;if("undefined"==typeof window)return e;var n=t.type;return n.endsWith("request")?{count:e.count+1}:n.endsWith("success")||n.endsWith("failure")?{count:e.count?e.count-1:0}:e},local:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.id,o=t.urlToken;return["request","success","failure"].includes(n.split("/").pop())?(0,U._)((0,B._)({},e),(0,X._)({},"".concat(n.slice(0,n.lastIndexOf("/")),"/").concat(r||o||""),n.endsWith("request"))):e}}),e8=n(6366),e9=n(22712),te=n(8866),tt=n(89250),tn=n(58857),tr=n(79540),to=n(84054),ti=n.n(to),ta={BABY:"knowledgeBaby",B_SIDE:"bSide",DIGITAL:"knowledgeDigital",CREATOR_SUPPORT:"creatorSupport",ACG:"knowledgeAcg",XIAOPENG_CAR:"knowledgeXiaopengCar",CAR:"knowledgeCar",SEA_SALT:"seaSalt",SCIENCE:"knowledgeScience",VIDEO_MAKER_ACQUISITION:"videoMakerAcquisition",VIDEO_MAKER_ACQUISITION_V2:"videoMakerAcquisitionV2",VIDEO_MAKER_ACQUISITION_V3:"videoMakerAcquisitionV3",BRAND_RENEWAL_QA:"brandRenewalQa",BRAND_RENEWAL_QA_ACTION:"brandRenewalQaAction",VOTE:"vote",ZHIHU_CAR:"zhihuCar",SCHOOL_NEWS:"schoolNews"};f={},(0,X._)(f,ta.BABY,{id:3}),(0,X._)(f,ta.B_SIDE,{id:4}),(0,X._)(f,ta.DIGITAL,{id:5}),(0,X._)(f,ta.ACG,{id:10}),(0,X._)(f,ta.XIAOPENG_CAR,{id:11}),(0,X._)(f,ta.CAR,{id:12}),(0,X._)(f,ta.SCIENCE,{id:15}),(0,X._)(f,ta.VIDEO_MAKER_ACQUISITION,{id:1}),(0,X._)(f,ta.VIDEO_MAKER_ACQUISITION_V2,{id:3}),(0,X._)(f,ta.VIDEO_MAKER_ACQUISITION_V3,{id:5}),(0,X._)(f,ta.VOTE,{id:2}),(0,X._)(f,ta.ZHIHU_CAR,{id:21});var tc=(0,B._)({},(0,eT.FH)("campaign",["LOAD_SINGLE","TOGGLE_FOLLOW_USER","APPLY_KNOWLEDGE","LOAD_LIST","POLL","REFRESH_VIDEO_LIST","ACCEPT_INVITATION","SUBMIT_INVITATION_CODE","APPLY_VIDEO_MAKER_ACQUISITION","LOAD_INVITEE_INFO","APPLY_ACCEPT_INVITE","APPLY_INVITE","LOAD_VOTE_USERS","APPLY_VOTE","GET_SHARE_POSTER","GET_IDENTITY_VERIFY_STATUS","FOLLOW_USER"]),(0,eT.co)("campaign",["UPDATE_ZHIHU2020_RECOMMENDED_MEMBER_FOLLOE_STATUS","REFRESH_RESERVATION","SHARE_POSITION"])),ts="boarding",tl=(0,B._)({},(0,eT.FH)(ts,["GET","GET_SHARE_LINK","GET_SHARE_POSTER","GET_BUBBLES","GET_REWARD_LIST","GET_WITHDRAWAL_LIST","BIND_INVITER","GET_INVITER","GET_INVITE_LIST","CALL","DRAW_REWARD","GET_TASK","GET_NOTIFICATION","WITHDRAW"]),(0,eT.co)(ts,["CLEAR"])),tu={},td="card-collecting",tp=(0,B._)({},(0,eT.FH)(td,["GET_PROFILE","DRAW_PRIZE","GET_TASK_LIST","GET_SHARE_LINK","GET_GIVER_INFO","GET_INVITER_INFO","GET_PROFILE","GET_CARD_LIST","FUSE_CARD","GET_SHARE_KEY","GET_FUSE_STATUS","GET_RECEIVED_CARD","RECEIVE_CARD","GET_PRIZE_LIST","GET_SHARE_POSTER","WITHDRAW"]),(0,eT.co)(td,["SET_MODAL","SET_PANEL","SHIFT_CARD","SET_NEW_COIN_COUNT","SET_SHARE_INTENTION","CONSUME_NEW_USER_CARD","SET_MESSAGE","CLEAR_RECEIVED_CARD","CLEAR_PRIZE"])),th={message:null,profile:{balance:"0",chance:0,coinNum:0,gatherClose:!1,isGotMagicCard:!1,isPay:!1,partitionStart:!1,totalDone:0,withdrawStart:!1},sharePoster:{share:"",sendCard:"",invite:""},shareLink:null,shareIntention:"share",shareKey:null,shareCardId:null,inviterInfo:null,giverInfo:null,prize:null,receivedCard:null,newCoinCount:null,newCardList:[],newUserCardCount:1,taskList:[],prizeList:null,cardList:null,panel:{showTaskPanel:!1,showRewardPanel:!1},modal:{showWelcomeModal:!1,showFusionModal:!1,showFusionPromptModal:!1,showShareModal:!1,showBackModal:!1}},tf=(0,eT.FH)("searchGaokaoSubPage",["GET_ACE_MAJORS","GET_EMPLOYMENT_DESTINATION","GET_SCORES","GET_ADMISSIONS_GUIDE","GET_IMAGES","GET_PROVINCE_LINE","GET_SCHOOL_INFO","GET_COURSES","GET_COLLEGES","GET_STATS","GET_TOPIC"]),t_=(0,eT.FH)("searchHealth",["GET_HEALTH"]),tm=(0,B._)({},(0,eT.FH)("zhiboPandian2020",["GET_STATISTICS"])),tv=n(31824);(0,tv.P1)([eC.Xj,function(e){var t,n,r,o;return null===(t=e.campaign)||void 0===t?void 0:null===(n=t.single)||void 0===n?void 0:null===(r=n.featuredQuestionsConfig)||void 0===r?void 0:null===(o=r.data)||void 0===o?void 0:o.config}],function(e,t){return t?e?t:t.filter(function(e){return"1"===e.isPublic}):null});var tg=(0,e5.combineReducers)({single:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.meta,o=t.payload,i=t.needMerge;if(n===tc.LOAD_SINGLE.request)return(0,U._)((0,B._)({},e),(0,X._)({},r.stateKey,(0,U._)((0,B._)({},e[r.stateKey]),{refreshLoading:!0})));if(n===tc.LOAD_SINGLE.success){var a=r.time;return(0,U._)((0,B._)({},e),(0,X._)({},r.stateKey,(0,U._)((0,B._)({},i&&e[r.stateKey],o,a&&{time:a}),{refreshLoading:!1})))}return n===tc.LOAD_SINGLE.failure?(0,U._)((0,B._)({},e),(0,X._)({},r.stateKey,(0,U._)((0,B._)({},e[r.stateKey]),{refreshLoading:!1}))):n===tc.REFRESH_RESERVATION?(0,U._)((0,B._)({},e),(0,X._)({},r.stateKey,(0,U._)((0,B._)({},e[r.stateKey]),{data:(e[r.stateKey].data||[]).concat(o)}))):n===tc.SHARE_POSITION?(0,U._)((0,B._)({},e),(0,X._)({},r.stateKey,(0,U._)((0,B._)({},e[r.stateKey]),{data:o}))):n===tc.UPDATE_ZHIHU2020_RECOMMENDED_MEMBER_FOLLOE_STATUS?(0,U._)((0,B._)({},e),(0,X._)({},r.stateKey,(0,U._)((0,B._)({},e[r.stateKey]),{data:e[r.stateKey].data.map(function(e){return e.urlToken===o?(0,U._)((0,B._)({},e),{isFollowing:!e.isFollowing}):e})}))):e},list:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r=n.type,o=n.meta,i=n.payload;return r===tc.LOAD_LIST.request?(0,U._)((0,B._)({},t),(0,X._)({},o.stateKey,(0,U._)((0,B._)({},t[o.stateKey]),{isLoading:!0}))):r===tc.LOAD_LIST.failure?(0,U._)((0,B._)({},t),(0,X._)({},o.stateKey,(0,U._)((0,B._)({},t[o.stateKey]),{isLoading:!1}))):r===tc.LOAD_LIST.success?(0,U._)((0,B._)({},t),(0,X._)({},o.stateKey,(0,U._)((0,B._)({},t[o.stateKey],i),{data:(0,g._)(!o.isRefetch&&(null===(e=t[o.stateKey])||void 0===e?void 0:e.data)||[]).concat((0,g._)(i.data||[])),isLoading:!1}))):t},videoMakerAcq:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.meta,o=t.payload;return n===tc.LOAD_INVITEE_INFO.success?(0,U._)((0,B._)({},e),(0,X._)({},r.stateKey,o)):n===tc.GET_SHARE_POSTER.success?(0,U._)((0,B._)({},e),{sharePoster:o.posterUrl}):e},vote:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.meta,o=t.payload;if(n===tc.LOAD_VOTE_USERS.success){var i=r.stateKey,a=o.activityInfo,c=o.userInfo,s=o.items;return{activityInfo:a,userInfo:c,candidatesList:(0,U._)((0,B._)({},e.candidatesList),(0,X._)({},i,s))}}return e},cardCollecting:function(){var e,t,n,r,o,i,a,c,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:th,l=arguments.length>1?arguments[1]:void 0,u=l.type,d=l.payload,p=l.meta;if(u.endsWith("/success")&&(null==d?void 0:null===(e=d.error)||void 0===e?void 0:e.message))return s.error?s:(0,U._)((0,B._)({},s),{message:{text:d.error.message,closePage:u===tp.GET_SHARE_LINK.success}});if(u===tp.SET_MODAL)return(0,U._)((0,B._)({},s),{modal:(0,B._)({},s.modal,d)});if(u===tp.SET_PANEL)return(0,U._)((0,B._)({},s),{panel:(0,B._)({},s.panel,d)});if(u===tp.SET_NEW_COIN_COUNT)return(0,U._)((0,B._)({},s),{newCoinCount:d});if(u===tp.SHIFT_CARD)return(0,U._)((0,B._)({},s),{newCardList:s.newCardList.slice(1)});if(u===tp.DRAW_PRIZE.request)return(0,U._)((0,B._)({},s),{prize:null});if(u===tp.DRAW_PRIZE.success)return(null===(n=d.data)||void 0===n?void 0:n.prizeType)==="element"?(0,U._)((0,B._)({},s),{newCardList:s.newCardList.concat((0,B._)({},d.data,p))}):(0,U._)((0,B._)({},s),{prize:d.data});if(u===tp.GET_TASK_LIST.success)return(0,U._)((0,B._)({},s),{taskList:(null===(r=d.data)||void 0===r?void 0:r.taskList)||[]});if(u===tp.GET_SHARE_LINK.success)return d.error?(0,U._)((0,B._)({},s),{error:null===(o=d.error)||void 0===o?void 0:o.message}):(0,U._)((0,B._)({},s),{shareLink:d.data.linkUrl.replace("intention=invite&","")});if(u===tp.GET_INVITER_INFO.success)return(0,U._)((0,B._)({},s),{inviterInfo:d.data});if(u===tp.SET_SHARE_INTENTION)return(0,U._)((0,B._)({},s),{shareIntention:d});if(u===tp.GET_PROFILE.success)return(0,U._)((0,B._)({},s),{profile:(0,B._)({},s.profile,d.data)});if(u===tp.GET_CARD_LIST.success){var h=d.data.elements;return(0,U._)((0,B._)({},s),{cardList:h})}return u===tp.GET_GIVER_INFO.success?(0,U._)((0,B._)({},s),{giverInfo:d.data}):u===tp.CONSUME_NEW_USER_CARD?(0,U._)((0,B._)({},s),{newUserCardCount:s.newUserCardCount-1}):u===tp.GET_SHARE_KEY.success?(0,U._)((0,B._)({},s,d.data.posterUrl&&{sharePoster:(0,U._)((0,B._)({},s.sharePoster),{sendCard:d.data.posterUrl})}),{shareKey:d.data.shareKey,shareCardId:p.shareCardId}):u===tp.GET_FUSE_STATUS.success?(0,U._)((0,B._)({},s),{profile:(0,U._)((0,B._)({},s.profile),{fusionStatus:(null===(i=d.data)||void 0===i?void 0:null===(a=i.collections)||void 0===a?void 0:null===(c=a[0])||void 0===c?void 0:c.status)||0})}):u===tp.SET_MESSAGE?(0,U._)((0,B._)({},s),{message:d}):u===tp.GET_RECEIVED_CARD.success?(0,U._)((0,B._)({},s),{receivedCard:d}):u===tp.CLEAR_RECEIVED_CARD?(0,U._)((0,B._)({},s),{receivedCard:null}):u===tp.CLEAR_PRIZE?(0,U._)((0,B._)({},s),{prize:null}):u===tp.RECEIVE_CARD.success&&(null==d?void 0:null===(t=d.data)||void 0===t?void 0:t.length)?(0,U._)((0,B._)({},s),{newCardList:s.newCardList.concat(d.data.filter(function(e){return e.linkId}))}):u===tp.GET_PRIZE_LIST.success&&(null==d?void 0:d.data)?(0,U._)((0,B._)({},s),{prizeList:d.data}):u===tp.GET_SHARE_POSTER.success?(0,U._)((0,B._)({},s),{sharePoster:(0,U._)((0,B._)({},s.sharePoster),(0,X._)({},s.shareIntention,d.data.imgUrl))}):s},zhiboPandian2020:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;if(t.type===tm.GET_STATISTICS.success){var n=t.payload;return(0,B._)({},e,n)}return e},boarding:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tu,n=arguments.length>1?arguments[1]:void 0,r=n.type,o=n.payload;switch(r){case tl.GET.success:return(0,U._)((0,B._)({},t),{profile:(0,B._)({},t.profile,o.data)});case tl.GET_SHARE_LINK.success:var i,a,c=null===(i=o.error)||void 0===i?void 0:i.code;return(0,U._)((0,B._)({},t),{shareLink:null===(a=o.data)||void 0===a?void 0:a.linkUrl,taskError:1005===c||1003===c?["邀请任务已结束","快去提醒好友做任务得剩余奖励吧"]:null});case tl.GET_SHARE_POSTER.success:return(0,U._)((0,B._)({},t),{sharePoster:null===(e=o.data)||void 0===e?void 0:e.imgUrl});case tl.GET_BUBBLES.success:return(0,U._)((0,B._)({},t),{bubbles:o.data});case tl.GET_REWARD_LIST.success:return(0,U._)((0,B._)({},t),{rewardList:o.data});case tl.GET_WITHDRAWAL_LIST.success:return(0,U._)((0,B._)({},t),{withdrawalList:o.data});case tl.GET_INVITER.success:return(0,U._)((0,B._)({},t),{inviter:o.data});case tl.GET_INVITE_LIST.success:return(0,U._)((0,B._)({},t),{inviteList:o.data});case tl.DRAW_REWARD.success:return(0,U._)((0,B._)({},t),{currentReward:o.data});case tl.CLEAR:return(0,U._)((0,B._)({},t),{currentReward:null});case tl.GET_TASK.success:return(0,U._)((0,B._)({},t),{task:o.data});case tl.GET_NOTIFICATION.success:return(0,U._)((0,B._)({},t),{notification:o.data});default:return t}},searchGaokaoSubPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.meta,o=(void 0===r?{}:r).isReset;if(n===tf.GET_TOPIC.success)return(0,U._)((0,B._)({},e),{topic:t.payload});if(n===tf.GET_COURSES.success)return(0,U._)((0,B._)({},e),{courses:t.payload});if(n===tf.GET_COLLEGES.request)return(0,U._)((0,B._)({},e),{universities:(0,U._)((0,B._)({},e.universities),{isLoading:!0})});if(n===tf.GET_COLLEGES.success){var i,a=t.payload,c=a.universities,s=a.paging,l=a.provinces,u=a.tags,d=a.types,p=o?c:(0,g._)((null===(i=e.universities)||void 0===i?void 0:i.universities)||[]).concat((0,g._)(c));return(0,U._)((0,B._)({},e),{universities:(0,U._)((0,B._)({},e.universities),{isLoading:!1,paging:s,provinces:l,tags:u,types:d,universities:p})})}if(n===tf.GET_STATS.success)return(0,U._)((0,B._)({},e),{stats:t.payload});if(n===tf.GET_ACE_MAJORS.success)return(0,U._)((0,B._)({},e),{aceMajors:t.payload});if(n===tf.GET_EMPLOYMENT_DESTINATION.success)return(0,U._)((0,B._)({},e),{employmentDestination:t.payload});if(n===tf.GET_SCORES.success)return(0,U._)((0,B._)({},e),{scores:t.payload});if(n===tf.GET_PROVINCE_LINE.success)return(0,U._)((0,B._)({},e),{provinceLine:t.payload});if(n===tf.GET_ADMISSIONS_GUIDE.success)return(0,U._)((0,B._)({},e),{intro:t.payload});if(n===tf.GET_SCHOOL_INFO.success)return(0,U._)((0,B._)({},e),{schoolInfo:t.payload});if(n===tf.GET_IMAGES.request)return(0,U._)((0,B._)({},e),{images:(0,U._)((0,B._)({},e.images),{isLoading:!0,isDrained:!1})});if(n===tf.GET_IMAGES.success){var h,f,_=t.payload||{},m=_.imageInfo.thumbnails,v=_.videoInfo.thumbnails,T=t.meta.isPC,E=(null===(h=e.images)||void 0===h?void 0:h.thumbnails)||[],C=(null===(f=e.images)||void 0===f?void 0:f.videoThumbnails)||[],y=v.length>0?T?v:(0,g._)(v).concat([{type:"text"}]):[];return(0,U._)((0,B._)({},e),{images:(0,U._)((0,B._)({},t.payload),{isLoading:!1,isDrained:!m.length,thumbnails:(0,g._)(E).concat((0,g._)(y),(0,g._)(m)),videoThumbnails:(0,g._)(C).concat((0,g._)(v))})})}return e},searchHealth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===t_.GET_HEALTH.success?(0,B._)({},e,t.payload):e}}),tT=n(13737),tE=n(73086),tC=n(33068),ty=n(64813),tS=n(73135),tI=n(28953),tb=n(86871),tA=(0,B._)({},(0,eT.FH)("chat",["SEARCH_USER"]),(0,eT.co)("chat",["CLEAR_SEARCH_RESULT"])),tZ=(0,tb.Z)(tA.SEARCH_USER,tA.CLEAR_SEARCH_RESULT),tw=n(25130),tR=(0,e5.combineReducers)({recents:tC.ZP,strangers:ty.Z,friends:tS.ZP,search:tZ,config:tw.ZP}),tN={isChatMqttExisted:!1},tk=(0,eT.co)("chatGlobal",["SET_CHAT_MQTT_STATUS"]),tO=(0,e5.combineReducers)({chats:tE.ZP,inbox:tR,global:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tN,t=arguments.length>1?arguments[1]:void 0;if(t.type===tk.SET_CHAT_MQTT_STATUS){var n=t.meta.status;return(0,U._)((0,B._)({},e),{isChatMqttExisted:n})}return e}}),tx=n(25809),tP=n(94146),tD=n(67927),tL=function(e){if(!e)return!1;var t=e.childCommentCount,n=e.isDelete,r=e.collapsed;return t>0||!n&&!r},tB=(0,B._)({},(0,eT.FH)("commentMangage",["LOAD_UPDATE_STATUS","UPDATE_VISIT_STATUS","LOAD_COMMENT_LIST","UPDATE_COMMENT","UPDATE_COMMENT_LIKE","UPDATE_COMMENT_DISLIKE","UPDATE_COMMENT_HOT","UPDATE_COMMENT_COLLAPSED","DELETE_COMMENT","APPROVE_COMMENT","REJECT_COMMENT","REPLY_COMMENT","LOAD_SUB_COMMENT_LIST","UPDATE_SUB_COMMENT","UPDATE_SUB_COMMENT_LIKE","UPDATE_SUB_COMMENT_DISLIKE","UPDATE_SUB_COMMENT_HOT","UPDATE_SUB_COMMENT_COLLAPSED","DELETE_SUB_COMMENT","APPROVE_SUB_COMMENT","REJECT_SUB_COMMENT","REPLY_SUB_COMMENT"])),tU=(0,tP.HF)();tU.getSelectors(function(e){return e.commentManage.commentList});var tM=(0,tP.HF)();tM.getSelectors(function(e){return e.commentManage.subCommentList});var tG=tU.getInitialState({nextOffset:0,urlToken:""}),tF=function(e,t){var n=t.meta;tU.updateOne(e,n)},tz=(0,tP.oM)({name:"commentManage/commentList",initialState:tG,reducers:{resetCommentList:function(e,t){var n=t.payload;return(0,U._)((0,B._)({},tG),{urlToken:n})}},extraReducers:(_={},(0,X._)(_,tB.LOAD_COMMENT_LIST.success,function(e,t){var n,r=t.payload,o=t.meta.urlToken;o===e.urlToken&&r&&(e.nextOffset=r.nextOffset,e.urlToken=o,tU.addMany(e,((null===(n=r.data)||void 0===n?void 0:n.filter(tL))||[]).map(function(e){return(0,U._)((0,B._)({},e),{_id:(0,tP.x0)()})})))}),(0,X._)(_,tB.UPDATE_COMMENT_LIKE.request,tF),(0,X._)(_,tB.UPDATE_COMMENT_DISLIKE.request,tF),(0,X._)(_,tB.UPDATE_COMMENT_HOT.request,tF),(0,X._)(_,tB.UPDATE_COMMENT_COLLAPSED.request,tF),(0,X._)(_,tB.DELETE_COMMENT.success,tF),(0,X._)(_,tB.REPLY_COMMENT.success,tF),(0,X._)(_,tB.APPROVE_COMMENT.success,tF),(0,X._)(_,tB.UPDATE_COMMENT.success,function(e,t){var n=t.payload;n&&tU.updateOne(e,{id:n.id,changes:n})}),_)});tz.actions.resetCommentList;var tH=tM.getInitialState({paging:{next:"",isEnd:!1}}),tq=function(e,t){var n=t.meta,r=t.payload;n.inConversation&&tM.addOne(e,r)},tV=function(e,t){var n=t.meta;tM.updateOne(e,n)},tX=(0,tP.oM)({name:"commentManage/subCommentList",initialState:tH,reducers:{resetSubCommentList:function(){return tH}},extraReducers:(m={},(0,X._)(m,tB.LOAD_SUB_COMMENT_LIST.success,function(e,t){var n,r=t.payload;r&&(e.paging=r.paging,tM.addMany(e,((null===(n=r.data)||void 0===n?void 0:n.filter(tL))||[]).map(function(e){return(0,U._)((0,B._)({},e),{_id:(0,tP.x0)()})})))}),(0,X._)(m,tB.UPDATE_SUB_COMMENT_LIKE.request,tV),(0,X._)(m,tB.UPDATE_SUB_COMMENT_DISLIKE.request,tV),(0,X._)(m,tB.UPDATE_SUB_COMMENT_HOT.request,tV),(0,X._)(m,tB.UPDATE_SUB_COMMENT_COLLAPSED.request,tV),(0,X._)(m,tB.DELETE_SUB_COMMENT.success,tV),(0,X._)(m,tB.REPLY_SUB_COMMENT.success,tq),(0,X._)(m,tB.REPLY_COMMENT.success,tq),(0,X._)(m,tB.APPROVE_SUB_COMMENT.success,tV),(0,X._)(m,tB.UPDATE_SUB_COMMENT.success,function(e,t){var n=t.payload;n&&tM.updateOne(e,{id:n.id,changes:n})}),m)});tX.actions.resetSubCommentList;var tW=(0,e5.combineReducers)({commentList:tz.reducer,subCommentList:tX.reducer}),tK=n(803),tj=n(69906),tY=(0,B._)({},(0,eT.FH)("comment",["GET","GET_COLLAPSED","GET_REVERSE","GET_REVIEWING","GET_CONVERSATION","UPDATE_LIKE","UPDATE_DISLIKE","UPDATE_FEATURED","UPDATE_COLLAPSED","APPROVE","REJECT","DELETE","ADD","GET_MORE_REPLY_COMMENT","GET_CONVERSATION_MORE","GET_STICKERS","GET_COMMENT_WITH_PIC_PERMISSION","LOAD_NOTI_COMMENTS"]),(0,eT.co)("comment",["ORDER"])),tQ={ebook:"book",collection:"favlist"},tJ=function(e){var t=e.parentType,n=e.parentId;return"".concat(t,"_").concat(n)},t$=(0,e5.combineReducers)({pagination:(0,tj.Fd)(tY.GET,{mapActionToKey:tJ,additionalCaseTypes:[tY.APPROVE.success,tY.ADD.success,tY.GET_CONVERSATION.success].concat((0,g._)(Object.values(tY.UPDATE_FEATURED)),(0,g._)(Object.values(tY.UPDATE_COLLAPSED))),additionalCase:function(e,t){switch(t.type){case tY.APPROVE.success:return(0,U._)((0,B._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.id])});case tY.ADD.success:var n=t.replyToId,r=t.id;if(n&&!r){var o=e.ids.indexOf(n);return(0,U._)((0,B._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids.slice(0,o+1)).concat([t.result],(0,g._)(e.ids.slice(o+1))),newIds:(0,g._)(e.newIds.slice(0,o+1)).concat([t.result],(0,g._)(e.newIds.slice(o+1)))})}return(0,U._)((0,B._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.result]),newIds:(0,g._)(e.newIds).concat([t.result])});case tY.UPDATE_COLLAPSED.request:var i=e.ids,a=i.indexOf(t.id),c=i.slice();return t.expect?c.splice(a,1):c.push(t.id),(0,U._)((0,B._)({},e),{ids:c,newIds:c,index:a});case tY.UPDATE_COLLAPSED.success:return delete e.index,(0,B._)({},e);case tY.UPDATE_COLLAPSED.failure:var s=e.ids.slice(),l=s.indexOf(t.id);return t.expect?s.splice(l,0,t.id):s.splice(l,1),delete e.index,(0,U._)((0,B._)({},e),{ids:s,newIds:s});default:return e}}}),collapsed:(0,tj.Fd)(tY.GET_COLLAPSED,{mapActionToKey:tJ,additionalCaseTypes:(0,g._)(Object.values(tY.UPDATE_COLLAPSED)),additionalCase:function(e,t){switch(t.type){case tY.UPDATE_COLLAPSED.request:var n=e.ids,r=n.indexOf(t.id),o=n.slice();return t.expect?o.push(t.id):o.splice(r,1),(0,U._)((0,B._)({},e),{ids:o,newIds:o,index:r});case tY.UPDATE_COLLAPSED.success:return delete e.index,(0,B._)({},e);case tY.UPDATE_COLLAPSED.failure:var i=e.ids,a=e.index,c=i.slice();return t.expect?c.splice(a,1):c.splice(a,0,t.id),delete e.index,(0,U._)((0,B._)({},e),{ids:i,newIds:c});default:return e}}}),reverse:(0,tj.Fd)(tY.GET_REVERSE,{mapActionToKey:tJ,additionalCaseTypes:[tY.APPROVE.success,tY.ADD.success],additionalCase:function(e,t){switch(t.type){case tY.APPROVE.success:return(0,U._)((0,B._)({},e),{totals:e.totals+1,ids:[t.id].concat((0,g._)(e.ids))});case tY.ADD.success:var n=t.replyToId,r=t.id;if(n&&!r){var o=e.ids.indexOf(n);return(0,U._)((0,B._)({},e),{totals:e.totals+1,newIds:(0,g._)(e.newIds.slice(0,o+1)).concat([t.result],(0,g._)(e.newIds.slice(o+1))),ids:(0,g._)(e.ids.slice(0,o+1)).concat([t.result],(0,g._)(e.ids.slice(o+1)))})}return(0,U._)((0,B._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.result]),newIds:(0,g._)(e.newIds).concat([t.result])});default:return null}}}),reviewing:(0,tj.Fd)(tY.GET_REVIEWING,{mapActionToKey:tJ,additionalCaseTypes:[tY.APPROVE.success],additionalCase:function(e,t){if(t.type===tY.APPROVE.success){var n=e.ids;return n.splice(n.indexOf(t.id),1),(0,U._)((0,B._)({},e),{ids:n})}return e}}),conversation:(0,tj.Fd)(tY.GET_CONVERSATION,{additionalCaseTypes:[tY.ADD.success].concat((0,g._)(Object.values(tY.UPDATE_FEATURED))),additionalCase:function(e,t){return t.type===tY.ADD.success?(0,U._)((0,B._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.payload.id])}):e}}),parent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=tJ(t);switch(t.type){case tY.GET.success:var r=t.payload,o=r.featuredCounts,i=r.collapsedCounts,a=r.reviewingCounts,c=r.commonCounts,s=r.commentStatus;return(0,U._)((0,B._)({},e),(0,X._)({},n,{featuredCounts:o,collapsedCounts:i,reviewingCounts:a,commonCounts:c,commentStatus:s}));case tY.APPROVE.success:var l=e[n].reviewingCounts-1;return(0,U._)((0,B._)({},e),(0,X._)({},n,(0,U._)((0,B._)({},e[n]),{reviewingCounts:l})));case tY.REJECT.success:var u=e[n].reviewingCounts+1;return(0,U._)((0,B._)({},e),(0,X._)({},n,(0,U._)((0,B._)({},e[n]),{reviewingCounts:u})));case tY.UPDATE_COLLAPSED.success:var d=e[n]||{};return(0,U._)((0,B._)({},e),(0,X._)({},n,(0,U._)((0,B._)({},d),{collapsedCounts:d.collapsedCounts+(t.expect?1:-1)})));case tY.DELETE.success:var p=e[n]||{};return(0,U._)((0,B._)({},e),(0,X._)({},n,(0,B._)({},p,t.collapsed&&{collapsedCounts:p.collapsedCounts-1},t.reviewing?{reviewingCounts:p.reviewingCounts-1}:{commonCount:p.commonCount-1})));default:return e}}});function t0(e,t){var n=e[t]&&e[t].ids||[],r=n.filter(function(e){return String(e).includes("_featured")}).length,o=n.length-r;return{featuredCounts:r,commonCounts:o}}n(46942);var t1=(0,B._)({},(0,eT.FH)("commentV2",["GET","GET_COLLAPSED","GET_REVERSE","GET_REVIEWING","GET_CONVERSATION","UPDATE_LIKE","UPDATE_DISLIKE","UPDATE_FEATURED","UPDATE_COLLAPSED","APPROVE","REJECT","DELETE","ADD","GET_MORE_REPLY_COMMENT","GET_CONVERSATION_MORE","GET_STICKERS","GET_COMMENT_WITH_PIC_PERMISSION","LOAD_NOTI_COMMENTS"]),(0,eT.co)("comment",["ORDER"])),t2=function(e){var t=e.parentType,n=e.parentId;return"".concat(t,"_").concat(n)},t3=(0,e5.combineReducers)({stickers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===t1.GET_STICKERS.success?(0,g._)(e).concat((0,g._)(t.payload.data)):e},commentWithPicPermission:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===t1.GET_COMMENT_WITH_PIC_PERMISSION.success?(0,B._)({},e,t.payload):e},notificationsComments:(0,tj.Fd)(t1.LOAD_NOTI_COMMENTS,{mapActionToKey:function(e){return e.notificationId||e.id},additionalCaseTypes:[t1.ADD.success].concat((0,g._)(Object.values(t1.UPDATE_FEATURED))),additionalCase:function(e,t){switch(t.type){case t1.ADD.success:var n=t.replyType,r=t.result;if("notification"===n)return(0,U._)((0,B._)({},e),{ids:(0,g._)(e.ids).concat([r])});return e;case t1.UPDATE_FEATURED.success:var o=t.notificationId,i=t.commentId;if(o){var a=e.ids,c=a.indexOf("".concat(i,"_featured"));-1===c?a.unshift("".concat(i,"_featured")):a.splice(c,1)}return e;default:return e}}}),pagination:(0,tj.Fd)(t1.GET,{mapActionToKey:t2,additionalCaseTypes:[t1.APPROVE.success,t1.REJECT.success,t1.ADD.success,t1.ADD.failure,t1.GET_CONVERSATION.success].concat((0,g._)(Object.values(t1.UPDATE_FEATURED)),(0,g._)(Object.values(t1.UPDATE_COLLAPSED))),additionalCase:function(e,t){switch(t.type){case t1.APPROVE.success:return(0,U._)((0,B._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.id])});case t1.REJECT.success:var n=e.ids;return(0,U._)((0,B._)({},e),{totals:e.totals-1,ids:n.filter(function(e){return e!==t.id})});case t1.ADD.success:var r=t.replyToId,o=t.shouldUpdateChildComments;switch(t.replyType){case"comment":return(0,U._)((0,B._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.result]),newIds:(0,g._)(e.newIds).concat([t.result])});case"replyToFeatured":if(o)return(0,B._)({totals:e.totals+1},e);return(0,U._)((0,B._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.result]),newIds:(0,g._)(e.newIds).concat([t.result])});case"replyToSubFeatured":var i=e.ids.indexOf("".concat(r,"_featured"));return(0,U._)((0,B._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids.slice(0,i+1)).concat([t.result],(0,g._)(e.ids.slice(i+1))),newIds:(0,g._)(e.newIds.slice(0,i+1)).concat([t.result],(0,g._)(e.newIds.slice(i+1)))});case"replyToCommon":case"replyToSubCommon":return(0,U._)((0,B._)({},e),{totals:e.totals+1});default:return e}case t1.UPDATE_COLLAPSED.request:var a=e.ids,c=a.indexOf(t.id),s=a.slice();return t.expect?s.splice(c,1):s.push(t.id),(0,U._)((0,B._)({},e),{ids:s,newIds:s,index:c});case t1.UPDATE_COLLAPSED.success:return delete e.index,(0,B._)({},e);case t1.UPDATE_COLLAPSED.failure:var l=e.ids.slice(),u=l.indexOf(t.id);return t.expect?l.splice(u,0,t.id):l.splice(u,1),delete e.index,(0,U._)((0,B._)({},e),{ids:l,newIds:l});case t1.UPDATE_FEATURED.request:var d=t.commentId,p=e.ids,h=e.newIds,f=p.indexOf("".concat(d,"_featured"));if(-1===f)return(0,U._)((0,B._)({},e),{ids:["".concat(d,"_featured")].concat((0,g._)(p)),newIds:["".concat(d,"_featured")].concat((0,g._)(h))});return p.splice(f,1),h.splice(f,1),e;default:return e}}}),collapsed:(0,tj.Fd)(t1.GET_COLLAPSED,{mapActionToKey:t2,additionalCaseTypes:(0,g._)(Object.values(t1.UPDATE_COLLAPSED)),additionalCase:function(e,t){switch(t.type){case t1.UPDATE_COLLAPSED.request:var n=e.ids,r=n.indexOf(t.id),o=n.slice();return t.expect?o.push(t.id):o.splice(r,1),(0,U._)((0,B._)({},e),{ids:o,newIds:o,index:r});case t1.UPDATE_COLLAPSED.success:return delete e.index,(0,B._)({},e);case t1.UPDATE_COLLAPSED.failure:var i=e.ids,a=e.index,c=i.slice();return t.expect?c.splice(a,1):c.splice(a,0,t.id),delete e.index,(0,U._)((0,B._)({},e),{ids:i,newIds:c});default:return e}}}),reverse:(0,tj.Fd)(t1.GET_REVERSE,{mapActionToKey:t2,additionalCaseTypes:[t1.APPROVE.success,t1.ADD.success],additionalCase:function(e,t){switch(t.type){case t1.APPROVE.success:return(0,U._)((0,B._)({},e),{totals:e.totals+1,ids:[t.id].concat((0,g._)(e.ids))});case t1.ADD.success:var n=t.replyToId,r=t.id;if(n&&!r){var o=e.ids.indexOf(n);return(0,U._)((0,B._)({},e),{totals:e.totals+1,newIds:(0,g._)(e.newIds.slice(0,o+1)).concat([t.result],(0,g._)(e.newIds.slice(o+1))),ids:(0,g._)(e.ids.slice(0,o+1)).concat([t.result],(0,g._)(e.ids.slice(o+1)))})}return(0,U._)((0,B._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.result]),newIds:(0,g._)(e.newIds).concat([t.result])});default:return null}}}),reviewing:(0,tj.Fd)(t1.GET_REVIEWING,{mapActionToKey:t2,additionalCaseTypes:[t1.APPROVE.success,t1.REJECT.success],additionalCase:function(e,t){switch(t.type){case t1.APPROVE.success:var n=e.ids;return n.splice(n.indexOf(t.id),1),(0,U._)((0,B._)({},e),{ids:n});case t1.REJECT.success:return(0,U._)((0,B._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.id])});default:return e}}}),conversation:(0,tj.Fd)(t1.GET_CONVERSATION,{additionalCaseTypes:[t1.ADD.success].concat((0,g._)(Object.values(t1.UPDATE_FEATURED))),additionalCase:function(e,t){switch(t.type){case t1.ADD.success:var n=t.replyToId,r=t.replyType,o=t.isAnchorComments;if("conversation"===r){var i=e.ids.indexOf(n);if(-1===i&&(i=e.ids.indexOf("".concat(n,"_featured"))),o&&-1===i)return e;return(0,U._)((0,B._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids.slice(0,i+1)).concat([t.result],(0,g._)(e.ids.slice(i+1)))})}return e;case t1.UPDATE_FEATURED.request:var a=t.commentId,c=e.ids,s=e.newIds,l=c.indexOf("".concat(a,"_featured")),u=c.indexOf(a);return -1!==l?(c.splice(l,1,a),s.splice(l,1,a)):-1!==u&&(c.splice(u,1,"".concat(a,"_featured")),s.splice(u,1,"".concat(a,"_featured"))),e;default:return e}}}),conversationMore:(0,tj.Fd)(t1.GET_CONVERSATION_MORE,{additionalCaseTypes:[t1.ADD.success].concat((0,g._)(Object.values(t1.UPDATE_FEATURED))),additionalCase:function(e,t){switch(t.type){case t1.ADD.success:var n=t.replyToId,r=t.replyType,o=t.isAnchorComments;if("conversation"===r){if(!o)return(0,B._)({},e);var i=e.ids.indexOf(n);if(-1===i&&-1===(i=e.ids.indexOf("".concat(n,"_featured"))))return e;return(0,U._)((0,B._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids.slice(0,i+1)).concat([t.result],(0,g._)(e.ids.slice(i+1)))})}return e;case t1.UPDATE_FEATURED.request:var a=t.commentId,c=e.ids,s=e.newIds,l=c.indexOf("".concat(a,"_featured")),u=c.indexOf(a);return -1!==l?(c.splice(l,1,a),s.splice(l,1,a)):-1!==u&&(c.splice(u,1,"".concat(a,"_featured")),s.splice(u,1,"".concat(a,"_featured"))),e;default:return e}}}),parent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t2(t);switch(t.type){case t1.GET.success:var r=t.payload,o=r.featuredCounts,i=r.collapsedCounts,a=r.reviewingCounts,c=r.commonCounts,s=r.commentStatus;return(0,U._)((0,B._)({},e),(0,X._)({},n,{featuredCounts:o,collapsedCounts:i,reviewingCounts:a,commonCounts:c,commentStatus:s}));case t1.APPROVE.success:var l=e[n].reviewingCounts-1;return(0,U._)((0,B._)({},e),(0,X._)({},n,(0,U._)((0,B._)({},e[n]),{reviewingCounts:l})));case t1.REJECT.success:var u=e[n].reviewingCounts+1;return(0,U._)((0,B._)({},e),(0,X._)({},n,(0,U._)((0,B._)({},e[n]),{reviewingCounts:u})));case t1.UPDATE_COLLAPSED.success:var d=e[n]||{};return(0,U._)((0,B._)({},e),(0,X._)({},n,(0,U._)((0,B._)({},d),{collapsedCounts:d.collapsedCounts+(t.expect?1:-1)})));case t1.DELETE.success:var p=e[n]||{};return(0,U._)((0,B._)({},e),(0,X._)({},n,(0,B._)({},p,t.collapsed&&{collapsedCounts:p.collapsedCounts-1},t.reviewing?{reviewingCounts:p.reviewingCounts-1}:{commonCount:p.commonCount-1})));case t1.LOAD_NOTI_COMMENTS.success:var h=t.notificationsComments,f=t.notificationId;return(0,U._)((0,B._)({},e),(0,X._)({},f,(0,B._)({},t0(h,f))));case t1.UPDATE_FEATURED.request:case t1.UPDATE_FEATURED.success:var _=t.notificationsComments,m=t.notificationId;if(m)return(0,U._)((0,B._)({},e),(0,X._)({},m,(0,B._)({},t0(_,m))));return e;default:return e}}}),t4=(0,eT.FH)("commercialReport",["GET_COMMERCIAL_REPORT_INFO"]).GET_COMMERCIAL_REPORT_INFO,t5=(0,eT.co)("commercialReport",["UPDATE_LOCAL_ANSWER_COMMERCIAL_REPORT_INFO"]).UPDATE_LOCAL_ANSWER_COMMERCIAL_REPORT_INFO,t6={commercialTypes:[]},t7=(0,eT.FH)("ask",["GET_MATCH_TOPICS","ADD"]),t8=n(11345),t9=(0,e5.combineReducers)({ask:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(!t.payload||![t7.ADD.success,t7.ADD.failure].includes(t.type))return e;var n=t.payload,r=n.id,o=n.code,i=n.message;switch(o){case 103003:return(0,U._)((0,B._)({},e),{title:{level:"error",text:"已经存在的问题"}});case 103001:return(0,U._)((0,B._)({},e),{detail:{level:"error",text:"过长的补充说明"}});default:return r?{id:r}:(0,U._)((0,B._)({},e),{overall:{text:i}})}},cities:t8.Z}),ne=(0,B._)({},(0,eT.FH)("creationRanking",["GET_CREATION_RANKING","GET_CREATION_RANKING_TYPE","GET__CREATION_RANKING_POSTER","GET__CREATION_RANKING_MONTHLIST"])),nt=n(19958),nn=n(74351),nr=function(e){return e.creatorMCN},no=(0,tv.P1)(nr,function(e){return e.mcn});(0,tv.P1)(no,function(e){return e.id}),(0,tv.P1)(nr,function(e){return e.isNoAuth}),(0,tv.P1)(nr,function(e){return e.mcnStatistics}),(0,tv.P1)(nr,function(e){return e.creatorManageData}),(0,tv.P1)(nr,function(e){return e.creatorManageDataTotal}),(0,tv.P1)(nr,function(e){return e.creatorCheeseManageData}),(0,tv.P1)(nr,function(e){return e.creatorCheeseManageDataTotal}),(0,tv.P1)(nr,function(e){return e.mcnDomains}),(0,tv.P1)(nr,function(e){return e.mcnRight}),(0,tv.P1)(nr,function(e){return e.statisticHealthScoreData}),(0,tv.P1)(nr,function(e){return e.healthScore});var ni=(0,B._)({},(0,eT.FH)("creator-mcn",["GET_HOME_DATA","LOAD_ACTIVITY_LIST","GET_CREATOR_MANAGE_DATA","GET_CREATOR_CHEESE_MANAGE_DATA","DOWNLOAD_CREATOR_CHEESE_MANAGE_DATA_EXCEL_CHECK","SEARCH_PEOPLE","DOWNLOAD_CREATORS","GET_MCN_DOMAINS","GET_INVITE_STATUS","LAUNCH_UNBIND","ACCEPT_UNBIND","REJECT_UNBIND","SUBMIT_INVITATION","GET_CONTENTS","GET_CONTENT_ANALYSIS","DOWNLOAD_CONTENTS","GET_CREATOR_STATISTICS","DOWNLOAD_CREATOR_STATISTICS","GET_CREATOR_INCOME","GET_CREATOR_INCOME_STATISTICS","GET_MCN_INCOME","GET_INCOME_TYPE","DOWNLOAD_CREATOR_INCOME","DOWNLOAD_MCN_INCOME","LOAD_PAYMENT_LIST","LOAD_PAYMENT_DETAIL","LOAD_CREATOR_BALANCE","LOAD_CREATOR_BALANCE_DETAIL","GET_CONTENTS_PROMOTE_DETAIL","GET_CONTENTS_PROMOTE_COUPON_LIST","CHECK_CONTENTS_PROMOTE_COUPON","USE_CONTENTS_PROMOTE_COUPON","POST_CREATE_ORDER","POST_PAYMENT","GET_PAYMENT_STATUS","GET_SALT_AGGR","GET_SALT_DETAIL","GET_HEALTH_SCORE","LOAD_HEALTHSCORE_LIST","LOAD_STATISTIC_HEALTH_SCORE_DATA","BEFORE_DOWNLOAD_CHECK"])),na={mcn:{},mcnStatistics:{},mcnRight:{bind:!1,coupon:!1},isNoAuth:!1,creatorManageData:[],creatorManageDataTotal:1,mcnDomains:[],bill:{list:{},detail:{}},healthScore:{healthScore:"0",updateTime:"",evaluate:""},healthScoreRecordInfo:{},statisticHealthScoreData:{},beforeDownloadCheckResult:{}},nc=n(26267),ns=n(40382),nl=(0,B._)({},(0,eT.FH)("creatorSalt",["GET_AUTHOR_STATUS","GET_AUTHOR_STATUS_NEW","GET_AUTHOR_WEBSITES","GET_AUTHOR_CONTRIBUTES_DOMAIN","CREATE_AUTHOR_DRAFT","PUBLISH_AUTHOR_DRAFT","UPDATE_AUTHOR_DRAFT","GET_QUESTION_RECOMMEND","SUB_USER_INFO","SUB_INSTITUTION_INFO","GET_AUTHOR_CONTRIBUTES_LIST","SUBMIT_AUTHOR_DRAFT","DELETE_AUTHOR_DRAFT","GET_DRAFT_INFO","GET_HAS_SUBMIT_ARTICLES","TRANSFER_CONTENT_TO_DRAFT","GET_BANNER_IMG_LIST","GET_CLAIM_BANNER_IMG_LIST","GET_REST_CONTRIBUTION_NUMBER","GET_AUTHOR_INFO","GET_All_BIND_ACCOUNT","OPERATE_INVITE_REQUEST","GET_AUTHOR_INVITE_STATUS","INVITE_AUTHOR","GET_INVITE_ACCOUNT_INFO","GET_INVITATION","HANDLE_INVITATION","UPLOAD_FILE","UPLOAD_IMG_WITH_WATERMARK","UPDATE_AUTHOR_INFO","CANCEL_INVITE_AUTHOR","GET_BOUND_INSTITUTION_INFO","GET_GROWTH_LEVEL","GET_TAGS_TREE","GET_LONG_SECTIONS","UPDATE_LONG_SECTIONS","GET_AUTHOR_CONTRIBUTES_DOMAIN_ALL","GET_MANUSCRIPT_LIST","GET_STATUS_COUNT","GET_STATUS_MAP","CREATE_CONTROBUTION","UPDATE_CONTROBUTION","GET_CONTRIBUTION_INFO","GET_COMMUNITY_CONTENT","CALLBACK_CONTROBUTION","UPLOAD_MANUSCRIPT","GET_All_BIND_ACCOUNT_NEW","GET_UNREAD_COUNT","UPDATE_AUTHOR_INFO_IN_SIGN_ON_LINE","CHOOSE_SETTLEMENT_INFO","GET_SIGN_LIST","GET_BANK_LIST","SUBMIT_CONTRACT_DESC_INFO","GET_CONTRACT_PDF","GET_WELFARE_CONFIG","GET_MANUSCRIPT_STATUS_TEXT"])),nu={recommendQuestionList:[],bannerList:[],claimBannerList:[],sites:[],domains:{},hasRecored:!1,hasClaim:!1,hasContributedList:[],notContributedList:[],contributesTotal:null,previewPageTitle:"",previewPageContent:"",restContributionNumber:"-"},nd=n(74065),np=(0,B._)({},(0,eT.FH)("EDIT_VIDEO",["GET_ENABLED"])),nh={editVideoEnabled:!1},nf=n(20765),n_=n(62039),nm=n(87441),nv=(0,eT.FH)("explore",["GET_RECOMMENDATIONS","GET_LATEST_SPECIALS","GET_LATEST_ROUNDTABLES","GET_HOT_COLLECTIONS","GET_RECOMMEND_COLUMNS","FOLLOW_SPECIAL","UNFOLLOW_SPECIAL","FOLLOW_ROUNDTABLE","UNFOLLOW_ROUNDTABLE","FOLLOW_COLLECTION","UNFOLLOW_COLLECTION","GET_RECENT_HOT_QUESTION","GET_POTENTIAL_QUESTION"]),ng=(0,e5.combineReducers)({recommendations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===nv.GET_RECOMMENDATIONS.request?{isLoading:!0}:t.type===nv.GET_RECOMMENDATIONS.success?{isDrained:!0,items:t.payload.data}:t.type===nv.GET_RECOMMENDATIONS.failure?{isError:!0}:e},specials:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{entities:{},order:[]},t=arguments.length>1?arguments[1]:void 0;if(t.type===nv.GET_LATEST_SPECIALS.success){var n=t.payload.data;return{entities:n.reduce(function(e,t){return(0,U._)((0,B._)({},e),(0,X._)({},t.id,t))},{}),order:n.map(function(e){return e.id})}}if([nv.FOLLOW_SPECIAL.request,nv.UNFOLLOW_SPECIAL.failure].includes(t.type)){var r=t.meta.id,o=e.entities;return o[r]?(0,U._)((0,B._)({},e),{entities:(0,U._)((0,B._)({},o),(0,X._)({},r,(0,U._)((0,B._)({},o[r]),{isFollowing:!0})))}):e}if([nv.UNFOLLOW_SPECIAL.request,nv.FOLLOW_SPECIAL.failure].includes(t.type)){var i=t.meta.id,a=e.entities;return a[i]?(0,U._)((0,B._)({},e),{entities:(0,U._)((0,B._)({},a),(0,X._)({},i,(0,U._)((0,B._)({},a[i]),{isFollowing:!1})))}):e}return e},roundtables:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{entities:{},order:[]},t=arguments.length>1?arguments[1]:void 0;if(t.type===nv.GET_LATEST_ROUNDTABLES.success){var n=t.payload.data;return{entities:n.reduce(function(e,t){return(0,U._)((0,B._)({},e),(0,X._)({},t.urlToken,t))},{}),order:n.map(function(e){return e.urlToken})}}if([nv.FOLLOW_ROUNDTABLE.request,nv.UNFOLLOW_ROUNDTABLE.failure].includes(t.type)){var r=t.meta.urlToken,o=e.entities;return o[r]?(0,U._)((0,B._)({},e),{entities:(0,U._)((0,B._)({},o),(0,X._)({},r,(0,U._)((0,B._)({},o[r]),{followersCount:o[r].followersCount+1,isFollowing:!0})))}):e}if([nv.UNFOLLOW_ROUNDTABLE.request,nv.FOLLOW_ROUNDTABLE.failure].includes(t.type)){var i=t.meta.urlToken,a=e.entities;return a[i]?(0,U._)((0,B._)({},e),{entities:(0,U._)((0,B._)({},a),(0,X._)({},i,(0,U._)((0,B._)({},a[i]),{followersCount:a[i].followersCount-1,isFollowing:!1})))}):e}return e},collections:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===nv.GET_HOT_COLLECTIONS.success)return t.payload.data.reduce(function(e,t){return(0,U._)((0,B._)({},e),(0,X._)({},t.id,t))},{});if([nv.FOLLOW_COLLECTION.request,nv.UNFOLLOW_COLLECTION.failure].includes(t.type)){var n=t.meta.id;return e[n]?(0,U._)((0,B._)({},e),(0,X._)({},n,(0,U._)((0,B._)({},e[n]),{followerCount:e[n].followerCount+1,isFollowing:!0}))):e}if([nv.UNFOLLOW_COLLECTION.request,nv.FOLLOW_COLLECTION.failure].includes(t.type)){var r=t.meta.id;return e[r]?(0,U._)((0,B._)({},e),(0,X._)({},r,(0,U._)((0,B._)({},e[r]),{followerCount:e[r].followerCount-1,isFollowing:!1}))):e}return e},columns:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===nv.GET_RECOMMEND_COLUMNS.success?t.payload.data.reduce(function(e,t){return(0,U._)((0,B._)({},e),(0,X._)({},t.urlToken,t))},{}):e},square:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{hotQuestionList:[],potentialList:[]},t=arguments.length>1?arguments[1]:void 0;if(t.type===nv.GET_RECENT_HOT_QUESTION.success){var n=t.payload.data;return(0,U._)((0,B._)({},e),{hotQuestionList:(void 0===n?[]:n).slice(0,4)})}if(t.type===nv.GET_POTENTIAL_QUESTION.success){var r=t.payload.data;return(0,U._)((0,B._)({},e),{potentialList:r.slice(0,4)})}return e}}),nT=n(35528),nE=(0,B._)({},(0,eT.FH)("guide",["GET_TOPICS","SUBMIT_TOPICS"]),(0,eT.co)("guide",["CHANGE_SELECT_TOPIC"])),nC=(0,e5.combineReducers)({guide:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isShowGuide:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case nE.SUBMIT_TOPICS.request:case nE.SUBMIT_TOPICS.failure:return(0,U._)((0,B._)({},e),{isSubmitTopic:"fail"});case nE.SUBMIT_TOPICS.success:var n=t.payload.success;return(0,U._)((0,B._)({},e),{isSubmitTopic:n?"done":"fail"});case nE.GET_TOPICS.request:case nE.GET_TOPICS.failure:return(0,U._)((0,B._)({},e),{isFetching:!1});case nE.GET_TOPICS.success:var r=t.payload.data;return(0,U._)((0,B._)({data:r},e),{isFetching:!0});case nE.CHANGE_SELECT_TOPIC:var o=t.data.index,i=e.data,a=e.data[o],c=a.relatedTopics,s=a.isFollowing,l=a.isSelected,u=Object.entries(i).map(function(e,t){var n=(0,j._)(e,2),r=(n[0],n[1]);return t===o?(0,U._)((0,B._)({},r),{isFollowing:!s,isSelected:!0}):r}),d=[];if(c&&!l){var p=c.map(function(e){return(0,U._)((0,B._)({},e),{isRelated:!0})});d=(0,g._)(u.slice(0,o+1)).concat((0,g._)(p),(0,g._)(u.slice(o+1)))}else d=u;return{data:(0,B._)({},d),isFetching:!0};default:return e}}}),ny=(0,eT.FH)("helpCenter",["LOAD_QUESTION_CATEGORIES","LOAD_CATEGORY_QUESTIONS","LOAD_COMMON_QUESTIONS","LOAD_QUESTION_DETAIL","LOAD_RELATED_QUESTIONS","SEARCH_QUESTIONS","LOAD_QUESTION_ALL_TYPES","LOAD_FAQ_QUESTIONS","LOAD_FAQ_QUESTION_DETAIL"]),nS={entities:{question:{},category:{}},categories:[],commonQuestions:[],relatedQuestions:{},faqTypes:[]},nI=n(45347),nb=(0,eT.FH)("knowledgePlan",["APPLY_ACTIVITY","LOAD_ALL_CREATION_RANK_LIST","LOAD_FEATURED_QUESTIONS","LOAD_LIST","SEND_MESSAGE"]),nA=(0,e5.combineReducers)({lists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.meta,o=t.payload;return n===nb.LOAD_LIST.success?(0,U._)((0,B._)({},e),(0,X._)({},r.stateKey,o)):e},allCreationRankList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===nb.LOAD_ALL_CREATION_RANK_LIST.success?(0,B._)({},e,r):e},featuredQuestions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===nb.LOAD_FEATURED_QUESTIONS.request?(0,U._)((0,B._)({},e),{isLoading:!0}):n===nb.LOAD_FEATURED_QUESTIONS.failure?(0,U._)((0,B._)({},e),{isLoading:!1}):n===nb.LOAD_FEATURED_QUESTIONS.success?(0,U._)((0,B._)((0,U._)((0,B._)({},e),{isLoading:!1}),r),{data:(0,g._)((null==e?void 0:e.data)||[]).concat((0,g._)(r.data))}):e}}),nZ=n(10416),nw=n(71240),nR=(0,eT.FH)("mcn",["LOAD_RANK_LIST","VOTE_PRODUCT","LOAD_ELIGIBLE_CONTENT","LOAD_CONTENT_PRODUCTS","POST_CONTENT_PRODUCTS"]),nN={products:{},rankList:{total:{},yesterday:{}}},nk=(0,e5.combineReducers)({household:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nN,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,o=t.meta;if(n===nR.LOAD_RANK_LIST.success){var i={},a={};for(var c in r){var s=function(e){var t={},n=[];return e.forEach(function(e){var r=e.linkcardId;t[r]=e,n.push(r)}),{entities:t,ids:n}}(r[c]),l=s.entities,u=s.ids;Object.assign(i,l),a[c]=u}return(0,U._)((0,B._)({},e),{products:(0,B._)({},e.products,i),rankList:(0,U._)((0,B._)({},e.rankList),(0,X._)({},o.type,a))})}if(n===nR.VOTE_PRODUCT.request){var d=o.id,p=o.topicStatus;return(0,U._)((0,B._)({},e),{products:(0,U._)((0,B._)({},e.products),(0,X._)({},d,(0,U._)((0,B._)({},e.products[d]),{topicStatus:p})))})}if(n===nR.VOTE_PRODUCT.failure){var h=o.id,f=o.originalStatus;return(0,U._)((0,B._)({},e),{products:(0,U._)((0,B._)({},e.products),(0,X._)({},h,(0,U._)((0,B._)({},e.products[h]),{topicStatus:f})))})}return e}}),nO=n(38030),nx={isFetching:!1,isDrained:!1,isPrevDrained:!1,result:[],next:null,key:null},nP=function(e,t){var n=e.request,r=e.success,o=e.failure;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nx,i=arguments.length>1?arguments[1]:void 0;switch(i.type){case t:return nx;case n:var a=i.key,c=a!==e.key;return(0,U._)((0,B._)({},c?nx:e),{key:a,isFetching:!0});case r:var s=i.result,l=i.next,u=i.isDrained,d=i.isPrevDrained;return(0,U._)((0,B._)({},e),{result:(0,g._)(e.result).concat((0,g._)(s)),next:l,isDrained:u||s.length<10,isPrevDrained:d,isFetching:!1});case o:return(0,U._)((0,B._)({},e),{isFetching:!1});default:return e}}},nD=n(84),nL=(0,B._)({},(0,eT.FH)("notifications",["GET_RECENT","GET_HISTORY","GET_NOTIFICATION_ACTORS","MARK_ALL_READ"]),(0,eT.co)("notifications",["CHANGE_RECENT_NOTIFICATION_ENTRY","CLEAR_NOTIFICATION_ACTORS"]));new nD.fK.Array(new nD.fK.Object({target:tI.l.USER}));var nB=nP(nL.GET_RECENT,nL.CHANGE_RECENT_NOTIFICATION_ENTRY),nU=nP(nL.GET_HISTORY),nM=nP(nL.GET_NOTIFICATION_ACTORS,nL.CLEAR_NOTIFICATION_ACTORS),nG=(0,e5.combineReducers)({recent:nB,history:nU,notificationActors:nM,recentNotificationEntry:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",t=arguments.length>1?arguments[1]:void 0;return t.type===nL.CHANGE_RECENT_NOTIFICATION_ENTRY?t.entry:e}}),nF=n(6438),nz=n(26797),nH=(0,eT.FH)("publicEditPermission",["GET_PUBLIC_EDIT_PERMMISSION"]),nq=n(19680),nV=n(40195),nX=n(35586),nW=n(72238),nK=n(39041),nj=n(67036),nY=n(87964),nQ=n(53582),nJ=n.n(nQ),n$=n(92769),n0=n.n(n$);n(38322);var n1=n(89910),n2=n.n(n1);["baike_box","edu_course","search_result","one_box","wiki_box","relevant_query","time_box","knowledge_ad","knowledge_result","knowledge_edu","ebook_saltpick","anniversary_activity","video_box","zvideo","koc_box","hot_timing","gaokao","film_box","game_box","education"].concat((0,g._)(x.Z.isMobileEntry?["ncee_2020_activity"]:[])),["baike_box","relevant_query","anniversary_activity","video_box","gaokao","film_box","game_box"].concat((0,g._)(x.Z.isMobileEntry?["ncee_2020_activity"]:[]));var n3=n(44169),n4=(0,eT.FH)("search",["GET_GENERAL","GET_GENERAL_A_DAY","GET_GENERAL_A_WEEK","GET_GENERAL_THREE_MONTHS","GET_PEOPLE","GET_TOPIC","GET_COLUMN","GET_LIVE","GET_KM_COURSE","GET_ALBUM","GET_EBOOK","GET_KM_GENERAL","GET_SUGGEST","GET_TOP_SEARCH","GET_NEW_TOP_SEARCH","GET_PRESET_WORDS","LIKE_TOPIC","CANCEL_LIKE_TOPIC","DISLIKE_TOPIC","GET_MOBILE_TOP_SEARCH","CANCEL_DISLIKE_TOPIC","GET_ZVIDEO","GET_SCHOLAR","GET_SIDEBAR","GET_CALENDAR","GET_SCORES","GET_STATS","GET_COURSES","GET_UNIVERSITIES","GET_ACE_MAJORS","GET_ADMISSIONS_GUIDE","GET_EMPLOYMENT_DESTINATION","GET_CUSTOM_FILTER_TAGS"]),n5=(0,eT.co)("search",["UPDATE_SEARCH_VALUE","CLEAR_SEARCH_QUERY_DATA"]),n6=Object.values(n0()(n4,["GET_TOP_SEARCH","GET_MOBILE_TOP_SEARCH","GET_NEW_TOP_SEARCH"])).map(function(e){return e.success});tI.l.SEARCH_ADVANCED_GENERAL_ARRAY,tI.l.SEARCH_ADVANCED_GENERAL_ONE_DAY_ARRAY,tI.l.SEARCH_ADVANCED_GENERAL_ONE_WEEK_ARRAY,tI.l.SEARCH_ADVANCED_GENERAL_THREE_MONTHS_ARRAY,n4.GET_GENERAL,n4.GET_GENERAL_A_DAY,n4.GET_GENERAL_A_WEEK,n4.GET_GENERAL_THREE_MONTHS,new nD.fK.Array(new nD.fK.Entity("searchKnowledgeGeneral")),new nD.fK.Array(new nD.fK.Entity("searchKnowledge"));var n7=function(e){return e.query},n8=function(e){return"".concat(e.query,"/").concat(e.customQuery)};function n9(e){return{API:{types:n4.GET_SUGGEST,endpoint:"/search/suggest",query:{q:e},headers:{"X-API-Version":"3.0.91","X-App-Za":"OS=Web"}},NOTIFICATION:!1}}var re=(0,e5.combineReducers)({recommendSearch:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;if(n.type===n4.GET_GENERAL.success&&(null===(e=n.payload.relatedSearchResult)||void 0===e?void 0:e.length)){var r=n.payload.relatedSearchResult.map(function(e){return e.object||{}});return n2()((0,g._)(t).concat((0,g._)(r)),function(e,t){return e.id===t.id&&e.type===t.type})}return t},topSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===n4.GET_NEW_TOP_SEARCH.success?t.payload?t.payload.recommendQueries:e:t.type===n4.GET_TOP_SEARCH.success?t.payload?t.payload.topSearch:e:t.type===n4.GET_MOBILE_TOP_SEARCH.success&&t.payload?{words:t.payload.data}:e},searchValue:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===n5.UPDATE_SEARCH_VALUE?{value:t.data.searchValue}:e},suggestSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===n4.GET_SUGGEST.success&&t.payload?t.payload:e},attachedInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{generalByQuery:{}},t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.loadSearchType,o=t.searchType,i=null==n?void 0:n.searchActionInfo;if(n6.includes(t.type)&&i){if("general"===o){var a=n8(t);return(0,U._)((0,B._)({},e),(0,X._)({},r,(0,U._)((0,B._)({},e[r]),(0,X._)({},a,i))))}return(0,U._)((0,B._)({},e),(0,X._)({},r,i))}return e},nextOffset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{generalByQuery:{}},t=arguments.length>1?arguments[1]:void 0;if(t.type===n5.CLEAR_SEARCH_QUERY_DATA)return{};if(n6.includes(t.type)){var n,r=t.nextOffset,o=t.loadSearchType,i=t.payload,a=t.searchType,c=null==i?void 0:null===(n=i.paging)||void 0===n?void 0:n.next,s=c?(0,er.parse)(c.split("?")[1]):{},l=s.offset,u=s.limit,d=l?{offset:Number(l),limit:Number(u)}:{offset:r||0,limit:20};if("general"===a){var p=n8(t);return(0,U._)((0,B._)({},e),(0,X._)({},o,(0,U._)((0,B._)({},e[o]),(0,X._)({},p,d))))}return(0,U._)((0,B._)({},e),(0,X._)({},o,d))}return e},topicReview:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.id,o=t.totalVotes,i=t.currentStatus;switch(n){case n4.LIKE_TOPIC.success:return(0,U._)((0,B._)({},e),(0,X._)({},r,{status:"like",totalVotes:"dislike"===i?o:o+1}));case n4.DISLIKE_TOPIC.success:return(0,U._)((0,B._)({},e),(0,X._)({},r,{status:"dislike",totalVotes:"like"===i?o:o+1}));case n4.CANCEL_LIKE_TOPIC.success:case n4.CANCEL_DISLIKE_TOPIC.success:return(0,U._)((0,B._)({},e),(0,X._)({},r,{status:"none",totalVotes:o-1}))}return e},sidebar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===n4.GET_SIDEBAR.success&&t.payload?t.payload:e},calendar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===n4.GET_CALENDAR.success&&t.payload?t.payload:e},scores:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return t.type===n4.GET_SCORES.success&&t.payload?t.payload:e},majors:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r=n.type,o=n.meta;switch(r){case n4.GET_UNIVERSITIES.request:return(0,U._)((0,B._)({},t),(0,X._)({},o.dataType,(0,U._)((0,B._)({},t[o.dataType]),{isLoading:!0})));case n4.GET_COURSES.success:case n4.GET_STATS.success:return(0,U._)((0,B._)({},t),(0,X._)({},o.dataType,n.payload));case n4.GET_UNIVERSITIES.success:return o.isReset?(0,X._)({},o.dataType,(0,U._)((0,B._)({},n.payload),{isLoading:!1})):(0,U._)((0,B._)({},t),(0,X._)({},o.dataType,(0,U._)((0,B._)({},t[o.dataType],n.payload),{isLoading:!1,universities:(0,g._)((null===(e=t[o.dataType])||void 0===e?void 0:e.universities)||[]).concat((0,g._)(n.payload.universities))})))}return t},university:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.meta;switch(n){case n4.GET_ACE_MAJORS.success:case n4.GET_ADMISSIONS_GUIDE.success:case n4.GET_EMPLOYMENT_DESTINATION.success:case n4.GET_SCORES.success:return(0,U._)((0,B._)({},e),(0,X._)({},r.dataType,t.payload))}return e},generalByQuery:(0,tj.Fd)(n4.GET_GENERAL,{mapActionToKey:n8}),generalByQueryInADay:(0,tj.Fd)(n4.GET_GENERAL_A_DAY,{mapActionToKey:n7}),generalByQueryInAWeek:(0,tj.Fd)(n4.GET_GENERAL_A_WEEK,{mapActionToKey:n7}),generalByQueryInThreeMonths:(0,tj.Fd)(n4.GET_GENERAL_THREE_MONTHS,{mapActionToKey:n7}),peopleByQuery:(0,tj.Fd)(n4.GET_PEOPLE,{mapActionToKey:n7}),topicByQuery:(0,tj.Fd)(n4.GET_TOPIC,{mapActionToKey:n7}),zvideoByQuery:(0,tj.Fd)(n4.GET_ZVIDEO,{mapActionToKey:n7}),scholarByQuery:(0,tj.Fd)(n4.GET_SCHOLAR,{mapActionToKey:n7}),columnByQuery:(0,tj.Fd)(n4.GET_COLUMN,{mapActionToKey:n7}),liveByQuery:(0,tj.Fd)(n4.GET_LIVE,{mapActionToKey:n7}),albumByQuery:(0,tj.Fd)(n4.GET_ALBUM,{mapActionToKey:n7}),eBookByQuery:(0,tj.Fd)(n4.GET_EBOOK,{mapActionToKey:n7}),kmGeneralByQuery:(0,tj.Fd)(n4.GET_KM_GENERAL,{mapActionToKey:n7}),kmCourseByQuery:(0,tj.Fd)(n4.GET_KM_COURSE,{mapActionToKey:n7}),customFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{requestFinished:!1,keys:[],tags:[]},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;if(n===n4.GET_CUSTOM_FILTER_TAGS.success){var o=r.data,i=void 0===o?[]:o;return{requestFinished:!0,keys:(0,g._)(new Set(nJ()(i).map(function(e){return e.group}))),tags:i}}return n===n4.GET_CUSTOM_FILTER_TAGS.failure?(0,U._)((0,B._)({},e),{requestFinished:!0}):e}}),rt=(0,B._)({},(0,eT.FH)("social",["UNBIND_SOCIAL_ACCOUNT","DELETE_SOCIAL_ACCOUNT","GET_SOCIAL_BIND","GET_MESSAGE_SETTING","UPDATE_MESSAGE_SETTING","GET_NOTIFICATION_SETTING","UPDATE_NOTIFICATION_SETTING","GET_EMAIL_SETTING","UPDATE_EMAIL_SETTING","GET_PRIVACY_SETTING","UPDATE_PRIVACY_SETTING","GET_BLOCKED_USERS","UNBLOCK_USER","GET_BLOCKED_FOLLOWEES","UNBLOCK_FOLLOWEE","GET_IGNORED_TOPICS","GET_RESTRICTED_TOPICS","RELEASE_IGNORED_TOPIC","GET_LABORATORY_SETTING","UPDATE_LABORATORY_SETTING","UPDATE_WATERMARK_SETTING","GET_PROFILE","UPDATE_AVATAR","UPDATE_ADMIN_PHONE","UPDATE_ADMIN","GET_ORG_PHONE_VERIFY_CODE","GET_WALL_E_BLACKLIST","UNDO_WALL_E_BLOCK"])),rn=rt.UNBIND_SOCIAL_ACCOUNT,rr=rt.DELETE_SOCIAL_ACCOUNT,ro=rt.GET_SOCIAL_BIND,ri=rt.GET_MESSAGE_SETTING,ra=rt.UPDATE_MESSAGE_SETTING,rc=rt.GET_NOTIFICATION_SETTING,rs=rt.UPDATE_NOTIFICATION_SETTING,rl=rt.GET_EMAIL_SETTING,ru=rt.UPDATE_EMAIL_SETTING,rd=rt.GET_PRIVACY_SETTING,rp=rt.UPDATE_PRIVACY_SETTING,rh=rt.GET_BLOCKED_USERS,rf=rt.UNBLOCK_USER,r_=rt.GET_BLOCKED_FOLLOWEES,rm=rt.UNBLOCK_FOLLOWEE,rv=rt.GET_IGNORED_TOPICS,rg=rt.GET_RESTRICTED_TOPICS,rT=rt.RELEASE_IGNORED_TOPIC,rE=rt.GET_LABORATORY_SETTING,rC=rt.UPDATE_LABORATORY_SETTING,ry=(rt.UPDATE_WATERMARK_SETTING,rt.GET_PROFILE),rS=(rt.UPDATE_AVATAR,rt.UPDATE_ADMIN_PHONE,rt.UPDATE_ADMIN,rt.GET_ORG_PHONE_VERIFY_CODE,rt.GET_WALL_E_BLACKLIST),rI=rt.UNDO_WALL_E_BLOCK,rb={socialBind:null,inboxMsg:null,notification:{},email:{},privacyFlag:null,blockedUsers:{isFetching:!1,paging:{pageNo:1,pageSize:6},data:[]},blockedFollowees:{isFetching:!1,paging:{pageNo:1,pageSize:6},data:[]},ignoredTopics:{isFetching:!1,paging:{pageNo:1,pageSize:6},data:[]},restrictedTopics:null,laboratory:{}};function rA(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,U._)((0,B._)({},e),{isFetching:t})}function rZ(e){var t=e.page,n=e.payload,r=n.paging,o=void 0===r?{}:r,i=n.data;return{paging:(0,B._)({},o,t),data:(void 0===i?[]:i).map(function(e){return(0,U._)((0,B._)({},e),{isBlocked:!0})}),isFetching:!1}}function rw(e,t){var n=e.paging,r=e.data;return{paging:(0,U._)((0,B._)({},n),{totals:n.totals-1}),data:r.map(function(e){return e.urlToken===t?(0,U._)((0,B._)({},e),{isBlocked:!1}):e})}}var rR=n(40861),rN=(0,B._)({},(0,eT.FH)("sms",["SUPPORTED_COUNTRIES"]));function rk(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{supportedCountries:[]},t=arguments.length>1?arguments[1]:void 0;return t.type===rN.SUPPORTED_COUNTRIES.success?{supportedCountries:t.payload.data}:e}var rO=(0,eT.FH)("specials",["GET_SPECIALS","FOLLOW_SPECIAL","UNFOLLOW_SPECIAL"]),rx={entities:{},all:{data:[],paging:{},isLoading:!1}},rP=(0,B._)({},(0,eT.FH)("streaming",["CHECK_WHITE_LIST_STATUS","CHECK_ACTOR_STATUS","LOAD_CATEGORY_DATA","LOAD_ACTIVITY_DATA","CHECK_THEATER_STATUS","GET_THEATER_INFO","GET_PUSH_DRAMA_INFO","START_PUSH_DRAMA","CLOSE_PUSH_DRAMA","GET_PULL_INFO","CREATE_PULL_INFO","UPDATE_PULL_INFO","START_PULL_DRAMA","CLOSE_PULL_DRAMA","START_PREVIEW_PULL_DRAMA","STOP_PREVIEW_PULL_DRAMA"])),rD=n(55344),rL=n(76741),rB=n(61317),rU=n(48825),rM=n(96354),rG=n(37209),rF=n(42412),rz=(0,eT.FH)("WALL-E",["LOAD_PROTECT_HISTORY"]),rH={protectHistory:{total:0,pages:{},entities:{}}},rq=(0,eT.FH)("zhiPlus",["LOAD_ZHIPLUS_PERMISSION"]),rV={permissionStatus:9999},rX=n(41492),rW={common:t9,loading:e7,entities:nm.ZP,currentUser:eE.ZP,account:e8.ZP,settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rb,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;if(n===ro.success)return(0,U._)((0,B._)({},e),{socialBind:r});if(n===rn.success||n===rr.success){var o=t.account,i=(0,B._)({},e.socialBind);return i[o]&&delete i[o],(0,U._)((0,B._)({},e),{socialBind:i})}if(n===ri.success)return(0,U._)((0,B._)({},e),{inboxMsg:r.inboxmsg});if(n===ra.success){var a=t.input;return(0,U._)((0,B._)({},e),{inboxMsg:(0,B._)({},e.inboxMsg,a)})}if(n===rc.success)return(0,U._)((0,B._)({},e),{notification:r});if(n===rs.success){var c=t.input,s=c.key,l=c.option,u=(0,B._)({},e.notification[s],l);return(0,U._)((0,B._)({},e),{notification:(0,U._)((0,B._)({},e.notification),(0,X._)({},s,u))})}if(n===rd.success)return(0,U._)((0,B._)({},e),{privacyFlag:r.memberPrivateFlag});if(n===rl.success)return(0,U._)((0,B._)({},e),{email:r});if(n===ru.success){var d=t.input;return(0,U._)((0,B._)({},e),{email:(0,B._)({},e.email,d)})}if(n===rp.success)return(0,U._)((0,B._)({},e),{privacyFlag:!e.privacyFlag});if(n===rh.request)return(0,U._)((0,B._)({},e),{blockedUsers:rA(e.blockedUsers,!0)});if(n===rh.success)return(0,U._)((0,B._)({},e),{blockedUsers:rZ(t)});if(n===rh.failure)return(0,U._)((0,B._)({},e),{blockedUsers:rA(e.blockedUsers,!1)});if(n===rS.request)return(0,U._)((0,B._)({},e),{wallEBlacklist:rA(e.wallEBlacklist,!0)});if(n===rS.success)return(0,U._)((0,B._)({},e),{wallEBlacklist:rZ(t)});if(n===rS.failure)return(0,U._)((0,B._)({},e),{wallEBlacklist:rA(e.wallEBlacklist,!1)});if(n===rI.success)return(0,U._)((0,B._)({},e),{wallEBlacklist:rw(e.wallEBlacklist,t.meta.urlToken)});if(n===rf.success)return(0,U._)((0,B._)({},e),{blockedUsers:rw(e.blockedUsers,t.meta.urlToken)});if(n===r_.request)return(0,U._)((0,B._)({},e),{blockedFollowees:rA(e.blockedFollowees,!0)});if(n===r_.success)return(0,U._)((0,B._)({},e),{blockedFollowees:rZ(t)});if(n===r_.failure)return(0,U._)((0,B._)({},e),{blockedFollowees:rA(e.blockedFollowees,!1)});if(t.type===ry.success)return(0,U._)((0,B._)({},e),{account:t.payload});if(n===rm.success)return(0,U._)((0,B._)({},e),{blockedFollowees:rw(e.blockedFollowees,t.urlToken)});if(n===rv.request)return(0,U._)((0,B._)({},e),{ignoredTopics:rA(e.ignoredTopics,!0)});if(n===rv.success)return(0,U._)((0,B._)({},e),{ignoredTopics:rZ(t)});if(n===rv.failure)return(0,U._)((0,B._)({},e),{ignoredTopics:rA(e.ignoredTopics,!1)});if(n===rg.success)return(0,U._)((0,B._)({},e),{restrictedTopics:r.data});if(n===rT.success){var p=e.ignoredTopics,h=p.paging,f=p.data;return(0,U._)((0,B._)({},e),{ignoredTopics:{paging:(0,U._)((0,B._)({},h),{totals:h.totals-1}),data:f.filter(function(e){return e.id!==t.id})}})}if(n===rE.success)return(0,U._)((0,B._)({},e),{laboratory:{useTopstory:r.useTopstory.enable}});if(n===rC.success){var _=t.input.useTopstory;return(0,U._)((0,B._)({},e),{laboratory:{useTopstory:_}})}return e},notification:tD.ZP,people:nF.ZP,env:eC.ZP,me:eE.me,label:nZ.ZP,ecommerce:e6.B},rK={comments:t$,commentsV2:t3,pushNotifications:nq.ZP,messages:nO.ZP,register:nW.ZP,login:eS.ZP,switches:rD.ZP,captcha:tT.ZP,sms:rk,chat:tO,emoticons:n_.ZP,creator:nt.ZP,creators:ns.ZPm};(0,e5.combineReducers)((0,U._)((0,B._)({},rW,rK),{question:nV.ZP,shareTexts:rR.ZP,answers:te.ZP,banner:tn.ZP,topic:rL.ZP,captcha:tT.ZP,sms:rk,explore:ng,articles:tt.ZP,favlists:nT.ZP,pins:nz.ZP,topstory:rB.ZP,upload:rU.ZP,video:rG.ZP,zvideos:rX.ZP,guide:nC,reward:nj.ZP,search:re,creator:nt.ZP,creatorSalt:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nu,t=arguments.length>1?arguments[1]:void 0,n=t.payload;switch(t.type){case nl.GET_QUESTION_RECOMMEND.success:return(0,U._)((0,B._)({},e),{recommendQuestionList:n.data});case nl.GET_BANNER_IMG_LIST.success:return(0,U._)((0,B._)({},e),{bannerList:JSON.parse(n.data.config).list});case nl.GET_CLAIM_BANNER_IMG_LIST.success:return(0,U._)((0,B._)({},e),{claimBannerList:JSON.parse(n.data.config).list});case nl.GET_AUTHOR_WEBSITES.success:return(0,U._)((0,B._)({},e),{sites:n.data});case nl.GET_AUTHOR_CONTRIBUTES_DOMAIN.success:return(0,U._)((0,B._)({},e),{domains:n});case nl.GET_AUTHOR_CONTRIBUTES_DOMAIN_ALL.success:return(0,U._)((0,B._)({},e),{domainsAll:n});case nl.GET_AUTHOR_STATUS.success:return(0,U._)((0,B._)({},e),{hasRecored:n.hasRecored,hasClaim:n.hasClaim});case nl.GET_AUTHOR_STATUS_NEW.success:return(0,U._)((0,B._)({},e),{statusFetched:!0,hasClue:n.isClue,hasContract:n.isSettlementContract,isExclusive:1===n.exclusiveLevel,isInstitution:n.isInstitution,isOperation:n.isOperatorAccount});case nl.GET_AUTHOR_CONTRIBUTES_LIST.success:return(0,U._)((0,B._)({},e),{hasContributedList:n.data,contributesTotal:n.paging});case nl.GET_DRAFT_INFO.success:return(0,U._)((0,B._)({},e),{previewPageTitle:n.title,previewPageContent:n.content});case nl.GET_REST_CONTRIBUTION_NUMBER.success:return(0,U._)((0,B._)({},e),{restContributionNumber:n.specificNum});case nl.GET_REST_CONTRIBUTION_NUMBER.failure:return(0,U._)((0,B._)({},e),{restContributionNumber:0});case nl.GET_DRAFT_INFO.failure:return(0,U._)((0,B._)({},e),{previewPageTitle:"",previewPageContent:""});case nl.GET_STATUS_COUNT.success:return(0,U._)((0,B._)({},e),{statusCount:n,restContributionNumber:3-((null==n?void 0:n.submit)||0)});case nl.GET_STATUS_COUNT.failure:return(0,U._)((0,B._)({},e),{restContributionNumber:0});case nl.GET_UNREAD_COUNT.success:return(0,U._)((0,B._)({},e),{unread:null==n?void 0:n.unreadCount})}return e},publicEditPermission:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===nH.GET_PUBLIC_EDIT_PERMMISSION.success){var n=t.payload,r=n.isQuestionRedirectEditable,o=n.isQuestionTopicEditable,i=n.isQuestionEditable;return(0,U._)((0,B._)({},e),{isQuestionRedirectEditable:r,isQuestionTopicEditable:o,isQuestionEditable:i})}return e},readStatus:nX.ZP,draftHistory:nd.ZP,notifications:nG,specials:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rx,t=arguments.length>1?arguments[1]:void 0;if(t.type===rO.GET_SPECIALS.request)return(0,U._)((0,B._)({},e),{all:(0,U._)((0,B._)({},e.all),{isLoading:!0})});if(t.type===rO.GET_SPECIALS.success){var n=t.payload,r=n.data,o=n.paging;return(0,U._)((0,B._)({},e),{entities:(0,B._)({},e.entities||{},r.reduce(function(e,t){return(0,B._)((0,X._)({},t.id,t),e)},{})),all:{data:(0,g._)(e.all.data).concat((0,g._)(r.map(function(e){return e.id}))),paging:o,isLoading:!1}})}if(t.type===rO.GET_SPECIALS.failure)return(0,U._)((0,B._)({},e),{all:(0,U._)((0,B._)({},e.all),{paging:(0,U._)((0,B._)({},e.all.paging),{isEnd:!0}),isLoading:!1})});if([rO.FOLLOW_SPECIAL.request,rO.UNFOLLOW_SPECIAL.failure].includes(t.type)){var i=t.meta.id,a=e.entities;return a[i]?(0,U._)((0,B._)({},e),{entities:(0,U._)((0,B._)({},a),(0,X._)({},i,(0,U._)((0,B._)({},a[i]),{isFollowing:!0})))}):e}if([rO.UNFOLLOW_SPECIAL.request,rO.FOLLOW_SPECIAL.failure].includes(t.type)){var c=t.meta.id,s=e.entities;return s[c]?(0,U._)((0,B._)({},e),{entities:(0,U._)((0,B._)({},s),(0,X._)({},c,(0,U._)((0,B._)({},s[c]),{isFollowing:!1})))}):e}return e},collections:tx.ZP,userProfit:rM.ZP,mcn:nw.ZP,mcnActivity:nk,brand:tr.ZP,host:nI.ZP,campaign:tg,knowledgePlan:nA,wallE:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rH,t=arguments.length>1?arguments[1]:void 0;if(t.type===rz.LOAD_PROTECT_HISTORY.success){var n=t.meta,r=t.payload,o=r.data,i=r.paging.totals;return(0,U._)((0,B._)({},e),{protectHistory:(0,rF.q)(e.protectHistory,n.paging,{data:o,total:i})})}return e},roundtables:nY.ZP,helpCenter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nS,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,o=t.meta;if(n===ny.LOAD_QUESTION_CATEGORIES.success){var i={},a=r.data.map(function(e){var t=e.id;return i[t]=(0,U._)((0,B._)({},e),{questions:[]}),t});return(0,U._)((0,B._)({},e),{entities:(0,U._)((0,B._)({},e.entities),{category:i}),categories:a})}if(n===ny.LOAD_CATEGORY_QUESTIONS.success){var c={},s=r.data.map(function(e){var t=e.id;return c[t]=e,t});return(0,U._)((0,B._)({},e),{entities:(0,U._)((0,B._)({},e.entities),{category:(0,U._)((0,B._)({},e.entities.category),(0,X._)({},o.categoryId,(0,U._)((0,B._)({},e.entities.category[o.categoryId]),{questions:s}))),question:(0,B._)({},e.entities.question,c)})})}if(n===ny.LOAD_COMMON_QUESTIONS.success){var l={},u=r.data.map(function(e){var t=e.id;return l[t]=e,t});return(0,U._)((0,B._)({},e),{entities:(0,U._)((0,B._)({},e.entities),{question:(0,B._)({},e.entities.question,l)}),commonQuestions:u})}if(n===ny.LOAD_QUESTION_DETAIL.success)return(0,U._)((0,B._)({},e),{entities:(0,U._)((0,B._)({},e.entities),{question:(0,U._)((0,B._)({},e.entities.question),(0,X._)({},r.id,r))})});if(n===ny.LOAD_RELATED_QUESTIONS.success){var d={},p=r.data.map(function(e){var t=e.id;return d[t]=e,t});return(0,U._)((0,B._)({},e),{entities:(0,U._)((0,B._)({},e.entities),{question:(0,B._)({},e.entities.question,d)}),relatedQuestions:(0,U._)((0,B._)({},e.relatedQuestions),(0,X._)({},o.questionId,p))})}return n===ny.LOAD_QUESTION_ALL_TYPES.success?(0,U._)((0,B._)({},e),{faqTypes:null==r?void 0:r.data}):e},republish:nK.ZP,commercialReport:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t6,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,o=t.meta;if(n===t4.success){var i=r.data||{},a=i.isReported,c=i.commercialTypes,s=void 0===c?[]:c,l=o.type,u=o.urlToken;return(0,B._)((0,U._)((0,B._)({},e),{commercialTypes:s}),u&&(0,X._)({},"".concat(l,"s"),(0,X._)({},u,{isCommercialReported:a,selectedCommercialTypes:s.filter(function(e){return e.isRecognized})})))}if(n===t5){var d=o.questionId,p=r.isCommercialReported;return(0,U._)((0,B._)({},e),{questions:(0,X._)({},d,{isCommercialReported:p})})}return e},creatorMCN:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:na,t=arguments.length>1?arguments[1]:void 0,n=t.payload;switch(t.type){case ni.GET_HOME_DATA.success:return(0,U._)((0,B._)({},e),{mcn:n.mcn,mcnStatistics:n.mcnStatistics,mcnRight:n.mcnRight||{}});case ni.GET_HOME_DATA.failure:if(2e4===t.err.payload.code)return(0,U._)((0,B._)({},e),{isNoAuth:!0});break;case ni.GET_CREATOR_MANAGE_DATA.success:return(0,U._)((0,B._)({},e),{creatorManageData:n.data,creatorManageDataTotal:n.paging.totals});case ni.GET_CREATOR_CHEESE_MANAGE_DATA.success:return(0,U._)((0,B._)({},e),{creatorCheeseManageData:n.data,creatorCheeseManageDataTotal:n.paging.totals});case ni.GET_MCN_DOMAINS.success:return(0,U._)((0,B._)({},e),{mcnDomains:n.data});case ni.LOAD_PAYMENT_LIST.success:return(0,U._)((0,B._)({},e),{bill:(0,U._)((0,B._)({},e.bill),{list:n})});case ni.LOAD_PAYMENT_DETAIL.success:return(0,U._)((0,B._)({},e),{bill:(0,U._)((0,B._)({},e.bill),{detail:n})});case ni.GET_HEALTH_SCORE.success:return(0,U._)((0,B._)({},e),{healthScore:n});case ni.LOAD_HEALTHSCORE_LIST.success:return(0,U._)((0,B._)({},e),{healthScoreRecordInfo:n});case ni.LOAD_STATISTIC_HEALTH_SCORE_DATA.success:return(0,U._)((0,B._)({},e),{statisticHealthScoreData:n.data});case ni.BEFORE_DOWNLOAD_CHECK.success:return(0,U._)((0,B._)({},e),{beforeDownloadCheckResult:n.data})}return e},commentManage:tW,commentPermission:tK.ZP,creatorRightStatus:nc.ZP,zhiPlus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rV,t=arguments.length>1?arguments[1]:void 0;if(t.type===rq.LOAD_ZHIPLUS_PERMISSION.success){var n=t.payload.permissionStatus;return(0,U._)((0,B._)({},e),{permissionStatus:null==n?void 0:n.zhiZixuan})}return e},streaming:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.meta;switch(t.type){case rP.CHECK_WHITE_LIST_STATUS.success:return(0,U._)((0,B._)({},e),{showCategorySelector:(null==n?void 0:n.isMediaExternal)!==1,whiteListStatus:null==n?void 0:n.status});case rP.CHECK_ACTOR_STATUS.request:return(0,U._)((0,B._)({},e),{isCheckingStatus:!0});case rP.CHECK_ACTOR_STATUS.success:return(0,U._)((0,B._)({},e),{actorStatus:n,isCheckingStatus:!1});case rP.CHECK_ACTOR_STATUS.failure:var o=t.err,i=(void 0===o?{}:o).payload;return(0,U._)((0,B._)({},e),{actorStatus:i,isCheckingStatus:!1});case rP.LOAD_CATEGORY_DATA.success:var a=n.data;return(0,U._)((0,B._)({},e),{categoryList:a});case rP.LOAD_ACTIVITY_DATA.success:var c=n.data;return(0,U._)((0,B._)({},e),{activities:c});case rP.CHECK_THEATER_STATUS.success:return(0,U._)((0,B._)({},e),{theater:null==n?void 0:n.theater});case rP.GET_THEATER_INFO.success:var s=n.theater,l=(void 0===s?{}:s).drama;return(0,U._)((0,B._)({},e),{currentDramaInfo:l});case rP.GET_PUSH_DRAMA_INFO.success:return(0,U._)((0,B._)({},e),{pushStreamingRes:n});case rP.START_PUSH_DRAMA.success:return(0,U._)((0,B._)({},e),{currentDramaInfo:null==n?void 0:n.drama});case rP.GET_PULL_INFO.success:return(0,U._)((0,B._)({},e),{currentPullInfo:n});case rP.CREATE_PULL_INFO.success:return(0,U._)((0,B._)({},e),{currentPullInfo:(0,U._)((0,B._)({},e.currentPullInfo,r.data),{id:n.id})});case rP.UPDATE_PULL_INFO.success:return(0,U._)((0,B._)({},e),{currentPullInfo:(0,B._)({},e.currentPullInfo,r.data)});case rP.START_PULL_DRAMA.success:return(0,U._)((0,B._)({},e),{currentPullInfo:(0,U._)((0,B._)({},e.currentPullInfo),{theater:(0,U._)((0,B._)({},e.currentPullInfo.theater),{drama:n.drama})})});case rP.START_PREVIEW_PULL_DRAMA.success:return(0,U._)((0,B._)({},e),{currentPullInfo:(0,U._)((0,B._)({},e.currentPullInfo),{preview:n})});case rP.STOP_PREVIEW_PULL_DRAMA.success:return(0,U._)((0,B._)({},e),{currentPullInfo:(0,U._)((0,B._)({},e.currentPullInfo),{preview:void 0})})}return e},creationRanking:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===ne.GET_CREATION_RANKING.success?(0,U._)((0,B._)({},e),{creationRankData:t.payload}):t.type===ne.GET__CREATION_RANKING_POSTER.success?(0,U._)((0,B._)({},e),{posterData:t.payload}):t.type===ne.GET_CREATION_RANKING_TYPE.success?(0,U._)((0,B._)({},e),{rankTypeData:t.payload}):t.type===ne.GET__CREATION_RANKING_MONTHLIST.success?(0,U._)((0,B._)({},e),{monthList:t.payload}):e},eduSections:nf.ZP,adPromotion:e9.ZP,editVideo:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nh,n=arguments.length>1?arguments[1]:void 0;return n.type===np.GET_ENABLED.success?(0,U._)((0,B._)({},t),{editVideoEnabled:null===(e=n.payload)||void 0===e?void 0:e.pinVideoSwitch}):t}}));var rj=n(10886),rY=n(61436),rQ=n(35102),rJ=function(e){var t=e.width,n=e.height;return t>=1366&&n>=550},r$="articleDraft",r0=(0,B._)({},(0,eT.FH)(r$,["UPLOAD_COVER","UPLOAD_CONTENT_IMAGE","UPLOAD_VIDEO","UPDATE_DRAFT","GET_DRAFT","REVIEW_COLUMN","PUBLISH_COLUMN","LOAD_DISCLAIMERS","ADD_TOPIC","DELETE_TOPIC","FETCH_RECOMMEND_TOPIC","SCHEDULED_PUBLISH","CANCEL_SCHEDULED_PUBLISH","VALIDATE_SCHEDULED_PUBLISH","LOAD_LIMITED","LOAD_CITYS"]),(0,eT.co)(r$,["TOGGLE_FULL_SCREEN","REMOVE_COVER","RESET_DRAFT","SELECT_COLUMN"])),r1=r0.UPLOAD_COVER,r2=r0.UPLOAD_CONTENT_IMAGE,r3=r0.UPLOAD_VIDEO,r4=r0.UPDATE_DRAFT,r5=r0.GET_DRAFT,r6=r0.REVIEW_COLUMN,r7=r0.PUBLISH_COLUMN,r8=r0.LOAD_DISCLAIMERS,r9=r0.ADD_TOPIC,oe=r0.DELETE_TOPIC,ot=r0.FETCH_RECOMMEND_TOPIC,on=(r0.TOGGLE_FULL_SCREEN,r0.REMOVE_COVER),or=r0.RESET_DRAFT,oo=r0.SELECT_COLUMN,oi=r0.LOAD_LIMITED;function oa(e,t,n){var r=new FormData;return"string"==typeof t?r.append("url",t):(t.length&&(t=t[0]),r.append("picture",t)),n&&r.append("source",n),{API:{types:e,endpoint:"uploaded_images",root:x.Z.fetchRoot.zhuanlan,method:"POST",body:r}}}function oc(e,t,n){return function(r){return(0,rU.x1)(t,(0,B._)({autoRotate:!1},n&&{source:n})).then(function(t){return r({type:e.success,payload:(0,M.camelizeKeys)(t)})},function(t){return r({type:e.failure,err:t})})}}function os(e){var t=e.payload,n=t.dataRawheight,r=t.dataRawwidth,o=t.hash;return{url:t.src,width:r,height:n,id:o,watermark:t.watermark,watermarkSrc:t.watermarkSrc,originalSrc:t.originalSrc}}function ol(e){return{API:{root:x.Z.fetchRoot.zhuanlan,method:"GET",types:r8,endpoint:"articles/".concat(e,"/disclaimers")}}}function ou(e,t){return{API:{types:r9,endpoint:"articles/".concat(e,"/topics"),root:x.Z.fetchRoot.zhuanlan,method:"POST",body:t}}}function od(e){return function(t,n){n().selectedColumn!==e&&t({type:oo,payload:e})}}var op={titleImage:"",titleImageSize:{},isTitleImageFullScreen:!1,canTitleImageFullScreen:!1,title:"",titleImageUploading:!1,error:"",content:"",draftLoading:!1,updating:!1,globalLoading:!1,pendingVideo:{resource:null,error:null},deleteFail:{fail:!1},recommendTopics:[],selectedColumn:0,articleDisclaimers:[]},oh=(0,tv.P1)([eE.ib,function(e){return e.articleDraft},function(e){return e.me.columnContributions},eC.Hu,function(e){return e.userProfit.permission.visible},eE.W5,eE.wY],function(e,t,n,r,o,i,a){return{currentUser:e,draft:t,myColumns:n,isMobile:r,showUserProfitButton:o,isOrg:i,currentUserToken:a}}),of=n(97712),o_=n(83213),om="columnAutocomplete",ov=(0,B._)({},(0,eT.FH)(om,["FETCH_TOPICS","FETCH_USERS","FETCH_MY_FRIENDS"]),(0,eT.co)(om,["RESET_USERS","RESET_FRIENDS"])),og={users:[],friends:[]},oT=n(24316),oE=(0,eT.FH)("column",["IGNORE_CONTRIBUTE_REQUEST","GET_RECOMMENDED_CONTRIBUTORS","INVITE_CONTRIBUTOR","CANCEL_INVITE_CONTRIBUTOR","SET_AUTO_INVITE"]),oC=(0,e5.combineReducers)({contributeRequests:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===oE.IGNORE_CONTRIBUTE_REQUEST.success?e.filter(function(e){return e.article.id!==t.articleId}):e},autoInviteEnabled:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return t.type===oE.GET_RECOMMENDED_CONTRIBUTORS.success?!!t.payload.isAuto:t.type===oE.SET_AUTO_INVITE.success?t.meta:e},recommendedContributors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===oE.GET_RECOMMENDED_CONTRIBUTORS.success?t.payload.data:t.type===oE.INVITE_CONTRIBUTOR.success?e.map(function(e){return e.author.id===t.userId?(0,U._)((0,B._)({},e),{hasInvited:!0}):e}):e}}),oy=(0,eT.FH)("previewArticle",["GET"]),oS=(0,eT.FH)("recommendations",["GET","GET_HOME"]);function oI(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){return n({API:{root:x.Z.fetchRoot.zhuanlan,types:oS.GET_HOME,endpoint:"/recommendations/".concat(e),query:t}})}}var ob="requestColumn",oA=(0,B._)({},(0,eT.FH)(ob,["SUBMIT_REQUEST","CHECK_REQUEST","GET_CATEGORIES"]),(0,eT.co)(ob,["CLEAR_REQUEST_ERROR"])),oZ={categories:[],error:null},ow=(0,e5.combineReducers)((0,U._)((0,B._)({},rW,rK),{answers:te.ZP,sms:rk,comments:t$,recommendation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{homeRecommendations:[]},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,o=t.parentId;if(n===oS.GET.success){var i,a=e[o]?e[o].data:[];if(!Array.isArray(r.data))return e;var c=(0,g._)(a).concat((0,g._)(r.data));return(0,U._)((0,B._)({},e),(i={},(0,X._)(i,o,{data:c,paging:r.paging}),(0,X._)(i,"list",c),i))}return n===oS.GET_HOME.success&&Array.isArray(r.data)?(0,U._)((0,B._)({},e),{homeRecommendations:r.data.filter(Boolean)}):e},shareTexts:rR.ZP,articles:tt.ZP,previewPost:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.payload;return t.type===oy.GET.success&&n?n:e},favlists:nT.ZP,columns:rj.ZP,reward:nj.ZP,video:rG.ZP,switches:rD.ZP,messages:nO.ZP,register:nW.ZP,login:eS.ZP,topstory:rB.ZP,readStatus:nX.ZP,column:o_.ZP,requestColumn:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oZ,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case oA.SUBMIT_REQUEST.success:var n=t.payload.manualCensor;return(0,U._)((0,B._)({},e),{manualCensor:n,error:null});case oA.CHECK_REQUEST.success:case oA.CLEAR_REQUEST_ERROR:return(0,U._)((0,B._)({},e),{error:null});case oA.SUBMIT_REQUEST.failure:case oA.CHECK_REQUEST.failure:return(0,U._)((0,B._)({},e),{error:t.err.payload});case oA.GET_CATEGORIES.success:return(0,U._)((0,B._)({},e),{categories:t.payload.data||[]})}return e},articleContribution:rY.ZP,columnContribution:oC,draftHistory:nd.ZP,upload:rU.ZP,articleDraft:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:op,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case r0.UPLOAD_COVER.request:return(0,U._)((0,B._)({},n),{titleImageUploading:!0});case r0.UPLOAD_COVER.success:var o=os(r),i=o.url,a=o.width,c=o.height,s=rJ({width:a,height:c});return(0,U._)((0,B._)({},n),{titleImage:i,titleImageSize:{width:a,height:c},canTitleImageFullScreen:s,isTitleImageFullScreen:s,titleImageUploading:!1});case r0.UPLOAD_COVER.failure:return(0,U._)((0,B._)({},n),{titleImageUploading:!1});case r0.UPLOAD_CONTENT_IMAGE.request:return(0,U._)((0,B._)({},n),{globalLoading:!0});case r0.UPLOAD_CONTENT_IMAGE.success:case r0.UPLOAD_CONTENT_IMAGE.failure:return(0,U._)((0,B._)({},n),{globalLoading:!1});case r0.UPLOAD_VIDEO.request:return(0,U._)((0,B._)({},n),{globalLoading:!0,pendingVideo:(0,B._)({},n.pendingVideo)});case r0.UPLOAD_VIDEO.success:return(0,U._)((0,B._)({},n),{globalLoading:!1,pendingVideo:(0,U._)((0,B._)({},n.pendingVideo),{resource:r.payload})});case r0.UPLOAD_VIDEO.failure:return(0,U._)((0,B._)({},n),{globalLoading:!1,pendingVideo:(0,B._)({},n.pendingVideo)});case r0.DELETE_TOPIC.failure:return(0,U._)((0,B._)({},n),{deleteFail:!0});case r0.TOGGLE_FULL_SCREEN:return(0,U._)((0,B._)({},n),{isTitleImageFullScreen:!n.isTitleImageFullScreen});case r0.REMOVE_COVER:return(0,U._)((0,B._)({},n),{titleImage:"",titleImageSize:{},isTitleImageFullScreen:!1,canTitleImageFullScreen:!1});case r0.RESET_DRAFT:return(0,U._)((0,B._)({},n),{content:"",title:""});case r0.UPDATE_DRAFT.request:var l=r.meta.id;return(0,U._)((0,B._)({},n),{draftLoading:!l,updating:!0});case r0.UPDATE_DRAFT.success:var u=r.meta,d=r.payload,p=u.body,h=(0,U._)((0,B._)({},n0()(p,["isTitleImageFullScreen","delta_time"]),d),{updatedTime:new Date().toISOString(),updating:!1,draftLoading:!1,error:""});return(0,B._)({},n,h);case r0.UPDATE_DRAFT.failure:return(0,U._)((0,B._)({},n),{updating:!1,draftLoading:!1,error:function(e){if(!e)return"尝试保存时发生未知错误";var t=e.message,n=e.status,r=e.payload,o=e.errors;return r&&r.message?"尝试保存时发生错误：".concat(r.message):Array.isArray(o)&&o[0]?"尝试保存时发生错误：".concat(o[0].message):t?(0,rQ.hu)(t)?"尝试保存时发生网络请求错误":t.startsWith("request http")?"尝试保存时发生错误".concat(n?"："+n:""):"尝试保存时发生错误：".concat(t):""}(r.err||r.error)});case r0.GET_DRAFT.success:var f=r.payload;return(0,U._)((0,B._)({},n,f),{updatedTime:new Date(1e3*f.updated).toISOString()});case r0.FETCH_RECOMMEND_TOPIC.success:return(0,U._)((0,B._)({},n),{recommendTopics:r.payload.data||[]});case r0.LOAD_DISCLAIMERS.success:return(0,U._)((0,B._)({},n),{articleDisclaimers:r.payload.data});case r0.SELECT_COLUMN:return(0,U._)((0,B._)({},n),{selectedColumn:r.payload});case r0.CANCEL_SCHEDULED_PUBLISH.success:return(0,U._)((0,B._)({},n),{schedule:null});case r0.LOAD_CITYS.success:return(0,U._)((0,B._)({},n),{cityData:null===(e=r.payload)||void 0===e?void 0:null===(t=e.data)||void 0===t?void 0:t.regions});default:return n}},articleDrafts:of.ZP,columnAutocomplete:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:og,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ov.FETCH_USERS.success:return(0,U._)((0,B._)({},e),{users:t.payload.data||[]});case ov.RESET_USERS:return(0,U._)((0,B._)({},e),{users:[]});case ov.FETCH_MY_FRIENDS.success:return(0,U._)((0,B._)({},e),{friends:t.payload.data||[]});case ov.RESET_FRIENDS:return(0,U._)((0,B._)({},e),{friends:[]});default:return e}},columnCollection:oT.ZP,ecommerce:e6.B,chat:tO,emoticons:n_.ZP,userProfit:rM.ZP,mcn:nw.ZP,zvideos:rX.ZP,republish:nK.ZP,commentPermission:tK.ZP,creatorRightStatus:nc.ZP,adPromotion:e9.ZP})),oR=n(19076),oN=(0,nn.isBrowser)()?(0,v.tZ)(oR.Route,{path:"*",onEnter:function(e){var t=e.location;if(/^\/{2,}/.test(t.pathname)){var n=(0,j._)(/^\/{1,}(\/.*)$/.exec(t.pathname),2)[1];t.pathname=n}window.location="".concat(t.pathname).concat(t.search)}}):null,ok=/#comment-(\d+)/,oO=function(e,t){"undefined"!=typeof window&&window.Raven&&window.Raven.captureException(e,{logger:"RouteLoader",fingerprint:["RouteLoader"],extra:t})},ox=function(e){return function(){return e().then(function(e){return e.default}).catch(function(e){return oO(e,{target:"resolveComponent"}),eK.Ko})}},oP=n(18645);function oD(e){return e.routes[e.routes.length-1].name}var oL=n(20857),oB=n(86325),oU=n(85626),oM=n(45913),oG=n(14168),oF=n.n(oG),oz=n(11786),oH=n(32546),oq=n(67814),oV=n.n(oq),oX=n(87641),oW=n(69383),oK=n(26113),oj=n(21060),oY=n(30016),oQ=n(38889),oJ=n(79446),o$=n(93653),o0=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"render",value:function(){var e=this.props.hideSubtitle;return(0,v.BX)("a",{className:"OrgZhihuLogo",href:"/organization","aria-label":"知乎机构号",children:[(0,v.tZ)(o$.Z,{}),!e&&(0,v.tZ)("span",{className:"OrgZhihuLogo-appName",children:"机构号"})]})}}]),n}(b.PureComponent);function o1(){var e=(0,oJ.Z)(["email"]);return(0,v.tZ)("header",{role:"banner",className:"OrgAppHeader","data-za-module":"TopNavBar",children:(0,v.BX)("div",{className:"OrgAppHeader-inner",children:[(0,v.tZ)(o0,{}),(0,v.BX)("div",{className:"OrgAppHeader-userInfo",children:[(0,v.tZ)(ek.ql,{title:"机构号 - 知乎"}),(null==e?void 0:e.email)||"",(0,v.tZ)(oQ.ZP,{preset:"link",onClick:function(){location.href="/logout?next=/org/signup"},children:"退出"})]})]})})}var o2=n(24405);function o3(){var e=(0,ex.n)(),t=(0,o2.F)().colors;return e.Safari?(0,v.tZ)(eB.xB,{styles:{html:{"&:after":{content:'""',width:"100%",height:100,background:t.GBK99A,position:"fixed",top:-100,zIndex:2}}}}):null}var o4=n(26609),o5=n(17518),o6=n(85576),o7=n(25734),o8={institutionIndex:"/index",zvideo:"/zvideo"},o9=[{primary:!1,name:"follow",text:"关注",path:"/follow",path_if_org:"/follow",cookieValue:"f"},{primary:!0,name:"recommend",text:"推荐",path:"/",path_if_org:o8.institutionIndex,cookieValue:"r"},{primary:!1,name:"hot",text:"热榜",path:"/hot",path_if_org:"/hot",cookieValue:"h"},{primary:!1,name:"zvideo",text:"视频",path:o8.zvideo,path_if_org:o8.zvideo,cookieValue:"v"}],ie=n(11625),it=n.n(ie),ir=o9.map(function(e){return(0,U._)((0,B._)({},e),{path:e.path_if_org})}),io={tabsMapByName:it()(ir,"name"),tabsMapByCookie:it()(ir,"cookieValue"),tabsMapByPath:it()(ir,"path")},ii={tabsMapByName:it()(o9,"name"),tabsMapByCookie:it()(o9,"cookieValue"),tabsMapByPath:it()(o9,"path")},ia=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isOrg:!1},n=t.isOrg,r=void 0!==n&&n;(0,q._)(this,e),this.TABS_TABLE=r?ir:o9,this.PRIMARY_TAB=this.TABS_TABLE.find(function(e){return e.primary}),this.maps=r?io:ii}return(0,V._)(e,[{key:"isCurrCookiePrimary",value:function(e){return e===this.PRIMARY_TAB.cookieValue}},{key:"getTabByCookie",value:function(e){return this.maps.tabsMapByCookie[e]}},{key:"getTabByName",value:function(e){return this.maps.tabsMapByName[e]}},{key:"getTabByPath",value:function(e){return this.maps.tabsMapByPath[e]}}]),e}(),ic=n(45471),is=n(44066),il=n(24752),iu=n(97727),id=n(42559),ip=n.n(id),ih=n(20308),i_=function(e){var t=function(t){var n=e(t);if(n)return(t||window.event).returnValue=n,n};return window.addEventListener("beforeunload",t),function(){return window.removeEventListener("beforeunload",t)}},im=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"componentDidMount",value:function(){this.unsubscriber=i_(this.props.onUnload)}},{key:"componentWillUnmount",value:function(){this.unsubscriber()}},{key:"render",value:function(){return this.props.children||null}}]),n}(b.Component),iv=n(26921),ig=n(56828),iT=n(27521),iE=n(9338),iC=n(30971),iy=n(65733),iS=n(84871),iI=n.n(iS),ib=n(62250);nV.Kx;var iA=n(64512),iZ=n(55698),iw={title:"AskQuestion::title",topics:"AskQuestion::topics",detail:"AskQuestion::detail"},iR=function(){var e=O().get(iw.detail)||"";if(e&&"undefined"!==e){var t=e.html||e;if("string"==typeof t)return t}return""},iN=function(e){Object.keys(e).forEach(function(t){var n=iw[t];n&&void 0!==e[t]&&O().set(n,e[t])})},ik=function(e){return"commercial"===e},iO=function(e){return ik(e)?2:0},ix=function(e,t){var n,r;if(t)return null===(n=null===(r=e.people.brands)||void 0===r?void 0:r.find(function(e){return e.id===t}))||void 0===n?void 0:n.logo},iP=function(e){var t=e.questionType,n=e.brandId,r=e.brand,o=e.isAnonymous,i=e.css,a=(0,K._)(e,["questionType","brandId","brand","isAnonymous","css"]),c=(0,eM.useSelector)(function(e){var i;if(!o)return ik(t)?(null==r?void 0:r.logo)||ix(e,n):null===(i=(0,eE.ib)(e))||void 0===i?void 0:i.avatarUrl});return(0,v.tZ)(iZ.qE,(0,B._)({size:40,url:c,css:i},a))},iD=n(60414),iL=n(45001),iB=n(48504),iU=(r=r||{},i=(o=b.createContext(r)).Provider,a=o.Consumer,{consume:function(e){return function(t){e=e||function(e){return e};var n=function(n){(0,oB._)(o,n);var r=(0,oU._)(o);function o(){return(0,q._)(this,o),r.apply(this,arguments)}return(0,V._)(o,[{key:"render",value:function(){var n=this.props,r=n.forwardedRef,o=(0,K._)(n,["forwardedRef"]);return(0,v.tZ)(a,{children:function(n){return(0,v.tZ)(t,(0,U._)((0,B._)({ref:r},o,e(n)),{onChangeContext:n.onChangeContext}))}})}}]),o}(b.Component);return iI()(b.forwardRef(function(e,t){return(0,v.tZ)(n,(0,U._)((0,B._)({},e),{forwardedRef:t}))}),t)}},provide:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return function(t){var n=function(n){(0,oB._)(o,n);var r=(0,oU._)(o);function o(){var t;return(0,q._)(this,o),t=r.apply(this,arguments),(0,X._)((0,oL._)(t),"state",(0,B._)({},"function"==typeof e?e(t.props):e)),(0,X._)((0,oL._)(t),"handleChange",function(e,n){return t.setState(e,n)}),t}return(0,V._)(o,[{key:"render",value:function(){return(0,v.tZ)(i,{value:(0,B._)({onChangeContext:this.handleChange},this.state),children:(0,v.tZ)(t,(0,U._)((0,B._)({},this.props,this.state),{onChangeContext:this.handleChange}))})}}]),o}(b.Component);return iI()(n,t)}}}),iM=iU.provide,iG=iU.consume,iF=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"handleChange",function(t){return e.props.onChangeContext({brandId:t})}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.brandId,n=e.data,r=n&&n.payload&&n.payload.data||[];return(0,v.tZ)(iL.Z,(0,U._)((0,B._)({className:"AskBrand",listClassName:"AskBrand--list"},!t&&{text:(0,v.tZ)("span",{className:"AskBrand-text",children:"选择品牌"})}),{value:t,onChange:this.handleChange,children:r.map(function(e){return(0,v.tZ)(iL.W,{value:e.id,text:(0,v.BX)("span",{className:"AskBrand-text",children:[e.name,e.clickInfo&&e.clickInfo.target&&e.clickInfo.target.isOrg&&(0,v.tZ)(iD.xV,{size:24,"aria-label":"已认证账号"})]})},e.id)})}))}}]),n}(b.Component),iz=(0,e5.compose)((0,eM.connect)(function(e){return{currentUser:(0,eE.ib)(e)}}),(c={load:function(e){return e.dispatch((0,nF.R8)(e.currentUser.urlToken))}},function(e){var t=c.load,n=function(n){(0,oB._)(o,n);var r=(0,oU._)(o);function o(){var e;return(0,q._)(this,o),e=r.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{isFetching:!1,isDrained:!1,error:null,data:null}),(0,X._)((0,oL._)(e),"load",function(){e.setState({isFetching:!0}),t(e.props).then(function(t){return e.setState({isFetching:!1,isDrained:!0,data:t})}).catch(function(t){return e.setState({isFetching:!1,error:t})})}),e}return(0,V._)(o,[{key:"render",value:function(){return(0,v.tZ)(e,(0,U._)((0,B._)({},this.props,this.state),{load:this.load}))}}]),o}(b.Component);return iI()(n,e)}),(0,iB.Z)({load:function(e){return e.load()}}),iG(function(e){return{brandId:e.brandId}}))(iF),iH=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"render",value:function(){return(0,v.BX)("div",{className:"AskBrandTitle",children:[(0,v.tZ)("h2",{className:"AskBrandTitle-main",children:"品牌提问"}),(0,v.tZ)("div",{className:"AskBrandTitle-sub",children:"创建前请先与商务确认订单，如未确认联系 ad@zhihu.com"})]})}}]),n}(b.Component),iq=n(22701),iV=n(57730),iX=n(94902),iW=n(16234),iK=n(54460),ij=n(69578),iY=n(65744),iQ=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{toolBarShown:!1}),(0,X._)((0,oL._)(e),"focus",function(){return e.editable&&e.editable.focus()}),(0,X._)((0,oL._)(e),"triggerImageUpload",function(){e.editable&&e.editable.handleKeyCommand("insert-image")}),(0,X._)((0,oL._)(e),"triggerVideoUpload",function(){e.editable&&e.editable.handleKeyCommand("insert-video")}),(0,X._)((0,oL._)(e),"handleChange",function(t){var n=e.props.onChangeContext;n&&n({detail:t})}),(0,X._)((0,oL._)(e),"handleBlur",function(t){var n=e.validate();(0,e.props.onChangeContext)({detailTip:n});var r=e.props.onBlur;r&&r(t)}),(0,X._)((0,oL._)(e),"handleTrackDescriptionClickOnce",es()(function(e){oW.Z.trackEvent(e.target,{id:2464,action:"Click"})})),(0,X._)((0,oL._)(e),"handleToggleToolbar",function(){return e.setState({toolBarShown:!e.state.toolBarShown})}),(0,X._)((0,oL._)(e),"handleRef",function(t){return e.editable=t}),(0,X._)((0,oL._)(e),"handleUploadError",function(t,n){switch(n){case"video":e.handleError("video-upload-error");break;case"image":e.handleError("image-upload-error",t)}}),(0,X._)((0,oL._)(e),"handleError",function(e,t){return(0,rQ.Xc)(e,t,iY.t)}),(0,X._)((0,oL._)(e),"checkIfCanUpload",function(){return e.props.canUpload}),(0,X._)((0,oL._)(e),"hasVideo",function(){return e.editable&&e.editable.hasVideo()}),(0,X._)((0,oL._)(e),"canExit",function(){return e.editable&&e.editable.hasVideo("upload")?(0,iY.y)("关闭弹窗将丢失上传中的视频内容"):Promise.resolve()}),(0,X._)((0,oL._)(e),"validate",function(){var t;return!!(t=e.editable)&&(t.hasVideo("upload")?{level:"error",blockSubmit:!0,text:"请等待视频上传完成后发布"}:t.hasImage("upload")?{level:"error",blockSubmit:!0,text:"请等待图片上传完成后发布"}:t.hasImage("error")||t.hasVideo("error")&&!t.hasVideo("error-review")?{level:"fatal",blockSubmit:!0,text:"草稿中含有上传失败的内容，请更改后重新提交",title:"上传失败"}:!!(t.hasVideo("error-review")||t.hasVideo("censor"))&&{level:"fatal",blockSubmit:!0,text:"视频中包含未通过审核的信息，请更改后重新提交",title:"视频未通过审核"})}),(0,X._)((0,oL._)(e),"validateAndNotice",function(){var t=e.validate();return!!t&&("fatal"===t.level?iV.Z.alert(t.text,{title:t.title}):(0,iY.t)(t.text),e.focus(),t)}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this.state.toolBarShown,t=this.props,n=t.onFocus,r=t.value;return(0,v.BX)("div",{className:"AskDetail",children:[(0,v.tZ)("div",{className:"AskDetail-actionsWrapper",children:(0,v.BX)("div",{className:"AskDetail-actions",children:[(0,v.tZ)(iq.hA,{label:"".concat(e?"收起":"展开","工具栏"),isActive:e,icon:iX.g_,onClick:this.handleToggleToolbar}),(0,v.tZ)(iq.hA,{label:"插入图片",icon:iW.x3,onClick:this.triggerImageUpload}),(0,v.tZ)(iq.hA,{label:"上传视频",icon:iK.Y,onClick:this.triggerVideoUpload})]})}),(0,v.tZ)("div",{className:"AskDetail-inputWrapper",onClick:this.handleTrackDescriptionClickOnce,children:(0,v.tZ)(ij.Z,{placeholder:"输入问题背景、条件等详细信息（选填）",className:"AskDetail-input",ref:this.handleRef,allowDragAndDrop:!0,allowLinkCard:!0,minRows:2,allowToolbar:e,allowHeaderThree:!1,defaultValue:r&&r.toHTML(),onChange:this.handleChange,onError:this.handleError,onUploadError:this.handleUploadError,onBeforeVideoUpload:this.checkIfCanUpload,onBlur:this.handleBlur,onFocus:n,editingContentType:"question",videoSource:"question"})})]})}}]),n}(b.Component),iJ=iG(function(e){var t=e.detail;return{value:t&&t.toHTML?t:{toHTML:function(){return t}}}})(iQ);function i$(e){var t=e.hasVideo,n=e.onChangeContext,r=e.value,o=e.questionType,i=e.currentUser,a=(0,j._)((0,b.useState)(!1),2),c=a[0],s=a[1];return((0,b.useEffect)(function(){s(function(e){return e||r})},[r]),c)?i&&"organization"===i.userType||"commercial"===o||(0,v.tZ)("div",{children:(0,v.tZ)("div",{className:"AskOptions",children:(0,v.BX)("label",{htmlFor:"anonymous-checkbox",className:"AskOptions-label",children:[(0,v.tZ)("input",{id:"anonymous-checkbox",className:"AskOptions-checkbox",type:"checkbox",checked:r,onChange:function(){var e=!r;if(e){(0,iY.t)("无法匿名发布，实名发布获得更多曝光",{theme:"red"});return}if(e&&t()){(0,iY.t)("匿名不能使用知乎视频功能，如需启用匿名请删除问题中的视频",{theme:"red"});return}n({isAnonymous:e})}}),"匿名提问"]})})}):null}i$.propTypes={hasVideo:oF().func,onChange:oF().func,value:oF().bool,questionType:oF().string,currentUser:oF().object};var i0=(0,e5.compose)((0,eM.connect)(function(e){return{currentUser:(0,eE.ib)(e)}}),iG(function(e){return{value:e.isAnonymous||!1}}))(i$),i1=n(30722),i2=n(5941),i3=n(90656),i4=n(92868),i5=function(e){return(0,v.tZ)("div",{style:{textAlign:"right",minHeight:"1.67em"},children:(0,v.tZ)("span",{className:oV()("AskFieldTip",(0,X._)({},"AskFieldTip--".concat(e.level),e.level)),children:e.text})})},i6="group-title",i7={default:18,smaller:16},i8=Math.floor(2.68*i7.default),i9=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{fontSize:i7.default,items:[],rows:1,pos:0}),(0,X._)((0,oL._)(e),"appended",!1),(0,X._)((0,oL._)(e),"focus",function(){return e.input&&e.input.focus()}),(0,X._)((0,oL._)(e),"handleKeyDown",function(e){13===e.keyCode&&e.preventDefault()}),(0,X._)((0,oL._)(e),"handleSelect",function(e,t){window.open("/question/".concat(t.urlToken,"?q=").concat(e),"_self")}),(0,X._)((0,oL._)(e),"handleCompositionEnd",function(t){var n=t.target.value,r=e.props.onChangeContext;if(!e.appended&&"string"==typeof n&&n.length&&-1===n.indexOf("?")&&-1===n.indexOf("？")){e.appended=!0;var o=e.input&&e.input.selectionStart,i="".concat(n,"？");return e.setState({pos:o},function(){e.input&&e.input.setSelectionRange(o,o)}),r({title:i,titleTip:e.validate(i)})}}),(0,X._)((0,oL._)(e),"handleFocus",function(t){e.change(t.target.value),e.setState({focused:!0});var n=e.props.onFocus;n&&n(t)}),(0,X._)((0,oL._)(e),"handleBlur",function(t){e.change(t.target.value),e.setState({focused:!1})}),(0,X._)((0,oL._)(e),"handleDivRef",function(t){e.div=t}),(0,X._)((0,oL._)(e),"handleChange",function(t){return e.change(t)}),(0,X._)((0,oL._)(e),"change",function(t){var n=e.props,r=n.onChangeContext;if(t!==n.value)return t?e.updateItems(t):e.setState({items:[]}),r({title:t,titleTip:e.validate(t)})}),(0,X._)((0,oL._)(e),"updateItems",eQ()(function(t){return(0,i3.Ci)(t).then(function(t){return e.setState({items:t})})},200)),(0,X._)((0,oL._)(e),"updateHeight",function(){if(e.input&&e.div){var t=e.state.fontSize,n=e.props,r=n.line,o=n.onChangeLine,i=e.div.scrollHeight;i>=i8&&r<2?o(2):i<i8&&r>=2&&o(1),t!==i7.smaller?i>i8&&e.setState({fontSize:i7.smaller}):t!==i7.default&&i<=i8&&e.setState({fontSize:i7.default})}}),(0,X._)((0,oL._)(e),"validate",function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.value,r=(t=n||"").length<4?{level:"error",text:"至少输入 ".concat(4," 个字"),ignoreInInput:!0,blockSubmit:!0}:t.length>51?{level:"error",text:"已超过 ".concat(t.length-51," 个字"),ignoreInInput:!0,blockSubmit:!0}:t.length>0&&-1===t.indexOf("?")&&-1===t.indexOf("？")?{level:"error",text:"你还没有给问题添加问号",blockSubmit:!0}:(t.match(/(\?|？)/g)||[]).length>1?{level:"warning",text:"多个问题建议拆分"}:null,o=e.props.onError;return o&&o(r),r}),(0,X._)((0,oL._)(e),"renderLabel",function(e){return(0,v.BX)("div",{className:"AskTitle-suggestionClose",children:[(0,v.tZ)("span",{children:e}),(0,v.tZ)(oQ.ZP,{preset:"plain",children:"关闭"})]})}),(0,X._)((0,oL._)(e),"renderItem",function(t){var n=e.props.value;return(0,v.BX)("a",{className:"AskTitle-suggestionItemLink",href:"//www.zhihu.com/question/".concat(t.urlToken,"?q=").concat(n),children:[(0,v.tZ)("span",{className:"AskTitle-suggestionItemTitle",dangerouslySetInnerHTML:{__html:t.name}}),(0,v.BX)("span",{className:"AskTitle-suggestionItemDesc",children:[(0,i1.uf)(t.answersCount)," 个回答"]})]},t.urlToken)}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=this;this.updateHeight(),setTimeout(function(){e.focus();var t=e.props.onFocus;t&&t()})}},{key:"componentDidUpdate",value:function(e){e.value!==this.props.value&&(this.updateHeight(),this.validate())}},{key:"render",value:function(){var e=this,t=this.state,n=t.focused,r=t.items,o=t.fontSize,i=this.props,a=i.value,c=i.line,s=i.tip;return(0,v.BX)(b.Fragment,{children:[(0,v.BX)("div",{className:"AskTitle",children:[(0,v.tZ)("div",{className:"AskTitle-text",ref:this.handleDivRef,children:a}),(0,v.tZ)(i2.Z,{value:a,autoFocus:!0,onChange:this.handleChange,inputProps:{required:!0,multiline:!0,rows:c,spread:!0,large:!0,onCompositionEnd:this.handleCompositionEnd,placeholder:"写下你的问题，准确地描述问题更容易得到解答",className:"AskTitle-input",onKeyDown:this.handleKeyDown,style:{fontSize:o}},menuProps:{position:this.position,preventCloseOnTarget:!0,menuContainerClassName:"AskTitle-suggestionPopover",itemClassName:"AskTitle-suggestionItem",menuClassName:"AskTitle-suggestionContainer"},labels:(0,X._)({},i6,"你的问题可能已经有答案"),renderLabel:this.renderLabel,groups:(0,X._)({},i6,r.slice(0,10)),renderItem:this.renderItem,preventOpenOnFocus:!0,onRef:function(t){return e.input=t},autoSelect:!1,onSelect:this.handleSelect,onBlur:this.handleBlur,onFocus:this.handleFocus})]}),(0,v.tZ)(i5,(0,B._)({},n&&(!s||s.ignoreInInput)?{text:(0,v.tZ)(i4.Z,{current:a?a.length:0,max:51,name:""})}:s))]})}}]),n}(b.Component),ae=iG(function(e){return{value:e.title||"",tip:e.titleTip}})(i9),at=n(4627),an=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{activated:!1,changed:!1}),(0,X._)((0,oL._)(e),"updateTopicsFromKeyword",eQ()(function(t){var n=e.props,r=n.loadMatchTopics,o=n.onChangeContext;r({text:t}).then(function(e){o({topics:e.payload.data.slice(0,3)})})},200)),(0,X._)((0,oL._)(e),"handleChange",function(t){var n=e.props.onChangeContext,r=e.validate(t);r||e.setState({changed:!0}),n({topics:t,topicsTip:r}),r?e.focus():e.deactivated()}),(0,X._)((0,oL._)(e),"handleRemove",function(){return oW.Z.trackEvent((0,oL._)(e),{id:2466,action:"Delete"})}),(0,X._)((0,oL._)(e),"deactivated",function(){e.setState({activated:!1})}),(0,X._)((0,oL._)(e),"toggleActivated",function(){return e.setState({activated:!e.state.activated})}),(0,X._)((0,oL._)(e),"validate",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.value;return t&&0!==t.length?null:{level:"error",text:"至少添加一个话题",blockSubmit:!0}}),(0,X._)((0,oL._)(e),"focus",function(){return e.topicsInput&&e.topicsInput.focus()}),e}return(0,V._)(n,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.keyword,r=t.onChangeContext;if(n!==e.keyword){if(!n){r({topics:[]});return}!this.state.changed&&(n.length>=5||Math.abs(e.keyword.length-n.length)>=3)&&this.updateTopicsFromKeyword(n)}}},{key:"render",value:function(){var e=this,t=this.props.value,n=this.state.activated;return(0,v.tZ)(at.Z,{actived:n,inputProps:{className:"AskTopics-input"},onRef:function(t){e.topicsInput=t},value:void 0===t?[]:t,onChange:this.handleChange,onRemove:this.handleRemove,onToggleActived:this.toggleActivated})}}]),n}(b.Component),ar=(0,e5.compose)((0,eM.connect)(null,{loadMatchTopics:function(e){var t=(0,B._)({type:"question"},e),n=t.text,r=t.type;return{API:{types:t7.GET_MATCH_TOPICS,endpoint:"/recommendations/match-topics",query:{text:n,type:r}}}}}),iG(function(e){return{keyword:e.title,value:e.topics||[]}}))(an),ao=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{trans:!1,actived:!1,line:1,submitting:!1}),(0,X._)((0,oL._)(e),"zaRef",(0,b.createRef)()),(0,X._)((0,oL._)(e),"traceId",ip()()),(0,X._)((0,oL._)(e),"createAskFormRef",function(t){e.form=t}),(0,X._)((0,oL._)(e),"askDetail",(0,b.createRef)()),(0,X._)((0,oL._)(e),"handleFocus",function(){e.state.trans&&e.setState({trans:!1})}),(0,X._)((0,oL._)(e),"handleChangeLine",function(t){return e.setState({line:t})}),(0,X._)((0,oL._)(e),"handleUnload",function(){var t=e.props,n=t.topics,r=t.title,o=t.detail;iN({title:r,topics:n,detail:o&&o.toHTML?o.toHTML():o})}),(0,X._)((0,oL._)(e),"transitionKey",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.state,n=e.props,r=n.title,o=n.titleTip,i=n.topics,a=n.detail,c=n.detailTip,s=t.line;return"".concat(!!r,"-").concat(!!a,"-").concat(i&&i.length,"-").concat(!!o,"-").concat(!!c,"-").concat(s)}),(0,X._)((0,oL._)(e),"handleSuccess",function(){var t=e.props.publishErrorReporter;null==t||t.safeRecordStageStart("post-publish"),iN({title:null,topics:null,detail:null});var n=e.props,r=n.onSuccess,o=n.id;e.zaRef.current.trackEvent({action:"Question",eventType:"Click",elementLocation:{type:"Button",moduleId:"published_successful",content:{type:"Question",token:String(o)}}},{configMap:{traceId:e.traceId}}),r?r({id:o}):location.href="//".concat(x.Z.wwwHost,"/question/").concat(o)}),(0,X._)((0,oL._)(e),"handleSubmit",function(t){if(oW.Z.trackEvent(t.target,{id:2467,action:"Question"}),e.checkSubmittable()){e.setState({submitting:!0});var n=e.props.publishErrorReporter;null==n||n.startFreshReport("question","Ask"),(e.props.hitContentPublish?e.submitUnified():e.submitLegacy()).then(e.handleSuccess).catch(function(e){throw null==n||n.safeReport(e,"catch in submit promise"),e}).finally(function(){e.setState({submitting:!1})})}}),(0,X._)((0,oL._)(e),"setTitle",function(){var t=e.props.setTitle;if(t){var n=e.props.currentUser.isOrg,r=e.props.questionType;n&&(ik(r)?t("创建品牌提问",(0,v.BX)("p",{children:["创建前请先与商务确认订单，如未确认联系"," ",(0,v.tZ)("a",{href:"mailto:ad@zhihu.com",children:"ad@zhihu.com"})]})):t("创建社区提问",(0,v.BX)("div",{children:["描述精确的问题更易得到解答",(0,v.tZ)("a",{href:"/question/19806261",target:"_blank",children:"知乎社区提问规范"})]}))),t("写下你的问题","描述精确的问题更易得到解答")}}),(0,X._)((0,oL._)(e),"canExit",function(){var t=e.askDetail&&e.askDetail.current;return e.handleUnload(),t&&t.canExit()}),(0,X._)((0,oL._)(e),"checkSubmittable",function(){var t=e.props,n=t.titleTip,r=t.topicsTip;if(n&&n.blockSubmit)return!1;var o=e.askDetail&&e.askDetail.current;return!(o&&o.validateAndNotice())&&(!r||!r.blockSubmit)}),(0,X._)((0,oL._)(e),"disabled",function(){var t=e.props,n=t.title,r=t.titleTip,o=t.topicsTip,i=t.topics;return!n||r&&r.blockSubmit||!(i&&i.length)||o&&o.blockSubmit}),(0,X._)((0,oL._)(e),"shouldToggleTrans",function(){if(e.form){var t=e.form.scrollHeight<=327;t&&!e.state.trans?e.setState({trans:!0}):!t&&e.state.trans&&e.setState({trans:!1})}}),(0,X._)((0,oL._)(e),"hasVideo",function(){var t=e.askDetail&&e.askDetail.current;return t&&t.hasVideo()}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e,t,n=this;null===(e=this.props.writeShield)||void 0===e||null===(t=e.setOnModalClose)||void 0===t||t.call(e,function(){var e,t;null===(t=(e=n.props).onClose)||void 0===t||t.call(e)}),this.props.onChangeContext({title:O().get(iw.title)||"",detail:iR(),topics:O().get(iw.topics)||[]},this.checkSubmittable),this.setTitle(),this.timeout=setTimeout(function(){n.setState({actived:!0}),n.shouldToggleTrans()},300),this.props.imperativeRef&&(this.props.imperativeRef.current={canExit:this.canExit.bind(this)})}},{key:"componentDidUpdate",value:function(e,t){this.transitionKey(t)!==this.transitionKey()&&this.state.actived&&this.shouldToggleTrans()}},{key:"componentWillUnmount",value:function(){this.timeout&&clearTimeout(this.timeout),this.props.imperativeRef&&(this.props.imperativeRef.current=null)}},{key:"submitLegacy",value:function(){var e=this.props,t=e.brandId,n=e.questionType,r=e.askQuestion,o=e.title,i=e.topics,a=e.detail,c=e.isAnonymous,s=this.props.publishErrorReporter,l=a&&a.toHTML?a.toHTML():a,u=l&&l.html?l.html:l;null==s||s.safeRecordParamCollected("html",null==u?void 0:u.length);var d={type:iO(n),brandId:t,title:o,topicUrlTokens:i.map(function(e){return e.urlToken||e.id}),detail:"string"==typeof u?u:"",isAnonymous:c};return null==s||s.safeRecordParamCollected(),null==s||s.safeRecordStageStart("publish",{hitContentPublish:!1}),r(d)}},{key:"submitUnified",value:function(){var e=this.props,t=e.brandId,n=e.questionType,r=e.questionContentPublish,o=e.title,i=e.topics,a=e.detail,c=e.isAnonymous,s=this.props.publishErrorReporter,l=new iT.y;l.set("title",{title:o}),l.set("topic",{topics:i.map(function(e){return{topic_name:e.name,topic_token:e.urlToken||e.id}})}),null==s||s.safeRecordParamCollected("topic",i.length);var u=a&&a.toHTML?a.toHTML():a,d=u&&u.html?u.html:u;null==s||s.safeRecordParamCollected("html",null==d?void 0:d.length),l.set("hybrid",{html:"string"==typeof d?d:""}),l.setExtraInfo("publisher","pc"),l.set("questionConfig",{brand_id:String(t),type:String(iO(n))}),void 0!==c&&l.set("anonymity",{isAnonymity:c});var p=l.build();return null==s||s.safeRecordStageStart("publish",{hitContentPublish:!0}),r.publish(p)}},{key:"render",value:function(){var e=this.state,t=e.trans,n=e.line,r=e.submitting,o=this.props,i=o.questionType,a=o.brandId,c=o.title,s=o.detail,l=o.topics,u=o.isAnonymous,d=ik(i),p=(0,v.BX)("div",{className:"Ask-items",children:[(0,v.BX)("div",{className:oV()("Ask-item","Ask-titleWrapper"),children:[(0,v.tZ)(iP,{isAnonymous:u,questionType:i,brandId:a,css:{float:"left",marginTop:"3px",marginRight:"16px"}}),(0,v.tZ)("div",{className:"Ask-title",children:(0,v.tZ)(ae,{line:n,onChangeLine:this.handleChangeLine})})]}),(c||s||!!(l&&l.length))&&(0,v.tZ)("div",{className:"Ask-item",children:(0,v.tZ)(iJ,{ref:this.askDetail,canUpload:!u,onFocus:this.handleFocus,onBlur:this.shouldToggleTrans})}),(c||s||!!(l&&l.length))&&(0,v.tZ)("div",{className:"Ask-item",children:(0,v.tZ)(ar,{})}),(0,v.tZ)(im,{onUnload:this.handleUnload})]});return(0,v.BX)("form",{ref:this.createAskFormRef,className:"Ask-form",onSubmit:function(e){return e.preventDefault()},noValidate:!0,children:[(0,v.tZ)(eG.Wi,{zaType:"Popup",zaModuleId:"pc_question_editor_popup"}),(0,v.tZ)(eG.pS,{ref:this.zaRef}),d&&(0,v.BX)("div",{className:"Ask-header",children:[(0,v.tZ)(iH,{}),(0,v.tZ)(iz,{})]}),(0,v.tZ)(ih.Z,(0,U._)((0,B._)({},t?{transitionKey:this.transitionKey()}:{style:{height:"unset",overflow:"unset"},transitionKey:"none",transitionAppear:!1,transitionLeave:!1}),{children:p})),(0,v.BX)("div",{className:"Ask-footer",children:[!d&&(0,v.tZ)(i0,{hasVideo:this.hasVideo}),(0,v.tZ)("div",{className:"Ask-footer-buttonWrapper",children:(0,v.tZ)(eG.$U,{as:oQ.ZP,zaType:"Button",zaText:!0,zaAction:"Question",zaModuleId:"published_button",extra:{configMap:{traceId:this.traceId,type:"Question",publish_type:"newPublish"}},preset:"primary",color:"blue",disabled:r||this.disabled(),onClick:this.handleSubmit,children:r?"发布中...":"发布问题"})})]})]})}}]),n}(b.Component),ai=(0,e5.compose)((0,iv.ZP)({init:!0,getScene:function(){return{type:"question"}}}),iM(),(0,eM.connect)(function(e){return(0,B._)({},e.common.ask)},{askQuestion:function(e){return{API:{types:t7.ADD,method:"POST",endpoint:"questions",fetchOptions:{zsEncrypt:!0,body:(0,M.decamelizeKeys)(e)}}}}}),function(e){var t=function(t){var n,r,o,i=(n=(0,ib.u)("question","Ask"),r=(0,eM.useDispatch)(),o=(0,eM.useStore)(),{publish:(0,iy.Z)(function(e){var t,o,i=(t=(0,iE._)(function(e){return(0,iC.__generator)(this,function(t){throw r((0,tD.c0)((0,E.n$)(e),"red")),e})}),function(e){return t.apply(this,arguments)}),a=(o=(0,iE._)(function(e){return(0,iC.__generator)(this,function(t){switch(t.label){case 0:return[4,r({type:t7.ADD.success,payload:e})];case 1:return t.sent(),[2,e]}})}),function(e){return o.apply(this,arguments)});return n.publish(e).then(a,i)}),update:(0,iy.Z)(function(e,t){var i,a,c,s,l,u=o.getState(),d={};(null==t?void 0:null===(s=t.title)||void 0===s?void 0:s.title)&&(d.title=t.title.title),(null==t?void 0:null===(l=t.hybrid)||void 0===l?void 0:l.html)&&(d.editableDetail=t.hybrid.html);var p=(i=(0,iE._)(function(){return(0,iC.__generator)(this,function(t){return[2,r((0,nV.k9)({id:e,optimisticData:d},u))]})}),function(){return i.apply(this,arguments)}),h=(a=(0,iE._)(function(t){var n;return(0,iC.__generator)(this,function(o){switch(o.label){case 0:return n=t,[4,r((0,nV.Kd)({id:e},n,u))];case 1:return o.sent(),[2,n]}})}),function(e){return a.apply(this,arguments)}),f=(c=(0,iE._)(function(t){return(0,iC.__generator)(this,function(n){switch(n.label){case 0:return[4,r((0,nV.nH)({id:e},t,u))];case 1:throw n.sent(),t}})}),function(e){return c.apply(this,arguments)});return p().then(function(){return n.update(t).then(h,f)})})});return(0,v.tZ)(e,(0,U._)((0,B._)({},t),{questionContentPublish:i}))};return iI()(t,e),t},(0,ig.O)(function(e){return{hitContentPublish:"1"===e&&"1"===x.Z.apollo.content_publish_question}},"ws_publish_ask",{mock:"1"}),iA.FK)(ao),aa=n(31467),ac=n(99878),as=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"handleRefresh",function(){Promise.resolve(e.props.fillCurrentUserIfNeeded(["adType"])).then(e.handleCommercialSelect)}),(0,X._)((0,oL._)(e),"handleNormalSelect",function(){return e.props.onSelect("normal")}),(0,X._)((0,oL._)(e),"handleCommercialSelect",function(){var t=e.props,n=t.adType,r=t.onSelect;if("normal"===n)return iV.Z.alert((0,v.BX)("p",{children:["请发邮件至 ",(0,v.tZ)("a",{href:"mailto:ad@zhihu.com",children:"ad@zhihu.com"})," ","申请，标题为「申请品牌提问 - 账号名称」。我们会在 1 个工作日内联系你。"]}),{title:"暂无权限"});if("invited"===n){var o=e.props.currentUser.urlToken;return(0,iY.y)("你尚未激活广告账号",{content:(0,v.tZ)("div",{children:"激活广告账号后即可创建品牌提问"}),text:{ok:"激活广告账号",cancel:"已激活，继续创建"}}).then(function(){return window.open("https://e.zhihu.com/activate-advertiser?rf=createBrandQuestion&urlToken=".concat(o),"_blank")},e.handleRefresh)}r("commercial")}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=this.props.setTitle;e&&e("选择提问类型",(0,v.tZ)("a",{className:"QuestionCategory-link",href:"/organization/ophelp/faq/19",target:"_blank",children:"如何选择？"}))}},{key:"render",value:function(){return(0,v.BX)("div",{className:"QuestionCategorySelect",children:[(0,v.tZ)(n.Item,{onClick:this.handleNormalSelect,title:"社区提问",desc:"公共提问，社区用户共同参与问题编辑和管理，适合发起公共讨论。"}),(0,v.tZ)(n.Item,{onClick:this.handleCommercialSelect,title:"品牌提问",desc:(0,v.BX)("span",{children:["私有提问，由您自主管理问题展示和回答展示，适合承载官方活动。这是一款付费产品。",(0,v.tZ)("a",{href:"https://www.zhihu.com/introduction/brand_question",children:"了解更多"})]})})]})}}]),n}(b.Component);(0,X._)(as,"Item",function(e){var t=e.onClick,n=e.title,r=e.desc;return(0,v.BX)("div",{role:"button",tabIndex:0,className:"AskOrgSelect-item",onClick:t,children:[(0,v.BX)("div",{className:"AskOrgSelect-ItemContent",children:[(0,v.tZ)("div",{className:"AskOrgSelect-itemTitle",children:n}),(0,v.tZ)("div",{className:"AskOrgSelect-itemDesc",children:r})]}),(0,v.tZ)(ac.N,{size:"2em"})]})});var al=(0,e5.compose)((0,eM.connect)(function(e){return{currentUser:(0,eE.ib)(e)}},{fillCurrentUserIfNeeded:eE.sF}))(as),au=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userType,n=e.adType;return"organization"===t||"registered"===n},ad=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{selectShown:e.props.createBrandQuestion,askShown:e.props.show,questionType:"normal"}),(0,X._)((0,oL._)(e),"askRef",(0,b.createRef)()),(0,X._)((0,oL._)(e),"toggleSelectShown",function(){return e.setState({selectShown:!e.state.selectShown})}),(0,X._)((0,oL._)(e),"toggleAskShown",function(t){return e.setState({askShown:null!=t?t:!e.state.askShown})}),(0,X._)((0,oL._)(e),"setTitle",function(t,n){return e.setState({title:t,subtitle:n})}),(0,X._)((0,oL._)(e),"handleClose",function(){if(oW.Z.trackEvent((0,oL._)(e),{id:2463,action:"Close"}),e.askRef.current)return Promise.resolve(e.askRef.current.canExit()).then(function(){var t,n;e.toggleAskShown(!1),null===(n=(t=e.props).onClose)||void 0===n||n.call(t)}).catch(function(){return null});e.toggleAskShown(!1)}),(0,X._)((0,oL._)(e),"handleClick",e.props.authRequired(function(t){return e.props.realNameRequired(function(){var n,r;(null===(n=e.props.children)||void 0===n?void 0:n.props.onClick)&&(null===(r=e.props.children)||void 0===r||r.props.onClick(t)),e.props.canCurrentAskBrandQuestion?e.toggleSelectShown():e.toggleAskShown()})()})),(0,X._)((0,oL._)(e),"handleSelect",function(t){e.setState({questionType:t}),"commercial"===t?e.props.loadBrands().then(function(){return e.toggleAskShown()}):e.toggleAskShown()}),(0,X._)((0,oL._)(e),"handleSuccess",function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id,n=e.props,r=n.askHandleSuccess,o=n.router;e.toggleAskShown(),o.push("//".concat(x.Z.wwwHost,"/question/").concat(t)),null==r||r()}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){(0,this.props.fillCurrentUserIfNeeded)(["adType"]),this.props.imperativeRef&&(this.props.imperativeRef.current={click:this.handleClick})}},{key:"render",value:function(){var e=this.state,t=e.selectShown,n=e.askShown,r=e.questionType,o=e.title,i=e.subtitle,a=this.props,c=a.children,s=a.currentUser;return(0,v.BX)(v.HY,{children:[c&&(0,b.cloneElement)(c,{onClick:this.handleClick}),(0,v.tZ)(aa.Z,{size:"large",maskClosable:!1,onClose:this.handleClose,children:n&&(0,v.tZ)(ai,{imperativeRef:this.askRef,questionType:r,onSuccess:this.handleSuccess,onClose:this.handleClose})}),(0,v.tZ)(aa.Z,{title:o,subtitle:i,onClose:this.toggleSelectShown,children:t&&(0,v.tZ)(al,{adType:s&&s.adType,onSelect:this.handleSelect,setTitle:this.setTitle})})]})}}]),n}(b.Component),ap=(0,e5.compose)(oR.withRouter,o6.Z,eW.ru,(0,eM.connect)(function(e,t){var n;return{createBrandQuestion:!!((n=t.location)&&n.query&&"createBrandQuestion"===n.query.rf),canCurrentAskBrandQuestion:au((0,eE.ib)(e)),currentUser:(0,eE.ib)(e)}},{loadBrands:nF.R8,fillCurrentUserIfNeeded:eE.sF}))(ad),ah=n(45842),af=n(3028),a_=n(25480),am=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"renderGroupItems",value:function(e,t){var n=this,r=this.props,o=r.renderItem,i=r.isItemDisabled,a=this.state,c=a.id,s=a.selectedIndex,l=a.selectedGroupKey;return e.map(function(e,r){var a=e.data||r;return(0,v.tZ)(a_.Z,{id:"".concat(c,"-").concat(t,"-").concat(a),tag:"div",disabled:i(e),hovered:r===s&&t===l,onMouseEnter:function(){n.setState({selectedIndex:r,selectedGroupKey:t})},onClick:function(){return n.handleClose(!0,r,t)},onMouseDown:function(e){return e.preventDefault()},role:"option",children:o(e)},a)})}}]),n}(i2.Z),av="search:preset_words",ag="搜索你感兴趣的内容…",aT=function(){return O().get(av)},aE=function(e){O().set(av,e)},aC=function(e){var t=aT();if(t){var n=t.words;aE({nextRequestTime:t.nextRequestTime,words:n.map(function(t){return t.id===e?(0,U._)((0,B._)({},t),{valid:0}):t})})}},ay=function(e){return!e||!e.lastUpdateTime||e.lastUpdateTime+3e4<Date.now()},aS=function(e){var t=aT();if(t){var n=t.words,r=t.nextRequestTime,o=t.lastUpdateTime,i=t.lastId,a=ay(t);aE({nextRequestTime:r,lastUpdateTime:a?Date.now():o,lastId:a?e:i,words:n.map(function(t){return t.id===e?(0,U._)((0,B._)({},t),{times:t.times+1}):t})})}},aI=function(e){var t=e&&e.payload&&e.payload.presetWords||{},n=t.nextRequestTs,r=t.words,o=(aT()||{}).words,i=void 0===o?[]:o,a={nextRequestTime:n?1e3*n:Date.now()+6e5,words:r.map(function(e){var t=e.id,n=e.beginTs,r=e.endTs,o=i.find(function(e){return e.id===t}),a=o&&o.times||0;return(0,U._)((0,B._)({},e),{times:a,beginTs:1e3*n,endTs:1e3*r})})};return aE(a),a},ab=function(e){var t=e.reduce(function(e,t){return e+t.weight},0);return e.reduce(function(e,n){var r=n.id,o=n.weight,i=e&&e[e.length-1]&&e[e.length-1].range[1]||0;return(0,g._)(e).concat([{id:r,range:[i,i+o/t]}])},[])},aA=function(e){var t=Math.random();return e.find(function(n,r){var o=n.range,i=r===e.length-1?1:o[1];return o[0]<t&&i>t})||e[e.length-1]},aZ=function(e){var t=Date.now(),n=e.filter(function(e){var n=e.valid,r=e.beginTs,o=e.endTs;return n&&r<t&&o>t});if(!n.length)return!1;var r=[],o=n.filter(function(e){return e.weight>=10}),i=(aA(ab((r=o.length>0?o:n).map(function(e){var t=e.weight,n=e.times;return{weight:t/((void 0===n?0:n)+1),id:e.id}})))||{}).id,a=void 0===i?"-1":i;return r.find(function(e){return e.id===a})},aw=function(e){var t=aT(),n=t||{},r=n.nextRequestTime,o=n.words;if(r&&(r<Date.now()||r>325036512e5)||!o)return e(t?t.words.map(function(e){return{valid:e.valid,id:e.id}}):null).then(aI).then(function(e){var t=aZ(e.words.filter(function(e){return"general"===e.type}));return aS(t.id),t});var i=o.filter(function(e){return"general"===e.type});if(!ay(t)){var a=t.lastId;return Promise.resolve(i.find(function(e){return a===e.id}))}var c=aZ(i);return aS(c.id),Promise.resolve(c)},aR=n(82644),aN=function(e,t){return e.map(function(e,n){return(0,B._)({data:(null==e?void 0:e.query)||e,index:n,id:null==e?void 0:e.rawId},t)})},ak=function(e,t){return"string"==typeof t&&e.startsWith(t)?(0,v.BX)("span",{children:[(0,v.tZ)("em",{children:t}),e.slice(t.length)]}):e},aO=function(e){return e?{history:{SearchSource:"SuggestionHistory",zaModuleName:"SearchHistoryItem"},suggest:{SearchSource:"Suggestion",zaModuleName:"SearchSuggestionItem"},searchLink:{SearchSource:"",zaModuleName:"SearchSuggestionList"}}:{topSearch:{SearchSource:"Hot",zaModuleName:"HotSearchWordItem"},history:{SearchSource:"History",zaModuleName:"SearchHistoryItem"}}},ax=function(e,t,n,r){oW.Z.trackCardShow(e,{},{search:(0,B._)({search_source:aO(r)[n].SearchSource,raw_query:t},r&&{input_query:r})})},aP=function(e){var t=e.type,n=e.index,r=e.rawSearchResult,o=e.data,i=null;(i="searchLink"!==t?(document.querySelectorAll(".SearchBar-menu div[data-za-detail-view-path-module =\n    ".concat(aO(r)[t].zaModuleName,"]"))||[])[n]:document.querySelector(".SearchBar-menu div[data-za-detail-view-element_name=ViewSeachResult]"))&&oW.Z.trackEvent(i,(0,B._)({action:"Click"},"searchLink"===t?{element_name:"ViewSeachResult"}:{}),{search:(0,B._)({search_source:aO(r)[t].SearchSource,raw_query:o},r&&{input_query:r})})},aD=function(e,t){return t?"SearchSuggestionList":"history"===e?"SearchHistoryList":"topSearch"===e?"HotSearchWordList":""},aL=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"handleDelete",function(t,n){var r=e.props.rawSearchResult;oW.Z.trackEvent(t.target,{action:"Delete"},{search:(0,B._)({raw_query:n},r&&{input_query:r,search_source:"SuggestionHistory"},!r&&{search_source:"History"})}),e.props.onDelete(t,n)}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.index,n=e.data,r=e.rawSearchResult;oW.Z.setModule(this.container,{module:"SearchHistoryItem",index:t}),ax(this.container,n,"history",r)}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,r=t.rawSearchResult;return(0,v.BX)("div",{ref:function(t){e.container=t},className:"SearchBar-historyItem",children:[(0,v.tZ)("span",{className:oV()("SearchBar-historyItemContent",{blueFont:r}),children:ak(n,r)}),(0,v.BX)("div",{className:"SearchBar-historyIconWrapper SearchBar-historyDelete",children:[(0,v.tZ)("span",{className:"preventCloseOnTarget SearchBar-historyIconShade",onClick:function(t){return e.handleDelete(t,n)},role:"button",tabIndex:0,"aria-label":"删除",onMouseDown:function(e){return e.preventDefault()}}),(0,v.tZ)(aR.HN,{width:18,height:18,fill:"#d3d3d3"})]})]})}}]),n}(b.Component),aB=n(43831),aU=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"componentDidMount",value:function(){oW.Z.trackCardShow(this.container,{name:"清空"})}},{key:"render",value:function(){var e=this,t=this.props,n=t.label,r=t.onDelete;return(0,v.BX)("div",{role:"button",tabIndex:0,className:"SearchBar-label SearchBar-label--history","data-za-detail-view-path-module":aD("history",""),onMouseDown:function(e){return e.preventDefault()},children:[n,(0,v.BX)("div",{ref:function(t){e.container=t},className:"SearchBar-historyIconWrapper",children:[(0,v.tZ)("span",{role:"button",tabIndex:0,className:"SearchBar-historyIconShade preventCloseOnTarget",onClick:function(e){oW.Z.trackEvent(e.target,{action:"Click",name:"清空"}),r(e,null)}}),(0,v.tZ)(aB.R,{center:!0}),"清空"]})]})}}]),n}(b.Component),aM=function(e){var t=e.handleReportShow;return(0,v.tZ)(v.HY,{children:(0,v.tZ)("div",{role:"button",tabIndex:0,className:"ReportsItem",onClick:function(e){e.stopPropagation(),t()},children:"举报"})})},aG="search::top-search",aF=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=e.rawSearchResult;ax(this.container,t,"history",n)}},{key:"render",value:function(){var e=this,t=this.props.rawSearchResult;return(0,v.BX)("div",{ref:function(t){e.container=t},className:"SearchBar-searchLink","data-za-detail-view-element_name":"ViewSeachResult",children:["查看「",t.length>12?"".concat(t.slice(0,12),"..."):t,"」的搜索结果"]})}}]),n}(b.Component),az=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=e.rawSearchResult,r=e.index;oW.Z.setModule(this.container,{module:"SearchSuggestionItem",index:r}),ax(this.container,t,"suggest",n)}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,r=t.rawSearchResult;return(0,v.tZ)("div",{ref:function(t){e.container=t},className:"SearchBar-defaultResult",children:ak(n,r)})}}]),n}(b.Component),aH=n(57032),aq=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.index,n=e.query;oW.Z.setModule(this.container,{module:"HotSearchWordItem",index:t}),ax(this.container,n,"topSearch","")}},{key:"render",value:function(){var e=this,t=this.props,n=t.index,r=t.query,o=t.label,i=t.attachedInfo;return(0,v.BX)(eG.$U,{as:"div",className:"SearchBar-topSearchItem",ref:function(t){e.container=t},zaAction:"OpenUrl",zaType:"Text",zaText:r,zaModuleIndex:n,zaModuleId:"search_guess_your_want_word",shouldTrackShow:!0,view:{elementLocation:{page:{pageId:"10148"}}},extra:{attachedInfoBytes:i},children:[r,"hot"===o&&(0,v.tZ)(aH.ZP,{css:{marginLeft:5,fill:"#FA2925"},size:18})]},n)}}]),n}(b.Component),aV=function(e){return e?"search::history_".concat(e):"search::history_guest"},aX=function(e,t,n){var r=O().get(e)||[];return t?r.filter(function(e){var n=e.q;return"string"==typeof n&&n.toLowerCase().startsWith(t.toLowerCase())}).slice(0,2).map(function(e){return e.q}):r.slice(0,n?10:5).map(function(e){return e.q})},aW=function(e,t,n){var r=O().get(e)||[],o=r.findIndex(function(e){return e.q===t}),i=[];return t&&(i=o>-1?(0,g._)(r.slice(0,o)).concat((0,g._)(r.slice(o+1))):r),O().set(e,i),i.slice(0,n?10:5).map(function(e){return e.q})},aK=function(e){return function(t){return e(t).then(function(e){return e.payload.suggest.map(function(e){return{query:e.query,rawId:e.rawId}})})}},aj=function(){var e=O().get(aG)||{},t=e.words,n=e.timeStamp;return t&&"string"==typeof t[0]?(O().delete(aG),null):t&&n&&new Date().getTime()-Number(n)<6e5?t:null},aY={topSearch:"搜索发现",history:"搜索历史"},aQ=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{rawSearchResult:"",searchResults:{},presetWordsData:{query:""},completeTopSearchData:[],reportModalShown:!1}),(0,X._)((0,oL._)(e),"domRef",(0,b.createRef)()),(0,X._)((0,oL._)(e),"askButtonRef",(0,b.createRef)()),(0,X._)((0,oL._)(e),"componentWillUnmount",function(){document.removeEventListener("visibilitychange",e.visibleCallback)}),(0,X._)((0,oL._)(e),"visibleCallback",function(){!1===document.hidden&&e.handleUpdatePresetWords()}),(0,X._)((0,oL._)(e),"handleReportHide",function(){e.setState({reportModalShown:!1})}),(0,X._)((0,oL._)(e),"handleReportShow",function(){e.setState({reportModalShown:!0})}),(0,X._)((0,oL._)(e),"handleUpdatePresetWords",function(){aw(e.props.getPresetWords).then(function(t){if(!t)return e.setState({presetWordsData:{query:ag}});oW.Z.trackCardShow((0,oL._)(e),{id:2403},{search:{raw_query:t.query}}),e.setState({presetWordsData:t})})}),(0,X._)((0,oL._)(e),"getCurrentHistoryKey",function(){return aV((e.props.currentUser||{}).id)}),(0,X._)((0,oL._)(e),"getHistoryData",function(t){return aX(e.getCurrentHistoryKey(),t)}),(0,X._)((0,oL._)(e),"handleChange",eQ()(function(t){return void 0===t?null:t?e.handleInputHasValue(t):e.handleInputIsEmpty({rawSearchResult:t})},300)),(0,X._)((0,oL._)(e),"handleInputHasValue",function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=aK(e.props.getSuggestActionCreator),o=e.getHistoryData(t);r(t).then(function(r){e.updateAutoComplete({suggestData:n2()((0,g._)(aN(o,{type:"history",rawSearchResult:t})).concat((0,g._)(aN(r,{type:"suggest",rawSearchResult:t}))),function(e,t){var n=e.data,r=t.data;return n.toLowerCase()===r.toLowerCase()})},(0,B._)({rawSearchResult:t},n))})}),(0,X._)((0,oL._)(e),"handleInputIsEmpty",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.props.loadTopSearchActionCreatorV2,r=e.getHistoryData(),o=aj(),i=function(n){e.setState({completeTopSearchData:n}),e.updateAutoComplete({topSearchData:n.map(function(e){return e.queryDisplay}),historyData:r},t)};return o?i(o):n().then(function(e){var t,n=((null==e?void 0:null===(t=e.payload)||void 0===t?void 0:t.recommendQueries)||{}).queries,r=(void 0===n?[]:n).map(function(e){return{queryDisplay:e.queryDisplay,query:e.query,label:e.label,attachedInfo:e.attachedInfo}}).slice(0,5);return O().set(aG,{words:r,timeStamp:new Date().getTime()}),r}).then(i)}),(0,X._)((0,oL._)(e),"handleDeleteData",function(t,n){t.stopPropagation();var r=e.state,o=r.rawSearchResult,i=r.searchResults.suggest,a=aW(e.getCurrentHistoryKey(),n);if(o){var c=(void 0===i?[]:i).filter(function(e){var t=e.type,r=e.data;return!("history"===t&&r===n)});e.updateAutoComplete({suggestData:c})}else e.updateAutoComplete({historyData:a})}),(0,X._)((0,oL._)(e),"updateAutoComplete",function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.state,o=r.searchResults,i=r.rawSearchResult,a=(n||{}).rawSearchResult,c=void 0===a?i:a,s=t.topSearchData,l=t.historyData,u=t.suggestData,d=void 0===u?[]:u;if(!c){var p=o.topSearch,h=o.history;return e.setState((0,B._)({searchResults:(0,B._)({},s?{topSearch:aN(s,{type:"topSearch",rawSearchResult:c})}:{topSearch:void 0===p?[]:p},l?{history:aN(l,{type:"history",rawSearchResult:c})}:{history:void 0===h?[]:h})},n))}var f=aN([c],{type:"searchLink",rawSearchResult:c});return e.setState((0,B._)({searchResults:(0,B._)({suggest:d,searchLink:f},d.length>0&&{reports:[{type:"reports"}]})},n))}),(0,X._)((0,oL._)(e),"handleSelect",function(t,n){var r=n.data,o=n.type,i=e.state.completeTopSearchData;aP(n),e.autoComplete.inputNode.blur();var a=r;"topSearch"===o&&(a=(i.find(function(e){return e.displayQuery===r})||{}).query||r);var c=(0,B._)({q:a},"topSearch"===o&&{utm_content:"search_hot",search_source:"Guess"},"history"===o&&{utm_content:"search_history",search_source:"History"},"suggest"===o&&{utm_content:"search_suggestion",search_source:"Suggestion"});window.open("//www.zhihu.com/search?".concat((0,er.stringify)(c)))}),(0,X._)((0,oL._)(e),"handleFocus",function(){(0,e.props.setEnvVars)({isPageHeaderDisabled:!0});var t=e.state.rawSearchResult,n={isFocus:!0};return t?e.handleInputHasValue(t,n):e.handleInputIsEmpty(n)}),(0,X._)((0,oL._)(e),"focusInput",function(t){if(t.preventDefault(),e.autoCompleteInput.closest(".AppHeader.is-hidden")){setTimeout(function(){return e.autoCompleteInput.focus()},300);return}e.autoCompleteInput.focus()}),(0,X._)((0,oL._)(e),"handleSubmit",function(){var t=e.props.location.query.type;if(e.autoComplete&&e.autoComplete.inputNode){var n=e.autoComplete.inputNode.value,r=void 0===t?"content":t,o=n;if(!n){var i=e.state.presetWordsData||{},a=i.realQuery,c=i.type,s=i.id;if(!a||!c)return;r="general"===c?"content":c,o=a,aC(s)}var l=(0,B._)({type:r,q:o},!n&&{utm_content:"search_preset",search_source:"Preset"});location.href="//".concat(x.Z.wwwHost,"/search?").concat((0,er.stringify)(l))}}),(0,X._)((0,oL._)(e),"renderItem",function(t){var n,r,o=t.type,i=t.data,a=t.index,c=t.rawSearchResult,s=e.state.completeTopSearchData,l=null;switch(o){case"topSearch":l=(0,v.tZ)(aq,{index:a,label:(null===(n=s[a])||void 0===n?void 0:n.label)||"",query:i,attachedInfo:(null===(r=s[a])||void 0===r?void 0:r.attachedInfo)||""});break;case"history":var u=t.data;l=(0,v.tZ)(aL,{data:u,index:a,onDelete:e.handleDeleteData,rawSearchResult:c});break;case"searchLink":l=(0,v.tZ)(aF,{index:a,data:i,rawSearchResult:c});break;case"suggest":l=(0,v.tZ)(az,{data:i,index:a,rawSearchResult:c});break;case"reports":l=(0,v.tZ)(aM,{handleReportShow:e.handleReportShow})}return l&&(0,v.tZ)("div",{"data-za-module":"TopNavBar",children:(0,v.tZ)("div",{"data-za-module":aD(o,c),children:l})})}),(0,X._)((0,oL._)(e),"renderAutoCompleteLabel",function(t){return"搜索历史"===t?(0,v.tZ)(aU,{onDelete:e.handleDeleteData,label:t}):(0,v.tZ)("div",{onMouseDown:function(e){return e.preventDefault()},role:"button",tabIndex:0,className:"SearchBar-label",children:t})}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=this.autoComplete.inputNode.value;e?this.setState({rawSearchResult:e}):this.handleUpdatePresetWords(),document.addEventListener("visibilitychange",this.visibleCallback)}},{key:"render",value:function(){var e,t=this,n=this.state,r=n.searchResults,o=n.rawSearchResult,i=n.isFocus,a=n.presetWordsData,c=n.reportModalShown,s=this.props.location.query.q,l=this.props,u=l.className,d=l.theme,p=l.currentUser,h=l.setEnvVars,f=d.searchInputColor,_=d.searchButtonColor,m=d.searchButtonBg,g=d.searchButtonOpacity,T=d.searchAreaColor,E=d.searchBorder,C=d.searchBorderColor,y=d.searchPlaceHolderOpacity,S=d.searchInputOpacity,I=d.searchIconOpacity;return(0,v.BX)("div",{className:oV()("SearchBar",u),role:"search","data-za-module":"PresetWordItem",ref:this.domRef,children:[(0,v.tZ)(iu.yW,{input:"/",action:this.focusInput}),(0,v.tZ)("form",{className:oV()("SearchBar-tool",{"SearchBar-tool--focus":i}),onSubmit:function(e){return e.preventDefault()},children:(0,v.tZ)(am,{autoSelect:!1,ref:function(e){return t.autoComplete=e},onRef:function(e){return t.autoCompleteInput=e},labels:aY,groups:r,renderLabel:this.renderAutoCompleteLabel,value:s||"",renderItem:this.renderItem,inputProps:{type:"text",maxLength:100,grey:!0,placeholder:a&&a.query,className:oV()("SearchBar-input",{"SearchBar-input--focus":i}),css:function(e){return(0,B._)((0,U._)((0,B._)({input:(0,B._)({},f&&{color:e.colors[f]})},T&&{backgroundColor:"".concat(e.colorMod(e.colors[T]).alpha(S)," !important")}),{borderColor:"".concat((0,o7.pe)(e)(C)," !important"),"input::placeholder":(0,B._)({},T&&{color:"".concat(e.colorMod(e.colors[T]).alpha(y)," !important")})}),(0,o7.W5)("background-color","border","color"))},after:(0,v.tZ)(oQ.ZP,{className:"SearchBar-searchButton",preset:"primary",color:o?"blue":null,onClick:this.handleSubmit,"aria-label":"搜索",children:(0,v.tZ)(is.J7,{size:18,center:!0,className:oV()("SearchBar-searchIcon",{isFocus:i,hasValue:o}),css:function(e){return(0,B._)({color:e.colors[T],opacity:I,"&:hover":{opacity:1}},(0,o7.W5)("color"))}})})},menuProps:{menuClassName:oV()("SearchBar-menu",{"SearchBar-hasValueMenu":o,"SearchBar-noValueMenu":!o}),menuContainerClassName:"SearchBar-menuContainer","data-za-module":"TopNavBar",positionStatus:"fixed",style:{width:null===(e=this.domRef.current)||void 0===e?void 0:e.getBoundingClientRect().width}},onFocus:this.handleFocus,onBlur:function(){setTimeout(function(){t.setState({isFocus:!1}),h({isPageHeaderDisabled:!1})},100),t.autoComplete.menu.popover.close()},onSelect:this.handleSelect,onEnterInput:this.handleSubmit,onChange:this.handleChange})}),p&&!p.isOrg&&(0,v.tZ)(ap,{children:(0,v.tZ)(eG.Wi,{as:oQ.ZP,zaType:"Button",zaModuleId:"pc_ask_button",shouldTrackClick:!0,className:oV()("SearchBar-askButton",{"SearchBar-hiddenAskButton":i}),preset:"primary",color:"blue",onClick:function(){return oW.Z.trackEvent(t,{id:2581,action:"OpenUrl"})},css:function(e){return(0,B._)({backgroundColor:"".concat(e.colors[m]," !important"),color:"".concat(e.colors[_]," !important"),opacity:g,border:"".concat(E," !important"),"&:hover":{opacity:1}},(0,o7.W5)("background-color","color"))},children:"提问"})}),(0,v.tZ)(il.y,{type:"search_suggested_word",shown:c,onClose:this.handleReportHide,zaEnabled:!0,List:r.suggest})]})}}]),n}(b.PureComponent);(0,X._)(aQ,"defaultProps",{theme:o7.mv.normal});var aJ=(0,e5.compose)((0,af.Z)(null),oR.withRouter,ah.Z,(0,eM.connect)(null,{getPresetWords:function(){return{API:{endpoint:"search/preset_words",types:n4.GET_PRESET_WORDS,headers:{"X-API-Version":"3.0.91","X-App-Za":"OS=Web"}},NOTIFICATION:!1}},loadTopSearchActionCreatorV2:function(){return{API:{endpoint:"search/recommend_query/v2",types:n4.GET_NEW_TOP_SEARCH},NOTIFICATION:!1}},getSuggestActionCreator:n9,setEnvVars:eC.Ct}))(aQ),a$=n(95377);function a0(e){return(0,v.tZ)(oQ.ZP,(0,U._)((0,B._)({preset:"primary",className:"SimpleSearchBar-plainSearchButton"},e),{children:(0,v.tZ)(is.J7,{center:!0,size:18})}))}function a1(e){return(0,v.tZ)(oQ.ZP,(0,U._)((0,B._)({preset:"primary",className:"SimpleSearchBar-solidSearchButton",color:"blue",type:"submit"},e),{children:(0,v.tZ)(is.J7,{center:!0,fill:"#fff",size:18})}))}var a2=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{inputValue:e.props.initialValue}),(0,X._)((0,oL._)(e),"handleChange",function(t){e.setState({inputValue:t.target.value})}),(0,X._)((0,oL._)(e),"handleSubmit",function(t){t.preventDefault();var n=e.state.inputValue,r=e.props.type;n&&(location.href="/search?type=".concat(encodeURIComponent(r),"&q=").concat(encodeURIComponent(n)))}),e}return(0,V._)(n,[{key:"render",value:function(){var e,t=this.props,n=t.className,r=t.searchButtonType,o=this.state.inputValue;return"plain"===r?e=a0:"solid"===r&&(e=a1),(0,v.tZ)("form",{className:"SimpleSearchBar-wrapper",onSubmit:this.handleSubmit,children:(0,v.tZ)(a$.Z,{className:oV()("SimpleSearchBar-input",n),onChange:this.handleChange,value:o,placeholder:ag,after:e&&(0,v.tZ)(e,{onClick:this.handleSubmit})})})}}]),n}(b.PureComponent);(0,X._)(a2,"propTypes",{className:oF().string,initialValue:oF().string.isRequired,type:oF().oneOf(["content","people","topic","column","km_general","live","album","publication","zvideo","scholar","km_course"]).isRequired,searchButtonType:oF().oneOf(["solid","plain"])}),(0,X._)(a2,"defaultProps",{initialValue:"",type:"content",searchButtonType:"plain"});var a3=n(32854),a4=n(66980),a5=Object.assign,a6=function(e){return A().createElement(a4.Z,a5({width:"38",height:"38",fill:"none",viewBox:"0 0 38 38"},e),A().createElement("path",{fill:"url(#id-2361276011-a)",d:"M31.96 5.895a.291.291 0 0 1 .547 0l.49 1.324a.971.971 0 0 0 .573.573l1.324.49a.291.291 0 0 1 0 .546l-1.324.49a.971.971 0 0 0-.573.574l-.49 1.323a.291.291 0 0 1-.546 0l-.49-1.323a.97.97 0 0 0-.574-.574l-1.323-.49a.291.291 0 0 1 0-.546l1.323-.49a.97.97 0 0 0 .574-.573l.49-1.324Z"}),A().createElement("path",{fill:"#7C63FF",fillRule:"evenodd",d:"M23.37 22.258c.021-.05.041-.1.06-.152l1.88-5.296a1.888 1.888 0 0 0-1.78-2.52h-3.623a2.36 2.36 0 0 0-2.036 1.166c-.004.009.004-.008 0 0l.012-.026c.466-1.053 1.452-3.284 3.117-4.831 1.957-1.82 5.09-1.522 7.167.16 2.977 2.41 4.414 6.549 2.999 10.563-1.704 4.831-6.506 8.062-11.628 8.062h-.17c2.143-1.69 3.345-4.995 4.002-7.126Z",clipRule:"evenodd"}),A().createElement("mask",{id:"id-2361276011-c",width:"15",height:"21",x:"17",y:"9",maskUnits:"userSpaceOnUse",style:{maskType:"alpha"}},A().createElement("path",{fill:"#000",fillRule:"evenodd",d:"m23.369 22.252.06-.15 1.88-5.297a1.888 1.888 0 0 0-1.78-2.52h-3.623a2.36 2.36 0 0 0-2.036 1.166c-.004.008.004-.009 0 0l.012-.026c.466-1.054 1.452-3.284 3.117-4.832 1.957-1.819 5.09-1.521 7.167.16 2.977 2.41 4.414 6.55 2.999 10.564-1.704 4.83-6.505 8.062-11.628 8.062h-.17c2.143-1.69 3.345-4.995 4.002-7.127Z",clipRule:"evenodd"}),A().createElement("path",{fill:"url(#id-2361276011-b)",fillRule:"evenodd",d:"m23.369 22.252.06-.15 1.88-5.297a1.888 1.888 0 0 0-1.78-2.52h-3.623a2.36 2.36 0 0 0-2.036 1.166c-.004.008.004-.009 0 0l.012-.026c.466-1.054 1.452-3.284 3.117-4.832 1.957-1.819 5.09-1.521 7.167.16 2.977 2.41 4.414 6.55 2.999 10.564-1.704 4.83-6.505 8.062-11.628 8.062h-.17c2.143-1.69 3.345-4.995 4.002-7.127Z",clipRule:"evenodd"})),A().createElement("g",{filter:"url(#id-2361276011-d)",mask:"url(#id-2361276011-c)"},A().createElement("path",{fill:"#594CF8",d:"M32.189 11.927c-.517-1.25-4.157-6.615-10.352-4.373-6.196 2.242-3.785 10.218-3.785 10.218s1.592-3.883 5.496-5.497c3.904-1.615 9.158.902 8.64-.348Z"})),A().createElement("path",{fill:"#191B1F",fillRule:"evenodd",d:"m6.142 15.815.693-1.973c.061-.162.12-.337.183-.52l.28-.8c.673-1.768 1.973-3.866 6.632-3.866h8.497c-2.877 1.402-3.757 4.16-4.46 6.357-.074.234-.147.46-.22.68a2.385 2.385 0 0 0-.064.163l-2.173 6.12a1.271 1.271 0 0 0 1.198 1.696.15.15 0 0 1 .142.2l-.296.85a.147.147 0 0 0 .22.17l.922-.619a3.54 3.54 0 0 1 1.974-.6h1.535c.893 0 1.7-.503 2.1-1.282a21.49 21.49 0 0 0-.198.463c-.8 1.916-2.705 6.473-7.288 6.473-.516 0-.924.02-1.237.052H7.19l2.727-7.733 1.363-3.866.527-1.493.708-2.006h-.275c-3.207-.007-4.985-.01-6.06 1.529l-.037.005Z",clipRule:"evenodd"}),A().createElement("path",{fill:"url(#id-2361276011-e)",fillRule:"evenodd",d:"m6.142 15.815.693-1.973c.061-.162.12-.337.183-.52l.28-.8c.673-1.768 1.973-3.866 6.632-3.866h8.497c-2.877 1.402-3.757 4.16-4.46 6.357-.074.234-.147.46-.22.68a2.385 2.385 0 0 0-.064.163l-2.173 6.12a1.271 1.271 0 0 0 1.198 1.696.15.15 0 0 1 .142.2l-.296.85a.147.147 0 0 0 .22.17l.922-.619a3.54 3.54 0 0 1 1.974-.6h1.535c.893 0 1.7-.503 2.1-1.282a21.49 21.49 0 0 0-.198.463c-.8 1.916-2.705 6.473-7.288 6.473-.516 0-.924.02-1.237.052H7.19l2.727-7.733 1.363-3.866.527-1.493.708-2.006h-.275c-3.207-.007-4.985-.01-6.06 1.529l-.037.005Z",clipRule:"evenodd"}),A().createElement("defs",null,A().createElement("linearGradient",{id:"id-2361276011-a",x1:"28.636",x2:"36.505",y1:"12.232",y2:"9.14",gradientUnits:"userSpaceOnUse"},A().createElement("stop",{offset:".235",stopColor:"#9868FF"}),A().createElement("stop",{offset:"1",stopColor:"#594CF8"})),A().createElement("linearGradient",{id:"id-2361276011-b",x1:"31.749",x2:"38.02",y1:"30.861",y2:"16.462",gradientUnits:"userSpaceOnUse"},A().createElement("stop",{stopColor:"#594CF8"}),A().createElement("stop",{offset:"1",stopColor:"#9868FF"})),A().createElement("radialGradient",{id:"id-2361276011-e",cx:"0",cy:"0",r:"1",gradientTransform:"rotate(71.939 -3.884 22.188) scale(22.8396 24.3453)",gradientUnits:"userSpaceOnUse"},A().createElement("stop",{offset:".419",stopColor:"#7C63FF"}),A().createElement("stop",{offset:"1",stopColor:"#5C4FFF"})),A().createElement("filter",{id:"id-2361276011-d",width:"26.436",height:"22.561",x:"11.689",y:"1.112",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},A().createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),A().createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),A().createElement("feGaussianBlur",{result:"effect1_foregroundBlur_1474_2797",stdDeviation:"2.95"}))))},a7=Object.assign,a8=function(e){return A().createElement(a4.Z,a7({width:"73",height:"20",fill:"none",viewBox:"0 0 73 20"},e),A().createElement("path",{fill:"#191B1F",d:"M17.728 1.503v-.13h-7.352L9.42 19.311h6.24a1.18 1.18 0 0 0 1.18-1.118l.887-16.69Zm-5.513 15.65.752-13.607h1.992l-.722 13.384a.236.236 0 0 1-.236.223h-1.786ZM8.134 15.112a49.445 49.445 0 0 1-.574-4.398V10.6H6.307l.083-.411h2.72l.117-2.143H6.759c.085-.694.15-1.428.192-2.187l.08-1.484h2.256L9.39 2.2H4.942c.095-.383.21-.922.335-1.606l.028-.148H2.611l-.015.113a9.044 9.044 0 0 1-1.358 3.839l-.018.03-.23 4.092.21-.14.168-.116-.103 1.908h2.461a30.07 30.07 0 0 1-1.2 4.225L.704 19.53h2.717l1.754-5.044.05-.146a37.691 37.691 0 0 0 1.047 5.098l.028.092h3.01l-.06-.168a24.766 24.766 0 0 1-1.116-4.25ZM2.992 6.69a10.64 10.64 0 0 0 1.266-2.316h.102s-.035.7-.08 1.471a34.9 34.9 0 0 1-.195 2.2H1.669A7.37 7.37 0 0 0 2.992 6.69ZM53.029 3.894l.118-2.155H47.07l.077-1.283h-2.683l-.078 1.283h-6.112l-.1 2.155h6.112l-.058 1.07h-5.072l-.647 12.28h-1.676l-.128 2.157h16.146l.123-2.255H51.58l.631-12.199h-5.305l.06-1.07 6.062.017Zm-11.347 3.96.032-.752h7.442c.134 0 .242.113.235.247l-.023.505h-7.686Zm7.242 8.412-.05.978h-7.663l.052-.975 7.661-.003Zm.158-3.127-.05.977h-7.688l.05-.977h7.688Zm.16-3.127-.05.974h-7.688l.05-.975h7.688Z"}),A().createElement("path",{stroke:"#EF3131",strokeLinecap:"square",strokeWidth:".056",d:"M27.938 2.11 27.16 16.28l-.098 1.772-.082 1.507"}),A().createElement("path",{fill:"#191B1F",d:"M32.364 4.31a34.207 34.207 0 0 1-1.88 3.852l-.107.188h2.802l.035-.07a49.704 49.704 0 0 0 1.754-3.877l.067-.17h-2.638l-.033.077ZM24.02 4.32l-.026-.087h-2.668l.047.16a37.368 37.368 0 0 0 1.373 3.88l.033.077h2.757l-.08-.178A32.43 32.43 0 0 1 24.02 4.32ZM35.278.703c-2.153.256-4.32.382-6.488.378h-7.768l-.13 2.153h6.164l2.464-.013a57.122 57.122 0 0 0 5.666-.35l.135-.043.11-2.143-.153.018ZM20.049 9.833l-.11 2.155h15.446l.113-2.155h-15.45Z"}),A().createElement("path",{fill:"#191B1F",fillRule:"evenodd",d:"m29.673 1.379-.917 17.037a1.18 1.18 0 0 1-1.179 1.116H23.71V16.81h2.182a.236.236 0 0 0 .236-.223l.827-15.354 2.72.147Z",clipRule:"evenodd"}),A().createElement("path",{fill:"#191B1F",d:"M70.084 12.858H56.63l-.353 6.699H68.76a1.18 1.18 0 0 0 1.179-1.12l.282-5.576-.136-.003Zm-11.026 4.544.13-2.389h8.217l-.12 2.166a.236.236 0 0 1-.236.223h-7.991ZM72.088 1.746h-.133s-1.188.012-2.233 0h-1.9c.104-.38.188-.764.251-1.153l.025-.148H65.39l-.015.106a5.406 5.406 0 0 1-1.253 2.698l.088-1.503h-.133s-1.185.012-2.23 0h-1.644c.103-.38.187-.764.25-1.153l.028-.148h-2.726l-.018.106a8.999 8.999 0 0 1-.599 2.004 3.76 3.76 0 0 1-1.115 1.534l-.043.035-.163 3.057.18-.07c1.377-.531 2.507-1.614 3.369-3.215h.514c.386 1.524.584 2.238.824 2.611l.038.06 2.573-.02-.057-.165c-.18-.521-.532-1.737-.737-2.486h1.097L63.49 6.57l.155-.028A4.912 4.912 0 0 0 66.903 3.9h.81c.16.57.333 1.12.5 1.633.13.403.298.792.502 1.163l.035.065h2.636l-.073-.17a28.08 28.08 0 0 1-.93-2.694h1.59l.115-2.15ZM58.354 9.633l-.113 2.155h10.27l.112-2.155H58.354Z"}),A().createElement("path",{fill:"#191B1F",d:"m64.258 5.874-.694-.398-.609.521c-.452.371-.93.711-1.428 1.018a18.389 18.389 0 0 1-5.851 2.41l-.123 2.33.4-.082a20.548 20.548 0 0 0 7.827-3.476c1.39.782 4.701 2.589 7.518 3.76l.303.125.125-2.391a84.036 84.036 0 0 1-7.468-3.817Z"}))},a9=Object.assign,ce=function(e){return A().createElement(a4.Z,a9({width:"28",height:"28",fill:"none",viewBox:"0 0 28 28"},e),A().createElement("path",{fill:"#fff",d:"M23.547 4.344a.215.215 0 0 1 .403 0l.36.975c.073.196.227.35.423.422l.975.361a.215.215 0 0 1 0 .403l-.975.36a.716.716 0 0 0-.422.423l-.361.975a.215.215 0 0 1-.403 0l-.36-.975a.715.715 0 0 0-.423-.422l-.975-.361a.215.215 0 0 1 0-.403l.975-.36a.715.715 0 0 0 .422-.423l.361-.975Z"}),A().createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M17.218 16.4c.016-.036.03-.073.044-.111l1.386-3.903a1.391 1.391 0 0 0-1.312-1.856h-2.67a1.74 1.74 0 0 0-1.5.859c.004-.007-.002.006 0 0l.01-.02c.343-.776 1.07-2.42 2.296-3.56 1.443-1.34 3.751-1.12 5.281.118 2.194 1.776 3.253 4.826 2.21 7.784-1.256 3.56-4.794 5.94-8.568 5.94h-.126c1.58-1.245 2.466-3.68 2.95-5.25Z",clipRule:"evenodd"}),A().createElement("mask",{id:"id-627620507-b",width:"11",height:"16",x:"13",y:"6",maskUnits:"userSpaceOnUse",style:{maskType:"alpha"}},A().createElement("path",{fill:"#000",fillRule:"evenodd",d:"M17.216 16.396c.016-.036.03-.073.044-.111l1.386-3.902a1.391 1.391 0 0 0-1.312-1.857h-2.67a1.74 1.74 0 0 0-1.5.859c.004-.007-.002.006 0 0l.01-.02c.343-.776 1.07-2.42 2.296-3.56 1.443-1.34 3.751-1.12 5.281.118 2.194 1.776 3.253 4.826 2.21 7.784-1.255 3.56-4.793 5.94-8.568 5.94h-.126c1.58-1.245 2.466-3.68 2.95-5.25Z",clipRule:"evenodd"}),A().createElement("path",{fill:"url(#id-627620507-a)",fillRule:"evenodd",d:"M17.216 16.396c.016-.036.03-.073.044-.111l1.386-3.902a1.391 1.391 0 0 0-1.312-1.857h-2.67a1.74 1.74 0 0 0-1.5.859c.004-.007-.002.006 0 0l.01-.02c.343-.776 1.07-2.42 2.296-3.56 1.443-1.34 3.751-1.12 5.281.118 2.194 1.776 3.253 4.826 2.21 7.784-1.255 3.56-4.793 5.94-8.568 5.94h-.126c1.58-1.245 2.466-3.68 2.95-5.25Z",clipRule:"evenodd"})),A().createElement("g",{filter:"url(#id-627620507-c)",mask:"url(#id-627620507-b)"},A().createElement("path",{fill:"#fff",d:"M23.715 8.788c-.38-.921-3.063-4.874-7.628-3.222-4.565 1.652-2.788 7.53-2.788 7.53s1.173-2.862 4.05-4.052c2.876-1.19 6.747.665 6.366-.256Z"})),A().createElement("path",{fill:"#fff",fillRule:"evenodd",d:"m4.523 11.653.511-1.454c.045-.12.09-.248.135-.383l.207-.589c.496-1.303 1.453-2.849 4.886-2.849h6.261c-2.12 1.033-2.768 3.065-3.286 4.684-.055.172-.108.34-.162.5-.017.04-.033.08-.048.121l-1.6 4.51a.937.937 0 0 0 .882 1.25.11.11 0 0 1 .105.147l-.219.626a.108.108 0 0 0 .163.126l.68-.457a2.61 2.61 0 0 1 1.454-.443h1.13a1.74 1.74 0 0 0 1.547-.944l-.145.341c-.59 1.412-1.993 4.77-5.37 4.77-.38 0-.68.014-.911.038H5.296l2.009-5.697 1.004-2.85.388-1.1.522-1.477-.203-.001c-2.363-.004-3.673-.007-4.465 1.127l-.028.004Z",clipRule:"evenodd"}),A().createElement("path",{fill:"#fff",fillRule:"evenodd",d:"m4.523 11.653.511-1.454c.045-.12.09-.248.135-.383l.207-.589c.496-1.303 1.453-2.849 4.886-2.849h6.261c-2.12 1.033-2.768 3.065-3.286 4.684-.055.172-.108.34-.162.5-.017.04-.033.08-.048.121l-1.6 4.51a.937.937 0 0 0 .882 1.25.11.11 0 0 1 .105.147l-.219.626a.108.108 0 0 0 .163.126l.68-.457a2.61 2.61 0 0 1 1.454-.443h1.13a1.74 1.74 0 0 0 1.547-.944l-.145.341c-.59 1.412-1.993 4.77-5.37 4.77-.38 0-.68.014-.911.038H5.296l2.009-5.697 1.004-2.85.388-1.1.522-1.477-.203-.001c-2.363-.004-3.673-.007-4.465 1.127l-.028.004Z",clipRule:"evenodd"}),A().createElement("defs",null,A().createElement("linearGradient",{id:"id-627620507-a",x1:"23.392",x2:"28.012",y1:"22.74",y2:"12.13",gradientUnits:"userSpaceOnUse"},A().createElement("stop",{stopColor:"#594CF8"}),A().createElement("stop",{offset:"1",stopColor:"#9868FF"})),A().createElement("filter",{id:"id-627620507-c",width:"19.479",height:"16.624",x:"8.611",y:".819",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},A().createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),A().createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),A().createElement("feGaussianBlur",{result:"effect1_foregroundBlur_1774_68457",stdDeviation:"2.174"}))))},ct=Object.assign,cn=function(e){return A().createElement(a4.Z,ct({width:"52",height:"14",fill:"none",viewBox:"0 0 52 14"},e),A().createElement("path",{fill:"#fff",d:"M12.284.867V.773H6.976L6.287 13.72h4.505a.852.852 0 0 0 .85-.807L12.285.867Zm-3.98 11.296.543-9.822h1.438L9.763 12a.17.17 0 0 1-.17.162H8.304ZM5.36 10.69c-.181-1.05-.33-2.118-.415-3.175v-.083h-.904l.06-.296h1.962l.085-1.547H4.366c.062-.501.109-1.031.14-1.58l.058-1.07h1.628l.074-1.57H3.054c.07-.277.153-.666.243-1.16l.02-.106H1.373l-.011.081a6.528 6.528 0 0 1-.98 2.771l-.013.022-.167 2.954.152-.101.121-.084-.074 1.377h1.777a21.707 21.707 0 0 1-.867 3.05l-1.315 3.706h1.96l1.267-3.641.036-.105a27.21 27.21 0 0 0 .756 3.68l.02.066h2.173l-.044-.121a17.877 17.877 0 0 1-.805-3.068ZM1.647 4.61A7.68 7.68 0 0 0 2.56 2.94h.074s-.025.505-.058 1.062c-.032.557-.08 1.085-.14 1.588H.692c.359-.284.68-.613.955-.979ZM37.771 2.593l.085-1.556H33.47l.056-.926h-1.937l-.056.926H27.12l-.073 1.556h4.412l-.041.772h-3.662l-.466 8.864h-1.21l-.093 1.557h11.655l.089-1.628h-1.006l.456-8.805h-3.83l.044-.773 4.375.013Zm-8.19 2.858.023-.543h5.371a.17.17 0 0 1 .17.178l-.016.365H29.58Zm5.227 6.072-.036.706h-5.531l.038-.704 5.53-.002Zm.114-2.257-.036.705h-5.55l.037-.705h5.55Zm.116-2.258-.036.704h-5.55l.036-.704h5.55Z"}),A().createElement("path",{stroke:"#fff",strokeLinecap:"square",strokeWidth:".04",d:"m19.658 1.305-.561 10.23-.07 1.278-.06 1.088"}),A().createElement("path",{fill:"#fff",d:"M22.854 2.893a24.693 24.693 0 0 1-1.356 2.78l-.078.136h2.022l.026-.05c.46-.914.888-1.857 1.266-2.8l.049-.122h-1.905l-.024.056ZM16.83 2.9l-.019-.063h-1.926l.034.116c.279.95.61 1.885.991 2.8l.024.056h1.99l-.058-.129a23.425 23.425 0 0 1-1.037-2.78ZM24.959.289a39.072 39.072 0 0 1-4.683.273h-5.608l-.094 1.554h4.45l1.778-.01a41.234 41.234 0 0 0 4.09-.252l.098-.031.08-1.547-.111.013ZM13.964 6.88l-.08 1.555h11.15l.082-1.556H13.964Z"}),A().createElement("path",{fill:"#fff",fillRule:"evenodd",d:"m20.912.777-.662 12.297a.852.852 0 0 1-.85.806h-2.793v-1.965h1.575a.17.17 0 0 0 .17-.161L18.95.67l1.962.106Z",clipRule:"evenodd"}),A().createElement("path",{fill:"#fff",d:"M50.078 9.063h-9.712l-.255 4.835h9.01a.852.852 0 0 0 .852-.808l.203-4.025-.098-.002Zm-7.959 3.28.094-1.724h5.932l-.087 1.563a.17.17 0 0 1-.17.16h-5.769ZM51.524 1.042h-.096s-.857.009-1.611 0h-1.371a8.15 8.15 0 0 0 .18-.832l.019-.107h-1.956l-.01.076a3.902 3.902 0 0 1-.905 1.948l.063-1.085h-.096s-.855.009-1.61 0h-1.186c.075-.274.135-.552.18-.832l.02-.107h-1.967l-.013.076a6.492 6.492 0 0 1-.432 1.447c-.17.432-.447.813-.805 1.107l-.031.026-.118 2.206.13-.05c.994-.384 1.81-1.165 2.432-2.321h.37c.28 1.1.422 1.615.596 1.885l.027.043 1.857-.014-.041-.12a39.524 39.524 0 0 1-.532-1.794h.792l-.092 1.93.112-.02a3.545 3.545 0 0 0 2.352-1.908h.584c.116.412.24.808.362 1.18.094.29.215.57.362.838l.025.047h1.903l-.053-.123a20.278 20.278 0 0 1-.67-1.944h1.146l.083-1.552ZM41.609 6.735l-.082 1.556h7.413l.081-1.556H41.61Z"}),A().createElement("path",{fill:"#fff",d:"m45.872 4.022-.501-.288-.44.377c-.326.268-.67.513-1.03.734a13.274 13.274 0 0 1-4.225 1.74l-.088 1.683.29-.06a14.832 14.832 0 0 0 5.648-2.51c1.004.565 3.394 1.87 5.427 2.714l.219.09.09-1.725a60.644 60.644 0 0 1-5.39-2.755Z"}))};function cr(e){var t=e.theme,n=(0,j._)("normal"===t.type?[a6,a8]:[ce,cn],2),r=n[0],o=n[1];return(0,v.BX)(oX.Flex,{as:"span",alignItems:"center",height:22,children:[(0,v.tZ)(r,{size:28}),(0,v.tZ)(o,{style:{width:51,height:14,marginLeft:2}})]})}var co=n(34473),ci=(0,b.forwardRef)(function(e,t){var n=e.Icon,r=e.count,o=e.name,i=e.theme,a=(0,K._)(e,["Icon","count","name","theme"]),c=(0,o7.ZP)(),s=c.bgColor,l=c.icon,u=c.iconOpacity,d=c.themeTransition;return(0,v.BX)(oQ.ZP,(0,U._)((0,B._)({ref:t,preset:"plain",css:{position:"relative"}},a),{children:[(0,v.tZ)(n,{size:18,center:!0,css:function(e){return(0,B._)({color:e.colors[l],opacity:u,"&:hover":{opacity:1}},d("color","opacity"))}}),r>0&&(0,v.BX)(oX.Box,{color:"GBK99B",bg:"GRD03A",px:"4px",css:function(e){return{position:"absolute",bottom:"65%",left:"42%",fontSize:11,borderRadius:20,border:"2px solid",transform:"scale(0.8)",borderColor:(0,o7.pe)(e)(s)}},children:[Math.min(r,99),r>99&&"+"]}),o&&(0,v.tZ)(oX.Box,{fontSize:"12px",lineHeight:"14px",css:function(e){return i&&(0,B._)({color:"".concat(e.colors[null==i?void 0:i.navColor]," !important"),opacity:null==i?void 0:i.navOpacity,"&.is-active, &:hover":{opacity:1},"&.is-active::after":{backgroundColor:"".concat(e.colors[null==i?void 0:i.navActiveColor]," !important")}},d("color"))},children:o})]}))}),ca=(0,b.forwardRef)(function(e,t){return(0,v.tZ)(ci,(0,B._)({ref:t,Icon:co.Z,name:"创作中心"},e))}),cc=(0,oR.withRouter)(function(e){var t=e.location.pathname,n=(0,K._)(e,["location"]);return(0,v.tZ)(v.HY,{children:"/creator"===t||"/creator/"===t?null:(0,v.tZ)(eG.Wi,{zaType:"Button",zaText:"创作中心入口",zaBlock:"AppHeader-CreatorEntrance",children:(0,v.tZ)(eG.$U,{zaBlock:"AppHeader-CreatorEntranceClick",zaType:"Button",zaText:"创作中心",zaAction:"OpenUrl",as:oX.Link,target:"_blank",href:"https://".concat(x.Z.wwwHost,"/creator"),css:{display:"inline-block",marginRight:"24px",marginTop:"2px"},children:(0,v.tZ)(ca,(0,B._)({},n))})})})}),cs=n(29229),cl=n(7522),cu=(0,b.forwardRef)(function(e,t){return(0,v.tZ)(ci,(0,B._)({ref:t,Icon:cl.Z,name:"私信",theme:e.theme},e))}),cd=function(e){var t=e.className,r=(0,K._)(e,["className"]),o=(0,cs.Z)(function(){return Promise.all([n.e(584),n.e(4667),n.e(3786)]).then(n.bind(n,37700))});return o?(0,v.tZ)(o,(0,B._)({IconButton:cu,className:t},r)):(0,v.tZ)(cu,(0,B._)({className:t},r))};function cp(e){var t=e.theme,n=e.url,r=e.isActive,o=e.children,i=(0,K._)(e,["theme","url","isActive","children"]);return(0,v.tZ)(oY.O,{className:"AppHeader-Tab",children:(0,v.tZ)("a",(0,U._)((0,B._)({className:oV()("AppHeader-TabsLink",{"is-active":r}),tabIndex:0,"data-za-not-track-link":!0,css:function(e){return(0,B._)({color:"".concat(e.colors[t.navColor]," !important"),opacity:t.navOpacity,"&.is-active, &:hover":{opacity:1},"&.is-active::after":{backgroundColor:"".concat(e.colors[t.navActiveColor]," !important")}},(0,o7.W5)("color"))},href:n},i),{children:o}))})}var ch=n(97813),cf=(0,b.forwardRef)(function(e,t){return(0,v.tZ)(ci,(0,B._)({ref:t,Icon:ch.Z,name:"消息"},e))}),c_=function(e){var t=e.className,r=(0,K._)(e,["className"]),o=(0,cs.Z)(function(){return n.e(358).then(n.bind(n,50838))});return o?(0,v.tZ)(o,(0,B._)({IconButton:cf,className:t},r)):(0,v.tZ)(cf,(0,B._)({className:t},r))},cm=n(42735),cv=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{signFlowModalShown:!1}),(0,X._)((0,oL._)(e),"getPathname",function(){return e.props.pathname||e.props.location.pathname}),(0,X._)((0,oL._)(e),"isInTopstory",function(){var t=e.getPathname(),n=new ia().TABS_TABLE.map(function(e){return e.path});return n.push(o8.institutionIndex),n.includes(t)}),(0,X._)((0,oL._)(e),"getMsgNoteTitle",function(){var t=e.props,n=t.notificationsCount,r=t.messageCount;if(t.isMobile)return"";var o=[],i="".concat(99,"+");r&&o.push("".concat(r>99?i:r," 封私信"));var a=Object.keys(n).reduce(function(e,t){return e+n[t]},0);return a&&o.push("".concat(a>99?i:a," 条消息")),o.length?"(".concat(o.join(" / "),") "):""}),(0,X._)((0,oL._)(e),"handleAuth",e.props.authRequired(function(){return{}})),(0,X._)((0,oL._)(e),"createNavClickHandler",function(e){return function(t){oW.Z.trackEvent(t.target,{action:"OpenUrl",id:2730},{button:{text:{home:"首页",learning:"知乎知学堂",explore:"发现",topic:"话题",questionWaiting:"等你来答",zhida:"知乎直答"}[e]}})}}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=this.getPathname(),t=this.props,n=t.currentUser,r=t.fillCurrentUserIfNeeded,o=t.referer;if(!n||"guest"===n.userType){o&&(o.startsWith("https://www.zhihu.com")||o.startsWith("https://zhuanlan.zhihu.com"))&&e.startsWith("/p/")&&this.setState({signFlowModalShown:!0});return}r(["availableMessageTypes","defaultNotificationsCount","followNotificationsCount","voteThankNotificationsCount","messagesCount"]);var i=this.props,a=i.handleNewPushNotifications,c=i.handleReceiveMessages;(0,o5.Z)([{name:"zhihu/notification/badge/web/v1/".concat(n.id,"/"),onMessage:a},{name:"zhihu/message/web/v1/user/".concat(n.id,"/"),onMessage:c}])}},{key:"handleSignFlowModalClose",value:function(){this.setState({signFlowModalShown:!1})}},{key:"renderUserInfo",value:function(){var e=this.props,t=e.currentUser,n=e.ua,r=e.currentUserIsCreator,o=e.appHeaderTheme;return(0,v.BX)("div",{className:"AppHeader-userInfo",children:[t&&(0,v.BX)(v.HY,{children:[(0,v.tZ)(c_,{theme:o,className:"AppHeader-notifications"}),(0,v.tZ)(cd,{theme:o,className:"AppHeader-messages"})]}),r&&(0,v.tZ)(cc,{theme:o}),(0,v.tZ)(ek.ql,{titleTemplate:n.Zhihu?"".concat(this.getMsgNoteTitle(),"%s"):"".concat(this.getMsgNoteTitle(),"%s - 知乎")}),!t&&(0,v.tZ)("div",{children:(0,v.tZ)(a3.Z,{})}),(0,v.tZ)("div",{className:"AppHeader-profile",children:(0,v.tZ)(o4.Z,{currentUser:t,enableGuidesForLogin:!0})})]})}},{key:"render",value:function(){var e=this,t=this.getPathname(),n=this.state.signFlowModalShown,r=this.props,o=r.currentUser,i=r.outlet,a=r.inletProps,c=r.headerTitle,s=r.appHeaderTheme,l=!t.startsWith("/creator")&&!t.startsWith("/mcn");return t.startsWith("/organization/enter")?(0,v.tZ)(v.HY,{children:(0,v.tZ)(o1,{})}):(0,v.tZ)(oj.Z,{getStyle:function(){return{width:"100%",top:0}},children:(0,v.BX)("header",{role:"banner",className:oV()("AppHeader",{"is-hidden":a.shown}),"data-za-module":"TopNavBar",css:function(e){return(0,B._)({backgroundColor:(0,o7.pe)(e)(s.bgColor),boxShadow:s.boxShadow},(0,o7.W5)("background-color","box-shadow"))},children:[n&&(!o||"guest"===o.userType)&&(0,v.tZ)(ic.Vy,{defaultType:"login",onClose:function(){e.handleSignFlowModalClose()}}),(0,v.tZ)(o3,{}),(0,v.BX)("div",{className:"AppHeader-inner",css:function(e){return l&&{width:"auto",maxWidth:1156,minWidth:1e3,paddingLeft:16,paddingRight:55,".AppHeader-userInfo":{marginLeft:30,width:"auto"},".AppHeader-TabsLink.is-active, .AppHeader-TabsLink:hover":{color:e.colors.GBK02A}}},children:[(0,v.tZ)(cm.Z,{color:s.logo}),c?(0,v.tZ)(oX.Text,{color:s.headerTitle,fontSize:"18px",ml:"16px",flex:"1",children:c}):(0,v.BX)(v.HY,{children:[(0,v.BX)(oY.Z,{className:"AppHeader-Tabs",css:l&&{marginLeft:25,marginRight:15,".AppHeader-Tab":{paddingLeft:15,paddingRight:15},".Tabs-link.is-active::after":{height:4}},children:[o&&o.isOrg&&(0,v.BX)(v.HY,{children:[(0,v.tZ)(oY.O,{className:"AppHeader-Tab",children:(0,v.tZ)("a",{tabIndex:0,className:oV()("AppHeader-TabsLink",{"is-active":"/organization"===t||t.startsWith("/organization/question")}),href:"".concat(P.i7,"/organization"),children:"管理中心"})}),(0,v.tZ)("div",{className:"AppHeader-navDivider"})]}),(0,v.tZ)(cp,{theme:s,isActive:this.isInTopstory(),url:"".concat(P.i7).concat(o&&o.isOrg?"/index":"/"),onClick:this.createNavClickHandler("home"),children:"首页"}),(0,v.tZ)(cp,{theme:s,isActive:"/education/learning"===t,url:"".concat(P.i7,"/education/learning"),onClick:this.createNavClickHandler("learning"),children:"知乎知学堂"}),(0,v.tZ)(cp,{theme:s,isActive:t.startsWith("/question/waiting"),url:"".concat(P.i7,"/question/waiting"),onClick:this.createNavClickHandler("questionWaiting"),children:"等你来答"}),(0,v.tZ)(cp,{theme:s,isActive:t.startsWith("/zhida"),url:"".concat(P.i7,"/zhida"),onClick:this.createNavClickHandler("zhida"),target:"_blank",rel:"noreferrer noopener",children:(0,v.tZ)(cr,{theme:s})})]}),(0,v.tZ)(oX.Flex,{flex:"1",justifyContent:"center",children:(0,v.tZ)(aJ,{theme:s,css:l&&{maxWidth:482,".SearchBar-input":{borderRadius:999,paddingLeft:16},".SearchBar-askButton":{borderRadius:999,width:70,marginLeft:12},".SearchBar-searchButton":{borderBottomRightRadius:999,borderTopRightRadius:999}}})})]}),this.renderUserInfo()]}),i]})})}}]),n}(b.PureComponent),cg=(0,e5.compose)(oR.withRouter,o6.Z,(0,eM.connect)(function(e){var t=e.account;return{messageCount:e.messages.messageCount,notificationsCount:e.pushNotifications.notificationsCount,account:t,ua:e.env.userAgent,isMobile:(0,eC.Hu)(e),referer:(0,eC.Kv)(e),currentUserIsCreator:e.switches.isCreator,creatorNotification:(0,ns.EtQ)(e).notification||{}}},{handleNewPushNotifications:nq.F7,handleReceiveMessages:nO.nB,fillCurrentUserIfNeeded:eE.sF}))(cv),cT=b.memo(function(e){var t=(0,eM.useSelector)(function(e){return e.env.appHeaderTheme}),n=oK.Z.useInletProps(),r=n.shown||t.disable?"normal":"custom",o=(0,b.useMemo)(function(){return(0,B._)({type:r,bgColor:t[r].bgColor},o7.mv[r])},[r,t]);return(0,v.tZ)(cg,(0,B._)({outlet:(0,v.tZ)(oK.Z.Outlet,{}),inletProps:n,appHeaderTheme:o},e))}),cE=n(64074),cC=n(91850),cy=n(7835);function cS(e){var t=e.onClose,n=e.shown,r=void 0!==n&&n,o=e.delay,i=void 0===o?300:o,a=(0,ex.n)(),c=(0,eM.useSelector)(function(e){return(0,eE.ib)(e)}),s=(0,j._)((0,cC.Z)(r),2),l=s[0],u=s[1],d=(0,iy.Z)(function(){var e=u.off;i?setTimeout(e,i):e(),null==t||t()}),p=(0,iy.Z)(function(){return u.toggle()});(0,b.useEffect)(function(){r!==l&&p()},[r,l,p]);var h=(0,j._)((0,b.useState)("register"),2),f=h[0],_=h[1];return((0,cy.Z)(function(){!c&&(0,ic.gl)()&&_("login")}),l)?x.Z.isMobileEntry?(0,v.tZ)(ic.uq,{onClose:d}):a.Zhihu?(0,v.tZ)(ic.uq,{isAppView:!0,onClose:d}):(0,v.tZ)(ic.Vy,{defaultType:f,onClose:d}):null}function cI(e){return(0,oJ.n)()?null:(0,v.tZ)(cS,(0,B._)({},e))}var cb=n(49274),cA=n(34459),cZ=n(38020);function cw(){return(0,v.tZ)("div",{css:function(e){return{backgroundColor:e.colors.GBK99A,boxSizing:"border-box",width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center"}},children:(0,v.tZ)(cZ.Z,{})})}var cR=function(e){var t;return null===(t=e.reverse().find(function(e){return void 0!==e.loadingUI}))||void 0===t?void 0:t.loadingUI};function cN(e){var t=e.routes,n=e.params,r=e.location,o=e.children,i=e.csrType,a=e.Component,c=(0,K._)(e,["Component"]),s=(0,j._)((0,cC.Z)("render"===i),2),l=s[0],u=s[1],d=(0,j._)((0,cC.Z)(!1),2),p=d[0],h=d[1],f=(0,j._)((0,b.useState)(null),2),_=f[0],m=f[1],g=(0,j._)((0,b.useState)(0),2),T=g[0],C=g[1],y=(0,ex.n)(),S=(0,eM.useStore)(),I=(0,e2.Z)(),A=(0,iy.Z)(function(){u.on(),p&&h.off(),_&&m(null),C(function(e){return e+1}),(0,cA.R)(t,function(e){return{route:e,params:n,location:r,dispatch:S.dispatch,getState:S.getState,ua:y,ctx:null,http:I}}).catch(m).finally(function(){return h.on()})}),Z=(0,b.useMemo)(function(){return cR(t)},[t]);return((0,b.useEffect)(function(){"render"===i&&A()},[i,A]),!l||_)?(0,v.tZ)("div",{css:function(e){return{backgroundColor:e.colors.GBK99A,position:"absolute",top:0,left:0,height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"}},children:(0,v.tZ)(cb.H.EI1,(0,U._)((0,B._)({image:"loadingError",content:(0,E.n$)(_)},T<=1&&{buttonText:"点击重试",buttonOnClick:A}),{preset:"normal"}))}):p?a?(0,v.tZ)(a,(0,B._)({},c)):o:void 0!==Z?Z:(0,v.tZ)(cw,{})}function ck(e){var t=e.Component,n=e.children;return e.enable?(0,v.tZ)(cN,(0,B._)({},e)):t?(0,v.tZ)(t,(0,B._)({},e)):n}var cO=n(49906),cx=n(16836),cP=n(23719),cD=n(94935),cL=n(28248),cB=n(26299),cU=n(49998),cM=function(){var e=(0,j._)((0,cC.Z)(),2),t=e[0],n=e[1],r=(0,eM.useSelector)(function(e){return e.loading.global.count});return(0,b.useEffect)(function(){r?n.on():n.off()},[n,r]),(0,v.tZ)(cU.Z,{active:t})},cG=n.p+"assets/apple-touch-icon-152.81060cab.png",cF=n.p+"assets/apple-touch-icon-120.d5793cac.png",cz=n.p+"assets/apple-touch-icon-76.7abf3393.png",cH=n.p+"assets/apple-touch-icon-60.362a8eac.png",cq=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"render",value:function(){var e=this.props.ua;return(0,v.tZ)(ek.ql,{title:"知乎",titleTemplate:e.Zhihu?"%s":"%s - 知乎",link:[{rel:"apple-touch-icon",href:cG},{rel:"apple-touch-icon",href:cG,sizes:"152x152"},{rel:"apple-touch-icon",href:cF,sizes:"120x120"},{rel:"apple-touch-icon",href:cz,sizes:"76x76"},{rel:"apple-touch-icon",href:cH,sizes:"60x60"}]})}}]),n}(b.Component),cV=(0,eM.connect)(function(e){return{ua:e.env.userAgent}})(cq),cX=n(4416);function cW(e){(0,cP.yZ)(window,{behavior:"smooth",top:window.innerHeight/2*(e?1:-1)})}function cK(e){(0,cP.zT)(document.body,{behavior:"smooth",block:e})}var cj=function(){(0,cX.n)("shift+u",function(){return cW(!1)}),(0,cX.n)("shift+d",function(){return cW(!0)}),(0,cX.n)("g g",function(){return cK("start")}),(0,cX.n)("shift+g",function(){return cK("end")})};function cY(){return cj(),(0,v.tZ)(v.HY,{children:!1})}var cQ=function(e){var t=e.keyMap,n=t.key,r=t.hint,o=n.split(/[ +]/),i=n.includes("+")?"+":" ";return(0,v.BX)("div",{className:"KeyHint",children:[(0,v.tZ)("div",{className:"KeyHint-keyContainer",children:o.map(function(e,t){return(0,v.BX)("div",{className:"KeyHint-key",children:[(0,v.tZ)("kbd",{className:"KeyHint-kbd",children:e}),t<o.length-1&&(0,v.tZ)("div",{className:oV()("KeyHint-separator",{"KeyHint-separator--space":" "===i}),children:i})]},t)})}),(0,v.BX)("div",{children:["：",r]})]})},cJ=[["操作",[{key:"V",hint:"赞同"},{key:"D",hint:"反对"},{key:"L",hint:"喜欢"},{key:"C",hint:"展开 / 收起评论"},{key:"O",hint:"展开 / 收起全文"},{key:"F",hint:"收藏"},{key:"S",hint:"分享"}]],["导航",[{key:"J",hint:"主内容下一项"},{key:"K",hint:"主内容上一项"},{key:"G G",hint:"滚动到页面顶部"},{key:"Shift+G",hint:"滚动到页面底部"},{key:"Shift+U",hint:"向上滚动半屏"},{key:"Shift+D",hint:"向下滚动半屏"},{key:"Shift+S",hint:"侧边栏第一项"},{key:"/",hint:"搜索"},{key:"?",hint:"快捷键帮助"}]]],c$=function(){var e=(0,j._)((0,cC.Z)(),2),t=e[0],n=e[1];return(0,v.BX)(v.HY,{children:[(0,v.tZ)(cX.y,{input:"?",action:n.toggle}),(0,v.tZ)(cX.y,{input:"？",action:n.toggle}),(0,v.tZ)(aa.Z,{className:"ShortcutHintModal",title:"快捷键帮助",onClose:n.off,children:t&&(0,v.tZ)("div",{className:"ShortcutHintModal-content",children:(0,v.tZ)("div",{className:"ShortcutHintModal-hintListContainer",children:cJ.map(function(e){var t=(0,j._)(e,2),n=t[0],r=t[1];return(0,v.BX)("div",{className:"ShortcutHintModal-hintList",children:[(0,v.tZ)("div",{className:"ShortcutHintModal-hintTitle",children:n}),r.map(function(e){return(0,v.tZ)(cQ,{keyMap:e},e.key)})]},n)})})})})]})},c0=n(83821),c1=n(62317),c2=function(e,t){if(e.closest)return e.closest(t);do{if(e.matches(t))break;e=e.parentElement}while(e);return e},c3=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),(e=t.call(this)).state={show:!1},e.onGlobalMouseover=e.handleGlobalMouseover.bind((0,oL._)(e)),e.onCancelEvent=e.handleCancelEvent.bind((0,oL._)(e)),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){document.body.addEventListener("mouseover",this.onGlobalMouseover),window.addEventListener("scroll",this.onCancelEvent),window.addEventListener("resize",this.onCancelEvent)}},{key:"componentWillUnmount",value:function(){document.body.removeEventListener("mouseover",this.onGlobalMouseover),window.removeEventListener("scroll",this.onCancelEvent),window.removeEventListener("resize",this.onCancelEvent)}},{key:"handleGlobalMouseover",value:function(e){var t=this;clearTimeout(this.showTimeout),clearTimeout(this.hideTimeout);var n=c2(e.target,"[data-tooltip]");n&&!n.disabled?this.showTimeout=setTimeout(function(){var e,r,o=n.getAttribute("data-tooltip-position")||"top",i=n.getAttribute("data-tooltip"),a=n.getAttribute("data-tooltip-classname"),c=n.getAttribute("data-tooltip-preset")||"black",s=null!==n.getAttribute("data-tooltip-will-hide-on-click"),l=n.getBoundingClientRect(),u=l.left,d=l.right,p=l.top,h=l.bottom;switch(o){case"left":e=u-4,r=(p+h)/2;break;case"right":e=d+4,r=(p+h)/2;break;case"bottom":e=(u+d)/2,r=h+4;break;default:e=(u+d)/2,r=p-4}t.setState({show:!0,content:i,position:o,className:a,preset:c,willHideOnClick:s,x:Math.round(e),y:Math.round(r)})},100):this.state.show&&(this.hideTimeout=setTimeout(function(){c2(e.target,".GlobalTooltip")||t.setState({show:!1})},120))}},{key:"handleCancelEvent",value:function(){clearTimeout(this.showTimeout),clearTimeout(this.hideTimeout),this.state.show&&this.setState({show:!1})}},{key:"render",value:function(){var e=this.state,t=e.show,n=e.content,r=e.position,o=e.preset,i=e.restricted,a=e.className,c=e.contentClassName,s=e.contentChildrenClassName,l=e.x,u=e.y;return(0,v.tZ)(c1.Z,{className:oV()("GlobalTooltip",a),contentClassName:c,contentChildrenClassName:s,shown:t,content:n,position:r,preset:o,restricted:i,x:l,y:u})}}]),n}(b.Component),c4=function(e){var t=e.whitelist,n=void 0===t?["/term","/terms","/unregister"]:t,r=e.currentUrlPath,o=(0,oJ.Z)(["isDestroyWaiting"]),i=(0,iy.Z)(function(){(null==n?void 0:n.some(function(e){return r.startsWith(e)}))||(window.location.href="".concat(x.Z.protocol,"//").concat(x.Z.wwwHost,"/unregister?version=2&is_waiting_page=1"))});return(0,b.useEffect)(function(){(null==o?void 0:o.isDestroyWaiting)&&i()},[o,i]),null},c5=function(e){var t=(0,eh._)({},(0,ef._)(e)),n=t.currentUrlPath;return(0,b.useMemo)(function(){return!(n.match(/\/story\/\d+$/)||n.match(/\/authorize$/))},[n])?(0,v.tZ)(c4,(0,B._)({},t)):null};function c6(){var e=(0,e2.Z)();return(0,cy.Z)(function(){window.__ZHToolkit__={fetch:e}}),null}var c7=function(){var e=function(e){return(0,g._)(Array(e).keys()).map(function(e){return e+1})},t="text-shadow:".concat((0,g._)(e(4).map(function(e){return"".concat(.7*e,"px -").concat(e,"px 0 rgb(255 255 255 / ").concat(100-4*(e-1),"%)")})).concat((0,g._)(e(3).map(function(e){return"-".concat(e,"px ").concat(e,"px ").concat(2*e,"px rgb(0 0 0 / 70%)")}))).flat().join(","));console.log("%c知乎 ฅ՞•ﻌ•՞ฅ","color:#1772F6;font-weight:bold;font-size:6em;padding:10px 30px;".concat(t,";").concat("background: linear-gradient(to right top,oklab(58.2% -0.04 -0.21),oklab(58.2% -0.376 -0.21));")),console.log("加入知乎 http://zhi.hu/BDXoD")},c8=function(e){var t=e.location;return(0,eG._E)(t),null},c9=function(e){var t=e.location;return(0,eG.DI)(t),null},se=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.silent,n=e.fillCurrentUserIfNeeded,r=e.location.pathname;!t&&(c7(),r.match(/\/story\/\d+$/)||r.match(/\/authorize$/)||n(["email","accountStatus","isBindPhone"]))}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.location,r=e.userAgent,o=e.disableMainHelmet,i=e.disableWechatShareImage,a=e.disableCornerButtons;return(0,v.BX)("div",{className:t,children:[!o&&(0,v.tZ)(cV,{}),r.Wechat&&!i&&(0,v.tZ)(oH.J,{}),!r.Zhihu&&(0,v.tZ)(cM,{}),(0,v.tZ)(c8,{location:n}),(0,v.tZ)(c9,{location:n}),(0,v.tZ)(cD.z,{}),this.props.children,(0,v.tZ)(cL.Z,{}),(0,v.tZ)(c3,{}),(0,v.tZ)(cx.Z,{style:{display:"none"},children:(0,v.tZ)("i",{children:"想来知乎工作？请发送邮件到 jobs@zhihu.com"})}),!(void 0!==a&&a)&&!r.Mobile&&(0,v.tZ)(c0.Z,{children:(0,v.tZ)("div",{role:"complementary",children:(0,v.tZ)(cB.ZP,{children:(0,v.tZ)(cB.zV,{onClick:function(e){e.preventDefault(),(0,cP.X5)(window,{top:0,behavior:"smooth"})}})})})}),(0,v.tZ)(c0.Z,{children:(0,v.tZ)(c5,{currentUrlPath:n.pathname})}),(0,v.tZ)(c$,{}),(0,v.tZ)(cY,{}),(0,v.tZ)(c6,{})]})}}]),n}(b.Component),st=(0,e5.compose)((0,eM.connect)(function(e){var t="/launcher"===e.env.ctx.path||"zhida"===x.Z.currentEntry;return{currentUser:(0,eE.ib)(e),account:e.account,userAgent:e.env.userAgent,disableMainHelmet:t,ua:(0,eC.Uh)(e)}},{fillCurrentUserIfNeeded:eE.sF}),oR.withRouter)(se),sn=n(19319),sr=(0,eM.connect)(function(e){return{account:e.account,notification:(0,tD._X)(e)}})(function(e){var t,n=e.account,r=e.notification,o=n.isAppealed,i=n.spamLevel,a=(0,b.useMemo)(function(){var e=o||i?P.Wy:P.If,t=6===i?(0,U._)((0,B._)({},r),{theme:"red"}):r;return(0,v.tZ)(sn.Z,{notification:t,delay:e})},[o,i,r]);if(!(null==r?void 0:null===(t=r.zaProps)||void 0===t?void 0:t.shouldTrackShow))return a;var c=r.zaProps,s=c.zaText,l=c.zaBlock,u=c.key;return(0,v.tZ)(eG.Wi,{zaType:"Text",zaText:s||r.text,zaBlock:l,children:a},u)}),so=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{color:"#3e7ac2"};return(0,v.tZ)("a",{target:"_blank",rel:"noopener noreferrer",href:e,style:n,children:t})},si=so("/term/community","知乎社区管理规定"),sa=so("/term/community","知乎社区管理规定",{color:"#fff","text-decoration":"underline"}),sc=so("/question/19551824","知乎用户信息管理规范"),ss=so("/settings/profile#rename-section","修改"),sl=so("/people/edit","修改"),su=so("/account/unblock","验证"),sd={ads:"发布垃圾信息",unfriendly:"发布不友善内容",illegal:"发布违反法律法规的内容",politics:"发布不宜公开讨论的政治内容",animus_edit:"恶意编辑",other:"其他原因"},sp={hang:(0,v.BX)("span",{children:["由于严重违反 ",si,"，该账号已被停用。"]}),lock:function(e){var t=e.unBlockInfo,n=t.isAppealed,r=t.spamLevel;return n?(0,v.tZ)("span",{children:"你的账号由于存在异常行为暂时被知乎反作弊系统限制使用，我们已收到了您的申诉信息，24 小时内会以私信的方式告知你申诉结果，请耐心等待。"}):6===r?(0,v.BX)("span",{children:["您的账号由于违反 ",sa," ，已被永久封禁。"]}):4===r?(0,v.BX)("span",{children:["您的账号异常 ，部分功能暂不可用。如需恢复，请完成"," ",so("/account/unblock","账号验证")]}):(0,v.BX)("span",{children:["你的网络环境或行为异常，请进行安全",su]})},ban:function(e){var t=e.expiredAt,n=e.reason;return t>999?(0,v.BX)("span",{children:["由于严重违反\xa0",si,"\xa0，该账号已被永久禁言"]}):(0,v.BX)("span",{children:["您的账号由于\xa0",(0,v.tZ)("a",{target:"_blank",href:"/term/community",style:{color:"#3e7ac2"},children:sd[n]||"违反知乎社区规定"}),"\xa0暂时被限制使用，",t," 天后恢复正常。"]})},isForceRenamed:function(e){var t=e.isOrg;return(0,v.BX)("span",{children:["您的用户名不符合 ",sc,"，请您\xa0",t?ss:sl,"。"]})},notBindPhone:(0,v.BX)("span",{children:["您的账号未激活，无法正常使用赞同、评论等功能。请 ",(0,v.tZ)(ic.$7,{})," 。"]})},sh={profile:{hang:(0,v.BX)("span",{children:["由于严重违反 ",si,"，该账号已被停用"]}),lock:function(e){var t=e.unBlockInfo,n=t.isAppealed,r=t.spamLevel;return n&&3===r||!r?null:4===r?(0,v.BX)("span",{children:["您的账号异常 ，部分功能暂不可用。如需恢复，请完成"," ",so("/account/unblock","账号验证")]}):6===r?(0,v.BX)("span",{children:["您的账号由于违反 ",si," ，已被永久封禁。"]}):(0,v.BX)("span",{children:["你的网络环境或行为异常，请进行安全",su]})},ban:function(e){var t=e.isCurrentUser,n=e.expiredAt,r=e.reason;return n>999?(0,v.BX)("span",{children:["由于严重违反\xa0",si,"\xa0，该账号已被永久禁言"]}):t?(0,v.BX)("span",{children:["您的账号由于\xa0",(0,v.tZ)("a",{href:"/term/community",target:"_blank",style:{color:"#3e7ac2"},children:sd[r]||"违反知乎社区规定"}),"\xa0暂时被限制使用，",n," 天后恢复正常。"]}):(0,v.BX)("span",{children:["由于违反 ",si,"，该用户暂时处于禁言状态，",n," ","日后将恢复正常使用。"]})},isForceRenamed:function(e){var t=e.isCurrentUser,n=e.hasRenamed,r=e.isOrg;return t?(0,v.tZ)("span",{children:n?"您的用户名已修改，请等待管理员确认。申诉邮箱：i@zhihu.com。":(0,v.BX)("span",{children:["您的用户名不符合 ",sc,"，请您\xa0",r?ss:sl]})}):(0,v.BX)("span",{children:["由于违反 ",sc," ，该用户暂时处于改名状态。"]})},notBindPhone:function(){return null}},behavior:sp};function sf(e,t,n){var r,o="object"==typeof e?e.name:e;if("ban"===o){var i=e.createdAt,a=e.expiredAt;r={reason:e.reason,expiredAt:Math.ceil((0,n3.NV)(a-Date.now()/1e3+i))}}return o===P.Pw.lock&&(r={unBlockInfo:t}),o===P.Pw.isForceRenamed&&(r={isOrg:!!(n&&"organization"===n.userType)}),function(e,t,n){if(!t)return"";var r=sh[e];return"function"==typeof r[t]?r[t]((0,B._)({},n)):r[t]}("behavior",o,r)}function s_(e,t){var n=e.accountStatus,r=e.isForceRenamed,o=e.isBindPhone,i=e.userType,a=e.isRealname;if(n&&n.length){var c=n.find(function(e){var n=e.name;return t.includes(n)});if(c)return c}return!1===o&&!a&&t.includes("notBindPhone")?"notBindPhone":r&&t.includes("isForceRenamed")?"isForceRenamed":"guest"===i&&t.includes("isGuest")?"isGuest":null}function sm(e,t,n){for(var r=arguments.length,o=Array(r>3?r-3:0),i=3;i<r;i++)o[i-3]=arguments[i];var a=e.canWrite,c=e.alertTimeSpan;if(!a)return t.apply(void 0,(0,g._)(o));var s=new Date().getTime(),l=O().get(P.iG);return isNaN(l)||l>s||l+1e3*c<s?(O().set(P.iG,s),t.apply(void 0,(0,g._)(o))):n.apply(void 0,(0,g._)(o))}var sv=n(69140),sg=n(65357),sT=n(82865),sE=(0,eM.connect)(function(e){var t=e.entities.users[e.currentUser],n=t.isActive,r=t.email,o=t.isZombie,i=t.isBindPhone,a=e.account;return{isActive:n,email:r,isZombie:o,errorStatus:a.errorStatus,challenge:a.challenge,isBindPhone:i}},{getUnlockRequest:e8.F4})(function(e){var t=e.globalShow,n=e.toggleGlobalShow,r=e.isZombie,o=e.getUnlockRequest,i=e.isActive,a=e.email,c=e.challenge,s=e.errorStatus,l=e.isBindPhone,u=(0,j._)((0,b.useState)(!1),2),d=u[0],p=u[1],h=(0,j._)((0,b.useState)(""),2),f=h[0],_=h[1],m=(0,iy.Z)(function(){r&&(S.ZP.increment("logIn.zombieStatus.closeModal.count"),(0,sT.Fu)())}),g=(0,iy.Z)(function(){m(),(0,sg.o$)(),_("")}),T=(0,iy.Z)(function(){m(),(0,sg.o$)()}),E=(0,b.useCallback)(function(){d&&g(),n(!d)},[n,d,g]);(0,b.useEffect)(function(){r&&(S.ZP.increment("logIn.zombieStatus.showModal.count"),p(!0))},[r]),(0,b.useEffect)(function(){void 0!==l&&!l&&(0,sg.wb)()&&p(!0)},[l]),(0,b.useEffect)(function(){t&&S.ZP.increment("logIn.GlobalVerificationModal.show.count"),p(t)},[t]);var C=(0,iy.Z)(function(){var e=document.querySelector(".VerificationDialogModalHeader"),t="";t=r?(null==c?void 0:c.length)?sv.SAFETY_VERIFICATION:sv.BIND_PHONE:i&&a?sv.CONFIRM_BIND_PHONE:s&&!e&&c&&c.length?sv.SAFETY_VERIFICATION:sv.BIND_PHONE,S.ZP.increment("logIn.GlobalVerificationModal.initialStep.".concat(t,".count")),_(t)});return(0,b.useEffect)(function(){d&&o().then(function(){C()})},[d]),(0,v.tZ)(ic.t,{currentStep:f,onToggle:E,shown:d,onSuccess:T})}),sC=n(76295);function sy(){return"undefined"==typeof document?null:document.querySelector(".VerificationDialogModalHeader")}var sS=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{authModalShown:!1,bindPhoneModalShown:!1,signInModalShown:!1}),(0,X._)((0,oL._)(e),"handleAuthModalClose",function(){return e.setState({authModalShown:!1})}),(0,X._)((0,oL._)(e),"closeModal",function(){var t=e.props.recoverDefaultType;oz.c.close(),t()}),(0,X._)((0,oL._)(e),"handleInitAccount",function(t){var n=t||e.props,r=n.currentUser,o=n.account,i=n.getUnblockInfo;r&&r.accountStatus&&r.accountStatus.find(function(e){return"lock"===e.name})&&!o.isUnblockInfoFetched&&i()}),(0,X._)((0,oL._)(e),"handleBindPhoneModalToggle",function(){e.setState(function(e){return{bindPhoneModalShown:!e.bindPhoneModalShown}})}),(0,X._)((0,oL._)(e),"handleToggleSignInModalShown",function(){e.setState({signInModalShown:!e.state.signInModalShown})}),(0,X._)((0,oL._)(e),"handleLogin",function(){e.props.userAgent.Wechat?e.handleToggleSignInModalShown():location.href="https://www.zhihu.com/signin?next=".concat(encodeURIComponent(location.href))}),e}return(0,V._)(n,[{key:"getChildContext",value:function(){var e=this,t=this.props,n=t.isMobile,r=t.showNotification;return{currentUser:this.props.currentUser,isMobile:n,authRequired:function(e,t,n,r,o,i){var a=this;return function(c){for(var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P.zg,l=arguments.length,u=Array(l>2?l-2:0),d=2;d<l;d++)u[d-2]=arguments[d];var p=function(e){return function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];e.apply(void 0,(0,g._)(n)),"function"==typeof m&&m.apply(void 0,(0,g._)(n))}};if(!c){var h="function"==typeof e?e():e;return sf(s_(h,s),null,h)}var f=(0,j._)(Array.isArray(c)?c:[c],2),_=f[0],m=f[1];return function(){for(var c=arguments.length,l=Array(c),d=0;d<c;d++)l[d]=arguments[d];var h="function"==typeof e?e():e;if(!h)return p(r).apply(a,(0,g._)(l));var f=s_(h,s);return f?"notBindPhone"===f&&i?p(sm.bind(null,t,i,_)).apply(a,(0,g._)(l)):"isGuest"===f?p(r).apply(a,(0,g._)(l)):p(function(){return o.apply(void 0,[sf(f,f.name===P.Pw.lock?n():null,h)].concat((0,g._)(u)))}).apply(a,(0,g._)(l)):_.apply(void 0,(0,g._)(l))}}}(function(){return e.props.currentUser},P.xR,function(){return e.props.account},function(){return n?(0,sC.ZP)():e.setState({authModalShown:!0})},function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return r.apply(void 0,[e,"white"].concat((0,g._)(n)))},this.handleBindPhoneModalToggle),handleBindPhoneModalToggle:this.handleBindPhoneModalToggle}}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.account,n=e.currentUser,r=e.getUnlockRequest,o=t.errorStatus;if(!t.isFetching){var i=sy();o&&!i&&n&&"guest"!==n.userType&&r()}}},{key:"componentDidMount",value:function(){var e=this.props.edition;if(O().isSupported()){var t=Object.keys(e).find(function(t){return!!e[t]});t&&window.sessionStorage.setItem("utm_source",t)}}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.requestUnlockTicket,r=t.unlockTicketByDigits,o=t.unlockTicketByPassword,i=t.account,a=i.unlockTicketStatus,c=i.isFetching,s=i.errorStatus,l=i.challenge;!c&&s&&l&&l.length&&!sy()&&oz.c.show((0,v.tZ)(oz.c,{account:i,unlockTicketByDigits:r,requestUnlockTicket:n,unlockTicketByPassword:o,onClose:this.closeModal})),a&&oz.c.close(),e.currentUser&&this.props.currentUser&&(!e.currentUser.accountStatus&&this.props.currentUser.accountStatus&&this.handleInitAccount(),void 0===e.currentUser.isBindPhone&&void 0!==this.props.currentUser.isBindPhone&&this.unlockRequestIfNeed())}},{key:"componentWillUnmount",value:function(){(0,this.props.recoverDefaultType)()}},{key:"unlockRequestIfNeed",value:function(){var e=this.props,t=e.currentUser,n=e.getUnlockRequest;t&&!1===t.isBindPhone&&"guest"!==t.userType&&n()}},{key:"renderAppHeader",value:function(){var e=this.props,t=e.currentUser,n=e.isMobile,r=e.isZhihu,o=e.itemInfo,i=e.routes.some(function(e){return e.showAppHeader});return!1===i||r?null:n?(0,v.tZ)(cE.Z,{currentUser:t,onLogin:this.handleLogin,tag:"div",itemInfo:o}):i?(0,v.tZ)(cT,{currentUser:t}):null}},{key:"render",value:function(){var e=this.props,t=e.currentUser,n=e.userAgent,r=e.children,o=this.state,i=o.authModalShown,a=o.bindPhoneModalShown,c=o.signInModalShown;return(0,v.BX)(st,{className:"App",children:[n.Wechat&&(0,v.tZ)(oH.J,{}),this.renderAppHeader(),(0,v.tZ)(sr,{}),(0,v.tZ)("main",{role:"main",className:"App-main",children:r}),(0,v.tZ)(cI,{shown:i,onClose:this.handleAuthModalClose}),t&&(0,v.tZ)(sE,{globalShow:a,toggleGlobalShow:this.handleBindPhoneModalToggle}),(0,v.tZ)(eW.w,{}),c&&(0,v.tZ)(cO.Z,{buttons:[{name:"zhihu",text:"使用知乎账号登录",fill:"#0f88eb",color:"#fff"},{name:"wechat",text:(0,v.BX)("span",{children:[(0,v.tZ)(oM.F3,{text:!0,center:!0}),"\xa0微信快速登录"]}),fill:"#12b370",color:"#fff"}],onClose:this.handleLogin})]})}}]),n}(b.Component);(0,X._)(sS,"fetchData",function(e){return(0,e.dispatch)((0,eC.ph)())}),(0,X._)(sS,"childContextTypes",{currentUser:oF().object,authRequired:oF().func,handleBindPhoneModalToggle:oF().func,isMobile:oF().bool});var sI=(0,e5.compose)(function(e){return iI()(function(t){var n=(0,eM.useSelector)(function(e){return e.env.mode}),r=(0,eM.useSelector)(function(e){return e.env.vars.csrType})||"downgrade";return(0,v.tZ)(ck,(0,U._)((0,B._)({},t),{enable:"csr"===n,csrType:r,Component:e}))},e)},(0,eM.connect)(function(e,t){var n,r=e.env,o=r.userAgent,i=r.trafficSource,a=(0,eC.Hu)(e),c="p"===(n=t.location.pathname.split("/").slice(1))[0]?{type:"article",id:Number(n[1])}:"answer"===n[2]?{type:"answer",id:Number(n[3])}:"question"===n[0]?{type:"question",id:Number(n[1])}:"topic"===n[0]?{type:"topic",id:Number(n[1])}:null;return c&&(c.readStatus=(0,nX.O8)(e,c)),{trafficSource:i,currentUser:(0,eE.ib)(e),account:e.account,userAgent:o,isMobile:a,isZhihu:(0,eC.nR)(e),itemInfo:c||void 0,edition:(0,eC.cM)(e)}},{showNotification:tD.c0,unlockTicketByDigits:e8.LC,getUnblockInfo:e8.sQ,unlockTicketByPassword:e8.Hr,getUnlockRequest:e8.F4,requestUnlockTicket:e8.MM,recoverDefaultType:e8.Z3}))(sS),sb=n(35865),sA=n(10421),sZ=n(76280),sw=n(27548),sR=n(12752),sN=n(53159),sk=n(80565),sO=function(e){var t=e.icon,n=sD(e.isMobile),r=n.iconMarginRight,o=n.lineHeight,i=n.iconSize;return(0,v.tZ)(oX.Flex,{mr:"".concat(r,"px"),height:o,alignItems:"center",flexShrink:0,children:"string"==typeof t?(0,v.tZ)(oX.Box,{sx:{width:"".concat(i,"px"),height:"".concat(i,"px"),background:"url(".concat(t,") no-repeat"),backgroundSize:"100% 100%"}}):t})},sx=function(e){var t=e.desc,n=e.isMobile,r="string"==typeof t?(0,v.tZ)("span",{className:"desc-content",dangerouslySetInnerHTML:{__html:t}}):t,o=sD(n),i=o.fontSize,a=o.fontNumLimit,c=o.anchorColor;return(0,v.tZ)(oX.Box,{css:function(e){return(0,U._)((0,B._)({color:e.colors.GBK02A},(0,sk.S)(2),!n&&{maxWidth:"".concat(i*a,"px")}),{a:{color:"".concat(e.colors[c]," !important")},".desc-content":{a:{margin:"0 10px"}}})},children:r})};function sP(e){var t=e.desc,n=e.icon,r=e.isMobile,o=sD(r),i=o.fontSize,a=o.lineHeight;return(0,v.BX)(oX.Flex,{sx:{":not(:last-of-type)":{marginBottom:"8px"},fontSize:i,lineHeight:"".concat(a,"px"),alignItems:"flex-start"},children:[(0,v.tZ)(sO,{isMobile:r,icon:n}),(0,v.tZ)(sx,{desc:t})]})}function sD(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{parentPadding:16,fontSize:15,lineHeight:e?21:24,fontNumLimit:48,iconSize:16,iconMarginRight:e?8:12,anchorColor:e?"GBL01A":"GBL07A"}}var sL=function(e){var t=e.fold,n=e.setFold,r=sD(!0),o=r.iconSize,i=r.iconMarginRight,a=r.lineHeight,c={marginRight:"4px"},s=sR.colors[sR.groups.GBK06A[0]];return(0,v.tZ)(oX.Flex,{as:"button",css:function(e){return{alignItems:"center",lineHeight:"".concat(a,"px"),color:e.colors.GBK06A,fontSize:"13px",marginLeft:"".concat(o+i,"px"),marginTop:"6px"}},"aria-label":"更多",onClick:function(){n(!t)},children:t?(0,v.BX)(v.HY,{children:[(0,v.tZ)("span",{css:c,children:"展开更多"}),(0,v.tZ)(sA.Z,{size:5,fill:s})]}):(0,v.BX)(v.HY,{children:[(0,v.tZ)("span",{css:c,children:"收起"}),(0,v.tZ)(sZ.ZP,{size:5,fill:s})]})})};function sB(e){var t=e.user,n=e.inPage,r=(0,eM.useDispatch)(),o=(0,eM.useSelector)(function(e){return e.account}),i=o.isAppealed,a=o.spamLevel,c=(0,eM.useSelector)(eC.Hu),s=(0,eM.useSelector)(eE.ib),l=(0,j._)((0,b.useState)([]),2),u=l[0],d=l[1],p=(0,j._)((0,b.useState)(c),2),h=p[0],f=p[1],_=(0,b.useMemo)(function(){return!t||s&&s.urlToken===t.urlToken},[s,t]),m=(0,iy.Z)(function(){var e=t||s;if(e){var r=e.profilePunishmentReminds,o=e.isOrg,i=e.badge,a=e.badgeV2,l=[],u=(0,sN.a)(a,i),p=sD(c).iconSize;o&&!u.identity&&"people"===n&&l.unshift({desc:"未认证的机构号",icon:(0,v.tZ)(sw.Z,{size:p,fill:sR.colors[sR.groups.GYL01A[0]]})}),r&&(l=l.concat(r.map(function(e){return{desc:e.reasonDesc,icon:e.iconUrl}}))),d(l)}});(0,b.useEffect)(function(){_?Promise.resolve(r((0,eE.sF)(["accountStatus","isForceRenamed","renamedFullname","isBindPhone"]))).then(m):m()},[_,m,r]),(0,b.useEffect)(function(){(null==t?void 0:t.urlToken)&&m()},[m,i,a,t]);var g=sD(c),T=g.parentPadding,E=g.fontSize,C=g.fontNumLimit,y=g.iconSize,S=g.iconMarginRight;if(0===u.length)return null;var I=h?u.slice(0,2):u;return(0,v.tZ)(oX.Box,{css:function(e){return{padding:c?"15px 14px":"".concat(T,"px 0"),width:c?"calc(100% + ".concat(2*T,"px)"):"auto",backgroundColor:"column"===n?"transparent":e.colorMod(e.colors.GBK09A).alpha(.6)}},children:(0,v.BX)(oX.Box,{css:{wordBreak:"break-all",margin:"auto",width:["".concat(c?"auto":E*C+y+S),c?"auto":"fit-content"]},children:[I.map(function(e,t){return(0,v.tZ)(sP,(0,B._)({isMobile:c},e),t)}),u.length>2&&c&&(0,v.tZ)(sL,{fold:h,setFold:f})]})})}var sU=n(55679),sM=n(76976),sG=function(e){var t=e.scene;return function(e){return iI()(function(n){return(0,v.tZ)(sM.g_,{scene:t,children:(0,v.tZ)(e,(0,B._)({},n))})},e)}},sF=n(72174),sz=function(e){var t=e.className,n=e.onRequestClick,r=new Date().getFullYear();return(0,v.BX)("div",{className:oV()("ColumnHomeBottom",t),children:[(0,v.tZ)("h3",{className:"ColumnHomeBottom-title",children:"在知乎创作"}),(0,v.tZ)(oQ.ZP,{className:"ColumnHomeBottom-requestButton",onClick:n,children:"申请专栏"}),(0,v.BX)("footer",{className:"ColumnHomeBottom-footer",children:[(0,v.BX)("span",{children:["\xa9 ",r," 知乎"]}),(0,v.tZ)("span",{children:" \xb7 "}),(0,v.tZ)("a",{target:"_blank",href:"/",rel:"noopener noreferrer",children:"知乎专栏"}),(0,v.tZ)("span",{children:" \xb7 "}),(0,v.tZ)("a",{target:"_blank",href:"https://www.zhihu.com/roundtable",rel:"noopener noreferrer",children:"圆桌"}),(0,v.tZ)("span",{children:"\xb7"}),(0,v.tZ)("a",{target:"_blank",href:"https://www.zhihu.com/explore",rel:"noopener noreferrer",children:"发现"}),(0,v.tZ)("span",{children:" \xb7 "}),(0,v.tZ)("a",{target:"_blank",href:"https://www.zhihu.com/app",rel:"noopener noreferrer",children:"移动应用"}),(0,v.tZ)("span",{children:" \xb7 "}),(0,v.tZ)("a",{href:"https://www.zhihu.com/signin?no_qrcode=1",children:"使用机构账号登录"}),(0,v.tZ)("span",{children:" \xb7 "}),(0,v.tZ)("a",{href:"https://www.zhihu.com/contact",children:"联系我们"}),(0,v.tZ)("span",{children:" \xb7 "}),(0,v.tZ)("a",{target:"_blank",href:"https://www.zhihu.com/careers",rel:"noopener noreferrer",children:"来知乎工作"}),(0,v.tZ)("br",{}),(0,v.tZ)("a",{href:"https://tsm.miit.gov.cn/dxxzsp/",target:"_blank",rel:"noopener noreferrer",children:"京 ICP 证 110745 号"}),(0,v.tZ)("span",{children:" \xb7 "}),(0,v.tZ)("a",{href:"https://beian.miit.gov.cn/",target:"_blank",rel:"noopener noreferrer",children:"京 ICP 备 13052560 号 - 1"}),(0,v.tZ)("span",{children:" \xb7 "}),(0,v.BX)("a",{target:"_blank",rel:"noopener noreferrer",href:"http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010802020088",children:[(0,v.tZ)("img",{src:"https://pic3.zhimg.com/80/v2-d0289dc0a46fc5b15b3363ffa78cf6c7.png",alt:""}),"京公网安备 11010802020088 号"]}),(0,v.tZ)("span",{children:" \xb7 "}),(0,v.tZ)("a",{href:"http://zhstatic.zhihu.com/assets/zhihu/publish-license.jpg",target:"_blank",rel:"noopener noreferrer",children:"出版物经营许可证"})]})]})},sH=n(44812);function sq(e){var t=e.children;return(0,v.BX)("h3",{className:"ColumnHomeTitle",children:[(0,v.tZ)("div",{className:"ColumnHomeTitle-text",children:t}),(0,v.tZ)("div",{className:"ColumnHomeTitle-line"})]})}function sV(e){var t=e.className,n=e.column,r=n.url,o=n.imageUrl,i=n.title,a=n.description,c=n.followers,s=n.articlesCount;return(0,v.BX)("a",{className:oV()("ColumnHomeColumnCard",t),target:"_blank",href:r,rel:"noopener noreferrer",children:[(0,v.tZ)(iZ.qE,{className:"ColumnHomeColumnCard-Avatar",round:!0,size:48,url:o,alt:"专栏图像"}),(0,v.BX)("div",{className:"ColumnHomeColumnCard-info",children:[(0,v.tZ)("div",{className:"ColumnHomeColumnCard-title",children:i}),(0,v.tZ)("div",{className:"ColumnHomeColumnCard-description",children:a})]}),(0,v.BX)("div",{className:"ColumnHomeColumnCard-meta",children:[(0,i1.uf)(c)," 人关注 | ",(0,i1.uf)(s)," 篇文章"]}),(0,v.tZ)(oQ.ZP,{className:"ColumnHomeColumnCard-followButton",preset:"outline",color:"green",children:"进入专栏"})]})}var sX=function(e){var t=e.recommendations,n=e.onChange,r=(0,j._)((0,b.useState)(!1),2),o=r[0],i=r[1];return(0,v.BX)("div",{className:"ColumnHomeRecommendation",children:[(0,v.tZ)(sq,{children:"专栏 \xb7 发现"}),(0,v.tZ)("div",{className:"ColumnHomeRecommendation-cardContainer",children:(void 0===t?[]:t).map(function(e){return(0,v.tZ)(sV,{className:"ColumnHomeRecommendation-card",column:e},e.id)})}),(0,v.tZ)(oQ.ZP,{className:oV()("ColumnHomeRecommendation-refreshButton",{"ColumnHomeRecommendation-refreshButton--rotating":o}),color:"grey",icon:sH.x,label:"换一换",onClick:function(e){i(!0),n(e)},onTransitionEnd:function(){i(!1)}})]})},sW=n(31142),sK=(0,eM.connect)(function(e){return{isZhihu:e.env.userAgent.Zhihu,isWebView:e.env.userAgent.isWebView}})(function(e){var t=e.isZhihu,n=e.isWebView,r=e.onRequestClick;return(0,v.BX)("div",{className:"ColumnHomeTop",children:[(0,v.tZ)("h1",{className:"ColumnHomeTop-logo",children:"知乎专栏"}),(0,v.tZ)("h2",{className:"ColumnHomeTop-subTitle",children:"随心写作，自由表达"}),!t&&!n&&(0,v.BX)(b.Fragment,{children:[(0,v.tZ)(sW.Z,{className:"ColumnHomeTop-writeButton",preset:"outline",color:"grey",target:"_blank",to:"/write",onClick:function(e){oW.Z.trackEvent(e.target,{id:8035,action:"OpenUrl"},{link:{url:"https://zhuanlan.zhihu.com/write"}})},children:"开始写文章"}),(0,v.BX)(oQ.ZP,{className:"ColumnHomeTop-requestButton",preset:"plain",color:"green",onClick:r,children:["申请开通专栏",(0,v.tZ)(ac.N,{text:!0,center:!0})]})]})]})}),sj={limit:8,offset:0,seed:7};function sY(e){var t=e.currentUser,n=e.isMobile,r=e.homeRecommendations,o=e.getHomeRecommendations,i=e.showNotification,a=e.fillCurrentUserIfNeeded,c=(0,j._)((0,b.useState)(!1),2),s=c[0],l=c[1],u=(0,j._)((0,b.useState)(!1),2),d=u[0],p=u[1],h=(0,j._)((0,b.useState)(!1),2),f=h[0],_=h[1],m=(0,iy.Z)(function(){var e=t.accountStatus,n=t.hasApplyingColumn;return(null==e?void 0:e.muted)?p(!0):n?l(!0):void _(!0)});(0,b.useEffect)(function(){oW.Z.trackPageShow({id:3368})},[]),(0,b.useEffect)(function(){O().get("requestColumn")&&(O().delete("requestColumn"),i("信息已提交，我们将在三个工作日内确认并答复"))},[i]),(0,b.useEffect)(function(){a(["hasApplyingColumn"])},[]);var g=(0,b.useCallback)(function(){window.innerWidth<=1020?(sj.offset+=6,sj.limit=6):(sj.offset+=8,sj.limit=8),o("columns",sj)},[o]);return(0,v.BX)("div",{className:"ColumnHome",children:[(0,v.tZ)(ek.ql,{title:"知乎专栏 - 随心写作，自由表达"}),!n&&(0,v.tZ)(sF.Z,{showAdblockBanner:!0}),(0,v.tZ)(sK,{onRequestClick:m}),(0,v.tZ)(sX,{recommendations:r,onChange:g}),(0,v.tZ)(sz,{className:"ColumnHome-HomeBttom",onRequestClick:m}),(0,v.tZ)(aa.Z,{className:"ColumnHomeTop-PendingModal",onClose:function(){return l(!1)},children:s&&"你的专栏创建申请正在受理中。同时只能申请一个专栏。"}),(0,v.tZ)(aa.Z,{className:"ColumnHomeTop-MutedModal",onClose:function(){return p(!1)},children:d&&(0,v.tZ)(sB,{user:t,inPage:"column"})}),(0,v.tZ)(sb.Z,{onClose:function(){return _(!1)},shown:f})]})}sY.fetchData=function(e){return(0,e.dispatch)(oI("columns",sj))};var sQ=(0,e5.compose)(sG({scene:sM.ks.article}),sU.dT,(0,eM.connect)(function(e){var t=e.recommendation.homeRecommendations;return{currentUser:(0,eE.ib)(e),isMobile:(0,eC.Hu)(e),homeRecommendations:t}},{getHomeRecommendations:oI,fillCurrentUserIfNeeded:eE.sF,showNotification:tD.c0}),(0,iB.Z)({shouldLoad:function(e){return 0===e.homeRecommendations.length},load:function(e){return(0,e.getHomeRecommendations)("columns",sj)}}))(sY),sJ=n(30037),s$=n(19180),s0=n(2913),s1=n(88171),s2=n(32210),s3=n(99447),s4=n(20072),s5=n(58931),s6=n(36728),s7=n(99533),s8=n(62713),s9=n(62880),le=n(57138),lt=function(e){var t=e.pageInfo,n=e.pageOptions;return(0,eG.TN)(t,n),null},ln=(0,b.createContext)({}),lr=function(e){var t=e.children,n=e.isAnswerPage,r=e.callbackSource,o=(0,b.useRef)(null),i=(0,eG._e)(),a=(0,iy.Z)(function(e){var t,n,a,c=e.type,s=e.id,l=e.from,u=e.target,d=e.options;null===(t=o.current)||void 0===t||t.trackEvent({eventType:"Click",elementLocation:{type:"Button",moduleId:"reback_poplayer_btn"}},{configMap:{callback_from:l}}),(0,T.rH)((0,le.MN)(u||{type:c,id:s},(0,U._)((0,B._)({},d),{callback_source:r,page_id:(null===(n=i.current)||void 0===n?void 0:null===(a=n.value)||void 0===a?void 0:a.pageId)||"null"})))}),c=(0,b.useMemo)(function(){return{oiaWithTrack:a}},[a]);return(0,v.BX)(ln.Provider,{value:c,children:[n&&(0,v.tZ)(lt,{pageInfo:{pageId:"11189"}}),(0,v.tZ)(eG.pS,{ref:o}),t]})},lo=function(){return(0,b.useContext)(ln).oiaWithTrack},li=(0,b.forwardRef)(function(e,t){var n=lo();return(0,b.useImperativeHandle)(t,function(){return{oiaWithTrack:n}}),null}),la=function(e){var t=e.voteCount,n=e.onClick,r=(0,o2.F)(),o=r.colors,i=r.colorMod,a=function(e){null==n||n(e)};return(0,v.BX)("div",{css:{display:"flex",alignItems:"center",borderRadius:"20px",height:"36px",padding:"0 4px",backgroundColor:i(o.GBL01A).alpha(.08),color:o.MapBrand},children:[(0,v.BX)("div",{css:{padding:"0 12px",display:"flex",alignItems:"center"},onClick:a.bind(null,"voteUp"),children:[(0,v.tZ)(sZ.ZP,{size:14}),(0,v.tZ)("span",{css:{marginLeft:"6px",fontSize:"12px",lineHeight:0},children:t?(0,i1.Zh)(t):"赞同"})]}),(0,v.tZ)("div",{css:{height:"18px",width:"1px",backgroundColor:i(o.MapBrand).alpha(.1)}}),(0,v.tZ)("div",{css:{padding:"0 12px"},onClick:a.bind(null,"voteDown"),children:(0,v.tZ)(sA.Z,{size:14})})]})},lc=function(e){var t=e.count,n=e.renderIcon,r=e.onClick,o=(0,o2.F)().colors;return(0,v.BX)("div",{css:{width:"48px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",color:o.MapText04A},onClick:r,children:[n(),!!t&&(0,v.tZ)("div",{css:{position:"absolute",borderRadius:"13px",top:"4px",left:"27px",backgroundColor:o.MapUIFrame99B,fontSize:"9px",padding:"0 2px",whiteSpace:"nowrap"},children:(0,i1.Zh)(t)})]})},ls=function(e){var t=e.likeCount,n=e.onClick;return(0,v.tZ)(lc,{onClick:n,count:t,renderIcon:function(){return(0,v.tZ)(s6.Z,{})}})},ll=function(e){var t=e.collectCount,n=e.onClick;return(0,v.tZ)(lc,{onClick:n,count:t,renderIcon:function(){return(0,v.tZ)(s7.Z,{})}})},lu=function(e){var t=e.commentCount,n=e.onClick;return(0,v.tZ)(lc,{onClick:n,count:t,renderIcon:function(){return(0,v.tZ)(s8.ZP,{})}})},ld=function(e){var t=e.avatarUrl,n=e.onClick;return(0,v.BX)("div",{css:{position:"relative",display:"flex",justifyContent:"center"},onClick:n,children:[(0,v.tZ)(iZ.qE,{size:34,round:!0,url:t}),(0,v.tZ)("img",{alt:"",src:"https://pica.zhimg.com/v2-993390e1a2f4e53006a05b2502212ab3.png",css:{width:"22px",height:"14px",position:"absolute",bottom:"-7px"}})]})},lp=function(e){var t=e.type,n=e.id,r=e.voteCount,o=e.commentCount,i=e.collectCount,a=e.likeCount,c=e.author,s=(0,o2.F)().colors,l=lo(),u=(0,iy.Z)(function(e){l({type:t,id:n,from:e})}),d=(0,iy.Z)(function(e){l({type:"people",id:c.id,from:e})});return(0,v.BX)("div",{css:function(e){return{position:"fixed",bottom:0,width:"100%",backgroundColor:s.MapUIFrame99B,zIndex:100,borderTop:"1px solid ".concat(e.colors.MapUIFrame09A)}},className:"oia-action-bar",children:[(0,v.BX)("div",{css:{display:"flex",boxSizing:"border-box",padding:"6px 10px 6px 16px",alignItems:"center",justifyContent:"space-between",height:"60px"},children:[(0,v.tZ)(la,{voteCount:r,onClick:function(e){u("voteUp"===e?"agree":"disgree")}}),(0,v.BX)("div",{css:{display:"flex",flex:1,justifyContent:"flex-end",marginRight:"6px"},children:[(0,v.tZ)(ls,{likeCount:a,onClick:u.bind(null,"like")}),(0,v.tZ)(ll,{collectCount:i,onClick:u.bind(null,"authorsubscription")}),(0,v.tZ)(lu,{commentCount:o,onClick:u.bind(null,"comment")})]}),(0,v.tZ)(ld,{onClick:d.bind(null,"authoricon"),avatarUrl:c.avatarUrl})]}),(0,v.tZ)(s9.dh,{})]})},lh=n(89174),lf=function(e){var t=e.type,n=e.id,r=lo();return(0,v.BX)(eG.Wi,{zaType:"Block",zaModuleId:"top_bar",children:[(0,v.BX)("div",{css:function(e){return{height:"60px",width:"100%",padding:"0 14px",position:"fixed",boxShadow:"0px -0.5px 0px #E8E9ED inset",display:"flex",top:0,boxSizing:" border-box",alignItems:"center",backgroundColor:e.colors.MapUIFrame99B,zIndex:100}},onClick:function(){null==r||r({type:t,id:n,from:"toplayer"})},children:[(0,v.tZ)("img",{alt:"",css:{width:36,height:36,marginRight:"8px"},src:"https://pic1.zhimg.com/v2-45bd10426541b3d82bace746e8b5a53a.png"}),(0,v.BX)("div",{style:{flexDirection:"column",justifyContent:"center",alignItems:"flex-start",flex:1},children:[(0,v.tZ)("div",{css:function(e){return{color:e.colors.GBK03A,fontSize:"15px",fontWeight:"500",lineHeight:"18px"}},children:"知乎"}),(0,v.tZ)("div",{css:function(e){return{color:e.colors.GBK06A,fontSize:"12px",lineHeight:"18px"}},children:"有问题就会有答案"})]}),(0,v.tZ)(lh.ZP,{label:"打开App",preset:"primary",color:"blue",css:{borderRadius:"24px"}})]}),(0,v.tZ)("div",{css:{height:"60px"}})]})},l_=n(31011),lm=n(5198),lv=function(e){var t=e.onSuccessClick,n=(0,j._)((0,cC.Z)(!0),2),r=n[0],o=n[1],i=(0,lm.Z)(600),a=function(){o.off()};return(0,v.tZ)(l_.Z,{size:"small",className:"OiaModal",onClose:a,css:{borderRadius:18,width:"288px","& .MobileModal-content":{padding:24}},closeButton:null,children:r&&i&&(0,v.BX)(v.HY,{children:[(0,v.tZ)(oX.Flex,{fontSize:"18px",fontWeight:"bold",mb:"18px",justifyContent:"center",children:"是否在知乎 App 内阅读全文"}),(0,v.BX)(oX.Flex,{justifyContent:"space-between",children:[(0,v.tZ)(lh.ZP,{color:"grey",preset:"secondary",css:{width:112,height:40,fontSize:15,borderRadius:24},onClick:a,children:"取消"}),(0,v.tZ)(lh.ZP,{color:"blue",preset:"primary",css:{width:112,height:40,fontSize:15,borderRadius:24},onClick:function(){null==t||t(),a()},children:"确认"})]})]})})},lg=(0,tv.P1)(eC.Hu,eC.Kv,function(e,t){var n=decodeURIComponent(t.split("?title=")[1]||"");return{isSearchSpecialSource:e&&t.includes("zhihu.com/search-special")&&!!n,searchSpecialTitle:n}}),lT=n(11264),lE=function(){var e=location.href,t=(0,T.tL)(e),n=t.utm_source,r=t.utm_medium;location.href="https://www.zhihu.com/oauth/redirect/login/wechat_mp?next=/oauth/account_callback&from=".concat(encodeURIComponent(e),"&utm_source=").concat(n,"&ref_source=").concat(r)},lC=function(){var e=(0,oJ.n)(),t=(0,eC.dD)(),n=(0,ex.n)();return(0,cy.Z)(function(){!e&&t&&(null==n?void 0:n.Wechat)&&.2>Math.random()&&(S.ZP.increment("mobile.autowechatlogin.count"),lE())}),null},ly=n(8858),lS=n(84344),lI=n(61255),lb=n(69661),lA=n(48933),lZ=n(38267),lw=n.p+"assets/placeholder.0682898a.svg",lR=function(){return(0,v.tZ)(lZ.Z,{title:"该内容仅作者可见",subtitle:"",errorImage:lw})},lN=n(63573),lk=(0,v.tZ)(ek.ql,{meta:[{name:"robots",content:"noindex"}]}),lO=(0,e5.compose)((0,af.Z)(null))(function(e){var t=e.entity,n=void 0===t?{}:t,r=n.type,o=n.id,i=n.isCollapsed,a=n.suggestEdit,c=void 0===a?{}:a,s=n.adminClosedComment,l="";"question"===r?l=o:"answer"===r&&(l=n.question.id);var u=(0,eM.useSelector)(function(e){return(0,nV.Md)(e,{id:l})});if(u){var d=u.status,p=u.adminClosedComment,h=u.isMuted,f=u.visibleOnlyToAuthor;if((null==d?void 0:d.isClose)||(null==d?void 0:d.isSuggest)||(null==d?void 0:d.isEvaluate)||p||h||f)return lk}return"question"===r&&u.redirection?(0,v.tZ)("link",{rel:"canonical",href:"https://www.zhihu.com/question/".concat(u.redirection.to.id)}):"answer"===r&&((null==c?void 0:c.status)||i||s)||"article"===r&&((null==c?void 0:c.status)||s)?lk:""}),lx=n(41835),lP=n(25744),lD=n(3707),lL=n(94382),lB=n(85661),lU=(0,b.memo)(function(e){var t=e.members,n=e.maxLength,r=e.size,o=void 0===r?20:r,i=t.slice(0,n);return(0,v.tZ)(oX.Flex,{alignItems:"center",css:function(e){return{".UserLink":{borderRadius:"50%",border:"2px solid ".concat(e.colors.GBK99B),"&:nth-of-type(1)":{zIndex:1},"&:nth-of-type(n+2)":{marginLeft:-10}}}},children:i.map(function(e){return(0,v.tZ)(lB.Z,{user:e,avatar:!0,avatarProps:{size:o,round:!0}},e.id)})})});function lM(e){var t=e.members,n=e.hasMultiProposer;return(0,v.BX)(oX.Flex,{alignItems:"center",children:[n?(0,v.tZ)(lU,{members:t,maxLength:2}):(0,v.tZ)(lB.Z,{user:t[0],avatar:!0,avatarProps:{size:20,round:!0}}),(0,v.BX)(oX.Flex,{ml:"8px",fontSize:15,lineHeight:"20px",color:"GBK05A",children:[(0,v.tZ)(lB.Z,{user:t[0],css:{".UserLink-link":(0,B._)({maxWidth:90},(0,sk.S)(1))}}),n&&"等 ".concat(t.length," 人")]})]})}var lG=function(e){var t=e.children,n=e.extraStyle,r=(0,K._)(e,["children","extraStyle"]);return(0,v.tZ)(oQ.ZP,(0,U._)((0,B._)({},r),{css:{"&.Button":(0,B._)({fontSize:15,padding:0},n)},children:t}))},lF={invite:{requestText:"转载",cardShowId:8931,clickId:8932},self_recommend:{requestText:"推荐",cardShowId:8957,clickId:8958}},lz=(0,oR.withRouter)(function(e){var t=(0,j._)((0,b.useState)(!0),2),n=t[0],r=t[1],o=(0,eM.useDispatch)(),i=e.entityType,a=e.id,c=e.isAuthor,s=e.onShowAllRequests,l="1"===e.location.query.has_contribution_apply;(0,b.useEffect)(function(){(c||l)&&o((0,nK.$T)(a))},[o,l,a,c]);var u=c?"invite":"self_recommend",d=(0,eM.useSelector)(function(e){return(0,nK.bG)(e,{isAuthor:c,requestType:u,entityType:"article"})}),p=lF[u],h=p.cardShowId,f=p.clickId,_=p.requestText,m=d.map(function(e){return e.proposer}),g=m.length>1,T=c?"申请转载此文章到".concat(g?"他们的":"","专栏"):"申请推荐此文章到你的专栏",E=function(e,t){var n="approve"===t?"通过":"拒绝";oW.Z.trackEvent(e.target,{id:f,action:"Click",element:"Button"},{button:{text:n}}),o((0,nK.gT)({requestId:d[0].id,action:t,articleId:a})).then(function(){o((0,tD.c0)("已".concat(n).concat(_,"申请"))),r(!1)})};return n&&(null==d?void 0:d[0])?(0,v.tZ)(s3.r,{trackCardShow:!0,module:"Content",moduleName:c?g?"多人申请":"单人申请":"推荐申请处理",view:{id:h,element:"Dialog"},extra:{button:{text:"".concat(_,"申请处理")}},children:(0,v.BX)(oX.Flex,{justifyContent:"space-between",width:600,height:48,p:"12px",bg:"GBK99A",css:{position:"fixed",top:68,left:"50%",transform:"translateX(-50%)",borderRadius:8,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.1)"},children:[(0,v.BX)(oX.Flex,{flex:1,children:[(0,v.tZ)(lM,{members:m,hasMultiProposer:g}),(0,v.BX)(oX.Flex,{my:"8px",fontSize:15,lineHeight:1.4,alignItems:"center",color:"GBK02A",children:[(0,v.tZ)(oX.Text,{ml:"8px",flexShrink:0,children:T}),!g&&(0,v.tZ)(oX.Link,{flex:1,ml:"4px",fontWeight:"bold",color:"GBL05A",href:"https://www.zhihu.com/column/".concat(d[0].destination.id),css:[(0,sk.S)(1)],children:(0,v.tZ)(lL.Z,{column:d[0].destination})})]})]}),(0,v.BX)(oX.Flex,{ml:"10px",flexShrink:0,alignItems:"center",children:[(0,v.tZ)(oX.Flex,{fontSize:15,fontWeight:"bold",lineHeight:1.4,alignItems:"center",children:g?(0,v.tZ)(oX.Link,{"data-za-not-track-link":!0,onClick:function(e){oW.Z.trackEvent(e.target,{id:f,action:"Click",element:"Button"},{button:{text:"ViewAll"}}),s({id:a,entityType:i}),r(!1)},children:(0,v.tZ)(lG,{preset:"plain",color:"blue",children:"查看详情"})}):(0,v.BX)(v.HY,{children:[(0,v.tZ)(lG,{preset:"plain",color:"blue",onClick:function(e){return E(e,"approve")},children:"通过"}),(0,v.tZ)(lG,{preset:"plain",color:"grey",extraStyle:{marginLeft:22},onClick:function(e){return E(e,"reject")},children:"拒绝"})]})}),(0,v.tZ)(oX.Text,{ml:"24px",as:aR.HN,color:"GBK07A",size:16,onClick:function(){r(!1)}})]})]})}):null}),lH=n(99178),lq={article:{text:"转载",subtitle:"他人申请将你的文章转载至他的专栏",description:"申请转载文章到专栏",zaInfo:{pageShowId:8935,profileEntryCardShowId:8933,profileEntryClickId:8934,listModalCardShowId:8937,listModalClickId:8938}},column:{text:"推荐",subtitle:"他人推荐他们的文章到你的专栏",description:"申请推荐文章到你的专栏",zaInfo:{pageShowId:8961,profileEntryCardShowId:8959,profileEntryClickId:8960,listModalCardShowId:8962,listModalClickId:8963}}},lV={answer:"Answer",article:"Post"},lX=n(58245);function lW(e){var t=e.request,n=e.description,r=e.cardShowId,o=e.clickId,i=(0,eM.useDispatch)(),a=(0,j._)((0,b.useState)(""),2),c=a[0],s=a[1],l=t.id,u=t.destination,d=t.destination.id,p=t.object,h=p.id,f=p.type,_=p.title,m=p.imageUrl,g=p.voteupCount,T=void 0===g?0:g,E=p.commentCount,C=void 0===E?0:E,y=t.proposer,S=t.created,I=t.updated,A=t.state,Z=function(e,t){var n="approve"===t?"通过":"拒绝";oW.Z.trackEvent(e.target,{id:o,action:"Click",element:"Button"},{button:{text:n}}),i((0,nK.gT)({requestId:l,action:t,articleId:h})).then(function(){s("已".concat(n))})};return c||"pending"===A?(0,v.tZ)(s3.r,{trackCardShow:!0,view:{id:r,element:"Card"},module:"Content",content:{type:lV[f],token:String(h),parent_token:String(d)},children:(0,v.BX)(oX.Box,{p:"16px",mb:"16px",bg:"GBK99A",css:function(e){return(0,B._)({},(0,lX.M)({border:"1px solid ".concat(e.colors.GBK08A),borderRadius:8}))},children:[(0,v.BX)(oX.Flex,{alignItems:"center",children:[(0,v.BX)(oX.Flex,{alignItems:"center",children:[(0,v.tZ)(lB.Z,{user:y,avatar:!0,avatarProps:{size:20,round:!0},css:{lineHeight:1}}),(0,v.tZ)(oX.Text,{ml:"8px",flex:1,fontSize:15,color:"GBK06A",children:(0,v.tZ)(lB.Z,{user:y,css:{".UserLink-link":(0,B._)({maxWidth:90},(0,sk.S)(1))}})})]}),(0,v.BX)(oX.Flex,{ml:"8px",my:"8px",fontSize:15,lineHeight:1.4,alignItems:"center",color:"GBK02A",children:[(0,v.tZ)(oX.Text,{flexShrink:0,children:n}),(0,v.tZ)(oX.Text,{flex:1,ml:"4px",fontWeight:"bold",color:"GBL05A",css:[(0,sk.S)(1)],children:(0,v.tZ)(lL.Z,{column:u})})]})]}),(0,v.BX)(oX.Flex,{p:"10px 12px",height:60,bg:"GBK10A",css:{borderRadius:4},children:[(0,v.BX)(oX.Link,{href:"https://zhuanlan.zhihu.com/p/".concat(h),flex:1,css:[(0,sk.S)(1)],children:[(0,v.tZ)(oX.Text,{fontSize:14,lineHeight:"20px",color:"GBK03A",children:_}),(0,v.tZ)(oX.Text,{mt:"4px",fontSize:12,lineHeight:"14px",color:"GBK07A",children:"".concat((0,i1.Zh)(T),"赞同 \xb7 ").concat((0,i1.Zh)(C),"评论")})]}),m&&(0,v.tZ)(oX.Box,{width:40,height:40,flexShrink:0,css:{overflow:"hidden",borderRadius:2},children:(0,v.tZ)(oX.Image,{width:"100%",height:"100%",src:m,alt:"",css:{filter:"brightness(0.95)",objectFit:"cover"}})})]}),(0,v.BX)(oX.Flex,{mt:"16px",pr:"4px",lineHeight:"21px",justifyContent:"space-between",alignItems:"center",children:[(0,v.tZ)(oX.Text,{fontSize:12,color:"GBK07A",children:(0,n3.rL)(I||S)}),c?(0,v.tZ)(oX.Text,{fontSize:15,fontWeight:"bold",color:"GBK08A",children:c}):(0,v.BX)(oX.Flex,{fontSize:15,fontWeight:"bold",justifyContent:"space-between",children:[(0,v.tZ)(oQ.ZP,{preset:"plain",color:"grey",css:{padding:0},onClick:function(e){return Z(e,"reject")},children:"拒绝"}),(0,v.tZ)(oQ.ZP,{preset:"plain",color:"blue",css:{marginLeft:24},onClick:function(e){return Z(e,"approve")},children:"通过"})]})]})]})}):null}function lK(e){var t,n=e.isAuthor,r=e.isProfile,o=e.republishRequests,i=e.onClose,a=o||{},c=a.id,s=a.entityType,l=a.requestType,u=(0,eM.useDispatch)(),d=function(){r?u((0,nK.Jg)(c,s)):u((0,nK.$T)(c))};(0,b.useEffect)(d,[c,s,r,u]);var p=(0,eM.useSelector)(function(e){return(0,nK.bG)(e,{isAuthor:n,isProfile:r,entityType:s,requestType:l})}),h=(0,eM.useSelector)(function(e){return e.republish[s]}),f=h.isLoading,_=h.paging,m=lq[s],g=m.text,T=m.subtitle,E=m.description,C=m.zaInfo,y=C.pageShowId,S=C.listModalCardShowId,I=C.listModalClickId,A=null!==(t=null==_?void 0:_.isEnd)&&void 0!==t?t:!r;return((0,b.useEffect)(function(){oW.Z.trackPageShow({id:y})},[]),o)?(0,v.tZ)(oX.Box,{children:(0,v.tZ)(aa.Z,{size:"large",onClose:function(){d(),i()},title:"文章".concat(g,"申请"),subtitle:T,children:(0,v.tZ)(oX.Box,{my:"24px",maxHeight:460,css:{overflowY:"scroll","&::-webkit-scrollbar":{display:"none"}},children:(0,v.tZ)(lH.ZP,{onLoad:d,isLoading:null!=f&&f,isDrained:A,getContainer:function(e){return e.parentElement},children:p.map(function(e){return(0,v.tZ)(lW,{request:e,description:E,cardShowId:S,clickId:I},e.id)})})})})}):null}function lj(e){var t=e.id,n=e.selfRecommendedRepublishRequests,r=(0,eM.useDispatch)(),o=(0,j._)((0,b.useState)(!1),2),i=o[0],a=o[1],c=(0,b.useMemo)(function(){return n.map(function(e){var t=e.approver,n=e.destination;return"「".concat(t.name,"」的专栏「").concat(n.title,"」")}).join("、")},[n]);return(0,v.BX)(s3.r,{view:{id:8964,element:"Text"},trackCardShow:!0,extra:{button:{text:"撤销推荐"}},children:[(0,v.BX)(oX.Text,{as:"span",children:["\xa0\xb7\xa0",(0,v.tZ)(oX.Text,{as:"span",color:"GBL01A",css:{cursor:"pointer"},onClick:function(e){e.stopPropagation(),a(!0),oW.Z.trackEvent(e.target,{id:8965,action:"Click",element:"Text"},{button:{text:"撤销推荐"}})},children:"撤销推荐"})]}),(0,v.tZ)(aa.Z,{className:"VerificationForm-allowUseCreatorModal",title:"要撤销推荐吗？",closeButton:null,maskClosable:!1,children:i&&(0,v.BX)(v.HY,{children:[(0,v.tZ)("span",{children:"当前文章被推荐到".concat(c,"，要撤销吗？")}),(0,v.BX)(aa.w,{direction:"horizontal",children:[(0,v.tZ)(oQ.ZP,{onClick:function(){return a(!1)},children:"暂不撤销"}),(0,v.tZ)(oQ.ZP,{preset:"primary",color:"blue",onClick:function(){oW.Z.trackEvent(null,{id:8966,action:"Cancel",element:"Button"},{button:{text:"撤销推荐"}}),Promise.all(n.map(function(e){return r((0,nK.gT)({requestId:e.id,action:"cancel",articleId:t}))})).then(function(){r((0,tD.c0)("撤销成功"))}),a(!1)},children:"撤销推荐"})]})]})})]})}var lY=n(47163),lQ=n(79065),lJ=n(82806),l$=n.n(lJ);function l0(){var e=(0,lQ._)(["编辑于",""]);return l0=function(){return e},e}function l1(){var e=(0,lQ._)(["发布于",""]);return l1=function(){return e},e}function l2(){var e=(0,lQ._)(["・",""]);return l2=function(){return e},e}function l3(){var e=(0,lQ._)(["・",""]);return l3=function(){return e},e}var l4=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{showUpdated:!0}),(0,X._)((0,oL._)(e),"handleClick",function(){e.setState(function(e){return{showUpdated:!e.showUpdated}})}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.created,n=e.updated,r=e.ipInfo,o=e.extraInlineComponent,i=e.contentSource,a=this.state.showUpdated;return(0,v.BX)("div",{role:"button",tabIndex:0,className:"ContentItem-time",onClick:this.handleClick,children:[a&&n!==t?l$()(l0(),(0,n3.KZ)(n)):l$()(l1(),(0,n3.KZ)(t)),!!r&&l$()(l2(),r),!!i&&l$()(l3(),i),o]})}}]),n}(b.Component);(0,X._)(l4,"propTypes",{created:oF().number,updated:oF().number,extraInlineComponent:oF().node,ipInfo:oF().string,contentSource:oF().string});var l5=n(36225),l6=n(19821),l7="SearchSpecialButton",l8=function(e){var t=e.title,n=e.className;(0,b.useEffect)(function(){oW.Z.trackCardShow(null,{id:8107},{button:{text:t}})},[t]);var r=(0,b.useCallback)(function(){oW.Z.trackEvent(null,{id:8108,action:"OpenUrl"},{button:{text:t}});var e=(0,er.stringify)({type:"content",q:t});location.href="//www.zhihu.com/search?".concat(e)},[t]);return(0,v.tZ)(l6.ZP,{className:oV()(l7,n),children:(0,v.BX)(oQ.ZP,{className:"".concat(l7,"-inner"),preset:"primary",color:"blue",onClick:r,children:["查看更多「",t,"」相关内容"]})})},l9=n(82311),ue=n(68014),ut=n(57177),un=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.noHoverCard,r=e.onClick;return(0,v.tZ)(ue.Z,{className:"Topic",children:(0,v.tZ)(ut.Z,{noHoverCard:n||x.Z.isMobileEntry,topic:t,onClick:r})})}}]),n}(b.Component),ur=(0,s3.a)(function(e){return{module:"TopicItem",content:{type:"Topic",token:e.item.id},trackCardShow:!0}})(un),uo=function(e){var t=e.topics,n=e.className,r=e.noHoverCard,o=e.onItemClick;return(0,v.tZ)("div",{className:oV()("TopicList",n),children:t.map(function(e){return(0,v.tZ)(ur,{item:e,noHoverCard:r,onClick:o},e.id)})})},ui=n(97285),ua=n(81897),uc=n.n(ua),us=function(){!(!navigator.cookieEnabled||uc().get("social_id"))&&(uc().get("WECHAT_AUTHORIZATION_POPUP")||(uc().set("WECHAT_AUTHORIZATION_POPUP","1",{expires:1,domain:"zhihu.com"}),window.location.replace("https://www.zhihu.com/oauth/redirect/social_info/wechat_mp?from=".concat(encodeURIComponent(location.href)))))};function ul(e){var t=e.zaShareId;return(0,cy.Z)(function(){window.wx&&window.wx.ready(function(){us(),function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4408,r=(e=uc().get("social_id"),{firstShareUid:(t=new URLSearchParams(location.search)).get("utm_oi"),shareSocialId:t.get("s_s_i"),shareRecord:t.get("s_r"),curUserSocialId:e}),o=r.firstShareUid,i=r.shareSocialId,a=r.shareRecord,c=r.curUserSocialId;c&&0!==Number(a)&&(i||o)&&oW.Z.trackEvent(null,{id:n,action:"Share"},{share:{share_uid:o,share_unionid:i,open_unionid:c}})}(t)})}),null}var uu=n(65033),ud=n(91269),up=n(1785),uh=n(59937),uf=function(e){var t=e.router,n=e.location,r=n.query,o=r.HL,i=(0,K._)(r,["HL"]);if(o)try{var a,c=document.querySelector("#".concat(o));if(!c)return;setTimeout(function(){t.replace((0,U._)((0,B._)({},n),{query:i,hash:"#".concat(o)}))},0);var s=null===(a=c.getBoundingClientRect())||void 0===a?void 0:a.top;if(!s)return;var l=window.pageYOffset||0,u=Math.max(window.innerHeight/10,100);window.scrollTo({top:l+s-u})}catch(e){var d,p,h,f="locatePageByID";null===(d=window.webReporter)||void 0===d||d.report(f,{type:f,appName:"heifetz",error:{name:null!==(p=null==e?void 0:e.name)&&void 0!==p?p:"Unknown",message:null!==(h=null==e?void 0:e.message)&&void 0!==h?h:"Unknown"}})}},u_=function(e){var t=e.ua,n=e.env,r=e.location,o=n.ctx;if(!t.ZhihuHybrid&&(t.UC||t.Quark||t.MQQBrowser)){var i=Error();throw i.redirect="https://oia.zhihu.com".concat((0,le.Qu)(r.pathname),"?app_from=uckoc_interc&is_from_paid=1&redirect_from=").concat(encodeURIComponent(o.href)),i}},um=n(77878),uv=n(78970),ug=n(16850),uT=n.p+"assets/wechat-share-image.0393e0b7.png",uE=n(77683),uC=n(46829),uy=n(258),uS=n(96717),uI=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"zaRef",(0,b.createRef)()),(0,X._)((0,oL._)(e),"openInApp",function(){(0,uy.Z)({trackEvent:e.zaRef.current.trackEvent,zaV3Text:"关注用户",from:"authorpage"})}),(0,X._)((0,oL._)(e),"openLogin",function(){location.assign("https://www.zhihu.com/signin?next=".concat(encodeURIComponent(location.href)))}),(0,X._)((0,oL._)(e),"handleFollowButtonClick",function(t){var n=e.props,r=n.followOpenInApp,o=n.author,i=n.isMobile,a=n.currentUser,c=n.onToggleFollow,s=o.isFollowing?"UnFollow":"Follow";return((0,uS.E)(t,{id:1285,action:s}),null==c||c(!o.isFollowing),r&&i)?e.openInApp():!!a||e.openLogin()}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.author,n=e.isAuthor,r=e.isMobile,o=e.currentUser;return(0,v.BX)(eG.eV,{content:{type:"User",token:t.urlToken},children:[(0,v.tZ)(eG.pS,{ref:this.zaRef}),(0,v.BX)("div",{className:oV()("Post-Author",{"Post-Author-Mobile":r}),children:[(0,v.tZ)(uE.Z,{author:t,roundAvatar:!0,avatarSize:r?34:38,userLinkV2:!0}),!n&&(!!o||r)&&(0,v.tZ)(uC.Z,{preset:"primary",type:t.type,id:t.urlToken,gender:!r&&t.gender,isFollowing:t.isFollowing,onClick:this.handleFollowButtonClick})]})]})}}]),n}(b.Component);(0,X._)(uI,"propTypes",{author:oF().object.isRequired,postId:oF().number.isRequired,isAuthor:oF().bool,followOpenInApp:oF().bool});var ub=(0,e5.compose)((0,ug.$)(),ah.Z)(uI),uA=n(39503),uZ=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{showAllReviewers:!1,modalShown:!1,reviewersChangeLine:!1}),(0,X._)((0,oL._)(e),"handleListHide",function(){return e.setState({modalShown:!1})}),(0,X._)((0,oL._)(e),"handleListShown",function(){return e.setState({modalShown:!0})}),(0,X._)((0,oL._)(e),"handleShowAllReviewers",function(){var t=e.props.isAuthor;e.state.showAllReviewers||e.setState({showAllReviewers:!0}),t&&e.setState({showReviewComment:!0}),e.handleListShown()}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=document.querySelector(".TopicList").offsetHeight;this.handleReviewersChangeLine(e>=45)}},{key:"handleReviewersChangeLine",value:function(e){this.setState({reviewersChangeLine:e})}},{key:"render",value:function(){var e=this.props,t=e.reviewers,n=e.type,r=e.isAuthor,o=this.state,i=o.showAllReviewers,a=o.reviewersChangeLine,c=o.modalShown,s=t.slice(0,i?t.length:4).map(function(e,n){var r;return n!==t.length-1&&0>e.name.indexOf("、")&&(r=(0,v.tZ)("span",{children:"、"})),(0,v.BX)("div",{className:"PostIndex-reviewers-userlink-wrapper",children:[(0,v.tZ)(lB.Z,{className:"PostIndex-reviewerLink",blank:!0,user:e},e.id),r]},n)});return(0,v.BX)("div",{className:oV()("PostIndex-reviewers",{"PostIndex-reviewers-left":a}),children:[s,!!t.length&&(0,v.tZ)(oQ.ZP,{preset:"plain",className:oV()("PostIndex-showReviewerButton",(t.length>4||r)&&"is-clickable"),onClick:this.handleShowAllReviewers,children:t.length>4&&!i?"等".concat(t.length,"人亦有帮助"):"亦有帮助"}),(0,v.tZ)(e4.Z,{size:"fullPage",onClose:this.handleListHide,children:c&&(0,v.tZ)(uA.Z,{voteupCount:t.length,items:t,isDrained:!1,isFetching:!1,type:n,onLoad:function(){},text:"亦有帮助"})})]})}}]),n}(b.Component);(0,X._)(uZ,"propTypes",{reviewers:oF().array.isRequired,type:oF().string,isAuthor:oF().bool.isRequired});var uw=n(66011),uR=n(24340),uN=n(89774),uk=function(e){return(0,v.tZ)(oX.Box,(0,B._)({mx:"auto"},e))};function uO(e){var t=e.fullScreen,n=e.src,r=e.width,o=e.height,i=e.alt,a=e.useImageX,c=(0,ug.Z)(),s=(0,uN.Z)(),l="1"===(0,eD.c)("article_title_imagex",{mock:"1"}),u=!c&&a&&(l||s);return t?u?(0,v.tZ)(uk,{children:(0,v.tZ)(uR.Z,{ratio:3,children:(0,v.tZ)(uw.MQ,{src:n,alt:i,width:"100%",height:"100%",css:{objectFit:"cover"},layout:"fill"})})}):(0,v.tZ)(uk,{children:(0,v.tZ)(uR.Z,{ratio:3,children:(0,v.tZ)("img",{src:n,alt:i,width:"100%",height:"100%",css:{objectFit:"cover"}})})}):(0,v.tZ)(uk,{maxWidth:690,mt:[0,"1em"],children:r>0&&o>0?(0,v.tZ)(uR.Z,{ratio:r/o,children:u?(0,v.tZ)(uw.MQ,{src:n,alt:i,width:"100%",layout:"responsive"}):(0,v.tZ)(uw.G6,{src:n,alt:i,width:"100%",height:"100%"})}):u?(0,v.tZ)(uw.MQ,{src:n,layout:"raw",width:"100%",alt:i}):(0,v.tZ)(uw.G6,{src:n,alt:i,width:"100%"})})}var ux=n(102);function uP(e){var t=e.id,n=e.shown,r=e.onClose,o=(0,j._)((0,b.useState)(!1),2),i=o[0],a=o[1],c=(0,j._)((0,b.useState)(!1),2),s=c[0],l=c[1],u=(0,j._)((0,b.useState)(""),2),d=u[0],p=u[1],h=(0,eM.useDispatch)(),f=(0,b.useRef)([]).current,_=(0,eM.useSelector)(function(e){return e.me.columnContributions.filter(function(t){var n;return"normal"===t.columnType&&(null===(n=t.author)||void 0===n?void 0:n.urlToken)===e.currentUser})})||f,m=function(){h((0,eE.Pq)()).finally(function(){0===_.length&&r()})},g=function(){p(""),r()};return((0,b.useEffect)(function(){l(0===_.length)},[_]),n)?(0,v.BX)("div",{children:[(0,v.tZ)(aa.Z,{size:"large",onClose:g,title:"申请转载到我的专栏",subtitle:"选择一个专栏，向作者发送文章转载申请",children:_.length>0&&(0,v.tZ)(s3.r,{view:{id:8929,element:"Dialog"},extra:{button:{text:"申请转载到我的专栏"}},module:"Content",card:{content:{type:"Column",token:String(d)}},trackCardShow:!0,children:(0,v.BX)("div",{children:[(0,v.tZ)(oX.Box,{maxHeight:460,css:{overflowY:"scroll","&::-webkit-scrollbar":{display:"none"}},children:_.map(function(e,t){return(0,v.BX)(oX.Flex,{px:"8px",py:"16px",alignItems:"center",justifyContent:"space-between",as:"label",htmlFor:"RepublishApply-columnItem-".concat(t),css:function(e){return{borderBottom:"1px solid ".concat(e.colors.GBK10A)}},children:[(0,v.BX)(oX.Box,{flex:1,children:[(0,v.tZ)(oX.Text,{fontSize:18,fontWeight:"bold",color:"GBK02A",lineHeight:"22px",css:[(0,sk.S)(1)],children:e.title}),(0,v.BX)(oX.Text,{mt:"12px",fontSize:14,lineHeight:1,color:"GBL05A",children:[e.articlesCount||0," 篇内容 \xb7"," ",e.voteupCount||0," 赞同"]})]}),(0,v.tZ)(oX.Box,{flexShrink:0,as:"input",type:"radio",name:"RepublishApply-columnInput",id:"RepublishApply-columnItem-".concat(t),checked:e.id===d,onChange:function(){return p(e.id)}})]},e.id)})}),(0,v.tZ)(e4.w,{children:(0,v.tZ)(oQ.ZP,{disabled:!d,preset:"primary",color:"blue",onClick:function(e){oW.Z.trackEvent(e.target,{id:8930,action:"Click",element:"Button"},{button:{text:"申请转载"}}),h((0,nK.gT)({action:"create",articleId:t,columnId:d})).then(function(){h((0,tD.c0)("已发送转载申请！"))}).finally(g)},children:"申请转载"})})]})})}),(0,v.tZ)(aa.Z,{onClose:r,title:"要创建专栏吗？",children:s&&(0,v.BX)("div",{children:["你还没有可以用来转载文章的专栏，要创建专栏吗？",(0,v.BX)(e4.w,{direction:"horizontal",children:[(0,v.tZ)(oQ.ZP,{onClick:r,children:"取消"}),(0,v.tZ)(oQ.ZP,{preset:"primary",color:"blue",onClick:function(){l(!1),a(!0)},children:"创建专栏"})]})]})}),(0,v.tZ)(sb.Z,{onClose:function(){a(!1),m()},shown:i,disableRedirect:!0})]}):null}var uD=n(26974),uL=n(54843),uB=n(88329),uU=n.n(uB),uM=n(98731),uG=n(99158),uF=n(19495),uz=n(30361),uH=n(63362),uq=n(24794),uV=n(65939);function uX(e){if(!e||!Array.isArray(e.contributions))return null;var t=e.contributions.find(function(e){return"accepted"===e.state});return t?t.column:null}var uW=n(71783),uK=function(e){var t=e.isLiked,n=e.onClick,r=(0,K._)(e,["isLiked","onClick"]);return(0,v.tZ)(eG.$U,(0,B._)({as:oQ.ZP,zaType:"Button",zaText:!0,zaAction:t?"UnLike":"Like",preset:"plain",onClick:n,icon:uW.sh,label:t?"取消喜欢":"喜欢","aria-live":"polite"},r))};function uj(e){var t=e.onClick,n=(0,K._)(e,["onClick"]);return(0,v.tZ)(oQ.ZP,(0,B._)({preset:"plain",onClick:t,icon:uL.h,label:"申请转载"},n))}var uY=n(6779),uQ=n(58216),uJ=n(69725),u$=n(65423),u0=n(1733),u1=n(85703),u2=n(12667),u3=n(5469),u4=n(82335),u5=n(26820),u6=n(44765),u7=n(71981),u8={need_review:"转载申请需要审核",public:"允许所有人转载到专栏",reserved:"不允许他人转载到专栏"};function u9(e){var t=e.current,n=e.id,r=e.onChange,o=function(e){e!==t&&(oW.Z.trackEvent(null,{id:8939,action:"Click",element:"Button"},{button:{text:u8[e]}}),r(n,e))};return(0,v.tZ)(v.HY,{children:Object.keys(u8).map(function(e){return(0,v.tZ)(u7.Z,{onClick:function(){return o(e)},checked:e===t,children:u8[e]},e)})})}var de=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{deleteModalShown:!1,reportModalShown:!1,addAnnotationModalShown:!1,cancelAnnotationModalShown:!1,showAttention:!1}),(0,X._)((0,oL._)(e),"onCloseReward",function(){var t=e.props,n=t.article,r=t.rewardInfo;(0,t.updateArticleReward)(n.id,r.tagline,!1)}),(0,X._)((0,oL._)(e),"isColumnPage",function(){var t=e.props.routes;return"Column"===t[t.length-1].name}),(0,X._)((0,oL._)(e),"handleDelete",function(){var t=e.props,n=t.showNotification,r=t.article,o=t.deletePost,i=t.router,a=e.isColumnPage(),c=uX(r);o(r.id).then(function(){n("文章已删除"),a?window.location.reload():c&&c.id?i.replace("/".concat(c.id)):location.href="".concat(P.i7,"/people/").concat(r.author.urlToken,"/posts")})}),(0,X._)((0,oL._)(e),"handleModalClose",function(){e.setState({deleteModalShown:!1,reportModalShown:!1,addAnnotationModalShown:!1,cancelAnnotationModalShown:!1})}),(0,X._)((0,oL._)(e),"handleReportButtonClick",e.props.authRequired(function(t){(0,uS.E)(t,1294),e.setState({reportModalShown:!0})},P.q0.report)),(0,X._)((0,oL._)(e),"handleResetAnnotation",function(){(0,uS.E)(event,1293),e.setState({cancelAnnotationModalShown:!0})}),(0,X._)((0,oL._)(e),"handleAddAnnotation",function(t){(0,uS.E)(t,1293),e.setState({addAnnotationModalShown:!0})}),(0,X._)((0,oL._)(e),"handleMenuClick",function(t,n){var r=n.isAuthor,o=n.isMobile,i=r&&!o;if((0,uS.E)(t,i?1283:1292),r){var a=e.props,c=a.getCommercialInfo,s=a.article.id;e.commercialInfoPromise_=c(s).then(function(e){return!!(e.payload&&e.payload.isAudit)},function(){return!1})}}),(0,X._)((0,oL._)(e),"showEditAlert",function(){return iV.Z.confirm("文章在投放中，如修改会导致广告暂停，再次审核通过后，广告才会开启。确认修改？",{title:"确认修改"})}),(0,X._)((0,oL._)(e),"hendleEditButtonClick",function(){var t=(0,uD.b6)(e.props.article.id);(e.commercialInfoPromise_?e.commercialInfoPromise_:Promise.resolve(!1)).then(function(t){return t?e.showEditAlert():Promise.resolve()}).then(function(){return location.href=t},function(){})}),(0,X._)((0,oL._)(e),"renderReportItem",function(){return(0,v.BX)(v.HY,{children:[(0,v.tZ)(eG.$U,{zaAction:"Report",zaType:"Button",zaModuleId:"click_report",as:u0.sN,onClick:e.handleReportButtonClick,children:"举报"}),(0,v.tZ)(u0.R,{})]})}),(0,X._)((0,oL._)(e),"renderReportModal",function(){var t=e.props.article,n=t.type,r=t.id,o=e.state.reportModalShown;return(0,v.tZ)(il.y,{type:n,urlToken:r,isColumnArticle:e.isColumnPage(),shown:o,onClose:e.handleModalClose,zaEnabled:!0})}),(0,X._)((0,oL._)(e),"renderAnnotationItem",function(){var t=e.props.article.annotationDetail;return(0,v.tZ)(u0.sN,{onClick:t?e.handleResetAnnotation:e.handleAddAnnotation,children:t?"撤销标记":"标记内容"})}),(0,X._)((0,oL._)(e),"renderAnnotationModal",function(){var t=e.props,n=t.addAnnotation,r=t.cancelAnnotation,o=t.showNotification,i=t.article.id,a=e.state,c=a.addAnnotationModalShown,s=a.cancelAnnotationModalShown;return(0,v.BX)(v.HY,{children:[(0,v.tZ)(uJ.Z,{addAnnotation:n,onClose:e.handleModalClose,shown:c,type:u5.zs,urlToken:i,showNotification:o}),(0,v.tZ)(u$.Z,{cancelAnnotation:r,onClose:e.handleModalClose,shown:s,type:u5.zs,urlToken:i,showNotification:o})]})}),(0,X._)((0,oL._)(e),"renderDeleteItem",function(){return(0,v.BX)(v.HY,{children:[(0,v.tZ)(u0.sN,{onClick:function(){return e.setState({deleteModalShown:!0})},children:"删除"}),(0,v.tZ)(u0.R,{})]})}),(0,X._)((0,oL._)(e),"renderDeleteModal",function(){var t=e.props.isMobile,n=e.state.deleteModalShown;return(0,v.tZ)(u1.Z,{isMobile:t,title:"删除文章",subtitle:"确定删除这篇文章？",shown:n,onCancel:e.handleModalClose,onSubmit:e.handleDelete})}),(0,X._)((0,oL._)(e),"renderEditItem",function(){return(0,v.BX)(v.HY,{children:[(0,v.tZ)(u0.sN,{onClick:e.hendleEditButtonClick,children:"修改文章"}),(0,v.tZ)(u0.R,{})]})}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=this;if(this.props.justPublished){if(O().get("leadCommentSetting"))return;this.forceTimeId=setTimeout(function(){e.reallytarget=e.target,e.setState({showAttention:!0})},250),this.animateTimeId=setTimeout(function(){e.setState({showAttention:!1}),O().set("leadCommentSetting",!0)},3e3)}}},{key:"componentWillUnmount",value:function(){clearTimeout(this.forceTimeId),clearTimeout(this.animateTimeId)}},{key:"render",value:function(){var e=this,t=this.state.showAttention,n=this.props,r=n.article,o=n.rewardInfo,i=n.isMobile,a=n.currentUser,c=r.author,s=r.annotationAction,l=r.commentPermission,u=r.copyrightPermission,d=(0,up.Z)(a,c),p=d&&!i,h=!d&&Array.isArray(s)&&(s.indexOf(u5.jB.add)>=0||s.indexOf(u5.jB.cancel)>=0),f=!d,_=l&&!i&&d,m=o.isRewardable&&d,g=(0,v.tZ)("div",{children:(0,v.tZ)(oQ.ZP,{preset:"plain",icon:p?uY.T:uQ.AZ,label:p?"设置":""})});return(0,v.BX)("div",{className:"Post-ActionMenuButton",ref:function(t){e.target=t},children:[(0,v.tZ)(u2.Z,{placement:"top",isOpen:t,target:this.reallytarget,isFixed:!0,children:"你可以在这里设置评论权限"}),(0,v.BX)(u0.ZP,{arrowed:!_,menuClassName:oV()("Post-ActionMenu",{"Post-ActionMenu--withCommentSettings":_}),toggler:g,onClick:function(t){return e.handleMenuClick(t,{isAuthor:d,isMobile:i})},stickHover:!0,reversed:!0,children:[f&&this.renderReportItem(),d&&this.renderEditItem(),d&&(0,v.BX)(v.HY,{children:[(0,v.tZ)(u9,{current:u,id:r.id,onChange:this.props.updateRepublishPermission}),(0,v.tZ)(u0.R,{})]}),_&&(0,v.BX)(v.HY,{children:[(0,v.tZ)(u3.rt,{current:l,target:r,onChange:this.props.updateCommentPermission}),(0,v.tZ)(u0.R,{})]}),m&&(0,v.tZ)(u0.sN,{onClick:this.onCloseReward,children:"关闭赞赏"}),d&&this.renderDeleteItem(),h&&this.renderAnnotationItem()]}),f&&this.renderReportModal(),d&&this.renderDeleteModal(),h&&this.renderAnnotationModal()]})}}]),n}(b.Component);(0,X._)(de,"propTypes",{article:oF().object.isRequired,addAnnotation:oF().func.isRequired,cancelAnnotation:oF().func.isRequired,deletePost:oF().func.isRequired,showNotification:oF().func.isRequired,updateCommentPermission:oF().func.isRequired,updateRepublishPermission:oF().func.isRequired,updateArticleReward:oF().func.isRequired,rewardInfo:oF().shape({isRewardable:oF().bool,tagline:oF().string}),justPublished:oF().bool}),(0,X._)(de,"defaultProps",{rewardInfo:{isRewardable:!1,tagline:""}});var dt=(0,e5.compose)(oR.withRouter,(0,ug.$)(),o6.Z,(0,eM.connect)(null,{addAnnotation:u4.u,cancelAnnotation:u4.e,deletePost:u6.fR,showNotification:tD.c0,updateCommentPermission:u6.R_,updateRepublishPermission:nK.OO,updateArticleReward:nj.i3,getCommercialInfo:u6.g1}))(de),dn=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"handleVote",function(t){var n=e.props,r=n.article.id;(0,n.updateArticleVote)(r,t)}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.article,n=t.id,r=t.author,o=e.checkIfCanConvertToVessay,i=e.currentUser;(0,up.Z)(i,r)&&o(n,"article")}},{key:"render",value:function(){var e=this.props,t=e.currentUser,n=e.isMobile,r=e.authRequired,o=e.rewardInfo,i=e.article,a=e.positionStatus,c=e.onCommentClick,s=e.onFavClick,l=e.onLikeClick,u=e.onRepublishClick,d=e.children,p=e.justPublished,h=e.onContributeClick,f=e.isInListItem,_=e.toggleLike2020,m=e.blockStrategies,g=e.onShare,T=i.id,E=i.type,C=i.author,y=i.voteupCount,S=i.voting,I=i.title,b=i.commentCount,A=i.adminClosedComment,Z=i.isLiked,w=i.copyrightPermission,R=(0,up.Z)(t,C),N=t&&t.isOrg,k=!!uX(i),O=!n&&!R&&["public","need_review"].includes(w),x=(0,uG.Z)([(0,uG.m)(m)],uM.W9);return(0,v.BX)(uz.eX,{children:[(0,v.tZ)(v.HY,{children:x({componentList:[{name:"vote",component:(0,v.tZ)(uV.Z,{type:E,count:y,onVote:this.handleVote,voting:S,isOwner:R,handleToggleGuide:l,disableAuth:n},"vote")},{name:"comment",component:(0,v.tZ)(uF.Z,{className:"BottomActions-CommentBtn",onClick:c,commentClosed:A,count:b,positionStatus:a},"comment")},{name:"share",component:!n&&(0,v.tZ)(uq.Z,{id:T,type:"article",url:(0,uD.x$)(T),title:I,authorName:C&&C.name,positionStatus:a,onShare:g},"share")},{name:"like",component:!n&&(0,v.tZ)(uK,{className:"ContentItem-action",onClick:r(function(){oW.Z.trackEvent(null,{id:Z?7695:7694,action:Z?"UnLike":"Like"}),_(T)}),isLiked:Z},"like")},{name:"favlist",component:!N&&(0,v.tZ)(uH.Z,{onClick:s,label:n?"":"收藏"},"favlist")}]})}),O&&(0,v.tZ)(uj,{onClick:u}),(0,v.tZ)(dt,{article:i,rewardInfo:o,justPublished:p}),R&&!n&&!k&&!f&&(0,v.tZ)(oQ.ZP,{preset:"plain",onClick:h,icon:uL.h,label:"投稿"}),d]})}}]),n}(b.Component);(0,X._)(dn,"propTypes",{article:oF().object.isRequired,rewardInfo:oF().shape({isRewardable:oF().bool,tagline:oF().string}),positionStatus:oF().string,onCommentClick:oF().func.isRequired,onFavClick:oF().func.isRequired,onLikeClick:oF().func,onContributeClick:oF().func,justPublished:oF().bool,isInListItem:oF().bool});var dr=(0,e5.compose)((0,ug.$)(),o6.Z,sJ.OW,(0,eM.connect)(uB.noop,{updateArticleVote:tt.Pt,toggleLike2020:tt.cg,checkIfCanConvertToVessay:te.Zq}))(dn),di=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"handleNextArticleLink",function(){Promise.resolve(oW.Z.trackEvent(e,{action:"OpenUrl",name:"下一篇"})).then(function(){location.href=(0,uD.x$)(e.props.next.id)})}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this.props.next.title;return(0,v.BX)("div",{role:"button",tabIndex:0,className:"NextArticle",onClick:this.handleNextArticleLink,children:[(0,v.tZ)("span",{className:"NextArticle-Next",children:"下一篇"}),(0,v.tZ)("span",{className:"NextArticle-Title",children:e})]})}}]),n}(b.Component),da=n(83931),dc=n(10748),ds=n(76490),dl=function(e){var t=e.show,n=e.children,r=e.className;return(0,ds.Yz)(t,null,{from:{opacity:0},enter:{opacity:1},leave:{opacity:0}}).map(function(e){var t=e.item,o=e.key,i=e.props;return t&&(0,v.tZ)(ds.q.div,{style:i,className:r,children:n},o)})},du=function(e){return(0,v.tZ)(c0.Z,{children:(0,v.tZ)(dl,(0,B._)({},e))})},dd=function(e){return 1===e},dp=function(e){return -1===e},dh=function(e,t){var n=dd(t)?Math.max(e-1,0):dp(t)?e:e+1,r=dd(t)||dp(t)?"赞同 ":"已赞同 ";return 0===n?"赞同":r+(0,i1.Zh)(n).trim()},df=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{show:!1,justLiked:!1}),(0,X._)((0,oL._)(e),"threshold",80),(0,X._)((0,oL._)(e),"updateVisibility",function(){var t=window.pageYOffset;t>e.threshold&&!e.state.shown?e.setState({shown:!0,justLiked:!1}):t<e.threshold&&e.state.shown&&e.setState({shown:!1,justLiked:!1})}),(0,X._)((0,oL._)(e),"handleToggleVote",e.props.authRequired(function(t){var n=e.props,r=n.id,o=n.updateArticleVote,i=n.voting;oW.Z.trackEvent(t.target,{action:1===i?"UnUpvote":"Upvote",element:"Button"}),o(r,1===i?"neutral":"up")},P.q0.vote)),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=document.querySelector(".TitleImage--fullScreen");e&&(this.threshold=e.offsetHeight+this.threshold),this.updateVisibility()}},{key:"componentDidUpdate",value:function(e){var t=this;1!==this.props.voting||1===e.voting||this.state.justLiked||this.setState({justLiked:!0},function(){t.timeoutId=setTimeout(function(){return t.setState({justLiked:!1})},300)})}},{key:"componentWillUnmount",value:function(){this.timeoutId&&clearTimeout(this.timeoutId)}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.voting,r=e.count,o=e.url,i=e.title,a=e.authorName,c=e.isAuthor,s=e.stickyFixed,l=e.blockStrategies,u=void 0===l?{}:l,d=u.isBlockingVote,p=u.isBlockingShare,h=this.state,f=h.justLiked,_=h.shown,m=(0,v.BX)("button",{children:[(0,v.tZ)("div",{className:"Post-SideActions-icon",children:(0,v.tZ)(da.xP,{center:!0,size:20})}),"分享"]}),g=1===n,T=dh(r,n),E=0===r?"赞同":(dd(n)?"已赞同 ":"赞同 ")+(0,i1.Zh)(r).trim();return(0,v.BX)(b.Fragment,{children:[(0,v.BX)(du,{show:_&&s,className:oV()("Post-SideActions",{"Post-SideActionsDisabled":c}),children:[!d&&(0,v.BX)(eG.$U,{as:"button",zaType:"Button",zaAction:g?"UnUpvote":"Upvote",zaText:g?"取消赞同":"赞同",disabled:c,className:oV()("like",{active:g,justLiked:f}),onClick:this.handleToggleVote,children:[(0,v.tZ)("div",{className:"Post-SideActions-icon",children:(0,v.tZ)(sZ.Ex,{className:"Post-SideActions-upIcon",size:16})}),(0,v.tZ)("div",{className:"likeCount",children:(0,v.tZ)("div",{className:"likeCount-inner","data-previous":T,children:E})})]}),!p&&(0,v.tZ)(uq.Z,{id:t,type:"article",url:o,title:i,authorName:a,toggler:m,positionStatus:"fixed"})]}),(0,v.tZ)(dc.Z,{threshold:50,emitOnce:!1,onScrollUp:this.updateVisibility,onScrollDown:this.updateVisibility})]})}}]),n}(b.Component);(0,X._)(df,"propTypes",{id:oF().oneOfType([oF().number,oF().string]).isRequired,isAuthor:oF().bool,voting:oF().oneOf([-1,0,1]).isRequired,count:oF().number,url:oF().string.isRequired,title:oF().string.isRequired,authorName:oF().string.isRequired}),(0,X._)(df,"defaultProps",{voting:0});var d_=(0,e5.compose)(o6.Z,sJ.OW,(0,eM.connect)(null,{updateArticleVote:tt.Pt}))(df),dm={comment:"底部评论",collect:"收藏",up:"赞同",down:"反对",neutral:"取消赞同/反对"},dv=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"zaRef",(0,b.createRef)()),(0,X._)((0,oL._)(e),"state",{favlistsShown:!1,republishApplyShown:!1,positionStatus:"normal"}),(0,X._)((0,oL._)(e),"createOiaHandler",function(t){return function(n){for(var r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var a=e.props,c=a.isMobile,s=a.shouldSpecialOia;c&&s?(0,uy.Z)({trackEvent:e.zaRef.current.trackEvent,zaV3Text:dm[t]}):null==n||n.apply(void 0,(0,g._)(o))}}),(0,X._)((0,oL._)(e),"handleFavButtonClick",function(t){(0,uS.E)(t,1282),e.createOiaHandler("collect")(e.handleFavlistsShown)}),(0,X._)((0,oL._)(e),"handleRepublishButtonClick",function(t){(0,uS.E)(t,8928,{button:{text:"申请转载"}}),e.props.authRequired(function(){return e.setState({republishApplyShown:!0})})()}),(0,X._)((0,oL._)(e),"handlePositionStatusChange",function(t){e.setState({positionStatus:t})}),(0,X._)((0,oL._)(e),"handleFavlistsShown",function(){e.props.authRequired(function(){return e.setState({favlistsShown:!0})},P.q0.favlists)()}),(0,X._)((0,oL._)(e),"handleFavlistHide",function(){e.setState({favlistsShown:!1})}),(0,X._)((0,oL._)(e),"handleScrollIntoComment",function(){if(e.props.isMobile){var t=document.querySelector(".Post-MobileComments");t&&t.scrollIntoView({block:"start",behavior:"smooth"});return}var n=e.state.positionStatus;if("fixed"===n)e.props.updateCommentStatus(n);else{var r=document.querySelector(".Comments-container");r&&r.scrollIntoView({block:"start",behavior:"smooth"})}}),(0,X._)((0,oL._)(e),"showComments",function(t){(0,uS.E)(t,1281),e.createOiaHandler("comment")(e.handleScrollIntoComment)}),(0,X._)((0,oL._)(e),"handleOiaVoteClick",function(t,n){e.createOiaHandler(n)()}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.favlistsShown,r=t.republishApplyShown,o=t.positionStatus,i=this.props,a=i.article,c=i.paging,s=i.rewardInfo,l=i.justPublished,u=i.onContributeClick,d=i.shouldSpecialOia,p=i.isMobile,h=i.currentUser,f=i.onShare,_=a.id,m=a.author,g=a.voteupCount,T=a.voting,E=a.title,C=(0,up.Z)(h,m),y="fixed"===o,S={type:"Post",id:String(_),token:String(_)},I={content:S};return(0,v.tZ)(oj.Z,{bottom:!0,onPositionStatusChange:this.handlePositionStatusChange,children:(0,v.BX)("div",{ref:function(t){e.actionEle=t},className:"RichContent-actions",children:[(0,v.BX)(s3.r,{module:"BottomBar",card:I,children:[(0,v.tZ)(eG.pS,{ref:this.zaRef}),(0,v.BX)(dr,{rewardInfo:s,article:a,positionStatus:o,onCommentClick:this.showComments,onFavClick:this.handleFavButtonClick,onLikeClick:p&&d?this.handleOiaVoteClick:null,onRepublishClick:this.handleRepublishButtonClick,justPublished:l,onContributeClick:u,onShare:f,children:[c.next&&!p&&y&&(0,v.tZ)(di,{next:c.next}),(0,v.tZ)(ux.E,{id:_,type:"article",shown:n,onClose:this.handleFavlistHide}),(0,v.tZ)(uP,{id:_,shown:r,onClose:function(){e.setState({republishApplyShown:!1})}})]})]}),!p&&(0,v.tZ)(eG.eV,{content:S,block:"LeftTabBar",children:(0,v.tZ)(s3.r,{module:"LeftTabBar",card:I,children:(0,v.tZ)(d_,{stickyFixed:y,id:_,isAuthor:C,voting:T,count:g,url:(0,uD.x$)(_),title:E,authorName:m&&m.name})})})]})})}}]),n}(b.Component);(0,X._)(dv,"propTypes",{article:oF().object.isRequired,paging:oF().object.isRequired,isRewardable:oF().bool,tagline:oF().string,updateCommentStatus:oF().func,justPublished:oF().bool,onContributeClick:oF().func}),(0,X._)(dv,"defaultProps",{paging:{}});var dg=(0,e5.compose)((0,ug.$)(),o6.Z,(0,eM.connect)(function(e){return{shouldSpecialOia:(0,eC.cq)(e)}}))(dv),dT=n(14717),dE=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"?utm_medium=column&utm_content=".concat(e)},dC=function(e,t){(0,T.rH)("zhihu://articles/".concat(e).concat(dE(t)))},dy=function(e,t){(0,T.rH)("zhihu://columns/".concat(e).concat(dE(t)))},dS=n(91777),dI=(0,tv.P1)([function(e){return e.post},function(e){return e.columns},function(e){return e.articleContribution.deleteContributeIdList}],function(e,t,n){return{contributions:Array.isArray(e&&e.contributions)?e.contributions.filter(function(e){var t=e.id;return!n.includes(t)}).map(function(e){var n=e.column,r=e.state,o=e.id;return{column:t[n.id],state:r,id:o}}):[]}}),db=(0,tv.P1)([function(e){return e.articleContribution.handledContributeIdList},function(e){return e.articleContribution.contributeRequests}],function(e,t){return{contributeRequests:t.filter(function(t){var n=t.column;return!e.includes(n.id)})}}),dA=(0,tv.P1)([function(e){return e.post},function(e){return e.reward}],function(e,t){var n=e.canOpenTipjar,r=e.canTip,o=e.id,i=t.article[o]||{},a=i.bio,c=i.income,s=i.tipjarorsCount,l=i.tradeNumber,u=i.tipjarors,d=i.users,p=i.canTip,h=r,f=void 0!==n&&n;return"boolean"==typeof p&&(h=p,f=!p),{rewardInfo:{canOpenReward:f,isRewardable:h,rewardMemberCount:s,tagline:a,rewardTotalMoney:c},articleReward:{article:(0,X._)({},o,{users:d||u,tradeNumber:l})}}}),dZ=n(15219),dw=n(17255),dR=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.info,n=e.related,r=e.isMobile,o={info:t,related:n};return r?(0,v.tZ)(dw.Z,{data:o}):(0,v.tZ)(dZ.Z,{data:o})}}]),n}(b.Component);(0,X._)(dR,"propTypes",{info:oF().object.isRequired,related:oF().oneOfType([oF().oneOf([null]),oF().shape({pageId:oF().number.isRequired,sessionId:oF().number.isRequired,pageType:oF().string.isRequired})]),isMobile:oF().bool});var dN=(0,af.Z)(null)(dR),dk=n(75056),dO=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.reason,n=e.isAuthor;return(0,v.BX)("div",{className:"PostIndex-warning",children:[t&&(0,v.tZ)("div",{className:"PostIndex-warningTitle",children:t}),(0,v.tZ)("div",{className:"PostIndex-warningContent",children:n?"建议修改期间，文章内容对其他用户不可见。修改提交后会自动进入评估状态。":"作者修改内容通过后，文章会重新显示。"}),(0,v.tZ)("a",{target:"_blank",href:"https://www.zhihu.com/question/24752645",rel:"noopener noreferrer",className:"PostIndex-warningHelp","aria-label":"帮助",children:(0,v.tZ)(dk.rk,{})})]})}}]),n}(b.Component);(0,X._)(dO,"propTypes",{reason:oF().string.isRequired,isAuthor:oF().bool.isRequired});var dx=n(79852),dP=n(28753),dD=n(79445),dL=n.n(dD),dB=n(63020),dU=n(7768),dM=n(70538),dG=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{previewImage:null,prevImgUrls:[]}),(0,X._)((0,oL._)(e),"handleClick",function(t){var n,r,o=e.props,i=o.ua,a=o.isMobile,c=e.state.prevImgUrls,s=a&&i.MQQBrowser&&(null===(n=window.browser)||void 0===n?void 0:null===(r=n.app)||void 0===r?void 0:r.openPhotoBrowser),l=t.target;"IMG"===l.tagName&&l.classList.contains("zh-lightbox-thumb")&&(s?window.browser.app.openPhotoBrowser(c,dL()(c,function(e){return e===l.dataset.original}),0):e.setState({previewImage:l}))}),(0,X._)((0,oL._)(e),"handlePreviewImageClose",function(){e.setState({previewImage:null})}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.ua,n=e.html,r=e.isMobile;t.MQQBrowser&&r&&this.setState({prevImgUrls:(0,dM.Z)(n)})}},{key:"render",value:function(){var e=this,t=this.props,n=t.html,r=t.ecommerce,o=t.author,i=t.id,a=t.title,c=t.url,s=t.isAuthor,l=t.shouldShowCatalog,u=t.contentNeedTruncated,d=t.authRequired,p=this.state.previewImage;return(0,v.BX)("div",{className:"Post-RichTextContainer",onClick:this.handleClick,children:[(0,v.BX)("div",{css:{marginTop:16,position:"relative"},children:[(0,v.tZ)(dU.Z,{html:n,className:"Post-RichText",ecommerce:r,sourceType:"article",sourceId:i,shouldShowCatalog:l,isAuthor:s,maskGradientColor:"GBK99A",isExpanded:!0,contentNeedTruncated:u}),u&&(0,v.tZ)(oX.Flex,{height:"100px",justifyContent:"center",css:function(e){return{position:"absolute",width:"100%",bottom:"0",backgroundImage:"linear-gradient(to bottom, transparent, ".concat(e.colors.MapUIFrame99A," 50px)")}},children:(0,v.BX)(oQ.ZP,{css:function(e){return{fontSize:"15px",color:e.colors.GBL07A}},preset:"plain",className:"ContentItem-expandButton",onClick:d(function(){},""),children:["展开阅读全文",(0,v.tZ)(dP.f,{className:"ContentItem-arrowIcon",center:!0})]},"expand-button")})]}),(0,v.tZ)(dB.Z,{type:"article",author:o,objectId:i,title:a,url:c}),(0,v.tZ)(dx.Z,{img:p,onClose:function(){return e.setState({previewImage:null})}})]})}}]),n}(b.Component);(0,X._)(dG,"propTypes",{html:oF().string.isRequired,author:oF().object});var dF=(0,e5.compose)(o6.Z,(0,eM.connect)(function(e){return{ua:(0,eC.Uh)(e),isMobile:(0,eC.Hu)(e)}}))(dG),dz=function(e){var t=e.panels;return(0,v.tZ)(cx.Z,{className:"TopRightPanelWrapper",children:(0,v.tZ)(du,{show:!0,children:(void 0===t?[]:t).map(function(e){var t=e.title,n=e.content,r=e.buttonGroup,o=e.key,i=void 0===o?"":o;return(0,v.BX)("div",{className:"TopRightPanel",children:[t&&(0,v.tZ)("div",{className:"TopRightPanel-title",children:t}),(0,v.tZ)("div",{className:"TopRightPanel-content",children:n}),(0,v.tZ)("div",{className:"TopRightPanel-foot",children:(0,v.tZ)("div",{className:"TopRightPanelButtonGroup",children:r})})]},i)})})})},dH=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"handleRequest",function(t,n){var r=e.props,o=r.postId;(0,r.handleContributeRequest)(o,t,n)}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.postId;(0,e.getContributeRequest)(t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.contributeRequests,r=t.author;if(0===n.length)return null;var o=n.map(function(t){var n=t.column,o=n.id,i=n.title,a=n.url;return{buttonGroup:(0,v.BX)(b.Fragment,{children:[(0,v.tZ)(oQ.ZP,{color:"grey",onClick:function(){return e.handleRequest(o,!1)},children:"忽略"}),(0,v.tZ)(oQ.ZP,{color:"blue",onClick:function(){return e.handleRequest(o,!0)},children:"通过"})]}),content:(0,v.BX)(b.Fragment,{children:[(0,v.tZ)(lB.Z,{user:r,avatar:!1,target:"_blank",noBadge:!0})," 申请将该文章发布到 ",(0,v.tZ)("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:i}),"。"]}),title:i,key:o}});return(0,v.tZ)(dz,{panels:o})}}]),n}(b.Component);(0,X._)(dH,"propTypes",{contributeRequests:oF().array.isRequired,postId:oF().oneOfType([oF().number,oF().string]).isRequired,author:oF().object.isRequired});var dq=(0,e5.compose)((0,eM.connect)(null,{handleContributeRequest:rY.xR,getContributeRequest:rY.o8}))(dH),dV=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className;return(0,v.tZ)("h3",{className:oV()("BlockTitle",n),children:t})}}]),n}(b.PureComponent);(0,X._)(dV,"propTypes",{className:oF().string});var dX=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"onCancelContributeClick",function(){var t=e.props,n=t.column;(0,t.handleCancelContributeClick)(n)}),(0,X._)((0,oL._)(e),"openInApp",function(){dy(e.props.column.id,"follow_column")}),(0,X._)((0,oL._)(e),"handleFollow",function(t){return(0,uS.E)(t,1288),!e.props.isMobile||e.openInApp()}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.column,n=e.state,r=e.isMobile,o=t.intro,i=t.description,a=(0,v.tZ)(lL.Z,{column:t,avatar:!0,avatarProps:{size:40,round:!0},noHoverCard:r}),c="need_approved"===n,s=(0,v.BX)(v.HY,{children:[(0,v.tZ)(lL.Z,{column:t,className:"ColumnItem-Title",noHoverCard:r}),c&&" \xb7 ",c&&(0,v.BX)("button",{className:"ColumnItem-CancleButton",onClick:this.onCancelContributeClick,children:[(0,v.tZ)("span",{className:"status",children:"投稿中"}),(0,v.tZ)("span",{className:"cancel",children:"撤销投稿"})]})]});return(0,v.tZ)(uz.ZP,{className:"Column-ColumnItem",data:t,image:a,title:s,meta:o||i})}}]),n}(b.Component);(0,X._)(dX,"propTypes",{column:oF().object.isRequired,state:oF().string});var dW=(0,ug.$)()(dX),dK=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"handleCancelContributeClick",function(t){var n=e.props,r=n.postId;(0,n.deleteContributeRequest)(r,t.id)}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this,t=this.props.contributions;return Array.isArray(t)&&0!==t.length?(0,v.BX)("div",{className:"PostIndex-Contributions",children:[(0,v.tZ)(dV,{children:"文章被以下专栏收录"}),(0,v.tZ)("ul",{children:t.map(function(t){var n=t.column,r=t.state;return(0,v.tZ)(dW,{column:n,state:r,handleCancelContributeClick:e.handleCancelContributeClick},n.id)})})]}):null}}]),n}(b.Component);(0,X._)(dK,"propTypes",{contributions:oF().arrayOf(oF().object),postId:oF().number});var dj=(0,e5.compose)((0,eM.connect)(null,{deleteContributeRequest:rY.kv}),(0,s3.a)({module:"ColumnList",moduleName:"文章被以下专栏收录"}))(dK),dY="column:hideOpenColumnModalUntil",dQ=1/0,dJ=function(e){var t=O().get(dY)?dQ:Date.now()+e;O().set(dY,String(t))},d$=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"onDeny",function(){e.props.onClose(),dJ(2592e6)}),(0,X._)((0,oL._)(e),"onClose",function(){e.props.onClose(),dJ(6048e5)}),(0,X._)((0,oL._)(e),"onConfirm",function(){e.props.onClose(),dJ(dQ)}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this.props.shown;return(0,v.tZ)(e4.Z,{title:"邀请你开通专栏",subtitle:"专栏旨在为有持续创作及合作写作需求的用户提供写作工具。发布到专栏，让文章被更多人看到。",onClose:this.onClose,buttonGroupOnly:!0,className:"Column-SpecialModal",children:e&&(0,v.BX)(e4.w,{direction:"vertical",children:[(0,v.tZ)(oQ.ZP,{preset:"primary",color:"blue",component:"a",onClick:this.onConfirm,href:"https://www.zhihu.com/column/request",target:"_blank",children:"立即开通"}),(0,v.tZ)(oQ.ZP,{onClick:this.onDeny,children:"暂不开通"})]})})}}]),n}(b.Component);(0,X._)(d$,"propTypes",{shown:oF().bool,onClose:oF().func.isRequired}),(0,X._)(d$,"checkShouldShow",function(){var e=Number(O().get(dY))||0;return Date.now()>e});var d0=n(70877),d1=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"handleColumnClick",function(t){oW.Z.trackEvent(t.currentTarget,{id:1591,name:e.props.reason||"推荐专栏的投稿"})}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.column,n=e.reason,r=e.contributed,o=e.onSubmit,i=t.articlesCount,a=t.followers,c=t.id,s=r?(0,v.tZ)(oQ.ZP,{color:"grey",preset:"primary",className:"CancleButton",children:"已投稿"}):(0,v.tZ)(oQ.ZP,{color:"blue",onClick:function(){return o(c)},children:"投稿"}),l={column:t,target:"_blank",onClick:this.handleColumnClick},u=(0,v.tZ)(lL.Z,(0,U._)((0,B._)({},l),{avatar:!0,avatarProps:{size:40}})),d=(0,v.tZ)(lL.Z,(0,U._)((0,B._)({},l),{className:"ColumnItem-Title"})),p=n||"".concat((0,i1.uf)(a)," 人关注 \xb7 ").concat((0,i1.uf)(i)," 篇文章");return(0,v.tZ)(uz.ZP,{className:"Column-ColumnItem",data:t,image:u,title:d,extra:s,meta:p})}}]),n}(b.Component);(0,X._)(d1,"propTypes",{column:oF().object.isRequired,reason:oF().string,contributed:oF().bool,onSubmit:oF().func.isRequired});var d2=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{loading:!1}),(0,X._)((0,oL._)(e),"submit",function(t){var n=e.props;(0,n.addContributeRequest)(n.articleId,t)}),(0,X._)((0,oL._)(e),"handleClose",function(){oW.Z.trackEvent((0,oL._)(e),{id:1592,action:"Close",name:"要将该文章投稿到专栏吗"}),e.props.onClose()}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){this.props.shown&&this.handleModalAppear()}},{key:"componentDidUpdate",value:function(e){this.props.shown&&!e.shown&&this.handleModalAppear()}},{key:"componentWillUnmount",value:function(){this.isUnmounted=!0}},{key:"handleModalAppear",value:function(){var e=this;oW.Z.trackCardShow(this,{id:1590,name:"要将该文章投稿到专栏吗"});var t=this.props,n=t.articleId,r=t.getRecommendedColumns;this.state.loading||(this.setState({loading:!0}),r(n).catch(function(){}).then(function(){e.isUnmounted||e.setState({loading:!1})}))}},{key:"renderContent",value:function(){var e=this,t=this.props,n=t.recommendedColumns,r=t.pinnedColumns,o=t.sentContributeRequestsIdList,i=t.isOpenedByUser,a=r.length>0,c=n.length>0;return i||a||c?this.state.loading?(0,v.tZ)(d0.Z,{}):a||c?(0,v.BX)(b.Fragment,{children:[a&&(0,v.tZ)("ul",{className:"PinnedColumns",children:r.map(function(t){var n=t.reason,r=t.column;return(0,v.tZ)("li",{children:(0,v.tZ)(d1,{column:r,reason:n,contributed:o.includes(r.id),onSubmit:e.submit})},r.id)})}),c&&(0,v.BX)(b.Fragment,{children:[(0,v.tZ)("h3",{className:"SectionTitle",children:"为你推荐的专栏"}),(0,v.tZ)("ul",{className:"RecommendedColumns",children:n.map(function(t){var n=t.column,r=t.reason;return(0,v.tZ)("li",{children:(0,v.tZ)(d1,{column:n,reason:r,contributed:o.includes(n.id),onSubmit:e.submit,onCancelSubmit:e.cancelSubmit})},n.id)})})]})]}):(0,v.tZ)("div",{className:"EmptyState",children:"暂时没有匹配的专栏"}):null}},{key:"render",value:function(){var e=this.props.shown;return(0,v.tZ)(e4.Z,{title:"要将该文章投稿到专栏吗？",subtitle:"让好文章被更多人看到",size:"large",onClose:this.handleClose,className:"Column-RecommendationModal",children:e&&this.renderContent()})}}]),n}(b.Component);(0,X._)(d2,"propTypes",{shown:oF().bool,onClose:oF().func.isRequired,getRecommendedColumns:oF().func.isRequired,recommendedColumns:oF().array.isRequired,pinnedColumns:oF().array.isRequired,articleId:oF().number.isRequired,sentContributeRequestsIdList:oF().array.isRequired,isOpenedByUser:oF().bool});var d3=(0,eM.connect)(function(e){var t=e.articleContribution;return{recommendedColumns:t.recommendedColumns,pinnedColumns:t.pinnedColumns,sentContributeRequestsIdList:t.sentContributeRequestsIdList}},{getRecommendedColumns:rY.Ue,addContributeRequest:rY.zS})(d2),d4=n(36963),d5=n.p+"assets/liukanshan_blue@2x.187f55d4.png",d6=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{folded:e.props.enabled}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.enabled,r=t.onButtonClick,o=this.state.folded,i=(0,v.tZ)(iZ.qE,{className:"UserLink-avatar",url:d5,alt:"刘看山图片",size:o?18:40});if(o)return(0,v.BX)("li",{className:"AutoInvite-folded",onClick:function(){return e.setState({folded:!1})},children:[i,(0,v.tZ)("span",{className:"AutoInvite-title",children:"委托刘看山邀请"}),(0,v.BX)("span",{className:"AutoInvite-badge",children:[(0,v.tZ)(d4.BS,{height:16,width:16}),(0,v.tZ)("span",{className:"text",children:"已开启"})]}),(0,v.tZ)(dP.f,{height:24,width:24,className:"AutoInvite-arrow"})]});var a=n?(0,v.tZ)(oQ.ZP,{color:"grey",preset:"primary",className:"CancleButton",onClick:r,children:"已开启"}):(0,v.tZ)(oQ.ZP,{color:"blue",preset:"primary",onClick:r,children:"开启邀请"});return(0,v.tZ)("li",{children:(0,v.tZ)(uz.ZP,{className:"Column-ColumnItem",title:"委托刘看山邀请",image:i,meta:!o&&(n?"正在为你智能邀请感兴趣的创作者":"开启后为你智能邀请感兴趣的创作者"),extra:!o&&a})})}}]),n}(b.Component);(0,X._)(d6,"propTypes",{reason:oF().string,enabled:oF().bool,onButtonClick:oF().func.isRequired});var d7=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.author,n=e.reason,r=e.hasInvited,o=e.onInvite,i=r?(0,v.tZ)(oQ.ZP,{color:"grey",preset:"primary",className:"CancleButton",children:"已邀请"}):(0,v.tZ)(oQ.ZP,{color:"blue",onClick:function(){return o(t.id)},children:"邀请投稿"}),a=(0,v.tZ)(lB.Z,{user:t,avatar:!0,avatarProps:{size:40}}),c=(0,v.tZ)(lB.Z,{user:t});return(0,v.tZ)(uz.ZP,{className:"Column-ColumnItem",data:t,title:c,image:a,meta:n,extra:i})}}]),n}(b.Component);(0,X._)(d7,"propTypes",{author:oF().object.isRequired,reason:oF().string,hasInvited:oF().bool,onInvite:oF().func.isRequired});var d8="column:closeInviteModalTimes",d9=function(){return Number(O().get(d8))||0},pe=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{loading:!1}),(0,X._)((0,oL._)(e),"touched",!1),(0,X._)((0,oL._)(e),"handleInvite",function(t){oW.Z.trackEvent((0,oL._)(e),{id:1589,action:"Click",name:"邀请投稿"}),e.touched=!0;var n,r=e.props;(0,r.dispatch)((n=r.columnId,{API:{types:oE.INVITE_CONTRIBUTOR,method:"PUT",endpoint:"/columns/".concat(n,"/contribution-invitees"),fetchOptions:{credentials:"include"},body:{member_hash:t}},userId:t}))}),(0,X._)((0,oL._)(e),"toggleAutoInvite",function(){var t,n=e.props,r=n.dispatch,o=n.autoInviteEnabled,i=n.columnId;oW.Z.trackEvent((0,oL._)(e),{id:o?2605:2604}),r((t=!o,{API:{types:oE.SET_AUTO_INVITE,method:"PATCH",endpoint:"/columns/".concat(i,"/recommendation-contributors"),fetchOptions:{credentials:"include"},body:{is_auto:t}},meta:t}))}),(0,X._)((0,oL._)(e),"handleClose",function(){oW.Z.trackEvent((0,oL._)(e),{id:1593,action:"Close",name:"邀请大家来投稿"});var t=e.props,n=t.onClose;t.isOpenedByUser||e.touched||O().set(d8,String(d9()+1)),n()}),(0,X._)((0,oL._)(e),"handleNeverShow",function(t){oW.Z.trackEvent(t.currentTarget,{id:1594,action:"Click",name:"邀请投稿弹窗不再提示按钮"}),O().set(d8,String(1/0)),e.props.onClose()}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){this.props.shown&&this.handleModalAppear()}},{key:"componentDidUpdate",value:function(e){this.props.shown&&!e.shown&&this.handleModalAppear()}},{key:"componentWillUnmount",value:function(){this.isUnmounted=!0}},{key:"handleModalAppear",value:function(){var e=this;oW.Z.trackCardShow(this,{id:1587,name:"邀请大家来投稿"});var t=this.props,n=t.columnId,r=t.dispatch,o=t.isOpenedByUser;!this.state.loading&&n&&(this.setState({loading:!0}),r({API:{types:oE.GET_RECOMMENDED_CONTRIBUTORS,endpoint:"/columns/".concat(n,"/recommendation-contributors").concat(o?"?src=user":""),fetchOptions:{credentials:"include"}}}).then(function(){e.isUnmounted||(e.setState({loading:!1}),e.touched=!1)},function(e){if(!e.payload||409!==e.payload.code)throw e}))}},{key:"renderContent",value:function(){var e=this,t=this.props,n=t.recommendedContributors,r=t.isOpenedByUser,o=t.autoInviteEnabled;return r||0!==n.length?this.state.loading?(0,v.tZ)(d0.Z,{}):(0,v.BX)(v.HY,{children:[(0,v.tZ)("ul",{className:"AutoInvite",children:(0,v.tZ)(d6,{onButtonClick:this.toggleAutoInvite,enabled:o})}),(0,v.tZ)("ul",{children:n.map(function(t){var n=t.author,r=t.reason,o=t.hasInvited;return(0,v.tZ)("li",{children:(0,v.tZ)(d7,{author:n,reason:r,hasInvited:o,onInvite:e.handleInvite})},n.id)})})]}):null}},{key:"render",value:function(){var e=this.props,t=e.shown,n=e.columnId,r=e.isOpenedByUser;if(!n)return null;var o=!r&&(0,v.BX)("p",{children:["暂时不想邀请他人投稿？",(0,v.tZ)("button",{onClick:this.handleNeverShow,children:"不再显示"})]});return(0,v.tZ)(e4.Z,{title:"想要专栏获得更多文章？邀请大家来投稿",subtitle:"为你精选优质作者，让你的专栏更受欢迎",size:"large",onClose:this.handleClose,className:"Column-RecommendationModal",footer:o,children:t&&this.renderContent()})}}]),n}(b.Component);(0,X._)(pe,"propTypes",{shown:oF().bool,onClose:oF().func.isRequired,columnId:oF().string.isRequired,recommendedContributors:oF().array.isRequired,autoInviteEnabled:oF().bool.isRequired,isOpenedByUser:oF().bool}),(0,X._)(pe,"checkShouldShow",function(){return 2>d9()});var pt=(0,eM.connect)(function(e){var t=e.columnContribution;return{recommendedContributors:t.recommendedContributors,autoInviteEnabled:t.autoInviteEnabled}})(pe),pn=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"isFirst",!0),(0,X._)((0,oL._)(e),"state",{applyModalShown:!1,recommendModalShown:!1,inviteModalShown:!1,isOpenedByUser:!1}),(0,X._)((0,oL._)(e),"handleCloseModals",function(){e.setState({applyModalShown:!1,recommendModalShown:!1,inviteModalShown:!1,isOpenedByUser:!1})}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.currentUser,r=t.justPublishedQuery,o=t.columnId;if((0,t.getShowRecommendModalHandler)(function(){return e.setState({recommendModalShown:!0,isOpenedByUser:!0})}),this.isFirst){this.isFirst=!1;return}"1"!==r||n.isOrg?"2"===r&&(o||n.isOrg?o&&pt.checkShouldShow()&&(this.timeout=setTimeout(function(){return e.setState({inviteModalShown:!0})},600)):this.timeout=setTimeout(function(){return e.setState({recommendModalShown:!0})},600)):this.checkShouldShowApplyColumnModal().then(function(t){e.isUnmounted||e.setState(t?{applyModalShown:!0}:{recommendModalShown:!0})})}},{key:"componentWillUnmount",value:function(){this.isUnmounted=!0,clearTimeout(this.timeout)}},{key:"checkShouldShowApplyColumnModal",value:function(){var e=this;return(0,iE._)(function(){return(0,iC.__generator)(this,function(t){switch(t.label){case 0:if(!d$.checkShouldShow())return[2,!1];return[4,e.props.loadSwitches(["couldApplyColumn"])];case 1:return t.sent(),[2,e.props.switches.couldApplyColumn]}})})()}},{key:"render",value:function(){var e=this.state,t=e.applyModalShown,n=e.recommendModalShown,r=e.inviteModalShown,o=e.isOpenedByUser,i=this.props,a=i.articleId,c=i.columnId;return(0,v.BX)(v.HY,{children:[(0,v.tZ)(d$,{shown:t,onClose:this.handleCloseModals}),(0,v.tZ)(d3,{articleId:a,shown:n,onClose:this.handleCloseModals,isOpenedByUser:o}),c&&(0,v.tZ)(pt,{shown:r,columnId:c,onClose:this.handleCloseModals})]})}}]),n}(b.Component);(0,X._)(pn,"propTypes",{justPublishedQuery:oF().oneOf(["1","2"]),articleId:oF().number.isRequired,columnId:oF().string});var pr=(0,e5.compose)(ah.Z,(0,eM.connect)(function(e){return{switches:e.switches}},{loadSwitches:rD.X2}))(pn),po=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"trackClick",function(t){(0,uS.E)(t,{id:1299,action:"OpenUrl",name:e.props.column.title})}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.time,n=e.column,r=e.isPaidArticle,o=n&&!r;return(0,v.BX)("div",{className:"Post-TimeExtra",children:[(0,n3.rL)(t),o&&" \xb7 来自专栏 ",o&&(0,v.tZ)(lL.Z,{column:n,noHoverCard:!0,onClick:this.trackClick})]})}}]),n}(b.Component),pi=n(11797),pa=n(99830),pc=n(82435),ps=function(e){var t=e.parent.id,n=(0,b.useRef)(),r=(0,b.useCallback)(function(){(0,uy.Z)({trackEvent:n.current.trackEvent,zaV3Text:"评论热区",from:"comment"})},[]);return(0,v.BX)(v.HY,{children:[(0,v.tZ)(eG.pS,{ref:n}),(0,v.tZ)(pc.ZP,{requestHost:"www.zhihu.com",commentType:"root_comment",resourceType:"article",resourceId:String(t),zaContentType:"Post",showSecondaryComment:!0,showSecondaryCommentVoteButton:!0,useHeartIcon:!0,css:{margin:0,paddingTop:"15px"},customFooter:function(){return null},openInApp:r})]})};ps.propTypes={parent:oF().object.isRequired};var pl=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"trackChangeOrder",function(e,t){(0,uS.E)(t,{id:1290,name:t.currentTarget.textContent})}),(0,X._)((0,oL._)(e),"trackLike",function(e,t){var n=t.currentTarget.classList.contains("is-liked");(0,uS.E)(t,{id:1301,action:n?"UnUpvote":"Upvote"})}),(0,X._)((0,oL._)(e),"trackPaginationClick",function(t,n){oW.Z.trackEvent((0,oL._)(e),{id:1300,action:t>n?"PrevPage":"NextPage"})}),(0,X._)((0,oL._)(e),"handleCommentClose",function(){e.props.updateCommentStatus("bottom")}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.parent,n=e.commentPattern,r=e.byComment,o=e.onMount,i=e.onComment,a=e.isMobile;return a?(0,v.tZ)(ps,{parent:t}):(0,v.tZ)(pa.Z,{autoFocus:!1,parent:t,isMobile:a,commentPattern:n,commentPlugin:pi.Z,onOrderChange:this.trackChangeOrder,onItemLike:this.trackLike,onPaginationClick:this.trackPaginationClick,onClose:this.handleCommentClose,onComment:i,byComment:r,onMount:o,showPackupButton:!1,commentInputPosition:"top",shown:!0})}}]),n}(b.Component);(0,X._)(pl,"propTypes",{parent:oF().object.isRequired,commentPattern:oF().string.isRequired,byComment:oF().oneOfType([oF().number,oF().string]),updateCommentStatus:oF().func.isRequired});var pu=(0,e5.compose)((0,ug.$)(),(0,s3.a)({module:"CommentList"}))(pl),pd=n(42657),pp=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"openApp",function(){P.dd||dC(e.props.postId,"view_all")}),e}return(0,V._)(n,[{key:"render",value:function(){return(0,v.tZ)("button",{onClick:this.openApp,className:"Post-Button-ViewMore",children:"查看更多"})}}]),n}(b.Component);(0,X._)(pp,"propTypes",{postId:oF().number.isRequired});var ph=n(75472),pf=n.n(ph),p_=n(88423),pm=n(93547),pv=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"oiaRef",(0,b.createRef)()),(0,X._)((0,oL._)(e),"openInApp",function(t){if(e.props.shouldSpecialOia){t.preventDefault();var n,r=e.props.article;null===(n=e.oiaRef.current)||void 0===n||n.oiaWithTrack({type:"article",id:r.id,from:"recommend"})}}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){this.RecommendItemTitleEl.offsetHeight>25&&(this.RecommendItemSummaryEl.style.display="none");var e=this.props.article;e.author||window.Raven.captureException(Error("Missing `author` in article data."),{tags:{scope:"Column"},extra:{article:e}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.article,r=t.editorChoice,o=n.imageUrl,i=n.title,a=n.excerpt,c=n.author,s=(void 0===c?{}:c).name,l=void 0===s?"":s,u=n.column,d=n.url,p=o?64:u5.PY,h=u&&l.length>4?"".concat(l.slice(0,4),"..."):l,f=u?" \xb7 发表于".concat(u.title):"";return(0,v.BX)(v.HY,{children:[(0,v.tZ)(li,{ref:this.oiaRef}),(0,v.BX)("a",{onClick:this.openInApp,href:d,className:"MobilePostItem",children:[(0,v.BX)("div",{className:"MobilePostItem-Description",children:[(0,v.tZ)("div",{className:"MobilePostItem-Title",ref:function(t){e.RecommendItemTitleEl=t},children:i}),(0,v.tZ)("div",{className:"MobilePostItem-Summary u-ellipsis",ref:function(t){e.RecommendItemSummaryEl=t},children:(0,pm.NJ)(a,p)}),(0,v.BX)("div",{className:"MobilePostItem-Footer",children:[r&&(0,v.tZ)("span",{className:"MobilePostItem-edited",children:"编辑精选"}),h,f]})]}),o&&(0,v.tZ)("img",{src:(0,p_.imgUrl)(o,"ipico"),srcSet:"".concat((0,p_.imgUrl)(o,"250x250")," 2x, ").concat((0,p_.imgUrl)(o,"ms")," 3x"),className:"MobilePostItem-TitleImage",alt:i})]})]})}}]),n}(b.PureComponent);(0,X._)(pv,"propTypes",{article:oF().object.isRequired,editorChoice:oF().bool.isRequired});var pg=(0,e5.compose)((0,eM.connect)(function(e){return{shouldSpecialOia:(0,eC.cq)(e)}}))(pv),pT=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e=this.props.article;e.author||window.Raven.captureException(Error("Missing `author` in article data."),{tags:{scope:"Column"},extra:{article:e}})}},{key:"render",value:function(){var e=this.props.article,t=e.imageUrl,n=e.title,r=e.excerpt,o=e.author,i=(void 0===o?{}:o).name,a=void 0===i?"":i,c=e.column,s=e.url,l=c&&a.length>5?"".concat(a.slice(0,5),"..."):a,u="";return c&&(u=c.title.length>5?"发表于".concat(c.title.slice(0,5),"..."):"发表于".concat(c.title)),(0,v.tZ)("a",{href:s,className:"PostItem",children:(0,v.BX)("div",{children:[t&&(0,v.tZ)("img",{src:(0,p_.imgUrl)(t,"250x0"),srcSet:"".concat((0,p_.imgUrl)(t,"qhd")," 2x"),className:"PostItem-TitleImage",alt:n}),(0,v.tZ)("h1",{className:"PostItem-Title",children:n}),!t&&(0,v.tZ)("p",{className:"PostItem-Summary",children:(0,pm.NJ)(r,u5.PY)}),(0,v.BX)("div",{className:"PostItem-Footer",children:[(0,v.tZ)("span",{children:l}),(0,v.tZ)("span",{className:"PostItem-FooterTitle",children:u})]})]})})}}]),n}(b.Component);function pE(e){var t=e.editorChoice,n=e.article;return(0,ug.Z)()?(0,v.tZ)(eG.eV,{moduleId:"reback_poplayer_btn",children:(0,v.tZ)(pg,{article:n,editorChoice:t})}):(0,v.tZ)(pT,{article:n})}(0,X._)(pT,"propTypes",{article:oF().object.isRequired}),pE.propTypes={article:oF().object.isRequired,editorChoice:oF().bool.isRequired};var pC=n(54674),py=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"handlePagingButtonClick",function(){var t=e.props,n=t.onClick;"next"===t.direction&&oW.Z.trackEvent((0,oL._)(e),{action:"NextPage"}),n()}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.direction,n=e.disabled,r="previous"===t?pC.e:ac.N;return(0,v.tZ)(s3.r,{module:"Unknown",moduleName:"推荐阅读",children:(0,v.tZ)("button",{className:oV()("PagingButton","previous"===t?"PagingButton-Previous":"PagingButton-Next"),onClick:this.handlePagingButtonClick,disabled:n,children:(0,v.tZ)(r,{size:40,fill:"#d3d3d3"})})})}}]),n}(b.Component);(0,X._)(py,"propTypes",{direction:oF().oneOf(["previous","next"]).isRequired,onClick:oF().func.isRequired,disabled:oF().bool}),(0,X._)(py,"defaultProps",{direction:"next"});var pS=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"handleResizeChange",function(){var t=e.props.isMobile,n=document.querySelector(".ColumnPageHeader-Wrapper");!t&&e.RecommendationsEl&&n&&(e.RecommendationsEl.style.width="".concat(n.offsetWidth,"px"))}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){this.subscription=(0,s2.subscribe)("resize",this.handleResizeChange)}},{key:"componentDidUpdate",value:function(){this.handleResizeChange()}},{key:"componentWillUnmount",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"render",value:function(){var e=this,t=this.props,n=t.isMobile,r=t.id,o=t.currentPageItems,i=t.shouldDisableNextPage,a=t.shouldDisablePreviousPage,c=t.nextPage,s=t.previousPage;return 0===o.length?null:(0,v.BX)("div",{role:"complementary","aria-label":"推荐阅读",className:oV()({"Recommendations-Main":!n}),ref:function(t){e.RecommendationsEl=t},children:[(0,v.tZ)(dV,{className:"Recommendations-BlockTitle",children:"推荐阅读"}),(0,v.BX)("ul",{className:oV()({"Recommendations-List":!n}),children:[!n&&(0,v.tZ)(py,{disabled:a,direction:"previous",onClick:s}),o.map(function(e){var t=e.article,n=e.editorChoice;return(0,v.tZ)(pE,{article:t,editorChoice:n},t.id)}),!n&&(0,v.tZ)(py,{disabled:i,direction:"next",onClick:c})]}),n&&!P.dd&&(0,v.tZ)(pp,{postId:r})]})}}]),n}(b.Component);(0,X._)(pS,"propTypes",{isMobile:oF().bool,id:oF().number,currentPageItems:oF().array,shouldDisableNextPage:oF().bool,shouldDisablePreviousPage:oF().bool,nextPage:oF().func.isRequired,previousPage:oF().func.isRequired}),(0,X._)(pS,"defaultProps",{currentPageItems:[]});var pI=(0,e5.compose)((0,eM.connect)(function(e,t){var n=t.id,r=(e.recommendation[n]||{}).data,o=(0,eC.Hu)(e);return{items:r,onlyOnePage:o,isMobile:o}},function(e,t){var n=t.id;return{fetchData:function(t){return e(function(e,r){var o=r().recommendation[n],i=o&&o.paging&&o.paging.next;return e({parentId:n,API:(0,B._)({root:x.Z.fetchRoot.zhuanlan,types:oS.GET},i?{endpoint:i}:{endpoint:"/articles/".concat(n,"/recommendation"),query:{include:ti()({data:[{article:{column:!0}}]}),limit:t,offset:0}})})})}}}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;return function(t){var n=function(n){(0,oB._)(o,n);var r=(0,oU._)(o);function o(){var t;return(0,q._)(this,o),t=r.apply(this,arguments),(0,X._)((0,oL._)(t),"fetchCount",0),(0,X._)((0,oL._)(t),"state",{isFetching:!1,page:0,isExhausted:!1}),(0,X._)((0,oL._)(t),"getCurrentPageItems",function(){var n=t.state.page;return t.props.items.slice(n*e,(n+1)*e)}),(0,X._)((0,oL._)(t),"beforeFetch",function(){if(t.state.isExhausted)return Promise.resolve({isExhausted:!0});var n=t.props.items.length,r=t.props.onlyOnePage?n>=e:n>(t.state.page+2)*e;return r||t.fetchCount>2?Promise.resolve({isExhausted:!r}):Promise.reject(Error("not enough to fetch or fetch too many times"))}),(0,X._)((0,oL._)(t),"fetchUntilEnough",function(){return t.beforeFetch().then(function(e){var n=e.isExhausted;return t.fetchEnds(n)},function(){return t.fetchStart().then(t.fetchUntilEnough)})}),(0,X._)((0,oL._)(t),"fetchStart",function(){0===t.fetchCount&&t.setState({isFetching:!0}),t.fetchCount+=1;var n=t.props;return(0,n.fetchData)(e*(n.onlyOnePage?1:3))}),(0,X._)((0,oL._)(t),"fetchEnds",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.fetchCount=0,t.setState({isExhausted:e,isFetching:!1})}),(0,X._)((0,oL._)(t),"isFirstPage",function(){return 0===t.state.page}),(0,X._)((0,oL._)(t),"isLastPage",function(){var n=t.props.items.length;return 0===n||(t.state.page+1)*e>=n}),(0,X._)((0,oL._)(t),"previousPage",function(){t.isFirstPage()||t.setState(function(e){return{page:e.page-1}})}),(0,X._)((0,oL._)(t),"nextPage",function(){t.isLastPage()||t.setState(function(e){return{page:e.page+1}},t.fetchUntilEnough)}),t}return(0,V._)(o,[{key:"componentDidMount",value:function(){this.fetchUntilEnough()}},{key:"shouldComponentUpdate",value:function(t,n){var r=this.props.items.length<e&&t.items.length>=e,o=!pf()(this.state,n);return r||o}},{key:"render",value:function(){var e=this.props,n=e.onlyOnePage,r=e.items,o=this.state,i=o.isFetching,a=o.isExhausted,c=0===r.length||this.isLastPage()&&(a||i);return(0,v.tZ)(t,(0,B._)({currentPageItems:this.getCurrentPageItems(),shouldDisableNextPage:c||n,shouldDisablePreviousPage:this.isFirstPage()||n,nextPage:this.nextPage,previousPage:this.previousPage},n0()(this.props,["fetchData","onlyOnePage","items"])))}}]),o}(b.Component);return(0,X._)(n,"displayName","PageManager(".concat(t.displayName||t.name||"Component",")")),(0,X._)(n,"propTypes",{onlyOnePage:oF().bool,fetchData:oF().func.isRequired,items:oF().array.isRequired}),(0,X._)(n,"defaultProps",{items:[]}),n}}(u5.j))(pS),pb=function(e){var t=e.module,n=e.content,r=e.children,o=e.index;return(0,v.tZ)(eG.eV,{content:n,moduleIndex:o,children:(0,v.tZ)(s3.r,{module:t,card:{content:n},children:r})})},pA=(0,o6.Z)(function(e){var t=e.id,n=e.type,r=e.voteupCount,o=e.query,i=e.authRequired,a=(0,uv.Z)(i,"true"===o.from_voters_page),c=a.modalShown,s=a.openVotersModal,l=a.closeVotersModal;return(0,v.BX)(v.HY,{children:[(0,v.tZ)(lD.Z,{contentType:"article",id:t,onClickVoterInfo:s}),(0,v.tZ)(ui.Z,{id:t,type:n,voteupCount:r,modalShown:c,handleListHide:l})]})}),pZ=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{columnHeaderShown:!1,contentDomPosition:"",commentPattern:e.getByCommentFromHash()?"fixed":"bottom",justPublishedQuery:e.getJustPublishedQuery(),shareVideoQuery:e.getShareVideoId(),shouldShowVideoDetails:!1,postMainRef:null,adTrackInfo:null,republishRequests:null,signFlowModalShown:!1}),(0,X._)((0,oL._)(e),"alreadyScrolled",!1),(0,X._)((0,oL._)(e),"postMainRef",(0,b.createRef)()),(0,X._)((0,oL._)(e),"rewardContainerRef",(0,b.createRef)()),(0,X._)((0,oL._)(e),"readMarkRef",(0,b.createRef)()),(0,X._)((0,oL._)(e),"oiaRef",(0,b.createRef)()),(0,X._)((0,oL._)(e),"onscoll",function(){var t=e.state.contentDomPosition,n=document.querySelector(".Post-RichText"),r=function e(t){return t&&t.offsetTop?t.offsetTop+(t.offsetParent?e(t.offsetParent):0):0}(n),o=n?n.getBoundingClientRect().height:0;if(!t){if(!n)return;e.setState({contentDomPosition:r+o})}(document.documentElement.scrollTop||document.body.scrollTop)+window.innerHeight>r+o&&(oW.Z.trackEvent((0,oL._)(e),{action:"ScrollToBottom"}),e.scrollSubscription.unsubscribe())}),(0,X._)((0,oL._)(e),"handleVotersButtonClick",function(){var t=e.props,n=t.isMobile,r=t.post;n&&!P.dd&&dC(r.id,"vote_list")}),(0,X._)((0,oL._)(e),"handleShowContributionModal",function(){e.showRecommendModalHandler&&e.showRecommendModalHandler()}),(0,X._)((0,oL._)(e),"handleClickVideoMoreButton",function(){e.setState({shouldShowVideoDetails:!1})}),(0,X._)((0,oL._)(e),"updateCommentStatus",function(t){e.state.commentPattern!==t&&("fixed"===t?e.props.trackOpenCommentAdPromotion():e.props.trackCloseCommentAdPromotion()),e.setState({commentPattern:t})}),(0,X._)((0,oL._)(e),"onCommentMount",function(t){"#comments"!==e.props.location.hash||"bottom"!==e.state.commentPattern||e.alreadyScrolled||(e.timeoutId=setTimeout(function(){return t.scrollIntoView()},500))}),(0,X._)((0,oL._)(e),"renderLabels",function(t){var n=e.props,r=n.post,o=n.isMobile,i=r.suggestEdit.status,a=r.annotationDetail,c=r.commercialInfo,s=r.visibleOnlyToAuthor;if(t&&s)return(0,v.tZ)(l9.Z,{});var l=(null==c?void 0:c.isCommercial)?{data:c}:null,u=o&&P.dd;return i||u?null:(0,v.tZ)(lN.Z,{commercialProps:l,annotationProps:!i&&a&&{annotationDetail:a},item:r})}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){var e,t=this;(0,lA.hx)();var n=this.props,r=n.location,o=n.router,i=n.loadVideoDetails,a=n.post,c=n.ua,s=n.getTrackUrl,l=n.updateReadStatus,u=n.loadContentRightsNotification,d=n.loadArticleRelationEndorsement,p=n.currentUser,h=n.isMobile;(!(e=a.updated)||Date.now()-1e3*e>6e4)&&(0,N.v)("https://zz.bdstatic.com/linksubmit/push.js",{crossOrigin:void 0}),h||d(a.id);var f=this.state.shareVideoQuery;a.trackUrl?this.setState({adTrackInfo:(0,pd.Z)(a,c)}):s(a.id).then(function(){t.setState({adTrackInfo:(0,pd.Z)(a,c)})}),f&&i(f).then(function(){t.setState({shouldShowVideoDetails:!0})});var _=r.query,m=_.just_published,v=_.is_recommend,g=(0,K._)(_,["just_published","is_recommend"]);(m||v)&&o.replace((0,U._)((0,B._)({},r),{query:g})),m&&u("article",a.id),this.scrollSubscription=(0,s2.subscribe)("scroll",this.onscoll),h&&this.readMarkRef.current&&(0,s4.y3)(this.readMarkRef.current,function(){return l({type:"article",id:a.id},!0)}),h||p||this.setState({signFlowModalShown:!0}),this.setState({postMainRef:this.postMainRef.current}),oW.Z.trackPageShow({id:3366}),p&&(0,uh.ZP)("post",a.id,uh._x),uf({router:o,location:(0,U._)((0,B._)({},r),{query:g})}),(0,ud.ql)({type:"article",token:a.id,index:1})}},{key:"handleSignFlowModalClose",value:function(){this.setState({signFlowModalShown:!1})}},{key:"componentWillUnmount",value:function(){this.scrollSubscription&&this.scrollSubscription.unsubscribe(),clearTimeout(this.timeoutId)}},{key:"getByCommentFromHash",value:function(){var e,t=this.props.location.hash;return t&&(e=t.match(ok))&&e[1]}},{key:"getJustPublishedQuery",value:function(){var e=this.props,t=e.author,n=e.location,r=e.currentUser;return(0,up.Z)(r,t)?n.query.just_published:null}},{key:"getShareVideoId",value:function(){var e=this.props,t=e.location;return e.isMobile?t.query.preview_video_id:null}},{key:"renderPostTimeAreaExtra",value:function(){var e=this.props,t=e.post,n=e.selfRecommendedRepublishRequests,r=void 0===n?[]:n;return 0===r.length?null:(0,v.tZ)(lj,{id:t.id,selfRecommendedRepublishRequests:r})}},{key:"render",value:function(){var e,t,n,r=this,o=this.props,i=o.ua,a=o.post,c=o.reward,s=o.rewardInfo,l=o.author,u=o.contributions,d=void 0===u?[]:u,p=o.contributeRequests,h=o.location.query,f=o.shareVideoDetail,_=o.isRead,m=o.currentUser,g=o.readContentRightsNotification,T=o.ecommerce,E=o.shouldSpecialOia,C=o.isSearchSpecialSource,y=o.searchSpecialTitle,S=o.theme,I=o.isMobile,A=o.blockStrategies,Z=void 0===A?{}:A,w=Z.isBlockingBindTopic,R=Z.isBlockingComment,N=o.href,k=o.trackToggleFollowAdPromotion,O=o.trackShareAdPromotion,x=o.trackPublishCommentAdPromotion;if(!a)return null;var D=a.id,L=a.imageUrl,U=a.imageWidth,M=a.imageHeight,G=a.title,F=a.isTitleImageFullScreen,z=a.content,H=a.voteupCount,q=a.reviewers,V=void 0===q?[]:q,X=a.created,W=a.updated,K=a.topics,j=a.paging,Y=a.excerpt,Q=a.type,J=a.url,$=a.commercialInfo,ee=a.suggestEdit,et=ee.status,en=ee.reason,er=a.creatorRightsNotification,eo=a.visibleOnlyToAuthor,ei=a.articleType,ea=a.paidInfo,ec=a.paidContent,es=a.commentCount,el=a.likedCount,eu=a.favlistsCount,ed=a.creationRelationship,ep=a.entityWords,eh=a.ipInfo,ef=a.contentSource,e_=a.contentNeedTruncated,em=(0,up.Z)(m,l);if(!em&&eo)return(0,v.tZ)(lR,{});var ev=$||{},eg=ev.isCommercial,eT=ev.plugin,eE=this.state,eC=eE.commentPattern,ey=eE.justPublishedQuery,eS=eE.shareVideoQuery,eI=eE.shouldShowVideoDetails,eb=eE.adTrackInfo,eA=eE.republishRequests,eZ=eE.signFlowModalShown,ew=Y.replace(/<.+?>/g,""),eR=uX(a),eN=JSON.stringify({userToken:m&&m.urlToken||""}),eO=JSON.stringify({authorName:l&&l.name,itemId:D,title:G,type:Q}),ex={title:f.title,thumbnail:f.coverUrl,isLens:!0,id:eS,isPlayable:!0,url:"https://www.zhihu.com/video/".concat(eS)},eP=!!(eT&&eT.download),eD="paid"===ei,eL=(void 0===ea?{}:ea).content,eB=eD?eL:z,eU=I?(0,v.tZ)(lp,{id:D,type:"article",commentCount:es,voteCount:H,likeCount:el,collectCount:eu,author:l}):(0,v.tZ)(dg,{article:a,paging:j,rewardInfo:s,updateCommentStatus:this.updateCommentStatus,justPublished:!!ey,onContributeClick:this.handleShowContributionModal,onShare:O}),eM=(0,v.tZ)(ub,{postId:D,author:l,isAuthor:em,followOpenInApp:E,onToggleFollow:k}),eG=!et||em,eF=!I&&(0,ly.Z)(a,"post"),ez=null==ed?void 0:null===(t=ed.coCreation)||void 0===t?void 0:t.refBy,eH=null==ed?void 0:null===(n=ed.reference)||void 0===n?void 0:n.refBy;return(0,v.BX)(pb,{module:"PostItem",content:{type:"Post",token:String(D)},index:0,children:[(0,v.tZ)(lt,{pageInfo:{pageId:"10178"},pageOptions:{trackPageDisappear:!0}}),I&&(0,v.tZ)(s5.Z,{type:"post"}),(0,v.tZ)(lC,{}),(0,v.BX)("div",{className:oV()("Post-content",{"Post-content-mobile":I}),"data-zop-usertoken":eN,"data-zop":eO,children:[(0,v.tZ)(lO,{entity:a}),!I&&(0,v.tZ)(pr,{justPublishedQuery:ey,articleId:D,columnId:eR&&eR.id,getShowRecommendModalHandler:function(e){return r.showRecommendModalHandler=e}}),eZ&&(0,v.tZ)(ic.Vy,{maskClosable:!1,showQrcodeFirst:!0,defaultType:"login",onClose:function(){r.handleSignFlowModalClose()}}),(0,v.tZ)(ek.ql,{title:G,meta:(0,dT.r)(a)}),!I&&(0,v.tZ)(sF.Z,{columnId:eR&&eR.id,showAdblockBanner:!0}),I&&(0,v.BX)(v.HY,{children:[(0,v.tZ)(lf,{type:"article",id:D}),(0,v.tZ)(li,{ref:this.oiaRef})]}),L&&!et&&(0,v.tZ)(uO,{src:L,width:U,height:M,alt:G,fullScreen:!I&&F,useImageX:!0}),(0,v.tZ)("article",{className:oV()("Post-Main",{"Post-NormalMain":!I,"Post-Main-Mobile":I}),ref:this.postMainRef,tabIndex:-1,children:(0,v.BX)(iu.wi,{root:this.state.postMainRef,children:[(0,v.BX)("header",{className:"Post-Header",children:[(0,v.tZ)("h1",{className:"Post-Title",children:G}),!I&&eM,!eD&&this.renderLabels(em),(ez||eH)&&(0,v.tZ)(oX.Box,{my:"16px",children:(0,v.tZ)(lI.j7,{type:"article",coCreationRefBy:ez,referenceRefBy:eH})}),!I&&(0,v.tZ)(pA,{id:D,type:Q,voteupCount:H,query:h})]}),et&&(0,v.tZ)(dO,{reason:en,isAuthor:em}),!et&&I&&(0,v.tZ)(po,{time:W,column:eR,isPaidArticle:eD}),eD&&(0,v.tZ)(s0.Z,{result:ec,extra:{ua:i,isDarkMode:S.isDarkMode}}),I&&eM,eS&&eI?(0,v.BX)(b.Fragment,{children:[(0,v.tZ)(l5.Z,{data:ex}),(0,v.tZ)("p",{className:"Post-VideoContentMore",onClick:this.handleClickVideoMoreButton,children:"点击查看全文"})]}):eG&&(0,v.tZ)(dF,{html:eB,entityWords:ep,ecommerce:T,author:l,id:D,url:J,title:G,isAuthor:em,shouldShowCatalog:eF,contentNeedTruncated:e_}),eG&&(0,v.tZ)(lS.Z,{content:z,type:"article",urlToken:String(D)}),eD&&(0,v.tZ)(s$.Z,{result:ec,extra:{ua:i,theme:S}}),I&&(0,v.tZ)("div",{className:"Post-ReadMark",ref:this.readMarkRef}),eP&&(0,v.tZ)(dN,{isMobile:I,info:eT.download,related:eb}),!et&&!(eS&&eI)&&(0,v.tZ)(l4,{created:X,updated:W,ipInfo:eh,contentSource:ef,extraInlineComponent:this.renderPostTimeAreaExtra()}),!et&&m&&d.length>0&&(0,v.tZ)(lY.Z,{imperativeRef:this.rewardContainerRef,reward:c,currentUser:m,rewardInfo:s,isMobile:I,id:D,isAuthor:em,author:l,ua:i,type:Q,onRewardUserClick:function(e){return(0,uS.E)(e,1296)},onRewardUserMoreClick:function(e){return(0,uS.E)(e,1297)},onRewardButtonClick:function(e){return(0,uS.E)(e,1298)},balanceEnable:!1}),!w&&!et&&(I&&P.dd?null:(0,v.BX)("div",{className:"Post-topicsAndReviewer",children:[(0,v.tZ)(uo,{className:oV()("Post-Topics",{"Post-TopicsReviewer":V.length>0}),topics:K,onItemClick:function(e){return(0,uS.E)(e,1295)}}),V.length>0&&(0,v.tZ)(uZ,{reviewers:V,type:Q,isAuthor:em})]})),!I&&!(et&&!em)&&eU]})}),C&&(0,v.tZ)(l8,{className:"Post-searchSpecialButton",title:y}),I&&(0,v.tZ)(s1.Z,{id:D,type:"ARTICLE",zaInfo:{pageId:"11190"},className:"Post-VipRecommendCard"}),(0,v.BX)("div",{className:oV()("Post-Sub",{"Post-NormalSub":!I,"Post-Sub-Mobile":I}),children:[!I&&!R&&!et&&(0,v.tZ)(pu,{parent:a,byComment:this.getByCommentFromHash(),commentPattern:eC,updateCommentStatus:this.updateCommentStatus,onMount:this.onCommentMount,onComment:x}),!et&&(0,v.tZ)(dj,{contributions:d,postId:D}),!eg&&!et&&(0,v.tZ)(pI,{id:D}),!I&&m&&(0,v.tZ)(dq,{postId:D,author:l,contributeRequests:p})]}),E&&(0,v.tZ)(lx.Z,{mainContentInPage:a,href:(0,le.MN)({type:"article",id:D},(0,B._)({utm_content:"app_jumping",open:_?"1":"0"},eD&&{app_from:h.app_from||P.G5,redirect_from:encodeURIComponent(N),is_from_paid:1})),onClick:function(){var e;null===(e=r.oiaRef.current)||void 0===e||e.oiaWithTrack({type:"article",id:a.id,from:"poplayer"})}}),I&&(0,v.tZ)(lv,{onSuccessClick:function(){var e;null===(e=r.oiaRef.current)||void 0===e||e.oiaWithTrack({type:"article",id:a.id,from:"popup_frame"})}}),I&&!(et&&!em)&&eU,(0,v.tZ)(lb.Z,{notification:er,onRead:function(e){g("article",a.id,e)},onUseAdmire:function(){r.rewardContainerRef.current.activateReward()},onUseRecommend:function(){var e=r.props.postToolsRecommend;iV.Z.confirm((0,v.tZ)("div",{style:{textAlign:"center"},children:"该推荐将使用本月的 1 次推荐次数。"}),{title:"确定是否推荐？"}).then(function(){return e("article",String(D))},function(){})}}),(0,v.BX)(c0.Z,{children:[(0,v.tZ)(oH.l,{title:G,desc:ew,extraQuery:(e=uc().get("social_id"))?{s_s_i:e,s_r:1}:{s_r:0},imgUrl:L||uT}),(0,v.tZ)(ul,{})]}),!I&&(0,v.tZ)(lz,{entityType:"article",id:D,isAuthor:em,onShowAllRequests:function(e){r.setState({republishRequests:e})}}),!I&&!!eA&&(0,v.tZ)(lK,{isAuthor:em,republishRequests:eA,onClose:function(){r.setState({republishRequests:null})}})]}),(0,v.tZ)(lT.Z,{type:"article",id:D,index:0}),(0,v.tZ)(lP.Z,{type:"article",contentId:D,footerButton:"完成"})]})}}]),n}(b.Component);(0,X._)(pZ,"fetchData",function(e){e.ctx,e.http;var t=e.params.id,n=e.dispatch,r=e.ua,o=e.location,i=e.location.query,a=e.getState,c=(0,eC.Hs)(a());return Promise.all([null,n((0,u6.xl)(t,{zhiPlusFlag:i.zpf,isQiangZhiSafe:c})).then(function(e){if("paid"===e.payload.articleType)return r.Mobile&&u_({ua:r,env:a().env,location:o}),n((0,u6.Qo)(t))}),n((0,dS.H)(t)),n((0,u6.vM)(t))])}),(0,X._)(pZ,"propTypes",{post:oF().object,author:oF().object,contributions:oF().array,contributeRequests:oF().array,shareVideoDetail:oF().object,isSearchSpecialSource:oF().bool,searchSpecialTitle:oF().string});var pw=(0,e5.compose)((0,sU.ZP)("WhiteBg-body PostIndex-body"),sG({scene:sM.ks.article}),o6.Z,function(e){return iI()(function(t){var n,r=(0,eM.useSelector)(eC.cM),o=(0,T.tL)().utm_psn?"share":r.baiduSearch?"baidu_search":"others";return(0,v.tZ)(lr,{callbackSource:o,isAnswerPage:null===(n=t.params)||void 0===n?void 0:n.answerId,children:(0,v.tZ)(e,(0,U._)((0,B._)({},t),{callbackSource:o}))})},e)},(0,ug.$)(),(0,eM.connect)(function(e,t){var n=t.params,r=e.entities,o=r.articles,i=r.users,a=r.columns,c=e.articleContribution,s=e.reward,l=e.video.shareVideoDetail,u=o[n.id];!(0,nn.isBrowser)()||u&&u.commercialInfo||window.Raven.captureException(Error("Missing post data in PostIndex."),{tags:{scope:"Column"},extra:{columns:a,articles:o,params:n}});var d=dI({columns:a,post:u,articleContribution:c}).contributions,p=db({articleContribution:c}).contributeRequests,h=dA({reward:s,post:u}),f=h.articleReward,_=h.rewardInfo,m=u.author,v=(void 0===m?{}:m).urlToken,g=lg(e);return{post:u,contributions:d,contributeRequests:p,rewardInfo:_,reward:f,isSearchSpecialSource:g.isSearchSpecialSource,searchSpecialTitle:g.searchSpecialTitle,ua:(0,eC.Uh)(e),author:i[v]||u.author,shouldSpecialOia:(0,eC.cq)(e),shareVideoDetail:l,isRead:(0,nX.O8)(e,{type:"article",id:n.id}),ecommerce:(0,e6.G_)(e,{type:"article",urlToken:n.id}),selfRecommendedRepublishRequests:(0,nK.ij)(e),theme:e.env.theme,href:e.env.ctx.href}},{loadSwitches:rD.X2,loadVideoDetails:rG.hK,getTrackUrl:dS.H,updateReadStatus:nX.m3,loadContentRightsNotification:nt.NC,readContentRightsNotification:nt.Uq,postToolsRecommend:ns.XX4,loadArticleRelationEndorsement:tt.iv}),(0,um.Z)({biz_tag:"Post"}),(0,sJ.$_)({dataPath:"post",passThrough:function(e,t){var n=t.post;return!e.isBlockingVote&&u5.YP.includes(null==n?void 0:n.id)&&(e.isBlockingVote=!0),e}}),sJ.OW,(0,uu.jM)({dataPath:"post"}),uu.LY,(0,lT._)({dataPath:"post"}))(pZ),pR=(0,tv.P1)([function(e){return e.comments},function(e){return e.entities.comments},function(e,t){return t.target},eC.Hu],function(e,t,n,r){var o=e.pagination,i=(void 0===o?{}:o)[n]||{},a=i.isDrained,c=i.isFetching,s=i.isPrevDrained,l=i.newIds,u=i.ids,d=i.totals;return{isDrained:a,isFetching:c,isPrevDrained:s,newComments:(r?(void 0===l?[]:l).slice(0,u5.lg):void 0===u?[]:u).map(function(e){return t[e]}),totals:d}}),pN=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"handleDeleteComment",function(){var t=e.props,n=t.id,r=t.postId;e.props.deleteComment(n,"article",r)}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.author,n=t.member,r=t.member,o=(void 0===r?{}:r).name,i=e.isAuthor,a=e.createdTime,c=e.isArticleAuthor;return(0,v.BX)("div",{className:"PreviewAuthorInfo",children:[(0,v.tZ)(lB.Z,{className:"PreviewAuthorInfo-avatarWrapper",user:n,avatar:!0,avatarProps:{className:"AuthorInfo-avatar",size:36,round:!0}}),(0,v.BX)("div",{className:"PreviewAuthorInfo-content",children:[(0,v.BX)("div",{className:"PreviewAuthorInfo-head",children:[(0,v.tZ)("span",{className:"PreviewAuthorInfo-Author",children:o}),c&&(0,v.tZ)("span",{className:"PreviewAuthorInfo-Type",children:"(作者)"})]}),(0,v.BX)("div",{className:"PreviewAuthorInfo-detail",children:[(0,v.tZ)("span",{children:(0,n3.rL)(a)}),(i||c)&&(0,v.BX)("span",{role:"button",tabIndex:0,className:"PreviewAuthorInfo-DeleteButton",onClick:this.handleDeleteComment,children:[" ","\xb7 删除"]})]})]})]})}}]),n}(b.Component);(0,X._)(pN,"propTypes",{author:oF().object.isRequired,createdTime:oF().number.isRequired,id:oF().number.isRequired,postId:oF().number.isRequired,isArticleAuthor:oF().bool}),(0,X._)(pN,"defaultProps",{author:{},isArticleAuthor:!1});var pk=(0,e5.compose)((0,eM.connect)(null,{deleteComment:function(e,t,n){return function(r,o){var i=o(),a={API:{types:tY.DELETE,endpoint:"comments/".concat(e),method:"delete"}},c={UPDATE:{request:{},failure:{}}},s=i.entities.comments[e];s&&(c.UPDATE.request.comments=(0,X._)({},e,{isDelete:!0}),c.UPDATE.failure.comments=(0,X._)({},e,s));var l="".concat(t,"s"),u=(i.entities[l]||{})[n],d=!!s&&s.reviewing;return u&&!d&&(c.UPDATE.request[l]=(0,X._)({},n,{commentCount:u.commentCount-1}),c.UPDATE.failure[l]=(0,X._)({},n,u)),r((0,U._)((0,B._)({id:e,collapsed:s&&s.collapsed,reviewing:d,parentType:t,parentId:n},a,c),{NOTIFICATION:{key:tD.zQ,failure:tD.XR}}))}}}))(pN),pO=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.comment,n=t.author,r=t.content,o=t.createdTime,i=t.id,a=t.isDelete,c=e.postId,s=e.postAuthor;if(a)return null;var l=s.id===n.member.id;return(0,v.BX)("div",{className:"PreviewContent",children:[(0,v.tZ)(pk,{author:n,createdTime:o,postId:c,id:i,isArticleAuthor:l}),(0,v.tZ)(dU.Z,{html:r,className:"PreviewContent-RichText"}),(0,v.tZ)(dV,{className:"PreviewContent-Line"})]})}}]),n}(b.Component);(0,X._)(pO,"propTypes",{comment:oF().object,postId:oF().number,postAuthor:oF().object});var px=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{active:!1,disabled:!0,changeHeight:!1}),(0,X._)((0,oL._)(e),"handleSubmit",function(){var t=e.input.toHTML();e.addComment(t)}),(0,X._)((0,oL._)(e),"handleBlur",function(){var t=e.state.disabled;t&&(document.querySelector(".PreviewComments-content").style.height="518px",e.setState({changeHeight:!1})),e.setState({active:!t})}),(0,X._)((0,oL._)(e),"handleChange",function(t){e.setState({disabled:t.isEmpty})}),(0,X._)((0,oL._)(e),"handleFocus",function(){if(!e.state.changeHeight){var t=document.querySelector(".PreviewComments-content").offsetHeight+48;document.querySelector(".PreviewComments-content").style.height="".concat(t,"px"),e.setState({changeHeight:!0})}e.setState({active:!0})}),(0,X._)((0,oL._)(e),"addComment",function(t){var n,r=["article_review",e.props.id,t];(n=e.props).addComment.apply(n,(0,g._)(r)).then(function(){e.input.reset()})}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.active,r=t.disabled;return(0,v.BX)("div",{className:"PreviewComments-InputContent",children:[(0,v.tZ)(ij.Z,{allowMention:!0,allowPasteRichText:!1,outputBlockType:"div",ref:function(t){e.input=t},placeholder:"写下你的评论…",onFocus:this.handleFocus,onBlur:this.handleBlur,onChange:this.handleChange,onSubmit:this.handleSubmit}),n&&(0,v.tZ)(oQ.ZP,(0,U._)((0,B._)({},{preset:"primary",color:"blue",children:"评论",disabled:r}),{className:"PreviewComments-singleButton",onClick:this.handleSubmit}))]})}}]),n}(b.Component);(0,X._)(px,"propTypes",{id:oF().number.isRequired});var pP=(0,e5.compose)((0,eM.connect)(null,{addComment:function(e,t,n,r,o){return function(i,a){var c="".concat(e,"s"),s=(a().entities[c]||{})[t]||{};if(!s.isSubmitting){var l,u,d=s.commentCount,p=tQ[e]||e,h="评论发布成功！";return"commercial"===s.questionType&&"censor"===s.commentPermission&&(h=(null===(l=s.question)||void 0===l?void 0:null===(u=l.brand)||void 0===u?void 0:u.toastCommentDescription)||"评论已提交，由品牌筛选后公开"),i({parentType:e,parentId:t,id:o,API:{types:tY.ADD,endpoint:"".concat(p,"s/").concat(t,"/comments"),method:"POST",fetchOptions:{zsEncrypt:!0,body:(0,M.decamelizeKeys)({content:n,replyToId:r})}},schema:tI.l.COMMENT,UPDATE:{request:(0,X._)({},c,(0,X._)({},t,{commentCount:d+1,isSubmitting:!0})),success:(0,X._)({},c,(0,X._)({},t,{isSubmitting:!1})),failure:(0,X._)({},c,(0,X._)({},t,{commentCount:d,isSubmitting:!1}))},NOTIFICATION:{key:tD.zQ,success:h,failure:"评论发布失败。"},replyToId:r})}}}}))(px),pD=n.p+"assets/comment.d46c2c85.png",pL=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"render",value:function(){return(0,v.BX)("div",{className:"PreviewComments-EmptyComment",children:[(0,v.tZ)("img",{src:pD,alt:"无草稿评论"}),(0,v.tZ)("p",{className:"PreviewComments-EmptyCommentText",children:"暂无草稿评论"})]})}}]),n}(b.PureComponent),pB=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"load",function(t){var n=e.props;(0,n.loadComments)("article_review",n.previewPost.id,{order:"normal",isPrevious:t})}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){this.load()}},{key:"render",value:function(){var e=this.props,t=e.isDrained,n=e.isFetching,r=e.isPrevDrained,o=e.comments,i=e.previewPost,a=i.id,c=i.author,s=e.className,l=e.close;return(0,v.tZ)("div",{className:oV()("PreviewComments",s),children:(0,v.BX)("div",{className:"PreviewComments-content",children:[(0,v.tZ)("p",{className:"PreviewComments-title",children:"草稿评论"}),(0,v.tZ)("p",{className:"PreviewComments-description",children:"文章发表后草稿评论仅文章作者可见"}),o.length>0?(0,v.tZ)(lH.ZP,{className:"PreviewComments-List",isLocal:!0,isLoading:n,isPrevDrained:r,isDrained:t,onLoad:this.load,placeholder:(0,v.tZ)(lH.i,{className:"CommentItem",small:!0}),children:o.map(function(e){return(0,v.tZ)(pO,{comment:e,postId:a,postAuthor:c},e.id)})}):(0,v.tZ)(pL,{}),(0,v.tZ)(pP,{id:a}),l]})})}}]),n}(b.Component);(0,X._)(pB,"propTypes",{previewPost:oF().object.isRequired,post:oF().object,isDrained:oF().bool,isFetching:oF().bool,isPrevDrained:oF().bool,comments:oF().array,className:oF().string,close:oF().element}),(0,X._)(pB,"defaultProps",{comments:[]});var pU=(0,e5.compose)((0,af.Z)(null),(0,eM.connect)(function(e,t){var n=t.post||e.previewPost,r=pR(e,{target:"article_review_".concat(n.id)});return{comments:r.newComments,previewPost:n,isDrained:r.isDrained,isFetching:r.isFetching,isPrevDrained:r.isPrevDrained}},{loadComments:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.order,o=void 0===r?"normal":r,i=n.isPrevious,a=void 0!==i&&i,c=n.byComment,s=n.status,l=void 0===s?"open":s,u=n.commentPattern,d=n.current,p=n.patternLimit,h=void 0===p?20:p,f=arguments.length>3?arguments[3]:void 0;return function(n,r){var i=r().comments,s=i.pagination,p=tY.GET;"reviewing"===l&&(s=i.reviewing,p=tY.GET_REVIEWING),"collapsed"===l&&(s=i.collapsed,p=tY.GET_COLLAPSED),"reverse"===o&&"open"===l&&(s=i.reverse,p=tY.GET_REVERSE);var _=s["".concat(e,"_").concat(t)]||{},m=_.next,v=_.previous,g=_.ids,T=(void 0===g?[]:g).length&&(a?v:m),E=0,C=tj.VZ;return"bottom"!==u||f||(E=(d-1)*h,C=h,T=!1),n({parentId:t,parentType:e,isPrevious:a,API:(0,U._)((0,B._)({types:p},T?{endpoint:T}:{endpoint:"".concat(tQ[e]||e,"s/").concat(t,"/comments"),query:(0,B._)({include:"data[*].author",order:o,limit:C},"open"===l&&c?{byComment:c}:{offset:E,status:l})}),{headers:{"X-APP-VERSION":"6.42.0"}}),schema:tI.l.COMMENT_ARRAY,UPDATE:{failure:function(n){return n&&n.res&&403===n.res.status?(0,X._)({},"".concat(e,"s"),(0,X._)({},t,{adminClosedComment:!0})):{}}},NOTIFICATION:{key:tD.zQ,failure:function(e){return(!e||403!==e.code)&&"获取评论失败，请稍后重试"}}})}}}))(pB),pM=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.previewPost,n=e.location,r=e.isMobile,o=t.imageUrl,i=t.imageWidth,a=t.imageHeight,c=t.title,s=t.isTitleImageFullScreen,l=t.content,u=t.author,d=t.column,p=t.topics,h=t.created,f=t.updated,_=n.query,m=_.catalog,g=_.comment,T=!r&&(m?"1"===m:(0,ly.Z)(this.props.previewPost,"post")),E=(0,v.tZ)(ub,{author:u,isAuthor:!0});return(0,v.BX)("div",{className:"PreviewPost-content",children:[(0,v.tZ)(ek.ql,{title:c}),!r&&(0,v.tZ)(sF.Z,{columnId:d&&d.id}),o&&(0,v.tZ)(uO,{src:o,width:i,height:a,alt:c,fullScreen:s}),r&&E,(0,v.BX)("article",{className:"PreviewPost-Main",children:[(0,v.BX)("header",{children:[(0,v.tZ)("h1",{className:"PreviewPost-Title",children:c}),!r&&E]}),(0,v.tZ)(dU.Z,{html:l,className:"PreviewPost-RichText",shouldShowCatalog:T}),(0,v.tZ)(l4,{created:h,updated:f}),(0,v.tZ)(uo,{topics:p,css:{marginBottom:"-10px",padding:"16px 0",".Topic":{height:"33px",fontSize:"13px",lineHeight:"33px",overflow:"hidden",marginBottom:"10px"}}}),!r&&"0"!==g&&(0,v.tZ)(pU,{})]})]})}}]),n}(b.Component);(0,X._)(pM,"fetchData",function(e){var t;return(0,e.dispatch)((t=e.params.id,{API:{root:x.Z.fetchRoot.zhuanlan,types:oy.GET,endpoint:"/articles/".concat(t,"/review"),method:"GET",fetchOptions:{credentials:"include"}},schema:tI.l.ARTICLE}))}),(0,X._)(pM,"propTypes",{previewPost:oF().object});var pG=(0,e5.compose)((0,ug.$)(),(0,eM.connect)(function(e){return{previewPost:e.previewPost}}))(pM),pF=n(24187),pz=n(9478),pH=n.n(pz),pq=n(20303),pV=n(28435),pX=(0,b.createContext)({}),pW=(0,oR.withRouter)(function(e){var t=e.to,n=e.router,r=(0,b.useContext)(pX);return r.url||(r.url=t),(0,b.useEffect)(function(){(0,G.sD)(t)?window.location.replace(t):n.replace(t)},[n,t]),null}),pK=n(28209),pj=n(48710),pY=n(33722),pQ=n(36591),pJ=n(92995),p$=n(12564),p0="postEditorV2Guide",p1=pJ.Z("2021-12-04 00:00:00"),p2=function(e){var t=e.ratio,n=e.className,r=(0,K._)(e,["ratio","className"]);return(0,v.tZ)(uR.Z,{ratio:t,className:n,css:{marginBottom:"16px"},children:(0,v.tZ)(oX.Image,(0,B._)({width:"100%",height:"100%"},r))})},p3=function(e){var t=e.imageUrl,n=e.children;return(0,v.BX)(oX.Flex,{alignItems:"center",css:{marginBottom:"16px"},children:[(0,v.tZ)(oX.Image,{src:t,alt:"1",flex:"0 0 15px",height:"15px",mr:"8px"}),(0,v.tZ)("p",{children:n})]})},p4=function(){var e=(0,j._)((0,cC.Z)(!1),2),t=e[0],n=e[1];return(0,b.useEffect)(function(){+new Date>p1||"1"===O().get(p0)||setTimeout(function(){n.on(),O().set(p0,"1")},5e3)},[n]),(0,v.tZ)(aa.Z,{title:"版本升级",onClose:n.off,closeButton:null,maskClosable:!1,hotKeyClosable:!1,css:{color:"inherit",width:"660px"},children:t&&(0,v.BX)(oX.Box,{color:"GBK02A",fontSize:"14px",lineHeight:"20px",children:[(0,v.BX)(oX.Box,{height:"370px",css:{overflow:"auto"},children:[(0,v.tZ)("p",{css:{marginBottom:"16px"},children:"亲爱的创作者～知乎网页版的文章编辑器迎来了期待已久的全面更新啦，在最新一版中，我们有了全新排版的创作区域：工具栏、编辑区域、发布设置。"}),(0,v.tZ)(p3,{imageUrl:"https://pic1.zhimg.com/v2-659cdb7ba796ad9164a9d3c207efa43f.png",children:"工具栏划分为：操作、文字、高级、插入、其他、帮助文档这六个部分，并新增了：图片库\xa0/\xa0图片编辑、二级标题和帮助文档。"}),(0,v.tZ)(p2,{ratio:1860/337,src:"https://pic2.zhimg.com/v2-4aeafd0f11c297240c659c9e77d0aa67.png",alt:"工具栏"}),(0,v.tZ)(p3,{imageUrl:"https://pic3.zhimg.com/v2-e2c434e38a5827bcc4a25399530d7a7f.png",children:"内容编辑区域扩大至\xa0800\xa0px，满足你的大屏创作体验。"}),(0,v.tZ)(p2,{ratio:1860/381,src:"https://pic2.zhimg.com/v2-ef52146433f6be97677f406bc4f7ea99.png",alt:"内容区"}),(0,v.tZ)(p3,{imageUrl:"https://pica.zhimg.com/v2-ddec683f2b10b1d5476a7f60f14fef0c.png",children:"发布设置集中在内容编辑区域下方，还新增了预览功能，写文、设置、预览、发布让创作变得行云流水。"}),(0,v.tZ)(p2,{ratio:4.96,src:"https://pic1.zhimg.com/v2-d195780f2be87c02ece0156da8c7d7a7.png",alt:"发布设置"}),(0,v.tZ)("p",{children:"知乎网页版文章编辑器感谢各位创作者的声音，快来体验我们共创的编辑器吧，更多功能持续更新中..."})]}),(0,v.tZ)(oX.Box,{css:{textAlign:"center"},children:(0,v.tZ)(p$.ZP,{preset:"primary",color:"blue",onClick:n.off,css:{width:"359px",margin:"25px auto 0"},children:"我知道了"})})]})})},p5=function(){return(0,v.BX)("div",{css:{paddingTop:"16px",marginBottom:-10,h2:{paddingBottom:"20px",fontWeight:"500",fontSize:"24px",textAlign:"center"},p:{textAlign:"center",fontSize:"14px"}},children:[(0,v.tZ)("h2",{children:"近 7 日发布文章数量已达上限"}),(0,v.tZ)("p",{children:"根据你的创作者等级，你在最近 7 个自然日可发布的文章数量已达上限，当前编辑将存入草稿。你还可以尝试「想法」创作，期待你的更多内容。"})]})},p6=n(14914),p7=n(78920),p8=n(46305),p9=n(65233),he=n(37705),ht=n(84469),hn=n(86341),hr=n(23074),ho=n(36212),hi=n(99616),ha=n(19220),hc=n(64875),hs=n(20826),hl=n(72004),hu=n(5934),hd=n(77234),hp=n(38765),hh=n(65277),hf=n(65379),h_=n(50605),hm=[".jpg",".jpeg",".png",".gif"],hv=function(e,t,n){var r=(0,pm.Xs)(e,n);if(0===r)return{ok:!1,message:null};var o=r-t;return o>0?{ok:!1,message:"已超过 ".concat(o," 个字")}:o>=-10?{ok:!0,message:"还可以输入 ".concat(-o," 个字")}:{ok:!0,message:null}},hg=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"check","title"===e.props.type?function(e){return hv(e,100)}:function(e){return hv(e,1e5,!0)}),(0,X._)((0,oL._)(e),"state",e.check(e.props.content)),(0,X._)((0,oL._)(e),"compareState",function(t){var n=t.ok,r=t.message;return e.state.message!==r||e.state.ok!==n}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){this.props.onStatusChange(this.state.ok)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.onStatusChange,r=t.content;if(e.content!==r){var o=this.check(e.content);this.compareState(o)&&(n(o.ok),this.setState(o))}}},{key:"shouldComponentUpdate",value:function(e,t){return this.compareState(t)}},{key:"render",value:function(){var e=this.state,t=e.ok,n=e.message,r=oV()("WriteIndex-LengthStatus",{"WriteIndex-LengthStatus-warning":!t});return n&&(0,v.tZ)("div",{className:r,children:n})}}]),n}(b.Component);function hT(e){var t=e.id,n=e.width,r=e.height;return{url:e.url,id:t,rawWidth:n,rawHeight:r,watermark:e.watermark,watermarkSrc:e.watermarkSrc,originalSrc:e.originalSrc}}(0,X._)(hg,"propTypes",{content:oF().string,type:oF().oneOf(["content","title"]).isRequired,onStatusChange:oF().func.isRequired});var hE={draftSave:"DraftSave",draftLoad:"DraftLoad",editableEdit:"Editable.Edit",editableInit:"Editable.Init"},hC=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{content:e.props.content,realTimeContent:e.props.content,draftHistoryModalShown:!1,baiduFileSelectorShown:!1,showUserProfitCardSelector:!1,mcnEditingGood:null,toolbarMenuAttention:null,initialScheduledPublishAt:e.props.scheduledPublishAt}),(0,X._)((0,oL._)(e),"syncDraft",(0,hf.Z)(e.props.reporter.wrapAutoRecord(hE.draftSave,function(t){var n,r=e.props,o=r.updateDraft,i=r.logTime,a=r.onTyping,c=r.getEditableInstance,s=t.toHTML();e.setState({realTimeContent:s});var l=i("calculate"),u={content:s,table_of_contents:null===(n=c())||void 0===n?void 0:n.hasCatalog(),delta_time:l};e.props.editorEventPublisher.fire({type:"saveDraft",context:{content:s}}),o(u).finally(function(){return a(!1)})}),1e3)),(0,X._)((0,oL._)(e),"handleChangeContent",function(t){var n=e.props,r=n.logTime;(0,n.onTyping)(!0),r("start"),e.syncDraft(t)}),(0,X._)((0,oL._)(e),"uploadImage",function(t){return(0,e.props.uploadContentImage)(t,"article").then(hT).catch(function(t){var n;throw e.props.editorEventPublisher.fire({type:"post-upload",context:{type:"image",error:t,imageCount:(null===(n=e.editable.getImages())||void 0===n?void 0:n.size)||0}}),t})}),(0,X._)((0,oL._)(e),"uploadVideo",function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.props.uploadVideo.apply(void 0,(0,g._)(n)).then(function(e){return e.payload}).catch(function(t){var n;throw e.props.editorEventPublisher.fire({type:"post-upload",context:{type:"video",error:t,videoCount:(null===(n=e.editable.getVideos())||void 0===n?void 0:n.size)||0}}),t})}),(0,X._)((0,oL._)(e),"handleError",function(t,n){var r=e.props.showErrorMessage;(0,rQ.Xc)(t,n,r)}),(0,X._)((0,oL._)(e),"uploadImageError",function(t){var n=e.props.showErrorMessage,r=function(e){if("object"==typeof e)return e.message;switch(e){case"type":return"格式不支持，请上传以下格式的图片：".concat(hm.join(", "));case"size":return"请上传不超过 ".concat(P.i3,"M 的图片");case"dimension":return"GIF 图片的长或宽低于 ".concat(120,"px，无法上传");case"other":return"图片上传未完成，请稍后发布"}}(t);if(r)return n(r)}),(0,X._)((0,oL._)(e),"handleUploadError",function(t,n){switch(n){case"video":e.handleError("video-upload-error");break;case"image":e.handleError("image-upload-error",t)}}),(0,X._)((0,oL._)(e),"handleInsertZVideo",function(){var t,n;null===(n=(t=e.props).handleToggleInsertVideoState)||void 0===n||n.call(t,!0)}),(0,X._)((0,oL._)(e),"trackUserProfitCardshow",es()(function(){oW.Z.trackCardShow(null,{id:6096})})),(0,X._)((0,oL._)(e),"getToolbarMenuPlugins",function(){return null}),(0,X._)((0,oL._)(e),"setUseScheduledPublish",function(t,n){var r=e.props.onScheduledPublishAtChange;if(t){if(n)r(n);else{var o=p6.Z(new Date,30);e.setState({initialScheduledPublishAt:o}),r(o)}}else iV.Z.confirm("取消后，当前设定的定时发布将不会生效，确定要取消发布吗？",{title:"取消定时发布",text:{cancel:"我再想想"}}).then(function(){r(void 0),oW.Z.trackEvent(e,{action:"Click",id:5737,name:"文章"})}).catch(function(){oW.Z.trackEvent((0,oL._)(e),{action:"Click",id:5736,name:"文章"})}),oW.Z.trackCardShow((0,oL._)(e),{id:5735,name:"文章"})}),(0,X._)((0,oL._)(e),"handleReverted",function(t){var n=t.draft,r=n.content,o=n.title,i=e.props,a=i.logTime,c=i.updateDraft;a("start"),c({content:r,title:o,delta_time:a("calculate")}).finally(function(){return e.editable.resetWithValue(r)})}),(0,X._)((0,oL._)(e),"handleEditGGRCard",function(t){var n=t.type,r=t.payload,o=e.state.mcnEditingGood,i=e.props.updateLinkCard;if("goodsEditor/submitNewGoodsInfo"===n){i((0,U._)((0,B._)({},o),{title:null==r?void 0:r.title})).finally(function(){e.setState({mcnEditingGood:null}),e.editable.handleCommand("edit-mcn-link-card:".concat(o.id))});return}if("goodsEditor/closeGoodsEditor"===n){e.setState({mcnEditingGood:null});return}}),(0,X._)((0,oL._)(e),"onAfterChangeContent",function(e){requestAnimationFrame(function(){var t=e.getSelection().getIsBackward(),n=document.getSelection();if(n.rangeCount){var r=n.getRangeAt(0).cloneRange();r.collapse(t);var o=r.getBoundingClientRect();if(0===o.height){var i=r.commonAncestorContainer;if(1===i.nodeType&&(o=i.getBoundingClientRect()).height>30)return}if(0!==o.height){var a=o.bottom-(window.innerHeight-65);a>0&&window.scrollBy(0,a)}}})}),(0,X._)((0,oL._)(e),"getSentences",function(){return e.props.isReediting?e.props.getInteractText("articles",e.props.postId).then(function(e){var t;return null==e?void 0:null===(t=e.payload)||void 0===t?void 0:t.data}):null}),(0,X._)((0,oL._)(e),"createEditorPlugins",function(){var t=(0,hn.Z)({type:"article",getId:function(){return e.props.postId},getDraftId:function(){return e.props.postId},draftType:"article",syncDraft:e.syncDraft,shouldShowToolbarButton:function(){return e.props.postId}}),n=(0,hc.Z)({shouldShow:function(){return e.props.showUserProfitButton},getContentInfo:function(){return{type:"article",id:e.props.postId}}}),r=(0,ht.Z)(),o=(0,ha.Z)({sourceType:"article",sourceId:e.props.postId});e.helpDocPlugin=(0,hr.Z)({getInitialOffset:e.props.getHelpDocInitialOffset,forceUpdate:e.props.forceUpdateWriteIndex});var i=(0,hi.Z)({onToggle:e.props.toggleMarkdownEnabled});return[(0,ho.Z)({getSentences:e.getSentences}),t,n,r,o,e.helpDocPlugin,i]}),(0,X._)((0,oL._)(e),"editableReady",function(){e.props.reporter.reportSuccess(hE.editableInit)}),e}return(0,V._)(n,[{key:"canUseScheduledPublish",get:function(){var e=this.props,t=e.currentUser,n=e.isReediting;return t&&t.autoSendingCreations&&!n}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;e.content&&this.props.content!==e.content&&(this.setState({realTimeContent:e.content}),this.editable&&!this.editable.toHTML()?(this.props.editorEventPublisher.fire({type:"loadDraftSuccess",context:{content:e.content}}),this.props.reporter.wrapAutoRecord(hE.draftLoad,function(){t.editable.resetWithValue(e.content)})()):this.setState({content:e.content}))}},{key:"componentDidMount",value:function(){var e,t=this;this.props.editorEventPublisher.setCommonMessage({traceId:this.props.traceId}),(0,hl.$)(this.props.editorEventPublisher),this.props.editorEventPublisher.fire({type:"mount",context:{currentUserId:null===(e=this.props.currentUser)||void 0===e?void 0:e.id,href:window.location.href,browserContentScripts:(0,hh.l)(),content:this.props.content}}),this.props.reporter.reportRequest(hE.editableInit);var n=this.props,r=n.fillCurrentUserIfNeeded,o=n.getUserProfitPermission,i=n.loadCreatorRightStatus,a=r(["autoSendingCreations","mcn_user_info"]);o(),i(),Promise.resolve(a).then(function(){L.Z.getActionsByNames(["p_draft_history",t.canUseScheduledPublish&&"auto_pub_article"].filter(Boolean)).then(function(e){var n=(0,j._)(e,1)[0];n&&(t.setState({toolbarMenuAttention:n.description}),L.Z.markAsShown(n),"auto_pub_article"===n.guide_name&&oW.Z.trackCardShow(t,{id:5738}))})}),O().set("debug","ali-oss"),window.onbeforeunload=function(){return t.syncDraft.pending()||t.props.draft&&t.props.draft.updating?"草稿尚未保存完毕，确定离开此页？":void 0},oW.Z.trackCardShow(this,{id:5729,name:"文章"}),(0,hd.a)(["r","t","e"])}},{key:"componentWillUnmount",value:function(){this.props.editorEventPublisher.fire({type:"unmount"});var e=this.props.editorEventPublisher;setTimeout(function(){e.unsubscribe()},4e4),this.syncDraft.cancel(),(0,hd.n)()}},{key:"render",value:function(){var e=this,t=this.props,n=t.onEditableRef,r=t.videoPoster,o=t.onLengthStatusChange,i=t.couldSuperVideoUpload,a=t.post,c=t.publishArea,s=t.handleAnyChange,l=t.showInsertableVideoUploader,u=t.handleToggleInsertVideoState,d=t.onCloseCatalog,p=t.getMarkdownEnabled,h=this.state,f=h.content,_=h.mcnEditingGood,m=h.realTimeContent,g=h.toolbarMenuAttention,T=h.initialScheduledPublishAt;return(0,v.BX)("div",{className:"PostEditor-wrapper",children:[(0,v.BX)("div",{css:{minHeight:"calc(100vh - 190px)"},children:[(0,v.BX)(lA.vB,{name:hE.editableEdit,children:[(0,v.tZ)(p8.Z,{editorFrom:"article-pc-editor",storageKey:"article-pc-editor"}),(0,v.tZ)(he.Z,{ref:function(t){e.editable=t,n&&n(t)},large:!0,richtext:!0,spread:!0,allowLinkCard:!0,allowImageCaption:!0,allowResizeImage:!0,allowMention:!0,allowDragAndDrop:!0,allowToolbar:!0,allowToolbarSticky:!0,allowInlineCode:!0,allowUploadDocument:!0,allowVideoTitleChange:!0,allowZVideo:!0,allowReference:!0,allowTable:!0,allowHeaderThree:!1,placeholder:"请输入正文",className:"PostEditor",editingContentType:"article",toolbarMenuAttention:g,getToolbarMenuPlugins:this.getToolbarMenuPlugins,onInsertZVideo:this.handleInsertZVideo,toolbarProps:{menuCallout:null},onReady:this.editableReady,onChange:this.handleChangeContent,onAnyChange:s,onImageUpload:this.uploadImage,onVideoUpload:this.uploadVideo,defaultValue:f,poster:(void 0===r?{}:r).url,onError:this.handleError,uploadImageError:this.uploadImageError,onUploadError:this.handleUploadError,couldSuperVideoUpload:i,onMCNLinkCardEdit:function(t,n){e.setState({mcnEditingGood:n})},useEditableV2:!0,createEditorPlugins:this.createEditorPlugins,allowCatalog:!0,useCatalogV2:!0,stickyOffset:92,css:{".Editable_CatalogV2":{left:-210}},useImageOperationV2:!0,catalogEnabled:(0,ly.Z)(a,"post"),maskGradientColor:"GBK99A",showToolbar:!1,useV2Feature:!0,allowImageEditor:!0,onCloseCatalog:d,onAfterChange:this.onAfterChangeContent,docPluginProps:(0,p9.Z)(this.props.creatorRightStatus),getMarkdownEnabled:p,videoSource:"article"})]}),(0,v.tZ)(hg,{content:m,type:"content",onStatusChange:o}),(0,v.tZ)(e4.Z,{className:"PostEditor-MCNEditor",title:"编辑商品",onClose:function(){e.setState({mcnEditingGood:null})},children:!!_&&(0,v.tZ)(p7.Z,{className:"PostEditor-MCNEditorIframe",src:(0,hp.l6)({title:_.title,originTitle:_.originTitle,source:_.source,sourceId:_.sourceId,productTypeName:_.productTypeName}),onMessage:this.handleEditGGRCard})}),l&&(0,v.tZ)(hu.Z,{show:l,onClose:function(){null==u||u(!1)},onZVideoSubmit:function(t){null==u||u(!1),e.editable.handleCommand("insert-zvideo-card:".concat(JSON.stringify(t)))},onVideoSubmit:function(t){null==u||u(!1),e.editable.handleCommand("insert-video-card",t)}})]}),c&&A().cloneElement(c,{setUseScheduledPublish:this.setUseScheduledPublish,initialScheduledPublishAt:T,canUseScheduledPublish:this.canUseScheduledPublish,contentIsTooShort:9>(0,pm.Xs)(m,!0),realTimeContent:m})]})}}]),n}(b.Component);(0,X._)(hC,"propTypes",{postId:oF().number,content:oF().string.isRequired,logTime:oF().func.isRequired,onEditableRef:oF().func,onTyping:oF().func.isRequired,onLengthStatusChange:oF().func.isRequired,updateDraft:oF().func.isRequired,showErrorMessage:oF().func.isRequired,onScheduledPublishAtChange:oF().func.isRequired,showInsertableVideoUploader:oF().bool,handleToggleInsertVideoState:oF().func,handleAnyChange:oF().func,onCloseCatalog:oF().func,isReediting:oF().bool.isRequired,getEditableInstance:oF().func,toggleMarkdownEnabled:oF().func,getMarkdownEnabled:oF().func});var hy=(0,e5.compose)((0,eM.connect)(function(e){return{couldSuperVideoUpload:rD.yS.includes(e.currentUser),currentUser:(0,eE.ib)(e),showUserProfitButton:e.userProfit.permission.visible,creatorRightStatus:(0,nc.Sy)(e)}},{uploadContentImage:function(e,t){return function(n){return n(("string"!=typeof e?oc:oa)(r2,e,t)).then(os)}},uploadVideo:function(e){return{API:{types:r3,endpoint:"/api/embedded_videos",root:x.Z.fetchRoot.lens,method:"POST",body:{url:e}}}},fillCurrentUserIfNeeded:eE.sF,getUserProfitPermission:rM.Yr,loadCreatorRightStatus:nc.Xd,updateLinkCard:nw.ko,getInteractText:h_.k}),pj.SS,hs.eU,lA.l0,hh.ZP)(hC),hS=n(72280),hI=n(86385),hb=n(66268),hA=n(13905),hZ=n(3681),hw=oF().shape({updated:oF().number,description:oF().string,title:oF().string,url:oF().string,commentPermission:oF().string,created:oF().number,acceptSubmission:oF().boolean,intro:oF().string,imageUrl:oF().string,type:oF().string,urlToken:oF().string,id:oF().string}),hR=n(53910),hN=n(97234),hk=function(e){var t=(0,eG.Q4)().trackEvent;return(0,v.tZ)(hN.Z,(0,U._)((0,B._)({css:function(e){return[{display:"flex",width:"150px",height:"100px",borderRadius:"4px",border:"1px dashed",borderColor:e.colors.GBL05A,alignItems:"center"}]},onClick:function(){t({eventType:"Click",action:"Upload",elementLocation:{type:"Button",text:"上传封面"}})}},e),{children:(0,v.BX)(oX.Text,{color:"GBL05A",css:{fontSize:"12px",fontWeight:500,width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,v.tZ)(hR.nY,{size:14,css:{marginRight:"4px"}}),"添加文章封面"]})}))},hO=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"uploadImage",function(t){var n=t.file;if(n){var r=e.props,o=r.logTime,i=r.updateDraft,a=r.uploadCover,c=r.showNotification;o("start");var s=o("calculate");if(n.size>1048576*P.i3)return c("抱歉！请上传大小为 ".concat(P.i3,"M 以下的图片文件"),"red");a(n,"article").then(function(e){return i({titleImage:e.url,isTitleImageFullScreen:!1,delta_time:s})}).catch(uU())}}),(0,X._)((0,oL._)(e),"handleRemove",function(){var t=e.props,n=t.logTime,r=t.updateDraft,o=t.removeCover;n("start"),r({titleImage:"",delta_time:n("calculate")}).then(o)}),e}return(0,V._)(n,[{key:"render",value:function(){var e=this,t=this.props.image;return(0,v.BX)("div",{children:[t&&(0,v.BX)(oX.Box,{css:{position:"relative",width:"150px",height:"100px","&:hover .WriteCoverV2-buttonGroup":{display:"flex"}},children:[(0,v.tZ)(oX.Image,{alt:"封面图",src:t,size:"100%",css:{display:"block",borderRadius:"4px",objectFit:"cover"}}),(0,v.BX)(oX.Flex,{className:"WriteCoverV2-buttonGroup",css:function(e){return{display:"none",height:"32px",position:"absolute",left:"50%",bottom:"8px",transform:"translateX(-50%)",zIndex:"1",background:e.colorMod(e.colors.GBK02B).alpha(.75),borderRadius:"4px",border:0,alignItems:"center",".Button":{color:e.colors.GBK99B,fontSize:"13px",borderRadius:"4px",height:"32px",width:"47px",display:"flex",alignItems:"center",justifyContent:"center",border:"0",padding:"0","&:active":{background:e.colors.GBK02B,opacity:"0.5"}}}},children:[(0,v.tZ)(eG.$U,{as:oQ.ZP,zaText:!0,zaType:"Button",zaAction:"Upload",title:"更换",onClick:function(){return e.uploadNode.click()},children:"更换"}),(0,v.tZ)(oX.Box,{height:"12px",width:"1px",bg:"GBK09A"}),(0,v.tZ)(eG.$U,{as:oQ.ZP,zaText:!0,zaType:"Button",zaAction:"Unknown",title:"删除",onClick:this.handleRemove,children:"删除"})]})]}),(0,v.tZ)(hk,{accept:".jpeg, .jpg, .png",customUpload:this.uploadImage,css:t&&{display:"none"},onRef:function(t){t&&(e.uploadNode=t)}}),(0,v.tZ)(oX.Text,{color:"GBK06A",mt:"8px",css:{fontSize:"13px",lineHeight:"20px"},children:"图片上传格式支持 JPEG、JPG、PNG"})]})}}]),n}(b.Component);(0,X._)(hO,"propTypes",{image:oF().string,onRef:oF().func,logTime:oF().func.isRequired,updateDraft:oF().func}),(0,X._)(hO,"defaultProps",{onRef:function(){}});var hx=(0,e5.compose)((0,af.Z)(null),(0,eM.connect)(null,{uploadCover:function(e,t){return e.length&&(e=e[0]),function(n){return n(oc(r1,e,t)).then(os)}},removeCover:function(){return{type:on}},showNotification:tD.c0}))(hO),hP=n(92718),hD=n(6148);function hL(e,t,n){var r,o,i=new iT.y;i.setExtraInfo("publisher","pc"),i.set("draft",{disabled:1,id:String(e),isPublished:!n}),t.publish_at&&i.set("schedule",{publishAt:t.publish_at});var a=null===(r=t.column)||void 0===r?void 0:r.id;a&&i.set("column",{column:[a]});var c=(0,hD.hZ)(t);return c&&i.setExtraInfo("pc_business_params",c),i.set("commentsPermission",{comment_permission:t.commentPermission}),i.set("creationStatement",{disclaimer_type:t.disclaimer_type,disclaimer_status:t.disclaimer_status}),i.set("contentsTables",{table_of_contents_enabled:t.table_of_contents_enabled}),i.set("commercialReportInfo",{isReport:(null===(o=t.commercial_report_info)||void 0===o?void 0:o.is_report)?1:0}),t.commercial_zhitask_bind_info&&i.set("commercialZhitaskBindInfo",{bindOperate:t.commercial_zhitask_bind_info.bind_operate,taskId:String(t.commercial_zhitask_bind_info.task_id),taskType:t.commercial_zhitask_bind_info.task_type}),i.set("hybridInfo",{contentSource:t.content_source}),i.build()}var hB="PublishPost",hU="PublishPanelV2",hM=function(){oW.Z.trackCardShow(null,{id:7879}),location.href="https://".concat(x.Z.wwwHost,"/draft?type=article")},hG=function(e){var t=e.columns,n=(0,eG.Q4)().trackEvent,r=(0,eM.useDispatch)(),o=(0,eM.useSelector)(function(e){return e.articleDraft.selectedColumn}),i=0!==o,a=function(e){var o;n({eventType:"Click",action:"Unknown",elementLocation:{type:"Button",text:e>0?"专栏收录-".concat(null===(o=t[e-1])||void 0===o?void 0:o.title):"不发布到专栏"}}),r(od(e))};return(0,v.BX)(oX.Box,{color:"GBL05A",flex:"1",css:{fontSize:"14px"},children:[(0,v.BX)(oX.Flex,{height:"38px",children:[(0,v.tZ)(hZ.KT,{checked:i,text:"发布到专栏",onChange:function(){a(1)},id:"PublishPanel-columnLabel-1"}),(0,v.tZ)(hZ.KT,{checked:!i,text:"不发布到专栏",onChange:function(){a(0)},id:"PublishPanel-columnLabel-0"})]}),i?(0,v.tZ)(hZ.Qr,{placement:"bottom-left",useDefaultPosition:!0,onChange:a,value:o,css:{marginTop:"5px"},children:t.map(function(e,t){return(0,v.tZ)(hZ.o3,{value:t+1,text:e.title},e.id)})}):(0,v.tZ)(oX.Text,{color:"GBK06A",mt:"5px",css:{fontSize:"13px",lineHeight:"18px"},children:"将发布到个人主页的「文章」栏目下"})]})},hF=function(e){return(0,v.BX)(oX.Flex,{py:"11px",children:[(0,v.tZ)(hZ.gN,{name:"专栏收录"}),(0,v.tZ)(hG,(0,B._)({},e))]})},hz=n(84867),hH=n(27366),hq=n(86057),hV=n.n(hq),hX=n(20312),hW=function(e){var t=e.data,n=void 0===t?0:t,r=hX.Y_.ICON_DECLINE,o=hX.Y_.ICON_FLAT,i=hX.Y_.ICON_RISE,a=(0,v.tZ)(oX.Image,{width:"18px",mr:"6px",src:o});return hV()(n)&&n.includes("%")&&(n=Number(n.replace(/%/,""))),n>0&&(a=(0,v.tZ)(oX.Image,{width:"16px",mr:"6px",src:i})),n<0&&(a=(0,v.tZ)(oX.Image,{width:"16px",mr:"6px",src:r})),a},hK=n(22627),hj=n(48725),hY=n(94307),hQ=function(e){var t=e.children,n=(0,K._)(e,["children"]);return(0,v.tZ)(oX.Flex,(0,U._)((0,B._)({color:"GBL05A",py:"16px",css:function(e){return{fontSize:"14px",borderBottom:"1px solid ".concat(e.colors.GBK09A)}}},n),{children:t}))},hJ=function(e){var t=e.children,n=(0,K._)(e,["children"]);return(0,v.tZ)(oX.Flex,(0,U._)((0,B._)({py:"15px",css:function(e){return{alignItems:"center",borderBottom:"1px solid ".concat(e.colors.GBK09A)}}},n),{children:t}))};function h$(){var e=(0,lQ._)(["","回答 \xb7 ","关注"]);return h$=function(){return e},e}var h0=function(e){var t=e.list,n=e.disableShrink,r=(0,K._)(e,["list","disableShrink"]);return(0,v.tZ)(oj.Z,{offset:52,children:(0,v.tZ)(hQ,(0,U._)((0,B._)({backgroundColor:"GBK99A"},r),{children:t.map(function(e,t){var r=e.width,o=e.text,i=e.css;return(0,v.tZ)(oX.Text,(0,U._)((0,B._)({flexBasis:"".concat(r,"px")},n&&{flexShrink:0},i&&{css:i}),{children:o}),t)})}))})},h1=function(e){var t=e.width,n=e.title,r=e.titleLink,o=e.subText,i=e.answerCount,a=e.followerCount,c=e.renderLabel,s=e.keyWords,l=e.urlToken,u=(0,K._)(e,["width","title","titleLink","subText","answerCount","followerCount","renderLabel","keyWords","urlToken"]);return(0,v.BX)(oX.Box,(0,U._)((0,B._)({flexBasis:"".concat(t,"px")},u),{children:[(0,v.tZ)(hY.pl,{href:r,zaType:"Card",target:"_blank",zaText:s?"搜索".concat(s):l?"算法":"",children:(0,v.BX)(oX.Box,{className:"Creator-QuestionShared-title",css:function(e){return(0,U._)((0,B._)({},(0,sk.S)(2)),{fontSize:"15px",color:e.colors.GBK03A,fontWeight:500,lineHeight:"21px",paddingRight:"100px"})},children:[c&&c(),n]})}),(0,v.tZ)(oX.Flex,{fontSize:"14px",color:"GBL05A",mt:"8px",alignItems:"center",children:o||l$()(h$(),(0,i1.Zh)(i),(0,i1.Zh)(a))})]}))},h2=(0,oR.withRouter)(function(e){var t=e.width,n=e.haveAnswer,r=void 0!==n&&n,o=e.questionAnswerUrl,i=void 0===o?null:o,a=e.writeQuestionUrl,c=e.isArticleToAnswer,s=void 0!==c&&c,l=e.id,u=e.postId,d=e.text,p=e.zaInfo,h=void 0===p?{}:p,f=(0,K._)(e,["width","haveAnswer","questionAnswerUrl","writeQuestionUrl","isArticleToAnswer","id","postId","text","zaInfo"]),_=f.params,m=f.router,g=_.urlToken,T=(0,eM.useDispatch)(),E=function(e,t,n){var r="/question/".concat(e,"?").concat(t);if(n){window.location.href="https://www.zhihu.com".concat(r);return}m.push(r)};return(0,v.tZ)(oX.Flex,(0,U._)((0,B._)({justifyContent:"center",flexBasis:"".concat(t,"px")},f),{children:(0,v.tZ)(eG.$U,(0,U._)((0,B._)({zaType:"Button",zaText:d||!0,zaBlock:s||r?"ArticleToAnswer":"",zaAction:"OpenUrl",shouldTrackShow:!0},h),{extra:{link:{get url(){return r?i:a}}},children:s?(0,v.tZ)(oQ.ZP,{preset:"primary",color:"blue",label:"编辑发布",css:{padding:"0 9px"},onClick:function(){T((0,ns.Skx)(g,l)).then(function(e){var t=(null==e?void 0:e.payload)||{},n=t.isAllowPublish,r=t.hasAnswer,o=t.hasDraft,i=t.disableReason,a=t.articleCheckResult,c=new URLSearchParams((0,B._)({attach_to_article:g||u,write:""},u&&{push_activity:0})).toString();(null==a?void 0:a.hasPublishedAnswer)?T((0,tD.c0)("一个文章只能发布一个问题~")):n?E(l,c,u):r?T((0,tD.c0)("已发布回答")):o?iV.Z.confirm((0,v.tZ)("div",{css:{textAlign:"center"},children:"你在该问题下已有草稿，是否将此文章内容覆盖到草稿箱"})).then(function(){E(l,c,u)}).catch(function(){return null}):T((0,tD.c0)(i))})}}):r?(0,v.tZ)(sW.Z,{icon:hK.yP,label:"查看回答",href:i,target:"_blank",css:{padding:"0 9px"}}):(0,v.tZ)(sW.Z,{className:"QuestionItem-footer--writeAnswerButton",label:"写回答",icon:hj.E,href:a,target:"_blank"})}))}))}),h3=function(e){var t=e.zaContent,n=e.zaBlock,r=e.zaModuleId,o=e.zaModuleIndex,i=e.zaExtra,a=(0,K._)(e,["zaContent","zaBlock","zaModuleId","zaModuleIndex","zaExtra"]);return(0,v.tZ)(eG.eV,{content:t,block:n,moduleId:r,moduleIndex:o,extra:i,children:(0,v.tZ)(eG.Wi,(0,B._)({as:oX.Box,zaType:"Card"},a))})},h4=n(79091);function h5(){var e=(0,lQ._)(["共",""]);return h5=function(){return e},e}var h6=function(e){var t=e.title;return(0,v.tZ)("div",{className:"SearchQuestion-item-title",dangerouslySetInnerHTML:{__html:t}})},h7=function(e){var t=e.item,n=e.index,r=e.isArticleToAnswer,o=e.isSearch,i=e.onChange,a=e.keyWords,c=e.urlToken,s=t||{},l=s.question,u=l.id,d=l.highlightTitle,p=l.url,h=l.haveAnswer,f=l.questionAnswerUrl,_=s.reaction,m=_.newPv,g=_.pv,T=_.followNum,E=_.answerNum,C=s.checked,y=(0,b.useMemo)(function(){return{questionAnswerUrl:f,writeQuestionUrl:(0,h4.D)(p,{write:""}),haveAnswer:h}},[h,f,p]),S=(0,b.useMemo)(function(){return{title:(0,v.tZ)(h6,{title:d}),titleLink:p,followerCount:T,answerCount:E}},[E,T,d,p]),I="".concat(c?"".concat(a?"搜索".concat(a):"算法","; 文章token: ").concat(c):"");return(0,v.tZ)(h3,{zaContent:{token:String(u),type:"Question"},zaBlock:"RecommendQuestionItem",zaText:I,children:(0,v.BX)(hJ,{css:function(e){return{"& .SearchQuestion-item-title":{em:{fontStyle:"normal",color:e.colors.GRD03A}}}},children:[(0,v.tZ)(h1,(0,B._)({width:415,keyWords:a,urlToken:c},S)),(0,v.BX)(oX.Box,{flexBasis:"130px",children:[(0,v.BX)(oX.Flex,{alignItems:"center",children:[(0,v.tZ)(hW,{data:m}),(0,v.tZ)(oX.Text,{fontSize:"14px",color:"GBK03A",children:(0,i1.Zh)(m)})]}),(0,v.tZ)(oX.Text,{fontSize:"12px",color:"GBK06A",mt:"6px",children:l$()(h5(),(0,i1.Zh)(g))})]}),void 0!==o&&o?(0,v.tZ)(oX.Flex,{justifyContent:"center",flexBasis:"131px",children:(0,v.tZ)(eG.$U,{zaType:"Button",zaText:I,zaBlock:"ArticleToAnswer",shouldTrackShow:!0,children:(0,v.tZ)(oQ.ZP,{preset:C?"primary":"secondary",color:"blue",label:C?"已选择":"选择",css:{padding:"0 15px"},onClick:function(){return i&&i(t,n)}})})}):(0,v.tZ)(h2,(0,U._)((0,B._)({width:131},y),{isArticleToAnswer:void 0!==r&&r,id:u,postId:c,text:I}))]})})};h7.proptypes={item:oF().object,index:oF().number,isArticleToAnswer:oF().bool,isSearch:oF().bool,onChange:oF().func,keyWords:oF().string,urlToken:oF().string};var h8=function(e){var t=e.urlToken,n=e.keyWords,r=e.onChange,o=e.defaultConfig,i=(0,eM.useDispatch)(),a=(0,b.useRef)(o.nextRequest||null),c={totals:0,isEnd:!1,next:null},s=(0,j._)((0,b.useState)(!0),2),l=s[0],u=s[1],d=(0,j._)((0,b.useState)(!1),2),p=d[0],h=d[1],f=(0,j._)((0,b.useState)(o.questionList||[]),2),_=f[0],m=f[1],T=(0,j._)((0,b.useState)(c),2),E=T[0],C=T[1],y=(0,j._)((0,b.useState)(o),2),S=y[0],I=y[1],A=E.isEnd,Z=function(){p||(h(!0),i((0,ns.sOG)(a.current||"creators/search/query",!a.current&&{query:n,no_answer:1,no_draft:1})).then(function(e){var t=e.payload,r=t.paging,o=t.data;if(C(r=r||(0,U._)((0,B._)({},c),{totals:o.length||0,isEnd:!0})),null==S?void 0:S.checkedItem){var i=(0,g._)(o);(null==S?void 0:S.keyword)===n&&(i=o.filter(function(e){var t;return(null==e?void 0:null===(t=e.question)||void 0===t?void 0:t.id)!==S.checkQuestionId})),m((0,g._)((null==r?void 0:r.isStart)?[(0,U._)((0,B._)({},S.checkedItem),{checked:!0})]:_).concat((0,g._)(i)))}else m((0,g._)((null==r?void 0:r.isStart)?[]:_).concat((0,g._)(o)));h(!1),a.current=r.next},function(e){if((null==e?void 0:e.status)===403)throw Error("请求失败，请稍后重试");throw Error("发生未知错误，请稍后重试")}).catch(function(){return h(!1)}))},w=function(){h(!0),i((0,ns.oEW)(t)).then(function(e){m(e.payload.data||[]),h(!1)}).catch(function(){return h(!1)})},R=function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(l&&(null==o?void 0:null===(e=o.questionList)||void 0===e?void 0:e.length)){m(null==o?void 0:o.questionList),u(!1);return}t?w():Z()},N=function(){a.current=null,m([]),h(!1)};(0,b.useEffect)(function(){n&&!l&&(N(),R()),!n&&l&&R(!0),u(!1)},[n]);var k=function(e,t){var o=_.map(function(e){return(0,U._)((0,B._)({},e),{checked:!1})});o[t].checked=!_[t].checked;var i="",c={};if(o[t].checked){var s,l=o[t];o.splice(t,1),o.unshift(l),i=null==e?void 0:null===(s=e.question)||void 0===s?void 0:s.id,c={questionList:o,nextRequest:a.current,keyword:n,checkQuestionId:i||"",checkedItem:e}}I(c),r&&r(i||"",c),m(o)},O=_.map(function(e,r){return(0,v.tZ)(h7,{item:e,index:r,isSearch:!0,isArticleToAnswer:!0,keyWords:n,urlToken:t,onChange:k},"".concat(e.question.id,"+").concat(r))}),x=(0,v.tZ)(pF.O,{variant:"T01",height:120});return(0,v.BX)(oX.Box,{children:[(0,v.tZ)(fe,{}),(0,v.BX)(oX.Box,{className:"Box-Wrap",css:{height:"305px",overflowY:"scroll","& .skeleton":{padding:"20px 0"}},children:[(0,v.tZ)(oX.Box,{children:n?(0,v.tZ)(lH.ZP,{onLoad:Z,isLoading:p,placeholder:x,isDrained:A,getContainer:function(e){return e.parentElement.parentElement},children:O}):p?x:O}),!p&&!_.length&&(0,v.tZ)(cb.H.EI1,{image:"default",content:"暂无相关推荐问题，去搜索试试 ~"})]})]})};h8.proptypes={urlToken:oF().string,keyWords:oF().string,onChange:oF().func,defaultConfig:oF().object},n(36374),oF().bool,oF().func,oF().string,oF().string,oF().array;var h9=function(e){var t=e.totals,n=(0,b.useMemo)(function(){return[{width:415,text:"推荐问题 ".concat(t?(0,i1.uf)(t):"")},{width:130,text:"浏览增量"},{width:131,text:"操作",css:{textAlign:"center"}}]},[t]);return(0,v.tZ)(h0,{list:n})};h9.prototypes={totals:oF().number};var fe=h9,ft=n(79107),fn=function(e){var t=e.label,n=e.handleDeleteData;return"搜索历史"===t?(0,v.tZ)(aU,{onDelete:n,label:t}):(0,v.tZ)("div",{onMouseDown:function(e){return e.preventDefault()},role:"button",tabIndex:0,className:"Creator-SearchBar-label",children:t})},fr=function(e){var t=e.item,n=e.handleDeleteData,r=e.handleReportShow,o=t.type,i=t.data,a=t.index,c=t.rawSearchResult,s=null;switch(o){case"topSearch":s=(0,v.tZ)(aq,{index:a,query:i});break;case"history":var l=t.data;s=(0,v.tZ)(aL,{data:l,index:a,onDelete:n,rawSearchResult:c});break;case"suggest":s=(0,v.tZ)(az,{data:i,index:a,rawSearchResult:c});break;case"reports":s=(0,v.tZ)(aM,{handleReportShow:r})}return s||null},fo=function(e,t){return e.map(function(e,n){return(0,B._)({id:null==e?void 0:e.rawId,index:n,data:(null==e?void 0:e.displayQuery)||(null==e?void 0:e.query)||e,query:(null==e?void 0:e.query)||e},t)})},fi={topSearch:"知乎热搜",history:"搜索历史"},fa=function(e){var t,n=e.outCss,r=e.query,o=e.placeholder,i=e.currentUserId,a=e.onFocus,c=e.onSelect,s=e.onSubmit,l=e.ignoreHotWord,u=void 0!==l&&l,d=e.customSearchStyle,p=void 0!==d&&d,h=(0,eM.useDispatch)(),f=r.q,_=(0,b.useRef)(null),m=(0,b.useRef)(null),T=(0,j._)((0,b.useState)(null),2),E=T[0],C=T[1],y=(0,j._)((0,b.useState)({topSearch:[],history:[],suggest:[]}),2),S=y[0],I=y[1],A=(0,j._)((0,b.useState)(!1),2),Z=A[0],w=A[1],R=E&&!p,N=function(){return aV(i)},k=function(e){return aX(N(),e)},x=function(e){var t=e.topSearchData,n=e.historyData,r=e.suggestData,o=void 0===r?[]:r;if(m.current.inputNode.value)return I((0,B._)({suggest:o},o.length>0&&{reports:[{type:"reports"}]}));var i=S.topSearch,a=S.history;return I((0,B._)({},t?{topSearch:fo(t,{type:"topSearch"})}:{topSearch:void 0===i?[]:i},n?{history:fo(n,{type:"history"})}:{history:void 0===a?[]:a}))},P=function(){var e=k(),t=aj(),n=function(t){x({topSearchData:(0,g._)(t),historyData:e})};return u?n([]):t?n(t):h({API:{endpoint:"search/top_search",types:n4.GET_TOP_SEARCH},NOTIFICATION:!1}).then(function(e){var t=(e&&e.payload&&e.payload.topSearch||{}).words,n=(void 0===t?[]:t).map(function(e){return{displayQuery:e.displayQuery,query:e.query}}).slice(0,5);return O().set(aG,{words:n,timeStamp:new Date().getTime()}),n}).then(n)},D=function(e){var t=aK(function(){return h(n9(e))}),n=k(e);t().then(function(t){x({suggestData:n2()((0,g._)(fo(n,{type:"history",rawSearchResult:e})).concat((0,g._)(fo(t,{type:"suggest",rawSearchResult:e}))),function(e,t){var n=e.data,r=t.data;return n.toLowerCase()===r.toLowerCase()})})})},L=function(){var e=m.current.inputNode.value;null==s||s(e)},M=eQ()(function(e){return(C(e),e)?D(e):P()},300),G=function(e,t){e.stopPropagation(),x({historyData:aW(N(),t)})};return(0,b.useEffect)(function(){C(f)},[f]),(0,v.BX)(oX.Box,{css:n,children:[(0,v.BX)("form",{className:oV()("Creator-SearchBar-tool"),ref:_,onSubmit:function(e){return e.preventDefault()},children:[(0,v.tZ)(am,(0,U._)((0,B._)({autoSelect:!1,ref:m,labels:fi,groups:S,value:f||"",renderLabel:function(e){return(0,v.tZ)(fn,{label:e,handleDeleteData:G})},renderItem:function(e){return(0,v.tZ)(fr,{item:e,handleDeleteData:G,handleReportShow:function(){return w(!0)}})},inputProps:{type:"text",maxLength:100,grey:!0,placeholder:o,className:oV()("Creator-SearchBar-input",{"Creator-SearchBar-input-custom":u&&p}),after:(0,v.BX)(v.HY,{children:[R&&(0,v.tZ)(oX.Box,{width:"24px"}),(0,v.BX)(oQ.ZP,(0,U._)((0,B._)({className:"Creator-SearchBar-searchButton",preset:"primary",color:E||p?"blue":"grey"},E&&{onClick:L}),{"aria-label":"搜索",children:[(0,v.tZ)(is.J7,{size:18,center:!0,className:oV()("Creator-SearchBar-searchIcon",{hasValue:E})}),p&&(0,v.tZ)("span",{css:{marginLeft:"8px"},children:"搜索"})]}))]})},menuProps:{menuClassName:oV()("Creator-SearchBar-menu"),menuContainerClassName:"Creator-SearchBar-menuContainer",style:{width:null===(t=_.current)||void 0===t?void 0:t.getBoundingClientRect().width}},onFocus:function(){return(a&&a(),E)?D(E):P()},onSelect:function(e,t){null==c||c(t)}},E&&{onEnterInput:L}),{onChange:M})),R&&(0,v.tZ)(ft.C,{text:!0,css:function(e){return{color:e.colors.GBK07A,fontSize:"18px",cursor:"pointer",position:"absolute",top:"11px",right:"55px"}},onClick:function(){C(""),m.current.setState({value:""}),setTimeout(function(){m.current.inputNode.focus(),P()},50)}})]}),(0,v.tZ)(il.y,{type:"search_suggested_word",shown:Z,onClose:function(){return w(!1)},zaEnabled:!0,List:S.suggest})]})},fc=function(e){var t=(0,eG.Q4)().trackEvent,n=e.show,r=e.onClose,o=e.urlToken,i=e.onChange,a=((0,eM.useSelector)(eE.ib)||{}).id,c=(0,eM.useDispatch)(),s=(0,j._)((0,b.useState)(""),2),l=s[0],u=s[1],d=(0,j._)((0,b.useState)(!1),2),p=d[0],h=d[1],f=(0,j._)((0,b.useState)({}),2),_=f[0],m=f[1],g=(0,j._)((0,b.useState)({}),2),T=g[0],E=g[1],C=(0,j._)((0,b.useState)(""),2),y=C[0],S=C[1];(0,b.useEffect)(function(){return u((null==_?void 0:_.keyword)||""),S((null==_?void 0:_.checkedQuestionId)||""),function(){(null==_?void 0:_.questionList)||S("")}},[n]);var I=function(e){t({eventType:"Click",action:"Search",block:"ArticleToAnswerSearchInput",elementLocation:{type:"Input",text:"搜索".concat(e,"; 文章token: ").concat(o)}},{link:{url:window.location.href}})},A=function(e){u(e||""),I(e||"")};return(0,v.tZ)(aa.Z,{className:"QuestionSearchModal",title:"投稿至问题",onClose:r,size:"large",css:{width:"724px","& .Modal-content":{margin:"22px 0 5px"},"& .Creator-QuestionShared-title":{paddingRight:"65px"}},children:n&&(0,v.tZ)(eG.eV,{block:"QuestionRecommendSearchModal",children:(0,v.BX)(eG.Wi,{zaType:"Popup",zaText:"投稿至问题弹窗展示",children:[(0,v.tZ)(oX.Box,{textAlign:"center",children:(0,v.tZ)(fa,{outCss:{width:"400px",margin:"0 auto 16px"},currentUserId:a,query:{q:l},placeholder:"请输入关键词查找问题",onSelect:function(e){return A(null==e?void 0:e.query)},onSubmit:function(e){return A(e)}})}),(0,v.BX)(oX.Text,{textAlign:"center",mb:"16px",fontWeight:"400",fontSize:"14px",color:"GBK06A",children:["最多选择 1 个，已选择 ",y?1:0," 个"]}),(0,v.tZ)(h8,{urlToken:o,keyWords:l,defaultConfig:_,onChange:function(e,t){S(e),E((0,U._)((0,B._)({},t),{checkedQuestionId:e}))}}),(0,v.tZ)(oX.Box,{textAlign:"center",children:(0,v.tZ)(eG.$U,{zaType:"Button",zaText:"".concat(l?"搜索".concat(l):"算法","; 文章token: ").concat(o,"; 问题id: ").concat(y),zaBlock:"RecommendQuestionChoose",children:(0,v.tZ)(oQ.ZP,{icon:p&&cZ.Z,onClick:function(){if(!y){m({}),i(""),r();return}h(!0),c((0,ns.Skx)(o,y)).then(function(e){var t=(null==e?void 0:e.payload)||{},n=t.isAllowPublish,o=t.hasAnswer,a=t.hasDraft,s=t.disableReason;if(h(!1),n||a){i(y),m(T),r();return}if(o){c((0,tD.c0)("已发布回答，请换个问题哦")),m({}),i("");return}c((0,tD.c0)(s))})},disabled:p,preset:"primary",color:"blue",css:{width:"218px",marginTop:"40px"},children:"确定"})})})]})})})};fc.proptypes={show:oF().bool,onClose:oF().func,onChange:oF().func,urlToken:oF().string};var fs=function(e){var t,n,r=e.urlToken,o=e.onChange,i=e.style,a=e.disabled,c=(0,j._)((0,b.useState)(!1),2),s=c[0],l=c[1],u=(0,j._)((0,b.useState)("未选择"),2),d=u[0],p=u[1],h=(0,iv.Z1)();return(null==h?void 0:null===(t=h.commands)||void 0===t?void 0:null===(n=t.contribute)||void 0===n?void 0:n.instruction)?null:(0,v.BX)(oX.Box,{css:i,children:[(0,v.BX)(oX.Flex,{py:"11px",children:[(0,v.tZ)(hZ.gN,{name:"投稿至问题",helper:(0,v.BX)("div",{css:{p:{textIndent:0}},children:[(0,v.tZ)("p",{children:"1.含好物卡片、知+ 等卡片的文章不支持投稿至问题"}),(0,v.tZ)("p",{children:"2.超过发文限制的文章不支持持投稿至问题"})]})}),(0,v.tZ)(eG.$U,{zaType:"Button",zaText:"投稿至问题",zaBlock:"ArticleToAnswerSelect",shouldTrackShow:!0,children:(0,v.tZ)(hZ.Qr,{onClick:function(){return l(!0)},text:d,disabled:a})})]}),(0,v.tZ)(fc,{urlToken:r,onClose:function(){return l(!1)},show:s,onChange:function(e){p(e?"已选 1 个问题":"未选择"),o&&o(e)}})]})};fs.proptypes={urlToken:oF().string,onChange:oF().func,style:oF().object};var fl=(0,b.forwardRef)(function(e,t){var n=e.disclaimerInfo,r=e.articleDisclaimers,o=(0,eG.Q4)().trackEvent,i=(0,j._)((0,b.useState)({type:"none",description:"无声明"}),2),a=i[0],c=i[1],s=JSON.parse(JSON.stringify(r));s.push({type:"none",description:"无声明"});var l=!!n;return(0,b.useEffect)(function(){l&&c(n)},[l]),(0,b.useImperativeHandle)(t,function(){return{getReshipmentDisclaimers:function(){return a}}}),(0,v.tZ)(hZ.Qr,{onChange:function(e){var t=s.find(function(t){return t.type===e});o({eventType:"Click",action:"Unknown",elementLocation:{type:"Button",text:"创作声明-".concat(t.description)}}),t&&c(t)},value:a.type,children:s.map(function(e){return(0,v.tZ)(hZ.o3,{value:e.type,text:e.description},e.type)})})}),fu=(0,b.forwardRef)(function(e,t){return(0,v.BX)(oX.Flex,{py:"11px",children:[(0,v.tZ)(hZ.gN,{name:"创作声明",helper:(0,v.BX)(v.HY,{children:[(0,v.tZ)("p",{children:"「创作声明」是为自己创作的添加个人声明的工具。当你在创作特定内容（如内容存在虚构或剧透等情节）时，可设置创作声明，该声明将会展示在回答或文章开头。"}),(0,v.tZ)("p",{children:"创作声明表达的是创作者对内容负责的态度。知乎鼓励创作者设置创作声明，以方便知友更好地辨识和理解内容信息。你也可以在编辑内容时，关闭创作声明。"})]})}),(0,v.tZ)(oX.Box,{flex:"1",children:(0,v.tZ)(fl,(0,U._)((0,B._)({},e),{ref:t}))})]})}),fd=n(27349),fp={enter:13,space:32},fh=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){return(0,q._)(this,n),t.apply(this,arguments)}return(0,V._)(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=(0,K._)(e,["className"]);return(0,v.tZ)(oQ.ZP,(0,B._)({className:oV()("Button Button--plain",t)},n))}}]),n}(b.Component);function ff(e){return(0,v.tZ)("li",(0,U._)((0,B._)({},e),{className:oV()("ColumnMenu-item",e.className)}))}var f_=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{isOpen:!1,expand:!1}),(0,X._)((0,oL._)(e),"handleMenuClick",function(t){"INPUT"!==t.target.nodeName&&e.toggle()}),(0,X._)((0,oL._)(e),"handleMenuKeyDown",function(t){(t.keyCode===fp.enter||t.keyCode===fp.space)&&(e.toggle(),t.preventDefault())}),(0,X._)((0,oL._)(e),"handleWrapperMouseenter",function(){e.toggle(!0)}),(0,X._)((0,oL._)(e),"handleWrapperMouseleave",function(){e.toggle(!1)}),(0,X._)((0,oL._)(e),"handleDocClick",function(t){!e.state.isOpen||e.wrapperNode.contains(t.target)||(e.toggle(!1),t.stopPropagation(),t.preventDefault())}),(0,X._)((0,oL._)(e),"createButton",function(){var t=e.props,n=t.trigger,r=t.children,o=e.props.button;return o||b.Children.forEach(r,function(e){e&&e.type===fh&&(o=e)}),(0,b.cloneElement)(o,{className:oV()("MenuButton MenuButton-listen-".concat(n),o.props.className),onKeyDown:e.handleMenuKeyDown,ref:function(t){e.buttonRef=t}})}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){this.buttonNode=eN().findDOMNode(this.buttonRef);var e=this.props,t=e.trigger,n=e.autoHide;"click"===t?(this.buttonNode.addEventListener("click",this.handleMenuClick),this.dropdownNode.addEventListener("click",this.handleMenuClick),document.addEventListener("click",this.handleDocClick,!0)):(this.wrapperNode.addEventListener("mouseenter",this.handleWrapperMouseenter),this.wrapperNode.addEventListener("mouseleave",this.handleWrapperMouseleave),n&&this.dropdownNode.addEventListener("click",this.toggle.bind(this,!1)))}},{key:"componentWillUnmount",value:function(){"click"===this.props.trigger?(this.buttonNode.removeEventListener("click",this.handleMenuClick),this.dropdownNode.removeEventListener("click",this.handleMenuClick),document.removeEventListener("click",this.handleDocClick,!0)):(this.wrapperNode.removeEventListener("mouseenter",this.handleWrapperMouseenter),this.wrapperNode.removeEventListener("mouseleave",this.handleWrapperMouseleave)),clearTimeout(this.timer)}},{key:"toggle",value:function(e){var t=this,r=e;"boolean"!=typeof e&&(r=!this.state.isOpen);var o=this.props,i=o.onOpen,a=o.onClose,c=o.delay;r?(this.setState({isOpen:r}),this.timer=setTimeout(function(){t.setState({expand:!0}),i.call(t)},c)):(this.setState({expand:!1}),this.timer=setTimeout(function(){t.setState({isOpen:r}),a.call(t)},n.TRANSITION_DELAY+c))}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.children,o=t.arrow,i=this.state,a=i.expand,c=i.isOpen;return(0,v.BX)("div",{className:oV()("ColumnMenu",a?"ColumnMenu--open":"",n),ref:function(t){return e.wrapperNode=t},children:[this.createButton(),(0,v.BX)("div",{className:"ColumnMenu-dropdown",style:{visibility:!c&&"hidden"},ref:function(t){return e.dropdownNode=t},children:[c&&(0,v.tZ)("ul",{className:"ColumnMenu-list",children:b.Children.map(r,function(e){return e?e.type===fh?null:e.type===ff?e:(0,v.tZ)(ff,{children:e}):e})}),o]})]})}}]),n}(b.Component);(0,X._)(f_,"TRANSITION_DELAY",200),(0,X._)(f_,"propTypes",{trigger:oF().oneOf(["click","hover"]),onOpen:oF().func,onClose:oF().func,button:oF().element,arrow:oF().element,autoHide:oF().bool,delay:oF().number}),(0,X._)(f_,"defaultProps",{trigger:"click",onOpen:function(){},onClose:function(){},arrow:null,autoHide:!1,delay:50});var fm=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"onCompositionStart",function(){e.compositing=!0}),(0,X._)((0,oL._)(e),"onCompositionEnd",function(){e.compositing=!1,e.prevValue&&e.props.onChange(e.prevValue),e.prevValue=null}),(0,X._)((0,oL._)(e),"handleInputChange",function(t){var n=t.target.value;e.compositing?e.prevValue=n:e.props.onChange(n)}),e}return(0,V._)(n,[{key:"componentDidMount",value:function(){document.addEventListener("compositionstart",this.onCompositionStart),document.addEventListener("compositionend",this.onCompositionEnd)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd)}},{key:"render",value:function(){var e=this.props,t=e.menuButton,n=e.placeholder,r=e.friends,o=e.onClick,i=e.className,a=e.onOpen,c=e.onClose;return(0,v.BX)(f_,{preventCloseOnTarget:!0,trigger:"click",className:oV()("ColumnSearchMenu",i),button:t,onOpen:a,onClose:c,children:[(0,v.tZ)(a$.Z,{placeholder:n,className:"ColumnSearchMenu-searchInput",targetClassName:"preventCloseOnTarget",onChange:this.handleInputChange,before:(0,v.tZ)(is.J7,{text:!0})}),r&&r.map(function(e){return(0,v.tZ)(oQ.ZP,{preset:"plain",className:"ColumnSearchMenu-selectFriendsButton preventCloseOnTarget",onClick:function(t){return o(t,e)},children:(0,v.BX)("div",{className:"ColumnSearchMenu-friends preventCloseOnTarget",children:[(0,v.tZ)("img",{src:(0,p_.imgUrl)(e.avatarUrl,"m"),className:"ColumnSearchMenu-image preventCloseOnTarget",alt:"头像"}),(0,v.tZ)("span",{className:"preventCloseOnTarget",children:e.name})]})},e.id)})]})}}]),n}(b.Component);(0,X._)(fm,"propTypes",{menuButton:oF().node.isRequired,placeholder:oF().string.isRequired,friends:oF().arrayOf(oF().shape({id:oF().string.isRequired,avatarUrl:oF().string,name:oF().string.isRequired})),onChange:oF().func.isRequired,onClick:oF().func.isRequired,className:oF().string,onOpen:oF().func,onClose:oF().func});var fv=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{selectedColumn:null,isInvitedFriends:!1,selectedFriendList:[],isReviewInvite:!1}),(0,X._)((0,oL._)(e),"onClickSelectFriends",function(t,n){t.preventDefault(),e.props.resetFriends();var r=e.state.selectedFriendList;r.some(function(e){return e.id===n.id})||e.setState({selectedFriendList:(0,g._)(r).concat([n])})}),(0,X._)((0,oL._)(e),"createDeleteFriendHandler",function(t){return function(n){n.preventDefault(),e.setState(function(e){return{selectedFriendList:e.selectedFriendList.filter(function(e){return e.id!==t.id})}})}}),(0,X._)((0,oL._)(e),"createSelectColumnHandler",function(t){return function(n){n.preventDefault(),e.setState({selectedColumn:t})}}),(0,X._)((0,oL._)(e),"handleRemoveSelectedColumn",function(t){t.preventDefault(),e.setState({selectedColumn:null})}),(0,X._)((0,oL._)(e),"handleSelectFriends",function(){e.setState(function(e){return{isInvitedFriends:!e.isInvitedFriends}})}),(0,X._)((0,oL._)(e),"handleReviewButton",function(){var t=e.state,n=t.selectedFriendList,r=t.selectedColumn,o=r&&r.id,i=n.map(function(e){return e.urlToken});if(i.length||o){var a=e.props,c=a.postId,s=a.reviewColumn,l=a.handleOpenReviewComment;s(o,c,i).then(function(){e.setState({isReviewInvite:!0}),l()}).catch(uU())}}),(0,X._)((0,oL._)(e),"requestMyFriends",(0,hf.Z)(function(t){(0,e.props.fetchMyFriends)(t)},u5.Ij)),e}return(0,V._)(n,[{key:"renderFriendList",value:function(){var e=this,t=this.state.selectedFriendList;return(0,v.BX)("div",{children:[t&&t.length>0&&(0,v.tZ)("span",{className:"ReviewPanel-friend",children:t.map(function(t,n){return(0,v.BX)("div",{className:"ReviewPanel-selectFriend",children:[(0,v.tZ)(iZ.qE,{url:t.avatarUrl,size:36}),(0,v.tZ)(oQ.ZP,{onClick:e.createDeleteFriendHandler(t),preset:"plain",children:(0,v.tZ)(aR.HN,{})})]},n)})}),(0,v.tZ)(fh,{className:"ReviewPanel-selectButton",children:(0,v.tZ)(fd.Qk,{size:40})})]})}},{key:"renderReviewerSection",value:function(){var e=this.props,t=e.friends,n=e.resetFriends,r=this.state.isInvitedFriends;return(0,v.BX)("div",{className:"ReviewPanel-section ReviewPanel-inviteColumn",children:[(0,v.BX)("div",{role:"button",tabIndex:0,className:oV()("ReviewPanel-sectionTitle","ReviewPanel-selectFriends",r&&"ReviewPanel-selectFriends-transform"),onClick:this.handleSelectFriends,children:["相互关注的知乎好友",(0,v.tZ)(dP.f,{})]}),r&&(0,v.tZ)(fm,{placeholder:"搜索相互关注的好友",menuButton:this.renderFriendList(),onChange:this.requestMyFriends,onClick:this.onClickSelectFriends,onClose:n,friends:t})]})}},{key:"renderColumnSection",value:function(){var e=this,t=this.props.columns,n=this.state.selectedColumn;return(0,v.BX)("div",{className:"ReviewPanel-section ReviewPanel-inviteColumn",children:[(0,v.tZ)("div",{className:"ReviewPanel-sectionTitle",children:"你所在专栏的编辑"}),!!n&&(0,v.BX)("div",{className:"ReviewPanel-selectedColumn",children:[(0,v.tZ)(iZ.qE,{url:n.imageUrl,size:36}),(0,v.tZ)(oQ.ZP,{onClick:this.handleRemoveSelectedColumn,preset:"plain",children:(0,v.tZ)(aR.HN,{})})]}),!n&&(0,v.tZ)(f_,{preventCloseOnTarget:!0,trigger:"click",className:"ReviewPanel-selectColumnMenu",button:(0,v.tZ)(fh,{className:"ReviewPanel-selectButton",children:(0,v.tZ)(fd.Qk,{size:40})}),children:t&&t.map(function(t,n){return(0,v.BX)(oQ.ZP,{preset:"plain",className:"preventCloseOnTarget",onClick:e.createSelectColumnHandler(t),children:[(0,v.tZ)(iZ.qE,{url:t.imageUrl,size:36,className:"ReviewPanel-columnName"}),t.title]},n)})})]})}},{key:"render",value:function(){var e=this.state,t=e.selectedColumn,n=e.isReviewInvite,r=e.selectedFriendList;return(0,v.tZ)("div",{className:"ReviewPanel",children:n?(0,v.BX)("div",{className:"ReviewPanel-wrapper",children:[(0,v.tZ)("div",{className:"ReviewPanel-title",children:"邀请"}),(0,v.BX)("div",{className:"ReviewPanel-review",children:[(0,v.tZ)(d4.BS,{size:40,className:"ReviewPanel-reviewIcon"}),(0,v.tZ)("p",{children:r.length>0||t?"邀请预览已发出":"已取消预览邀请"})]})]}):(0,v.BX)("div",{className:"ReviewPanel-wrapper",children:[(0,v.tZ)("div",{className:"ReviewPanel-title",children:"邀请"}),(0,v.tZ)("div",{className:"ReviewPanel-description",children:"邀请专栏编辑或好友来预览这篇草稿，他们将可通过草稿评论给出意见。"}),this.renderColumnSection(),this.renderReviewerSection(),(0,v.tZ)("div",{className:"ReviewPanel-button preventCloseOnTarget",children:(0,v.tZ)(oQ.ZP,{color:"blue",className:"preventCloseOnTarget",onClick:this.handleReviewButton,children:"确定"})})]})})}}]),n}(b.Component);(0,X._)(fv,"propTypes",{columns:oF().arrayOf(hw),postId:oF().number.isRequired,handleOpenReviewComment:oF().func.isRequired});var fg=(0,e5.compose)((0,af.Z)(null),(0,eM.connect)(function(e){return{friends:e.columnAutocomplete.friends}},{fetchMyFriends:function(e){return{API:{types:ov.FETCH_MY_FRIENDS,endpoint:"autocomplete/friends",query:{token:e,max_matches:5,use_similar:0},root:x.Z.fetchRoot.zhuanlan}}},reviewColumn:function(e,t,n){return{API:{types:r6,endpoint:"articles/".concat(t,"/review"),root:x.Z.fetchRoot.zhuanlan,method:"POST",body:{column:e||null,users:n}}}},resetFriends:function(){return{type:ov.RESET_FRIENDS}}}))(fv);function fT(){var e=(0,lQ._)(["\n                font-size: 14px;\n                color: ",";\n              "]);return fT=function(){return e},e}function fE(){var e=(0,lQ._)(["\n                line-height: 40px;\n                white-space: nowrap;\n                &.MenuItem-Share {\n                  padding-left: 0;\n                  padding-right: 0;\n                }\n              "]);return fE=function(){return e},e}var fC=function(e){var t=e.draftId,n=e.getEditableInstance,r=e.handleOpenReviewComment,o=e.columns,i=e.contentIsTooShort,a=e.showErrorMessage,c=(0,K._)(e,["draftId","getEditableInstance","handleOpenReviewComment","columns","contentIsTooShort","showErrorMessage"]),s=(0,o2.F)(),l=(0,j._)((0,cC.Z)(),2),u=l[0],d=l[1],p=(0,iy.Z)(function(){var e,r=null===(e=n())||void 0===e?void 0:e.hasCatalog();window.open("/p/".concat(t,"/preview?comment=0&catalog=").concat(r?1:0),"_blank")});return(0,v.BX)(v.HY,{children:[(0,v.tZ)(eB.ms,{children:function(e){var t=e.css;return(0,v.BX)(u0.ZP,{positionStatus:"fixed",toggler:(0,v.tZ)(eG.$U,(0,U._)((0,B._)({as:oQ.ZP,zaType:"Button",zaText:!0,color:"grey",preset:"secondary",css:{marginLeft:"24px"}},c),{children:"预览"})),onClick:function(e){if(i)return e.preventDefault(),a("正文至少输入 ".concat(9," 个字"))},arrowed:!1,reversed:!0,menuClassName:t(fT(),s.colors.GBL05A),itemClassName:t(fE()),css:{marginLeft:"20px"},children:[(0,v.tZ)(eG.$U,{as:u0.sN,zaText:!0,zaType:"Button",zaAction:"Unknown",onClick:p,children:"电脑预览"}),(0,v.tZ)(eG.$U,{as:u0.sN,zaText:!0,zaType:"Button",zaAction:"Unknown",onClick:d.on,children:"邀请预览"})]},"settings")}}),(0,v.tZ)(e4.Z,{css:{width:"auto",".Modal-inner":{overflow:"visible"},".Modal-content":{paddingBottom:"16px"}},onClose:d.off,children:u&&(0,v.tZ)(fg,{postId:t,columns:o,handleOpenReviewComment:r})})]})},fy=n(9539),fS=n(61514),fI=function(e){var t=e.scheduledPublishAt,n=e.initialScheduledPublishAt,r=e.setUseScheduledPublish,o=(0,eG.Q4)().trackEvent,i=!!t,a=function(e){o({eventType:"Click",action:"Unknown",elementLocation:{type:"Button",text:e?"使用定时发布":"不使用定时发布"}}),r(e)};return(0,v.BX)(oX.Box,{color:"GBL05A",flex:"1",css:{fontSize:"14px"},children:[(0,v.BX)(oX.Flex,{height:"38px",children:[(0,v.tZ)(hZ.KT,{checked:!i,text:"不使用定时发布",onChange:function(){return a(!1)},id:"PublishPanel-scheduleLabel-0"}),(0,v.tZ)(hZ.KT,{checked:i,text:"使用定时发布",onChange:function(){a(!0),requestAnimationFrame(function(){(0,cP.X5)(window,{top:document.body.scrollHeight,behavior:"smooth"})})},id:"PublishPanel-scheduleLabel-1"})]}),i&&n&&(0,v.tZ)(fS.Z,{value:t,min:n,max:fy.Z(n,7),onChange:function(e){r(!0,e)},css:function(e){return{color:e.colors.GBL05A,fontSize:"14px",marginTop:"5px",".InputButton":{height:"38px"}}}})]})},fb=function(e){return(0,v.BX)(oX.Flex,{py:"11px",children:[(0,v.tZ)(hZ.gN,{name:"定时发布"}),(0,v.tZ)(fI,(0,B._)({},e))]})},fA=n(75798),fZ=n(3426),fw=function(e){return{display:"flex",alignItems:"center",minWidth:180,height:38,border:"1px solid",borderColor:e.colors.GBK09A,background:e.colors.GBK99A,boxSizing:"border-box",borderRadius:"4px",marginRight:"20px"}},fR=function(e){return(0,v.tZ)(a$.Z,(0,B._)({placeholder:"搜索话题...","aria-label":"搜索话题",before:(0,v.tZ)(is.J7,{text:!0,css:function(e){return{color:e.colors.GBK06A,marginRight:"6px"}}}),css:function(e){return[fw(e),{paddingRight:"0","input.Input::placeholder":{color:e.colors.GBK07A}}]}},e))},fN=function(e){return(0,v.BX)("button",(0,U._)((0,B._)({css:function(e){return[fw(e),{color:e.colors.GBK03A,justifyContent:"center"}]}},e),{children:[(0,v.tZ)(hR.nY,{size:"14px",css:{marginRight:"2px"}}),"添加话题"]}))},fk=function(e){return(0,v.tZ)("button",(0,B._)({css:function(e){return{display:"flex",alignItems:"center",minWidth:"180px",boxSizing:"border-box",height:40,color:e.colors.GBK02A,fontSize:"14px",paddingLeft:"19px","&:hover":{backgroundColor:e.colors.GBK10A}}}},e))},fO=(0,b.forwardRef)(function(e,t){var n,r=e.draft,o=e.showErrorMessage,i=(0,eG.Q4)().trackEvent,a=(0,eM.useDispatch)(),c=(0,j._)((0,cC.Z)(!1),2),s=c[0],l=c[1],u=(0,b.useRef)(null),d=(0,b.useRef)(""),p=(0,j._)((0,b.useState)([]),2),h=p[0],f=p[1],_=(0,j._)((0,b.useState)([]),2),m=_[0],T=_[1],E=(0,j._)((0,fA.Z)({once:!0}),2),C=E[0],y=E[1],S=s&&h.length<3,I=(0,iy.Z)(function(e){var t=e.target.value;d.current!==t&&(a(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{token:e,API:{types:ov.FETCH_TOPICS,endpoint:"autocomplete/topics",query:{token:e,max_matches:5,use_similar:0,topic_filter:1},root:x.Z.fetchRoot.zhuanlan}}}(t)).then(function(e){var t=e.payload,n=e.token;d.current===n&&T(t.data)}),d.current=t)}),A=(null===(n=r.topics)||void 0===n?void 0:n.length)>0;(0,b.useEffect)(function(){A&&f(r.topics)},[A]);var Z=(0,iy.Z)(function(){var e=r.state,t=r.topics,n=r.id;if(!((null==h?void 0:h.length)>0)){if("published"===e){f(t);return}"draft"===e&&a({API:{types:ot,endpoint:"/articles/".concat(n,"/recommend_topics")}}).then(function(e){return Promise.all((e.payload.data||[]).slice(0,3).map(function(e){return a(ou(n,e)).catch(uU())}))}).then(function(e){f(e.filter(Boolean).map(function(e){return e.payload}))}).catch(o)}});return(0,b.useEffect)(function(){y&&Z()},[y,Z]),(0,b.useImperativeHandle)(t,function(){return{getSelectedTopics:function(){return h}}}),(0,v.BX)(oX.Box,{color:"GBL05A",flex:"1",css:{fontSize:"14px"},ref:C,children:[(0,v.BX)(oX.Flex,{children:[h.map(function(e,t){return(0,v.BX)(oX.Box,{css:fw,children:[(0,v.tZ)(oX.Text,{ml:"10px",css:(0,sk.S)(1),children:e.name}),(0,v.tZ)(hZ.Tw,{onClick:function(){var t,n;a((t=r.id,n=e.id,{API:{types:oe,endpoint:"articles/".concat(t,"/topics/").concat(n),root:x.Z.fetchRoot.zhuanlan,method:"DELETE"}})).then(function(){f(function(t){return t.filter(function(t){return t.id!==e.id})})}).catch(uU())}})]},t)}),(0,v.tZ)(fR,{onChange:I,onRef:u,after:(0,v.tZ)(hZ.Tw,{onClick:l.toggle}),css:!S&&{display:"none"}}),h.length+s<3&&(0,v.tZ)(fN,{onClick:function(){return!s&&l.toggle()}})]}),(0,v.tZ)(fZ.Z,{isOpen:S&&m.length>0,placement:"bottom",arrowed:!1,target:u.current,children:(0,v.tZ)(oX.Box,{css:function(e){return{minWidth:"180px",backgroundColor:e.colors.GBK99A,border:"1px solid",borderColor:e.colors.GBK09A,boxShadow:"0px 5px 20px rgba(26, 26, 26, 0.1)",borderRadius:"4px",padding:"8px 0"}},children:m.map(function(e){return(0,v.tZ)(fk,{onClick:function(t){if(t.preventDefault(),h.some(function(t){return t.name===e.name})){d.current="",T([]),u.current.value="";return}i({eventType:"Click",action:"Unknown",elementLocation:{type:"Button",text:"话题-".concat(e.name)}}),a(ou(r.id,e)).then(function(e){var t=e.payload;t&&(d.current="",T([]),f(function(e){return(0,g._)(e).concat([t])}),u.current.value="",l.off())}).catch(uU())},children:e.name},e.id)})})})]})}),fx=(0,b.forwardRef)(function(e,t){return(0,v.BX)(oX.Flex,{py:"11px",children:[(0,v.tZ)(hZ.gN,{required:!0,name:"文章话题",helper:(0,v.tZ)("p",{children:"绑定合适的话题，能方便分类检索，文章也更容易让读者发现。"})}),(0,v.tZ)(fO,(0,U._)((0,B._)({},e),{ref:t}))]})});function fP(){var e=(0,lQ._)(["字数：",""]);return fP=function(){return e},e}var fD=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){(0,q._)(this,n),r=t.apply(this,arguments),(0,X._)((0,oL._)(r),"state",{submitting:!1}),(0,X._)((0,oL._)(r),"zaRef",(0,b.createRef)());var e,r,o=(0,oL._)(r);(0,X._)((0,oL._)(r),"publishArticle",(e=(0,iE._)(function(e,t,n){var r,i,a,c,s,l,u,d,p,h,f,_,m,v;return(0,iC.__generator)(this,function(g){switch(g.label){case 0:return u=(l=o.props).currentUser,d=l.draft,p=l.scheduledPublishAt,h=l.getEditableInstance,f=l.publishArticle,_=(o.state||{}).checkedQuestionId,m=o.zaRef.current.trackEvent,v=h(),[4,f(d.id,e,{isNew:t,hasColumn:n,hasFormula:!!(null==v?void 0:null===(r=v.hasFormula)||void 0===r?void 0:r.call(v)),isRecommend:_||o.isHasCard,reshipmentDisclaimers:o.disclaimersRef.getReshipmentDisclaimers(),scheduledPublishAt:p,hasCatalog:null==v?void 0:v.hasCatalog(),autoSendingCreations:u.autoSendingCreations,commercial_report_info:{is_report:null===(i=o.commercialReportRef)||void 0===i?void 0:i.getIsReport(),commercial_types:[]},commercial_zhitask_bind_info:(0,hb.at)(o.commercialZhitaskBindInfo),content_source:(0,hH.u)(null===(a=o.state)||void 0===a?void 0:a.contentSourceInfo)},{content:o.props.realTimeContent,imageCount:(null===(c=null==v?void 0:v.getImages())||void 0===c?void 0:c.size)||0,videoCount:(null===(s=null==v?void 0:v.getVideos())||void 0===s?void 0:s.size)||0})];case 1:if(g.sent(),m({action:"Post",eventType:"Click",elementLocation:{type:"Button",moduleId:"published_successful",content:{type:"Post",token:String(d.id)}}},{configMap:{traceId:o.props.traceId}}),t&&O().set("showEditorTipModal",!0),!(!p&&_&&!o.isHasCard))return[3,3];return[4,o.publishAnswer()];case 2:g.sent(),g.label=3;case 3:return[2]}})}),function(t,n,r){return e.apply(this,arguments)}));var i=(0,oL._)(r);return(0,X._)((0,oL._)(r),"publishAnswer",(0,iE._)(function(){var e,t;return(0,iC.__generator)(this,function(n){switch(n.label){case 0:return t=(e=i.props).draft,[4,(0,e.addAnswer)((i.state||{}).checkedQuestionId,{bizExt:{bindArticleToken:t.id},commentPermission:"all",commercialReportInfo:{isReport:!1},content:t.content,disclaimerStatus:"close",disclaimerType:"none",isReport:!1,pushActivity:!1,reshipmentSettings:"allowed",rewardSetting:{canReward:!1},tableOfContentsEnabled:!1,thankInviterStatus:"close"})];case 1:return n.sent(),[2]}})})),(0,X._)((0,oL._)(r),"handleSubmit",function(){var e=r.props,t=e.forceUpdateDraft,n=e.showErrorMessage,o=e.scheduledPublishAt,i=e.draft,a=e.getEditableInstance,c=e.selectedColumnId,s=e.columns;r.setState({submitting:!0});var l=(0,oL._)(r);t().then((0,iE._)(function(){var e,t,r;return(0,iC.__generator)(this,function(u){switch(u.label){case 0:if(l.props.contentIsTooShort)return[2,n("正文至少输入 ".concat(9," 个字"))];if(!(null===(e=l.topicsRef.getSelectedTopics())||void 0===e?void 0:e.length))return[2,n("请添加至少一个文章话题")];if(o&&hS.Z(o,p6.Z(new Date,30)))return iV.Z.alert((0,v.tZ)("div",{style:{textAlign:"center"},children:"只能设置 30 分钟后的定时时间"}),{title:"定时发布"}),[2];if(t=a()){if(t.hasVideo("upload"))return[2,n("视频上传完成后即可发布")];if(t.hasImage("upload"))return[2,n("图片上传完成后即可发布")];if(t.hasImage("error")||t.hasVideo("error")&&!t.hasVideo("error-review"))return[2,n("草稿中含有上传失败的内容，请更改后重新提交")];if(t.hasVideo("error-review")||t.hasVideo("censor"))return[2,n("视频中包含未通过审核的信息，请更改后重新提交")]}if("published"!==i.state)return[3,2];return[4,l.publishArticle()];case 1:return u.sent(),[2];case 2:if("draft"!==i.state)return[3,4];return r=c>0?s[c-1]:null,[4,l.publishArticle(r,!0,!!s.length)];case 3:u.sent(),u.label=4;case 4:return[2]}})})).finally(function(){r.setState({submitting:!1})})}),(0,X._)((0,oL._)(r),"handleReshipmentDisclaimers",function(e){r.setState({reshipmentDisclaimers:e}),oW.Z.trackEvent((0,oL._)(r),{id:7831,action:"Click"},{button:{text:e.description}})}),(0,X._)((0,oL._)(r),"handleSubmitContentSource",function(e){r.setState({contentSourceInfo:e})}),(0,X._)((0,oL._)(r),"renderContribution",function(){var e=r.props,t=e.draft,n=e.scheduledPublishAt,o=e.isContributionDisabled,i=t||{},a=i.id,c=i.state;return a&&"published"!==c?(0,v.tZ)(fs,{style:{display:n||r.isHasCard?"none":"block"},urlToken:String(a),onChange:function(e){return r.setState({checkedQuestionId:e})},disabled:o}):null}),(0,X._)((0,oL._)(r),"renderDisclaimers",function(){var e,t=r.props,n=t.articleDisclaimers,o=t.disclaimerLabel,i=t.draft.id;if(!i)return null;var a=null===(e=o["article_".concat(i)])||void 0===e?void 0:e.disclaimerInfo;return(0,v.tZ)(fu,{disclaimerInfo:a,articleDisclaimers:n,ref:function(e){return r.disclaimersRef=e}})}),(0,X._)((0,oL._)(r),"renderScheduledPublish",function(){var e=r.props,t=e.scheduledPublishAt,n=e.initialScheduledPublishAt,o=e.setUseScheduledPublish;return(0,v.tZ)(fb,{scheduledPublishAt:t,initialScheduledPublishAt:n,setUseScheduledPublish:o})}),(0,X._)((0,oL._)(r),"renderCommercialSetting",function(){var e,t,n=r.props,o=n.draft,i=n.id;return(0,v.tZ)(hA.Z,{type:"article",articleId:i,taskBindProps:{commercialZhitaskBindInfo:null===(e=o.settings)||void 0===e?void 0:e.commercialZhitaskBindInfo,onChange:function(e){return r.commercialZhitaskBindInfo=e}},reportProps:{commercialReportInfo:null===(t=o.settings)||void 0===t?void 0:t.commercialReportInfo,ref:function(e){return r.commercialReportRef=e}}})}),r}return(0,V._)(n,[{key:"isHasCard",get:function(){var e=this.props.draft;return/data-draft-type="mcn-link-card"|(data-draft-type="ad-link-card"(?! data-ad-id="fee_))/g.test(null==e?void 0:e.content)}},{key:"renderTopics",value:function(){var e=this,t=this.props,n=t.draft,r=t.showErrorMessage;return n.id?(0,v.tZ)(fx,{draft:n,showErrorMessage:r,ref:function(t){return e.topicsRef=t}}):null}},{key:"renderColumns",value:function(){return(0,v.tZ)(hF,{columns:this.props.columns})}},{key:"renderContentSource",value:function(){if(!this.props.draft.id)return null;var e=(this.state||{}).contentSourceInfo;return(0,v.tZ)(hz.Z,{handleSubmit:this.handleSubmitContentSource,originInfo:e})}},{key:"renderPreviewButton",value:function(){var e=this.props,t=e.disabled,n=e.draft,r=e.getEditableInstance,o=e.handleOpenReviewComment,i=e.columns,a=e.contentIsTooShort,c=e.showErrorMessage;return(0,v.tZ)(fC,{draftId:n.id,disabled:t,getEditableInstance:r,columns:i,handleOpenReviewComment:o,contentIsTooShort:a,showErrorMessage:c})}},{key:"renderSubmitButton",value:function(){var e=this.props,t=e.disabled,n=e.draft,r=e.scheduledPublishAt,o=e.isReediting,i=this.state.submitting?"发布中...":r?"定时发布":"draft"!==n.state&&n.state?"更新":"发布";return(0,v.tZ)(eG.$U,{as:oQ.ZP,zaType:"Button",zaText:!0,zaAction:"Post",zaModuleId:"published_button",extra:{configMap:{traceId:this.props.traceId,type:"Post",publish_type:o?"oldEdit":"newPublish"}},color:"blue",preset:"primary",onClick:this.handleSubmit,disabled:t||this.state.submitting,css:{marginLeft:"16px"},children:i})}},{key:"render",value:function(){var e=this.props,t=e.renderDraftText,n=e.realTimeContent,r=e.columns,o=e.canUseScheduledPublish,i=e.draft,a=e.logTime,c=e.updateDraft,s=e.markdownEnabled;return(0,v.BX)(eG.eV,{block:"PublishArea",children:[(0,v.tZ)(eG.pS,{ref:this.zaRef}),(0,v.tZ)(oX.Box,{bg:"GBK09A",css:{height:"1px"}}),(0,v.BX)(oX.Box,{css:function(e){return{background:e.colors.GBK99C}},children:[(0,v.tZ)(hZ.NZ,{children:"发布设置"}),(0,v.BX)(oX.Flex,{pb:"11px",children:[(0,v.tZ)(hZ.gN,{name:"添加封面"}),(0,v.tZ)(oX.Box,{flex:"1",children:(0,v.tZ)(hx,{image:i.titleImage,logTime:a,updateDraft:c})})]}),this.renderContribution(),this.renderDisclaimers(),this.renderTopics(),(null==r?void 0:r.length)>0&&(!i.state||"draft"===i.state)&&this.renderColumns(),this.renderContentSource(),this.renderCommercialSetting(),o&&this.renderScheduledPublish(),(0,v.tZ)(oX.Box,{bg:"GBK10A",height:"20px",mx:"-20px"}),(0,v.BX)(hZ.$_,{children:[(0,v.tZ)(oX.Text,{color:"GBL05A",fontSize:"14px",ml:"24px",children:l$()(fP(),(0,pm.Xs)(n,!0))}),s&&(0,v.tZ)(hI.Z,{}),(0,v.tZ)(oX.Text,{color:"GBL05A",fontSize:"14px",ml:"auto",children:t()}),this.renderPreviewButton(),this.renderSubmitButton()]})]})]})}}]),n}(b.Component);(0,X._)(fD,"propTypes",{columns:oF().arrayOf(hw),editable:oF().object,draft:oF().object.isRequired,disabled:oF().bool,forceUpdateDraft:oF().func.isRequired,showErrorMessage:oF().func.isRequired}),(0,X._)(fD,"defaultProps",{columns:[]});var fL=(0,e5.compose)((0,af.Z)(null),pj.SS,(0,eM.connect)(function(e){var t=e.articleDraft,n=t.selectedColumn,r=t.articleDisclaimers;return{currentUser:(0,eE.ib)(e),selectedColumnId:n,articleDisclaimers:r,disclaimerLabel:e.label}},{selectColumn:od,loadArticlesDisclaimers:ol,loadLabel:nZ.T$,addAnswer:te.oe}),function(e){return iI()(function(t){var n,r,o,i,a,c,s,l,u,d,p,h,f=(n=(0,lA.Dt)(),r=(0,j._)((0,iA.zb)(),1)[0],o=(0,hs.m5)(),i=(0,eM.useDispatch)(),a=(0,ib.u)("article",hU),c=(0,j._)((0,iA.zb)(),1)[0],s={publish:(0,iy.Z)(function(e,t,n){return c.safeRecordStageStart("pre-request"),a.publish(hL(e,t,n)).then(function(e){return{payload:null==e?void 0:e.publish}})}),scheduledPublish:(0,iy.Z)(function(e,t,n){return c.safeRecordStageStart("pre-request"),a.scheduledPublish(hL(e,t,n)).then(function(e){return{payload:null==e?void 0:e.publish}})})},l="1"===(0,hP.Z)("ws_publish_post",{mock:"1"})&&"1"===x.Z.apollo.content_publish_article,u=function(e,t){var r;return n.stash(hB,lA.KW.success),o.fire({type:"post-publish",context:{data:{publishAt:null==t?void 0:t.publish_at,content:null==e?void 0:null===(r=e.payload)||void 0===r?void 0:r.content}}}),e},d=function(e){var t,r;throw(!e.status||e.status>=500)&&n.reportFail(hB,e),o.fire({type:"post-publish",context:{error:e}}),(null==e?void 0:null===(t=e.payload)||void 0===t?void 0:t.code)===4031?iV.Z.alert((0,v.tZ)(p5,{}),{text:{ok:"我知道了"}}).then(uU()):i((0,tD.c0)(null==e?void 0:null===(r=e.payload)||void 0===r?void 0:r.message,"red")),e},h=(0,iy.Z)((p=(0,iE._)(function(e,t,a,c){var p,h,f,_,m,v,g,T,E,C,y,S,I,b,A;return(0,iC.__generator)(this,function(Z){var w;switch(Z.label){case 0:if(p=a.isNew,h=a.hasColumn,f=a.hasFormula,_=a.isRecommend,m=a.reshipmentDisclaimers,v=a.scheduledPublishAt,g=a.hasCatalog,T=a.autoSendingCreations,E=(0,K._)(a,["isNew","hasColumn","hasFormula","isRecommend","reshipmentDisclaimers","scheduledPublishAt","hasCatalog","autoSendingCreations"]),f&&n.reportRequest("HasFormula"),C=new URLSearchParams((0,B._)({},p&&{just_published:h?2:1},_&&{is_recommend:1})).toString(),y="".concat(C?"?":"").concat(C),r.safeRecordParamCollected("query",y),S=(null==m?void 0:m.type)||"none",I=(0,B._)({column:t,commentPermission:p?"anyone":void 0,disclaimer_type:S,disclaimer_status:"none"===S?"close":"open",table_of_contents_enabled:g},E),r.safeRecordParamCollected(),!v)return[3,2];return r.safeRecordStageStart("publish",{type:"scheduled publish",scheduledPublishAt:v,hitContentPublish:l}),b=(0,U._)((0,B._)({},I),{publish_at:Math.floor(v/1e3)}),[4,(l?s.scheduledPublish(e,b,p):i({API:{root:x.Z.fetchRoot.zhuanlan,types:r0.SCHEDULED_PUBLISH,endpoint:"articles/".concat(e,"/scheduled-publish"),method:"POST",body:b}})).then(function(e){return u(e,b)},d).then(hM).catch(function(e){r.safeReport(e,"catch in scheduledPublish")})];case 1:case 3:return Z.sent(),[2];case 2:if(w=(0,iE._)(function(){return(0,iC.__generator)(this,function(t){switch(t.label){case 0:var n,a;return r.safeRecordStageStart("publish",{type:"publish",hitContentPublish:l}),o.fire({type:"pre-publish",context:{content:c.content,imageCount:null==c?void 0:c.imageCount,videoCount:null==c?void 0:c.videoCount}}),[4,(l?s.publish(e,I,p):i((n=I,{API:{types:r7,endpoint:"articles/".concat(e,"/publish"),root:x.Z.fetchRoot.zhuanlan,method:"PUT",body:n},NOTIFICATION:!1}))).then(u,d).then((a="/p/".concat(e).concat(y),function(){oW.Z.trackCardShow(null,{id:7879}),location.href=a})).catch(function(e){r.safeReport(e,"catch in doPublish")})];case 1:return t.sent(),[2]}})}),A=function(){return w.apply(this,arguments)},T)return r.safeRecordStageStart("pre-publish",{type:"validate scheduled publish",autoSendingCreations:T}),i({API:{root:x.Z.fetchRoot.zhuanlan,types:r0.VALIDATE_SCHEDULED_PUBLISH,endpoint:"articles/".concat(e,"/scheduled-validate"),method:"POST",body:void 0},NOTIFICATION:!1}).then(A,function(e){var t;if((null==e?void 0:e.status)===400&&(null===(t=e.payload)||void 0===t?void 0:t.message))return iV.Z.confirm(e.payload.message,{title:"提醒",text:{ok:"确定发布",cancel:"我再想想"}}).then(A,function(){n.reportSuccess(hB)});r.safeReport(e,"catch in validateScheduledPublish")}),[2];return[4,A()]}})}),function(e,t,n,r){return p.apply(this,arguments)})),(0,b.useState)(function(){return r.wrapAutoReport(n.recordError(hB,h),{reportedBy:"auto report in publishHandler",freshReport:{type:"article",scene:hU}})})[0]);return(0,v.tZ)(e,(0,U._)((0,B._)({},t),{publishArticle:f}))},e)})(fD),fB=n(18341),fU=function(e){var t=e.editorState,n=e.onCommand,r=e.queryCommandEnable,o=e.queryCommandState,i=e.toolbarMainAreaData,a=e.toolbarMoreAreaData,c=e.toolbarFixtureAreaData,s=e.className;return(0,v.tZ)(fB.Z,{className:s,editorState:t,onCommand:n,queryCommandEnable:r,queryCommandState:o,toolbarMainAreaData:i,toolbarMoreAreaData:a,toolbarFixtureAreaData:c})},fM=n(62095),fG=n(1612),fF=function(e){var t=e.editorState,n=e.onCommand,r=e.queryCommandEnable,o=e.queryCommandState,i=e.showUserProfitButton,a=e.onInsertVideoClick,c=e.draftPage,s=e.getMarkdownEnabled,l=(0,fM.Z)().jumpUrl,u=(0,b.useMemo)(function(){return(0,fG.v$)({showProfit:i,onInsertVideoClick:a,isVideoAnswer:!1,shouldAdaptNative:"1"===x.Z.apollo.editor_adapt_native})},[i,a]),d=(0,b.useMemo)(function(){return(0,fG.vr)({draftPage:c})},[c]),p=(0,b.useMemo)(function(){return(0,fG.vi)({getMarkdownEnabled:s,onHandleManageEditClick:function(){return window.open(l)}})},[s,l]);return(0,v.tZ)(fU,{editorState:t,onCommand:n,queryCommandEnable:r,queryCommandState:o,toolbarMainAreaData:u,toolbarMoreAreaData:p,toolbarFixtureAreaData:d})},fz=n(60908),fH=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"state",{titleChangeStatus:!1,textContent:e.props.title}),(0,X._)((0,oL._)(e),"isFocused",!1),(0,X._)((0,oL._)(e),"resetCompositionStatus",function(){e.resetCompositionStatus.timerId=setTimeout(function(){(0,fz.Z)()},3e4)}),(0,X._)((0,oL._)(e),"cancelResetCompositionStatus",function(){void 0!==e.resetCompositionStatus.timerId&&(e.resetCompositionStatus.timerId=clearTimeout(e.resetCompositionStatus.timerId))}),(0,X._)((0,oL._)(e),"onCompositionStart",function(){if(!e.isFocused){e.cancelResetCompositionStatus(),e.resetCompositionStatus();return}e.composition=!0,e.handleChangeTitle.cancel()}),(0,X._)((0,oL._)(e),"onCompositionEnd",function(){if(!e.isFocused){e.cancelResetCompositionStatus();return}e.composition=!1,e.handleChangeTitle(e.prevValue||e.input.value),e.prevValue=null}),(0,X._)((0,oL._)(e),"onChangeTitle",function(t){e.props.logTime("start"),e.checkHeight();var n=t.target.value;e.setState({titleChangeStatus:!0,textContent:n}),e.composition?e.prevValue=n:e.handleChangeTitle(n)}),(0,X._)((0,oL._)(e),"handleChangeTitle",(0,hf.Z)(function(t){var n=e.props,r=n.logTime;(0,n.updateDraft)({title:t,delta_time:r("calculate")})},300)),(0,X._)((0,oL._)(e),"handleKeyDown",function(e){13===e.keyCode&&e.preventDefault()}),e}return(0,V._)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.state.titleChangeStatus,n=e.title;n&&this.props.title!==n&&!t&&(this.input.value=n,this.setState({textContent:n}),this.checkHeight())}},{key:"componentDidMount",value:function(){this.checkHeight(),document.addEventListener("compositionstart",this.onCompositionStart),document.addEventListener("compositionend",this.onCompositionEnd);var e=this.props.title;e&&(this.input.value=e)}},{key:"componentWillUnmount",value:function(){this.cancelResetCompositionStatus(),this.handleChangeTitle.cancel(),document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd)}},{key:"checkHeight",value:function(){if(this.input){this.input.style.height="1px";var e=Math.max(this.input.scrollHeight,44);this.input.style.height="".concat(e,"px")}}},{key:"render",value:function(){var e=this,t=this.props,n=t.onRef,r=t.className;return(0,v.BX)("div",{className:r,children:[(0,v.tZ)(a$.Z,{className:"WriteIndex-titleInput",multiline:!0,placeholder:"请输入标题（最多 ".concat(100," 个字）"),onChange:this.onChangeTitle,onRef:function(t){e.input=t,n(t)},onKeyDown:this.handleKeyDown,onFocus:function(){return e.isFocused=!0},onBlur:function(){return e.isFocused=!1},rows:"1"}),(0,v.tZ)(hg,{content:this.state.textContent,type:"title",onStatusChange:this.props.onLengthStatusChange})]})}}]),n}(b.Component);(0,X._)(fH,"propTypes",{title:oF().string,logTime:oF().func.isRequired,updateDraft:oF().func.isRequired,onRef:oF().func}),(0,X._)(fH,"defaultProps",{onRef:function(){}});var fq=(0,af.Z)(null)(fH);function fV(){var e=(0,lQ._)(["草稿保存于",""]);return fV=function(){return e},e}var fX=function(e){(0,oB._)(n,e);var t=(0,oU._)(n);function n(){var e;return(0,q._)(this,n),e=t.apply(this,arguments),(0,X._)((0,oL._)(e),"startCompositionTime",null),(0,X._)((0,oL._)(e),"rootRef",(0,b.createRef)()),(0,X._)((0,oL._)(e),"toolbarWrapperRef",(0,b.createRef)()),(0,X._)((0,oL._)(e),"state",{showReviewComment:!1,forceCloseReview:!1,isTyping:!1,titleLengthIsOk:!1,contentLengthIsOk:!1,scheduledPublishAt:void 0,editorState:null,showInsertableVideoUploader:!1,isSmallScreen:!1,markdownEnabled:!1,isContributionDisabled:!1}),(0,X._)((0,oL._)(e),"reporter",(0,lA.ZP)("PostPage",function(){return e.props.currentUserToken})),(0,X._)((0,oL._)(e),"checkShouldCancelScheduledPublish",function(){e.isEditBlocking&&iV.Z.confirm("如果继续编辑该文章，原定时发送设置将会失效，需重新设置定时发送时间，是否继续编辑？",{title:"编辑文章",text:{ok:"继续编辑",cancel:"我再想想"}}).then(function(){var t=e.props,n=t.draft;(0,t.cancelScheduledPublish)(n.id)},function(){window.location.href="https://www.zhihu.com/draft?type=article&filter=schedule"})}),(0,X._)((0,oL._)(e),"handleToggleInsertVideoState",function(t){e.setState({showInsertableVideoUploader:t})}),(0,X._)((0,oL._)(e),"handleOpenReviewComment",function(){e.setState({showReviewComment:!0})}),(0,X._)((0,oL._)(e),"handlePreviewCommentsClose",function(){e.setState({forceCloseReview:!0})}),(0,X._)((0,oL._)(e),"handleTyping",function(t){e.setState({isTyping:t})}),(0,X._)((0,oL._)(e),"handleAnyChange",function(t){var n=t.editorState;e.setState({editorState:n})}),(0,X._)((0,oL._)(e),"toggleMarkdownEnabled",function(){var t=e.state.markdownEnabled;e.setState({markdownEnabled:!t}),e.props.updateMarkdownSettings({markdownEnabled:!t})}),(0,X._)((0,oL._)(e),"renderDraftText",function(){var t=e.props.draft||{},n=t.updatedTime,r=t.updating,o=t.id,i=t.error,a=e.state.isTyping;return i?(0,v.BX)("span",{className:"WriteIndex-pageTitleError",children:[i,"，无法保存"]}):r||a?"草稿保存中…":o&&n?Date.now()<Date.parse(n)+6e4?"草稿已保存":l$()(fV(),(0,n3.rL)(n)):""}),(0,X._)((0,oL._)(e),"renderNavbarFunctionality",function(){return null}),(0,X._)((0,oL._)(e),"renderPublishArea",function(){var t,n=e.props,r=n.draft,o=n.myColumns,i=e.state,a=i.contentLengthIsOk,c=i.titleLengthIsOk,s=i.scheduledPublishAt,l=i.markdownEnabled,u=i.isContributionDisabled;return(0,v.tZ)(fL,{id:null===(t=e.props.params)||void 0===t?void 0:t.id,renderDraftText:e.renderDraftText,scheduledPublishAt:s,columns:o,draft:r,disabled:!(a&&c),forceUpdateDraft:e.forceUpdateDraft,showErrorMessage:e.showErrorMessage,getEditableInstance:function(){return e.editable},logTime:e.logTime,updateDraft:e.updateDraft,handleOpenReviewComment:e.handleOpenReviewComment,markdownEnabled:l,isContributionDisabled:u,isReediting:"published"===r.state})}),(0,X._)((0,oL._)(e),"onTitleStatusChange",function(t){t!==e.state.titleLengthIsOk&&e.setState({titleLengthIsOk:t})}),(0,X._)((0,oL._)(e),"onContentStatusChange",function(t){t!==e.state.contentLengthIsOk&&e.setState({contentLengthIsOk:t})}),(0,X._)((0,oL._)(e),"getTimestamp",function(e){return Math.floor((e?new Date(e):new Date).getTime()/1e3)}),(0,X._)((0,oL._)(e),"startLoggingTime",function(){e.startCompositionTime||(e.startCompositionTime=e.getTimestamp())}),(0,X._)((0,oL._)(e),"stopLoggingTime",function(){e.startCompositionTime=null}),(0,X._)((0,oL._)(e),"calculateLoggingTime",function(){var t=e.props.draft,n=e.getTimestamp(t.updatedTime),r=e.getTimestamp();return!n||e.startCompositionTime-n>180?r-e.startCompositionTime:r-n}),(0,X._)((0,oL._)(e),"showErrorMessage",function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"red",r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i="未知错误";t&&("string"==typeof t?i=t:t.payload&&t.payload.message?i=t.payload.message:t.message&&(i=t.message)),e.props.showNotification(i,n,r,o)}),(0,X._)((0,oL._)(e),"getHelpDocInitialOffset",function(){var t=e.toolbarWrapperRef.current;if(t)return{top:t.getBoundingClientRect().bottom+20,right:0}}),(0,X._)((0,oL._)(e),"updateDraft",function(t){if(!e.isUserBoundPhone)return e.context.handleBindPhoneModalToggle(),Promise.resolve();var n=e.props,r=n.draft,o=n.updateDraft;if(r.hasPublishingDraft)return iV.Z.alert("你有一份对该文章的修改正在发布中，请等待发布完成后再次修改。"),Promise.resolve();var i=r.id,a=r.draftLoading,c=function(){return e.logTime("stop")};return i||a?i?o(i,t).then(c):Promise.resolve():o(null,t).then(c)}),(0,X._)((0,oL._)(e),"forceUpdateDraft",function(){if(!e.isUserBoundPhone)return e.context.handleBindPhoneModalToggle(),Promise.resolve();var t=e.titleNode&&e.titleNode.value,n=e.coverNode&&e.coverNode.src,r=e.editable&&e.editable.toHTML(),o={},i=e.props.draft;return(t&&!i.title&&(o.title=t),n&&!i.titleImage&&(o.titleImage=n),r&&!i.content&&(o.content=r),(0,pq.Z)(e.reporter,r,"",e.editable),pH()(o))?Promise.resolve():e.updateDraft(o)}),(0,X._)((0,oL._)(e),"logTime",function(t){return e["".concat(t,"LoggingTime")]()}),(0,X._)((0,oL._)(e),"syncDraftSettings",function(){e.logTime("start");var t=e.logTime("calculate");setTimeout(function(){var n,r={table_of_contents:null===(n=e.editable)||void 0===n?void 0:n.hasCatalog(),delta_time:t};e.updateDraft(r)},0)}),(0,X._)((0,oL._)(e),"handleKeyCommand",function(t){if(!e.editable)return"not-handled";var n=e.editable.handleKeyCommand(t);return"toggle-catalog"===t&&(e.syncDraftSettings(),requestAnimationFrame(function(){e.forceUpdate()})),n}),(0,X._)((0,oL._)(e),"queryCommandEnable",function(t,n){return!!e.editable&&e.editable.queryCommandEnable(t,n)}),(0,X._)((0,oL._)(e),"queryCommandState",function(t,n){return!!e.editable&&e.editable.queryCommandState(t,n)}),(0,X._)((0,oL._)(e),"onInsertVideoClick",function(){return e.handleToggleInsertVideoState(!0)}),(0,X._)((0,oL._)(e),"onCloseCatalog",function(){e.editable&&(e.handleKeyCommand("toggle-catalog"),requestAnimationFrame(function(){e.forceUpdate()}))}),e}return(0,V._)(n,[{key:"isEditBlocking",get:function(){var e=this.props.draft;return!!(e&&e.schedule)}},{key:"componentDidMount",value:function(){var e,t,n=this;null===(e=this.props.writeShield)||void 0===e||null===(t=e.setOnModalClose)||void 0===t||t.call(e,function(){window.location.href="https://www.zhihu.com"}),window.screen.availWidth<860&&this.setState({isSmallScreen:!0}),(0,lA.hx)(),oW.Z.setModule(this.rootRef.current,{module:"PostEditView"}),oW.Z.trackPageShow({id:3371});var r=this.props,o=r.params.id,i=r.draft,a=r.getDraft,c=r.loadArticlesDisclaimers,s=r.loadLabel,l=r.queryDefaultSettings;(0,r.loadArticlesLimited)(o).then(function(e){var t;(null==e?void 0:null===(t=e.payload)||void 0===t?void 0:t.isAbleTo)||(n.setState({isContributionDisabled:!0}),iV.Z.confirm((0,v.tZ)(p5,{}),{text:{ok:"发想法",cancel:"知道了"}}).then(function(){window.location.href="https://www.zhihu.com/?writepin"},uU()))}),l().then(function(e){var t,r;return n.setState({markdownEnabled:null==e?void 0:null===(t=e.payload)||void 0===t?void 0:null===(r=t.commonSettings)||void 0===r?void 0:r.markdownEnabled})}),o&&(i&&i.id===o||a(o).then(this.checkShouldCancelScheduledPublish).catch(function(e){if(e.res){var t=e.res,r=e.payload;404===t.status?window.location.href="https://zhuanlan.zhihu.com/p/".concat(o):n.showErrorMessage(r)}}),c(o),s("article",o))}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.draft,n=e.location,r=e.router,o=e.loadArticlesDisclaimers,i=e.loadLabel;if(t&&t.id&&"/write"===n.pathname){o(t.id),i("article",t.id),r.replace("/p/".concat(t.id,"/edit"));return}}},{key:"componentWillUnmount",value:function(){this.props.resetDraft()}},{key:"renderPageTitle",value:function(){return(0,v.tZ)("div",{className:"WriteIndex-pageTitleWrapper",children:(0,v.tZ)("div",{className:"WriteIndex-pageTitle",children:"写文章"})})}},{key:"isUserBoundPhone",get:function(){var e=this.props.currentUser,t=e.isBindPhone,n=e.isRealname;return t||n}},{key:"renderPreviewComments",value:function(){var e=this.props.draft,t=this.state,n=t.forceCloseReview,r=t.showReviewComment,o=e.id,i=e.reviewers;if(!n&&(r||(void 0===i?[]:i).length>0)&&o)return(0,v.tZ)(pU,{className:"WriteIndex-previewWrapper",post:e,close:(0,v.tZ)(oQ.ZP,{className:"WriteIndex-closePreview",onClick:this.handlePreviewCommentsClose,children:(0,v.tZ)(aR.HN,{size:18})})})}},{key:"render",value:function(){var e=this,t=this.props,n=t.draft,r=t.isMobile,o=t.isOrg,i=t.showUserProfitButton;if(r)return(0,v.tZ)(pW,{to:"/"});if(!n)return(0,v.tZ)(cU.Z,{active:!0});var a=n.title,c=n.content,s=this.state,l=s.scheduledPublishAt,u=s.editorState,d=s.showInsertableVideoUploader,p=s.isSmallScreen;return(0,v.BX)(pj.ZP,{children:[(0,v.tZ)(lt,{pageInfo:{pageId:"10167"}}),(0,v.BX)(pQ.H.Provider,{value:"article-pc-editor",children:[(0,v.BX)("div",{className:"WriteIndexLayout",ref:this.rootRef,children:[(0,v.tZ)(eB.xB,{styles:{".App-main":{paddingBottom:0}}}),(0,v.tZ)(pK.Z,{}),(0,v.BX)(lA.ct.Provider,{value:this.reporter,children:[(0,v.tZ)(ek.ql,(0,B._)({title:"写文章"},(0,pY.Oo)(pY.EE))),(0,v.tZ)(sF.Z,{title:this.renderPageTitle(),renderNavbarFunctionality:this.renderNavbarFunctionality,sticky:!1}),(0,v.BX)("div",{className:oV()("WriteIndexLayout-main WriteIndex"),css:function(e){return{marginTop:0,width:"100%",background:e.colors.GBK10A}},children:[(0,v.tZ)(oj.Z,{getStyle:function(){return{width:"100%",top:0,left:0}},children:(0,v.tZ)("div",{ref:this.toolbarWrapperRef,css:function(e){return{display:"flex",justifyContent:"center",margin:"0 auto",background:e.colors.GBK99A}},children:(0,v.tZ)(fF,{editorState:u,onCommand:this.handleKeyCommand,queryCommandEnable:this.queryCommandEnable,queryCommandState:this.queryCommandState,showUserProfitButton:i,onInsertVideoClick:this.onInsertVideoClick,draftPage:"https://www.zhihu.com/".concat(o?"organization":"creator","/manage/creation/draft?type=article"),toggleMarkdownEnabled:this.toggleMarkdownEnabled,getMarkdownEnabled:function(){return e.state.markdownEnabled}})})}),(0,v.BX)("div",{css:function(e){return{width:p?"694px":"840px",margin:"0 auto",boxSizing:"border-box",padding:"0 20px",background:e.colors.GBK99A,marginTop:"20px",position:"relative"}},children:[!u&&(0,v.tZ)("div",{css:function(e){return{background:e.colors.GBK99A,position:"absolute",left:0,top:0,width:"100%",height:"100%",padding:40,zIndex:1,boxSizing:"border-box"}},children:(0,v.tZ)(pF.O,{variant:"T01"})}),(0,v.tZ)(fq,{onRef:function(t){return e.titleNode=t},title:a,logTime:this.logTime,updateDraft:this.updateDraft,onLengthStatusChange:this.onTitleStatusChange,css:{overflow:"hidden"}}),!this.isEditBlocking&&(0,v.tZ)(hy,{onEditableRef:function(t){return e.editable=t},isReediting:"published"===n.state,postId:n.id,post:n,content:c,onTyping:this.handleTyping,logTime:this.logTime,updateDraft:this.updateDraft,onLengthStatusChange:this.onContentStatusChange,showErrorMessage:this.showErrorMessage,showInsertableVideoUploader:d,handleToggleInsertVideoState:this.handleToggleInsertVideoState,scheduledPublishAt:l,onScheduledPublishAtChange:function(t){return e.setState({scheduledPublishAt:t})},handleAnyChange:this.handleAnyChange,publishArea:!!n&&this.renderPublishArea(),onCloseCatalog:this.onCloseCatalog,getEditableInstance:function(){return e.editable},getHelpDocInitialOffset:this.getHelpDocInitialOffset,forceUpdateWriteIndex:this.forceUpdate.bind(this),toggleMarkdownEnabled:this.toggleMarkdownEnabled,getMarkdownEnabled:function(){return e.state.markdownEnabled}}),this.renderPreviewComments()]})]})]})]}),(0,v.tZ)(p4,{})]})]})}}]),n}(b.Component);(0,X._)(fX,"contextTypes",{handleBindPhoneModalToggle:oF().func});var fW=(0,e5.compose)((0,iv.ZP)({init:!0,getScene:function(){return{type:"article"}}}),pV.g,sU.nx,oR.withRouter,(0,eM.connect)(oh,{getDraft:function(e){return{API:{types:r5,endpoint:"articles/".concat(e,"/draft"),root:x.Z.fetchRoot.zhuanlan}}},resetDraft:function(){return{type:or}},updateDraft:function(e,t){if(null===t.content)throw Error("The content of draft should not be null.");return{meta:{id:e,body:t},API:{types:r4,endpoint:e?"articles/".concat(e,"/draft"):"articles/drafts",root:x.Z.fetchRoot.zhuanlan,method:e?"PATCH":"POST",body:t,fetchOptions:{zsAutoSignature:!1}}}},showNotification:tD.c0,cancelScheduledPublish:function(e){return{API:{root:x.Z.fetchRoot.zhuanlan,types:r0.CANCEL_SCHEDULED_PUBLISH,endpoint:"articles/".concat(e,"/scheduled-publish"),method:"DELETE"}}},loadArticlesDisclaimers:ol,loadLabel:nZ.T$,queryDefaultSettings:nV.Gl,updateMarkdownSettings:nV.zp,loadArticlesLimited:function(e){return{API:{method:"GET",types:oi,endpoint:"community-prod/publish_article/is-able-to",query:{content_token:e}}}}}))(fX),fK=ox(function(){return n.e(3914).then(n.bind(n,88148))}),fj=(0,v.BX)(oR.Route,{path:"/",component:sI,name:"Index",onEnter:function(e){if(D.jS.onEnter(e),(0,nn.isBrowser)()){var t,n=oD(e);(0,S.t0)(n),(t=window.performance)&&t.timing&&((0,oP.uK)(function(e){return(0,S.pp)(e)}),(0,oP.I)({report:function(e){return S.ZP.increment("".concat((0,S.j0)(),".").concat(e,".count"))}}))}},onChange:function(e,t){D.jS.onChange(e,t),(0,S.t0)(oD(t))},children:[(0,v.tZ)(oR.IndexRoute,{component:sQ,name:"Home"}),(0,v.tZ)(oR.Route,{authRequired:!0,path:"drafts",getComponent:ox(function(){return n.e(7939).then(n.bind(n,61606))}),name:"Drafts"}),(0,v.tZ)(oR.Route,{authRequired:!0,path:"write",component:fW,name:"WritePage"}),(0,v.tZ)(oR.Route,{path:":id",getComponent:fK,name:"Column"}),(0,v.tZ)(oR.Route,{authRequired:!0,path:"column/request",getComponent:ox(function(){return n.e(1011).then(n.bind(n,87300))}),name:"Request",showAppHeader:!0}),(0,v.tZ)(oR.Route,{path:"column/p/:id",component:pw,showAppHeader:!1,name:"ColumnPost"}),(0,v.tZ)(oR.Route,{path:"column/:id",getComponent:fK,name:"NewColumn"}),(0,v.tZ)(oR.Route,{authRequired:!0,path:"column/:id/collect",getComponent:ox(function(){return n.e(9157).then(n.bind(n,16161))}),name:"ColumnCollect",showAppHeader:!1,zaPageShowId:8168}),(0,v.tZ)(oR.Route,{path:"column/:id/about",getComponent:ox(function(){return n.e(3295).then(n.bind(n,95458))}),name:"ColumnAbout"}),(0,v.tZ)(oR.Route,{authRequired:!0,path:"column/:id/settings",getComponent:ox(function(){return n.e(3844).then(n.bind(n,8861))}),name:"ColumnSettingsV2"}),(0,v.tZ)(oR.Route,{authRequired:!0,path:"p/:id/edit",component:fW,name:"EditPage"}),(0,v.tZ)(oR.Route,{path:"p/:id",component:pw,showAppHeader:!1,name:"Post"}),(0,v.tZ)(oR.Route,{authRequired:!0,path:"p/:id/preview",component:pG,name:"PreviewPost"}),(0,v.tZ)(oR.Route,{name:"ZVideoCollection",path:"zvideo/serial/collection/:id",getComponent:ox(function(){return n.e(8106).then(n.bind(n,66513))}),showAppHeader:!1}),(0,v.tZ)(oR.Redirect,{from:"/p/:id/voters",to:"/p/:id",query:{from_voters_page:!0}}),(0,v.tZ)(oR.Redirect,{from:"/:columnId/:id",to:"/p/:id"}),oN]});function fY(){return(0,v.tZ)(oR.Router,{history:oR.browserHistory,children:fj})}l=(s={rootReducer:ow,renderCallback:function(e,t){var n=t.container;e4.Z.setAppElement&&e4.Z.setAppElement(n),e(fY)},routes:fj}).rootReducer,u=s.renderCallback,p=(d={routes:s.routes,createStore:(0,e3.getCreateStore)(l),onRequestRender:function(e){var t=e.store,n=e.canaryConfig,r=e.http,o=e.container,i=e.afterHydrate,a=function(e){("csr"===t.getState().env.mode?eR.render:eR.hydrate)((0,v.tZ)(ek.B6,{children:(0,v.tZ)(b.Profiler,{id:"App",onRender:e1,children:(0,v.tZ)(ej,{store:t,canaryConfig:n,children:(0,v.tZ)(e2.q.Provider,{value:r,children:(0,v.tZ)(e,{})})})})}),o),null==i||i()};new Promise(function(e){/interactive|complete/.test(document.readyState)?e():document.addEventListener("DOMContentLoaded",e)}).then(function(){return u(a,e)})}}).createStore,h=d.onRequestRender,document.addEventListener("DOMContentLoaded",function(){window.Raven||(window.Raven={captureException:eg,captureMessage:eg,captureBreadcrumb:eg});var e,t,r,o,i,a,c,s,l=JSON.parse(document.getElementById("js-initialData").textContent),u=l.initialState,d=l.subAppName,f=l.spanName,_=l.fetchHost,m=l.canaryConfig,v=(0,eC.Xj)(u),A=u.env,Z=A.vars.passThroughHeaders,k=!!(A.userAgent.ZhihuHybrid||A.userAgent.Zhihu),M=k?{}:el(),G=[!1,(0,E.JT)(),(0,E.DH)(),(0,C.Yq)(),function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.allowPassThroughHeaders,o=(0,K._)(n,["allowPassThroughHeaders"]);return e(t,(0,U._)((0,B._)({},o),{headers:void 0!==r&&r?(0,B._)({},Z,o.headers):o.headers}))}},!k&&function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,eh._)({},(0,ef._)(n));return e(t,(0,U._)((0,B._)({},r),{headers:(0,B._)({},r.headers,M.xZst81&&{"x-zst-81":M.xZst81})}))}},ew({query:A.ctx.query,spanName:f,isOffice:v}),em({ua:A.userAgent,authInfo:{id:u.currentUser},xUDId:A.xUDId,passVars:Z}),(e=A.xTrafficFreeOrigin,function(t){return e?function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(n,(0,U._)((0,B._)({},r),{headers:(0,U._)((0,B._)({},r.headers),{"x-traffic-free":e})}))}:t}),function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e(t,n).then(null,ea)}},(t={namespace:d,getCurrentUser:function(){return u.currentUser}},function(e){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e(n,r).catch(function(e){throw/--(mr|box)/.test(location.host)||/--(mr|box)/.test(n)||function(e,t){var n,r=t.url,o=t.options,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.namespace,c=void 0===a?"Unknown":a,s=i.entryName,l=void 0===s?"FetchErrorV2":s,u=i.getCurrentUser,d=o||{},p=d.method,h=void 0===p?"GET":p,f=d.headers,_=f?Object.keys(f).length:0,m=location.protocol,v=location.host,g=location.href,T=ed({protocol:m,host:v}),E=new URL(r,g),C=J(E.pathname);if(!(E.host!==v||E.protocol!==m)){var y=[c,l,"SameOriginV1",T,h,C,"count"].join(".");S.ZP.increment({name:y,options:{version:"all"}}),401===e.status&&ep(e,void 0===u?function(){return"Unknown"}:u);return}var I="CrossOrigin",b=[c,l,I,T,h,ed(E),"H_".concat(_),C,"count"].join(".");S.ZP.increment({name:b,options:{version:"all"}}),null===(n=window.Raven)||void 0===n||n.captureException(e,{fingerprint:["FetchError",I],level:"warning",extra:{local:location.href,remote:r,method:h,headers:f}})}(e,{url:n,options:r},t),e})}}),function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.downgradeProbe,o=(0,K._)(n,["downgradeProbe"]);if(!r)return e(t,o);var i=r.url,a=$.instance();return e(a.prefer(t.toString(),i),o).catch(function(n){if((0,W._)(n,E.VL)&&n.status>=500&&n.url!==i)return en("downgrading",ee(t.toString())),a.check(n.url),e(i,o);throw n})}},z].filter(Boolean),F=H(G,_),q=p(u,{http:F});q.dispatch((0,eC.GM)(navigator.userAgent)),!1===O().get(P.Xq)&&q.dispatch((0,eC.JT)(!1)),"production"===A.trafficSource&&w()(b,function(e,t){return window.Raven.captureException(e,{extra:t}),null}),y.Z.install({appName:"main"===d?"heifetz":"heifetz-".concat(d),timingSampleRate:.001});var V=(0,eE.ib)(q.getState()),X=(0,eC.Uh)(q.getState()),j=(0,eC.Hu)(q.getState());v&&!j&&(i=(o=(r=JSON.parse(document.getElementById("js-initialData").textContent).initialState).env).vars.passThroughHeaders,a=[(0,E.JT)(),(0,C.Yq)(),em({ua:o.userAgent,authInfo:{id:r.currentUser},xUDId:o.xUDId,passVars:i}),z],c=(0,E.SQ)(fetch,[function(e){return function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(void 0,(0,g._)(n)).then(function(e){var t=e.payload,n=void 0===t?{}:t;return n.data&&!n.paging?n.data:n})}}].concat((0,g._)(a))),window.addEventListener("message",function(e){var t=e.data,n=t.url,r=t.params;"zop"===t.source&&c(n,(0,B._)({},r)).then(function(e){window.postMessage({source:"heifetz",sign:e,err:null},window.location.origin)}).catch(function(e){window.postMessage({source:"heifetz",sign:null,err:e},window.location.origin)})},!1)),(0,eT.N4)(H([function(e){return function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(void 0,(0,g._)(n)).then(function(e){var t=e.payload,n=void 0===t?{}:t;return n.data&&!n.paging?n.data:n})}}].concat((0,g._)(G)),_)),h({store:q,http:F,container:document.getElementById("root"),canaryConfig:m,afterHydrate:function(){j&&"errorpage"!==d.toLowerCase()&&ev(),X.Wechat&&(S.ZP.increment("WechatSDK.config.intention.count"),(0,T.S0)().catch(function(e){throw S.ZP.increment("WechatSDK.config.fail.count"),e})),X.JDMiniProgram&&(0,N.v)("https://beta-mini-app-static.jd.com/apps/jssdktest/js/jssdk.js"),X.MQQBrowser&&j&&(0,N.v)("https://jsapi.qq.com/get?api=app.openPhotoBrowser")}}),(0,D.Hf)(V,X).then(function(){n.e(4299).then(n.bind(n,14299)).then(function(e){(null==e?void 0:e.default)&&new e.default({performance:!0,resourceError:!1,request:!1,resourcePerformance:!0,runtimeError:!1,common:{disableLog:!1,projectId:"heifetz"}})})});var Y=null===(s=A.abV2)||void 0===s?void 0:s.config;if(null==Y?void 0:Y.abMap){var Q={abConfig:Y,idInfo:{memberHashId:null==V?void 0:V.id}};(0,I.M)(Q)}X.ZhihuHybrid&&v&&R.Z.enableLog(),L.Z.config({userId:u.currentUser}),V&&!k&&["www.zhihu.com","zhuanlan.zhihu.com","www-zhihu-com","zhuanlan-zhihu-com"].some(function(e){return location.host.includes(e)})&&function(e){var t=x.Z.refreshValidityPeriod,n=Date.now(),r=(0,ey.LP)();if(r){var o=JSON.parse(r),i=o.token;n-o.timestamp>864e5*Number(t)&&e((0,eS.zq)((0,eI.Z)("refresh_token",{refreshToken:i})));return}(0,E.dJ)("/api/account/prod/token/refresh",{method:"POST"}).then(function(t){var n=t.refresh_token;e((0,eS.zq)((0,eI.Z)("refresh_token",{refreshToken:n})))}).catch(function(e){var t=e.error;S.ZP.increment("token.error.getRefreshToken.".concat(null==t?void 0:t.code))})}(q.dispatch)})},58931:function(e,t,n){"use strict";var r=n(7835),o=n(54231);t.Z=function(e){var t=e.type;return(0,r.Z)(function(){o.ZP.increment("mobile.".concat(t,".count"))}),null}},72174:function(e,t,n){"use strict";n.d(t,{Z:function(){return V}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),l=n(85879),u=n(51695),d=n(14168),p=n.n(d),h=n(87363),f=n(36695),_=n(93206),m=n(43384),v=n(21060),g=n(32854),T=n(82644),E=n(67516),C=n.n(E),y=n(38889),S="AdblockBanner::dismiss",I=function(e){(0,c._)(u,e);var t=(0,s._)(u);function u(){var e;return(0,o._)(this,u),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{shown:!1}),(0,a._)((0,r._)(e),"handleClose",function(){C().set(S,!0),e.setState({shown:!1})}),e}return(0,i._)(u,[{key:"componentDidMount",value:function(){var e,t;!0!==C().get(S)&&!(n.g.navigator&&/Mobile/.test(navigator.userAgent))&&((e=document.createElement("div")).className="adsbox",document.body.appendChild(e),t="none"===getComputedStyle(e).display,document.body.removeChild(e),t)&&this.setState({shown:!0})}},{key:"render",value:function(){return this.state.shown&&(0,l.BX)("div",{className:"AdblockBanner",children:[(0,l.BX)("div",{className:"AdblockBanner-inner",children:["我们检测到你可能使用了 AdBlock 或 Adblock Plus，它的部分策略可能会影响到正常功能的使用（如关注）。",(0,l.tZ)("br",{}),"你可以设定特殊规则或将知乎加入白名单，以便我们更好地提供服务。 （",(0,l.tZ)("a",{href:"//www.zhihu.com/question/54919485",target:"_blank",rel:"noreferrer",children:"为什么？"}),"）"]}),(0,l.tZ)(y.ZP,{preset:"plain",className:"AdblockBanner-close",onClick:this.handleClose,icon:T.HN})]})}}]),u}(h.Component),b=n(42735),A=n(94382),Z=n(26609),w=n(51921),R=n(59523),N=n(96717),k=n(55164),O=n(71728),x=n(72111),P=n(58216),D=n(1733),L=n(66263),B=n(79446),U=n(36374),M=n(36591),G=function(e){var t=e.href,n=(0,O._)(e,["href"]);return(0,l.tZ)(x._o,{zaText:!0,children:(0,l.tZ)(D.sN,(0,k._)({zaText:!0,tag:"a",href:(0,M.Z)(t,"https://zhuanlan.zhihu.com")},n))})},F=function(){var e=(0,B.Z)(["urlToken","id"]),t=(0,U.Z)(),n=(0,l.tZ)(m.$U,{as:y.ZP,zaText:"更多",zaType:"Button",zaAction:"Unknown",className:"ColumnPageHeader-MenuToggler",preset:"plain",title:"更多",children:(0,l.tZ)(P.AZ,{})});return(0,l.BX)(D.ZP,{menuClassName:"ColumnPageHeader-Menu",positionStatus:"fixed",toggler:n,children:[(0,l.tZ)(G,{href:"https://www.zhihu.com/".concat(t?"organization":"creator","/manage/creation/article"),children:"我的文章"}),(0,l.tZ)(G,{href:"https://www.zhihu.com/people/".concat((null==e?void 0:e.urlToken)||(null==e?void 0:e.id),"/columns"),children:"我的专栏"}),(0,l.tZ)(G,{href:L.vg,children:"专栏 \xb7 发现"})]})},z="column",H="article",q=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleWriteButtonClick",function(e){Promise.resolve((0,N.E)(e,1280)).then(function(){window.open("https://zhuanlan.zhihu.com/write","_blank")})}),(0,a._)((0,r._)(e),"handleFollowClick",function(e){return(0,N.E)(e,1279),!0}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.isLogin,n=e.currentUser,r=e.getColumnContributions;t&&n&&n.urlToken&&r()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isLogin,r=t.currentUser,o=t.getColumnContributions;n&&(e.currentUser&&!e.currentUser.urlToken||!e.currentUser)&&r&&r.urlToken&&o()}},{key:"renderTitle",value:function(){var e=this.props,t=e.title,n=e.titleMeta,r=e.preset,o=e.column;if(t||o){var i=t||(0,l.tZ)(l.HY,{children:(0,l.BX)("div",{className:"ColumnPageHeader-TitleName",children:[(0,l.tZ)("span",{className:"ColumnPageHeader-TitleMeta",children:n||(r===H?"首发于":"专栏")}),(0,l.tZ)(A.Z,{column:o,noHoverCard:!0,className:"ColumnPageHeader-TitleColumn"})]})});return(0,l.BX)(l.HY,{children:[(0,l.tZ)("i",{className:"ColumnPageHeader-Line"}),(0,l.tZ)("div",{className:"ColumnPageHeader-Title",children:i})]})}return null}},{key:"renderButtons",value:function(){var e=this.props.renderNavbarFunctionality;return e?e():(0,l.BX)(m.$U,{as:y.ZP,zaType:"Button",zaText:!0,className:"ColumnPageHeader-WriteButton",color:"blue",onClick:this.handleWriteButtonClick,children:[(0,l.tZ)(u.yc,{}),"写文章"]})}},{key:"render",value:function(){var e=this.props,t=e.isLogin,n=e.showAdblockBanner,r=e.currentUser,o=e.sticky,i=(0,l.BX)("div",{className:"ColumnPageHeader",css:{boxShadow:"0px 16px 32px rgba(0, 0, 0, 0.04)"},children:[(0,l.BX)("div",{className:"ColumnPageHeader-content",children:[(0,l.tZ)(b.Z,{}),this.renderTitle(),(0,l.BX)("div",{className:"ColumnPageHeader-Button",children:[t&&(0,l.tZ)(F,{}),!r&&(0,l.tZ)(g.Z,{}),this.renderButtons()]})]}),(0,l.tZ)("div",{className:"ColumnPageHeader-profile",children:(0,l.tZ)(Z.Z,{currentUser:r,enableGuidesForLogin:!0})})]});return(0,l.tZ)(m.eV,{block:"ColumnPageHeader",children:(0,l.BX)("div",{className:"ColumnPageHeader-Wrapper",children:[n&&(0,l.tZ)(I,{}),void 0===o||o?(0,l.tZ)(v.Z,{children:i}):i]})})}}]),n}(h.Component);(0,a._)(q,"PRESETS",{COLUMN:z,ARTICLE:H}),(0,a._)(q,"propTypes",{column:p().object,preset:p().oneOf([z,H]).isRequired,isLogin:p().bool.isRequired,showAdblockBanner:p().bool,title:p().oneOfType([p().element,p().string]),titleMeta:p().oneOfType([p().element,p().string]),renderNavbarFunctionality:p().func}),(0,a._)(q,"defaultProps",{preset:H});var V=(0,_.compose)((0,f.connect)(function(e,t){var n=t.columnId;return{currentUser:(0,R.ib)(e),column:e.entities.columns[n],isLogin:""!==e.currentUser}},{getColumnContributions:w.Pq}))(q)},26820:function(e,t,n){"use strict";n.d(t,{Ij:function(){return i},PY:function(){return a},YP:function(){return l},j:function(){return s},jB:function(){return r},lg:function(){return c},zs:function(){return o}});var r={add:"annotation",cancel:"annotation_cancel",view:"show_annotation_detail"},o=2,i=300,a=178,c=5,s=4,l=[340792848,350203097,350203137,350203161,350203194,350203244,360980862,360980655,360979559,360979454,360979327,360979218,360979086,360978949,360978717,360978426,376742720,376747534,376747608,376747691,376747887,377838652,377838776,377839115,377839161,377839236,377839329,377839762,377839827,377839991,377840112,377906867,377907004,377907128,377907233,377907323,377907486,377907592,377907807,377907929,377908171,377908294,377908397,377908510,377908600,377908691,377908791,377908856,377908946,377908990,377909025]},14717:function(e,t,n){"use strict";n.d(t,{r:function(){return c},y:function(){return s}});var r=n(49899),o=n(93547),i=n(26974),a=function(e){return Object.keys(e).map(function(t){return{property:"og:".concat(t),content:e[t]}})},c=function(e){var t=e.imageUrl,n=e.title,i=e.url,c=e.excerpt,s=e.topics,l=(0,o.NJ)(c),u=[{name:"description",content:l}].concat((0,r._)(a({title:n,url:i,description:l,image:t,type:"article",site_name:"知乎专栏"})));if(s){var d=s.map(function(e){return e.name}).join(",");d&&u.unshift({name:"keywords",content:d})}return u},s=function(e){var t=e.title,n=e.intro,o=e.id,c=e.imageUrl;return[{name:"description",content:n}].concat((0,r._)(a({title:t,url:"https:".concat((0,i.M9)(o)),description:n,image:c,site_name:"知乎专栏"})))}},26974:function(e,t,n){"use strict";n.d(t,{M9:function(){return a},b6:function(){return i},x$:function(){return o}});var r=n(66263),o=function(e){return"".concat(r.vg,"/p/").concat(e)},i=function(e){return"".concat(r.vg,"/p/").concat(e,"/edit")},a=function(e){return"".concat(r.i7,"/column/").concat(e)}},96717:function(e,t,n){"use strict";n.d(t,{E:function(){return a}});var r=n(55164),o=n(69383),i={1283:{id:1283,name:"设置"},1292:{id:1292,name:"MoreAction"},1293:{id:1293,name:"标记按钮"},1294:{id:1294,name:"举报"},1281:{id:1281,name:"底部bar评论"},1298:{id:1298,name:"赞赏"},1279:{id:1279,name:"关注专栏"},1280:{id:1280,name:"写文章",action:"OpenUrl"},1288:{id:1288,name:"关注专栏"},1282:{id:1288,action:"Collect"},1295:{id:1295,name:"话题",action:"OpenUrl"},1296:{id:1296,action:"OpenUrl",element:"Image"},1297:{id:1297,action:"OpenUrl",element_name:"MoreAction"},8928:{id:8928,action:"Click",element:"Text"}},a=function(e,t,n){var a="number"==typeof t?i[t]:t;"object"==typeof a&&o.Z.trackEvent(e&&e.currentTarget,(0,r._)({action:"Click"},a),n)}},42657:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(42559),o=n.n(r);function i(e,t){var n=e.trackUrl,r=void 0===n?[]:n,i=e.id;if(0===r.length)return null;var a="other";t.Android?a="android":t.iOS&&(a="ios");var c=o()();return r.forEach(function(e){new Image().src=e.replace("__OS__",a).replace("__ADPLATFORM__",a).replace("__REQUESTID__",c).replace("__SESSIONID__",c).replace("__ATOKEN__",i).replace("__PAGETYPE__","article")}),{os:a,pageId:i,sessionId:c,pageType:"article"}}},84867:function(e,t,n){"use strict";n.d(t,{b:function(){return b},Z:function(){return A}});var r=n(94009),o=n(85879),i=n(89174),a=n(91850),c=n(58723),s=n(94172),l=n(87363),u=n(87641),d=n(3681),p=n(55164),h=n(7835),f=n(65733),_=n(36695),m=n(31467),v=n(71728),g=function(e){var t=e.color,n=(0,v._)(e,["color"]);return(0,o.tZ)(u.Box,(0,p._)({sx:{borderBottom:"1px solid",borderColor:void 0===t?"GBK09A":t}},n))},T=n(11345),E=n(94617),C={channel:void 0,bySelf:void 0,byAi:void 0,createAt:null,province:void 0,city:void 0},y={bySelfOption:""},S=function(e){var t=e.onClose,n=e.open,a=e.handleSubmit,c=e.originInfo,s=e.options,d=(0,_.useDispatch)(),v=(0,r._)((0,l.useState)(c||C),2),S=v[0],I=v[1],b=(0,r._)((0,l.useState)(y),2),A=b[0],Z=b[1],w=(0,l.useMemo)(function(){return void 0!==S.channel||S.bySelf||S.byAi},[S]);(0,h.Z)(function(){d((0,T.z)())});var R=(0,f.Z)(function(e){I((0,p._)({},S,e))}),N=(0,f.Z)(function(){var e=S.bySelf,t=S.createAt,n=S.province,r=S.city;return!e||t&&n&&r?(Z(y),!0):(Z({bySelfOption:"*当前填写有误，请修改后重试"}),!1)}),k=(0,f.Z)(function(){N()&&(a(S),null==t||t())}),O=(0,f.Z)(function(){null==t||t(),I(c||C),Z(y)});return(0,o.tZ)(m.Z,{onClose:O,title:"添加内容来源",subtitle:"根据自媒体投稿规范，发布新闻类的内容需要明确标注信息来源，请确认当前内容是否已正确添加",css:{"& .Modal-content":{padding:"0 24px 18px"}},children:n&&(0,o.BX)(u.Flex,{height:"330px",flexDirection:"column",justifyContent:"space-between",children:[(0,o.tZ)(u.Box,{children:(s||E.lw).map(function(e){var t=E.gL[e];return t?(0,o.BX)(u.Box,{children:[(0,o.tZ)(t,{conentSource:S,changeConentSource:R,error:A[e]}),(0,o.tZ)(g,{})]},e):null})}),(0,o.BX)(u.Box,{children:[(0,o.BX)(u.Flex,{justifyContent:"space-between",children:[(0,o.tZ)(i.ZP,{css:{padding:0,width:"48%",fontSize:"14px"},label:"取消添加",onClick:O,preset:"outline"}),(0,o.tZ)(i.ZP,{css:{padding:0,width:"48%",fontSize:"14px"},color:"blue",label:"确认添加",disabled:!w,onClick:k,preset:"primary"})]}),(0,o.tZ)(u.Flex,{justifyContent:"center",mt:"14px",color:"GBL05A",fontSize:"14px",children:"添加的内容来源将会在此条内容详情页展示"})]})]})})},I=n(27366),b=(0,l.memo)(function(e){var t=e.handleSubmit,n=e.originInfo,d=e.options,p=(0,r._)((0,a.Z)(!1),2),h=p[0],f=p[1],_=(0,l.useMemo)(function(){return(0,I.G)(n)},[n]);return(0,o.BX)(u.Box,{flex:"1",children:[_?(0,o.BX)(u.Flex,{alignItems:"center",height:"100%",color:"GBL05A",fontSize:"14px",children:[_,(0,o.tZ)(i.ZP,{icon:c.Z,label:"修改",preset:"plain",color:"blue",css:{marginLeft:"12px"},onClick:f.on})]}):(0,o.BX)(u.Flex,{alignItems:"center",py:"2",color:"GBL05A",px:"8px",bg:"GBK10A",css:{borderRadius:"4px",maxWidth:"530px"},children:[(0,o.tZ)(u.Text,{fontSize:"12px",children:"根据自媒体投稿规范，发布新闻类的内容需要明确标注信息来源，请确认当前内容是否已正确添加"}),(0,o.tZ)(i.ZP,{icon:s.Z,css:function(e){return{marginLeft:"8px",padding:0,width:"110px",fontSize:"12px",border:"1px solid ".concat(e.colors.GBK09A),color:e.colors.GBK03A,borderRadius:"4px","&:hover":{background:e.colors.GBK09A}}},label:"添加来源",onClick:f.on,preset:"outline"})]}),(0,o.tZ)(S,{onClose:f.off,open:h,handleSubmit:t,originInfo:n,options:d})]})}),A=function(e){var t=e.handleSubmit,n=e.originInfo;return(0,o.BX)(u.Flex,{py:"11px",children:[(0,o.tZ)(d.gN,{name:"内容来源"}),(0,o.tZ)(b,{handleSubmit:t,originInfo:n,options:["contentOriginOption","bySelfOption"]})]})}},94617:function(e,t,n){"use strict";n.d(t,{lw:function(){return I},gL:function(){return b},Co:function(){return A}});var r=n(55164),o=n(94009),i=n(79065),a=n(85879),c=n(41402),s=n(66345),l=n(32293),u=n(73376),d=n.n(u),p=n(87363),h=n(36695),f=n(87641),_=n(91846),m=n(31318),v=n(3681),g=n(45001);function T(){var e=(0,i._)(["\n                        max-height: 300px;\n                      "]);return T=function(){return e},e}function E(){var e=(0,i._)(["\n                        max-height: 300px;\n                      "]);return E=function(){return e},e}var C=function(e){var t=e.placeholder,n=e.required;return(0,a.BX)(a.HY,{children:[t,n?(0,a.tZ)(f.Text,{color:"GRD03A",ml:"5px",children:"*"}):null]})},y=function(e){var t=e.children,n=e.className;return(0,a.tZ)(f.Flex,{color:"GBK02A",fontSize:"14px",py:"10px",alignItems:"center",justifyContent:"space-between",className:n,children:t})},S=function(e){var t=e.conentSource,n=e.changeConentSource;return(0,a.BX)(y,{children:[(0,a.tZ)(v.gN,{name:"图片/视频为自行拍摄",props:{css:{width:"auto",whiteSpace:"nowrap",opacity:t.byAi?.4:1}}}),(0,a.tZ)(_.Z,{disabled:!!t.byAi,onChange:function(e){n((0,r._)({bySelf:e.target.checked},e.target.checked?{}:{createAt:void 0,province:void 0,city:void 0}))},checked:t.bySelf})]})},I=["contentOriginOption","bySelfOption","byAiOption"],b={contentOriginOption:function(e){var t=e.conentSource,n=e.changeConentSource;return(0,a.BX)(y,{children:[(0,a.tZ)(v.gN,{name:"内容信息来源",props:{css:{width:"auto",whiteSpace:"nowrap"}}}),(0,a.tZ)(g.Z,{text:t.channel?A[t.channel]:"选择具体的信息来源",onChange:function(e){return n({channel:e})},value:t.channel,css:{width:"170px","& .InputButton":{width:"170px",justifyContent:"space-between"}},children:Object.keys(A).map(function(e){return(0,a.tZ)(g.W,{css:{width:"170px"},value:e,text:A[e]},e)})})]})},bySelfOption:function(e){var t=e.conentSource,n=e.changeConentSource,r=e.error,i=(0,h.useSelector)(function(e){var t,n;return null===(t=e.common)||void 0===t?void 0:null===(n=t.cities)||void 0===n?void 0:n.cityData})||[],u=i.find(function(e){var n;return e.id===(null===(n=t.province)||void 0===n?void 0:n.id)}),_=(0,o._)((0,p.useState)((null==u?void 0:u.cities)||[]),2),v=_[0],I=_[1];return(0,a.BX)(a.HY,{children:[(0,a.tZ)(S,{conentSource:t,changeConentSource:n}),t.bySelf&&(0,a.BX)(a.HY,{children:[(0,a.BX)(y,{css:{paddingTop:0},children:[(0,a.tZ)(m.Z,{placeholder:(0,a.tZ)(C,{placeholder:"选择拍摄时间",required:!0}),css:{"& .DatePicker-Button":{padding:"4px 10px",svg:{width:"1.2em"}}},value:t.createAt&&(0,l.Z)(1e3*t.createAt),onChange:function(e){return n({createAt:d()(e).unix()})},disabledDate:function(e){return s.Z(e,(0,l.Z)(Date.now()))}}),(0,a.tZ)(f.Flex,{flex:"1",children:(0,a.tZ)(c.ms,{children:function(e){var r=e.css;return(0,a.BX)(a.HY,{children:[(0,a.tZ)(g.Z,{text:t.province?t.province.name:(0,a.tZ)(C,{placeholder:"省份",required:!0}),onChange:function(e){I(e.cities),n({province:{id:e.id,name:e.province},city:void 0})},value:t.province,css:{marginLeft:"10px",whiteSpace:"nowrap",".InputLike":{maxWidth:"98px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},listClassName:r(T()),children:i.map(function(e){return(0,a.tZ)(g.W,{value:e,text:e.province},e.id)})}),(0,a.tZ)(g.Z,{text:t.city?t.city.name:(0,a.tZ)(C,{placeholder:"城市",required:!0}),onChange:function(e){return n({city:{id:e.id,name:e.name}})},value:t.city,css:{maxWidth:"98px",".InputLike":{maxWidth:"98px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},marginLeft:"4px",whiteSpace:"nowrap"},listClassName:r(E()),children:v.map(function(e){return(0,a.tZ)(g.W,{value:e,text:e.name},e.id)})})]})}})})]}),r&&(0,a.tZ)(f.Flex,{color:"GRD03A",fontSize:"14px",mb:"10px",children:r})]})]})},byAiOption:function(e){var t=e.conentSource,n=e.changeConentSource;return(0,a.BX)(y,{children:[(0,a.tZ)(v.gN,{name:"图片/视频由 AI 生成",props:{css:{width:"auto",whiteSpace:"nowrap",opacity:t.bySelf?.4:1}}}),(0,a.tZ)(_.Z,{disabled:!!t.bySelf,onChange:function(e){return n({byAi:e.target.checked})},checked:t.byAi})]})}},A={officialWebsite:"官方网站",newsReport:"新闻报道",TVMedia:"电视媒体",printMedia:"纸质媒体"}},27366:function(e,t,n){"use strict";n.d(t,{G:function(){return c},u:function(){return a}});var r=n(55164),o=n(78160),i=n(94617),a=function(e){if(e&&0!==Object.keys(e).length){var t=e.channel,n=e.bySelf,o=e.createAt,i=e.province,a=e.city,c=e.byAi;return(0,r._)({channel:t},n&&{method:1,created_at:o,location:{province:i.id,city:a.id}},c&&{method:2})}},c=function(e){var t=e||{},n=t.channel,r=t.bySelf,a=t.byAi,c=t.createAt,s=t.city;if(void 0===n&&void 0===r&&void 0===a)return"";var l=n?"来源于".concat(i.Co[n]," "):"",u=r?"拍摄于".concat((0,o.Z)(1e3*c,"yyyy-MM-dd")," ").concat(s.name):"",d=a?"图片 / 视频由 AI 生成":"";return"".concat(l).concat(l&&(u||d)?" ":"").concat(u||d)}},1612:function(e,t,n){"use strict";n.d(t,{vr:function(){return X},v$:function(){return q},vi:function(){return V}});var r=n(55164),o=n(85879),i=n(2347),a=n(16427),c=n(28124),s=n(25405),l=n(40933),u=n(28545),d=n(83688),p=n(26030),h=n(55041),f=n(11690),_=n(59280),m=n(47866),v=n(21706),g=n(29126),T=n(15881),E=n(2325),C=n(93975),y=n(93406),S=n(7629),I=n(80874),b=n(48936),A=n(65389),Z=n(76319),w=n(58216),R=n(75056),N=n(66744),k=n(89237),O=n(55890),x=n(87969),P=n(33773),D=n(82604),L=n(11360),B=n(94009),U=n(8586),M=n(87363),G=n(87641),F=n(43384),z=n(38889),H=function(e){var t=e.getMarkdownEnabled,n=e.label,r=e.icon,i=e.text,a=e.onClick,c=(0,B._)((0,M.useState)(t()),2),s=c[0],l=c[1],u=function(){a(),l(!s)};return(0,o.BX)(F.$U,{as:z.ZP,zaType:"Button",zaText:"".concat(n," ").concat(s?"关":"开"),preset:z.EE.Plain,"aria-label":n,css:function(e){return{"&.Button.Button--plain":{padding:"12px 20px",display:"flex",alignItems:"center",color:e.colors.GBK03A,width:"100%",boxSizing:"border-box",whiteSpace:"nowrap",borderRadius:"4px",position:"relative"}}},children:[(0,o.tZ)(G.Box,{onClick:u,css:{position:"absolute",left:0,top:0,width:"100%",height:"100%",zIndex:1}}),(0,o.tZ)(r,{center:!0,css:{marginRight:"4px"}}),null!=i?i:n,(0,o.tZ)(U.Z,{forceControlled:!0,checked:s,preset:"small",css:{marginLeft:37},onChange:u,onClick:function(e){return e.preventDefault()}})]})},q=function(e){var t=e.showProfit,n=e.onInsertVideoClick,o=e.isVideoAnswer,w=e.shouldAdaptNative;return[{sectionName:"operation",minLength:3,priority:1,items:[{icon:i.O1,priority:2,label:"撤销",commandName:"undo",shortcut:"⌘+Z"},{icon:a.OJ,label:"重做",priority:1,commandName:"redo",shortcut:"⌘+Y"},{icon:c.Z,label:"清除格式",priority:3,commandName:"clear-format",shortcut:"⌘+\\"}]},{sectionName:"style",minLength:4,priority:2,items:[(0,r._)({icon:s.ZP,label:"标题",priority:1},w?{commandName:"toggle-block-type-header-two",shortcut:"⌘+⌥+1"}:{children:[{icon:l.ic,label:"一级标题",commandName:"toggle-block-type-header-two",shortcut:"⌘+⌥+1"},{icon:u.NC,label:"二级标题",commandName:"toggle-block-type-header-three",shortcut:"⌘+⌥+2"}]}),{icon:d.Z,label:"加粗",commandName:"toggle-inline-style-BOLD",priority:2,shortcut:"⌘+B"},!w&&{icon:p.ZP,label:"斜体",commandName:"toggle-inline-style-ITALIC",priority:3,shortcut:"⌘+I"}]},{sectionName:"blockType",minLength:6,priority:4,items:[{icon:h.Z,label:"列表",priority:1,children:[{icon:f.hS,label:"有序列表",commandName:"toggle-block-type-ordered-list-item",shortcut:"⌘+⇧+L"},{icon:_.bd,label:"无序列表",commandName:"toggle-block-type-unordered-list-item",shortcut:"⌘+L"}]},{Component:D.Z,icon:m.ZP,label:"目录",commandName:"toggle-catalog",shortcut:"⌘+⌥+J",priority:2},{icon:v.R7,label:"引用",commandName:"toggle-block-type-blockquote",shortcut:"⌘+⇧+U",priority:3},{icon:g.Z,label:"分割线",commandName:"insert-divider",shortcut:"⌘+⌥+S",priority:4},{icon:T.Z,label:"代码块",commandName:"toggle-block-type-code-block",shortcut:"⌘+⌥+C",priority:5},{icon:E.Z,label:"注释",commandName:"insert-reference",shortcut:"⌘+⌥+R",priority:6}]},{sectionName:"advanced",minLength:2,priority:3,items:[{Component:L.Z,icon:C.Z,label:"图片",commandName:"insert-image-from-library",priority:7},!o&&{label:"视频",icon:y.Z,priority:6,onClick:function(){null==n||n()}},{label:"链接",icon:S.ZP,commandName:"insert-link",priority:5,shortcut:"⌘+K"},t&&!o&&{label:"收益",icon:I.gI,commandName:"toggle-user-profit-modal",priority:4},{label:"公式",icon:b.Z,commandName:"insert-formula",priority:3,shortcut:"⌘+⌥+E"},!o&&{label:"表格",icon:A.Z,commandName:"insert-table",priority:2,shortcut:"⌘+⌥+T"},{label:"附件",icon:Z.Z,commandName:"insert-file-from-baidu-wangpan",priority:1}].filter(Boolean)}]},V=function(e){var t=e.getMarkdownEnabled,n=e.onHandleManageEditClick;return[{sectionName:"moreArea",minLength:2,priority:2,items:[{label:"更多",icon:w.B2,children:[{label:"帮助文档",icon:R.Ov,commandName:"toggle-help-document",hideMenuOnClick:!0},{label:"默认设置",icon:N.ZP,onClick:function(){return n()},hideMenuOnClick:!0},{Component:function(e){return(0,o.tZ)(H,(0,r._)({getMarkdownEnabled:t},e))},label:"Markdown 语法识别",icon:k.Z,commandName:"toggle-markdown-enabled"}]}]}]},X=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).draftPage;return[{sectionName:"fixArea",minLength:2,priority:2,items:[(0,r._)({label:"文档",icon:O.j5},e?{children:[{icon:O.j5,label:"文档",commandName:"insert-doc"},{icon:x.DV,label:"草稿箱",onClick:function(){location.href=e}}]}:{commandName:"insert-doc"}),{label:"历史版本",icon:P.ZP,commandName:"toggle-draft-history-modal"}]}]}},61436:function(e,t,n){"use strict";n.d(t,{Ue:function(){return f},kv:function(){return d},o8:function(){return p},xR:function(){return h},zS:function(){return u}});var r=n(49899),o=n(84054),i=n.n(o),a=n(93206),c=n(39288),s=n(44765),l=(0,c.FH)("article",["ADD_CONTRIBUTE_REQUEST","DELETE_CONTRIBUTE_REQUEST","GET_CONTRIBUTE_REQUEST","HANDLE_CONTRIBUTE_REQUEST","GET_RECOMMENDED_CONTRIBUTE_COLUMNS"]),u=function(e,t){return{API:{types:l.ADD_CONTRIBUTE_REQUEST,endpoint:"/articles/".concat(e,"/contribute_requests"),method:"POST",fetchOptions:{credentials:"include"},body:{column_id:t}},columnId:t}};function d(e,t){return{API:{types:l.DELETE_CONTRIBUTE_REQUEST,endpoint:"/articles/".concat(e,"/contribute/requests/").concat(t),method:"DELETE"},columnId:e,id:t}}function p(e){return{API:{types:l.GET_CONTRIBUTE_REQUEST,endpoint:"/articles/".concat(e,"/contribute_requests"),method:"GET"}}}function h(e,t,n){return{API:{types:l.HANDLE_CONTRIBUTE_REQUEST,endpoint:"/articles/".concat(e,"/contribute/requests/").concat(t),method:"PUT",body:{accept:n}},id:t,NOTIFICATION:{success:n?"已通过投稿审核":"已忽略投稿审核"}}}var f=function(e){return{API:{types:l.GET_RECOMMENDED_CONTRIBUTE_COLUMNS,endpoint:"/articles/".concat(e,"/recommendation-contribute-columns"),fetchOptions:{credentials:"include"},query:{include:i()({data:{recommendations:[{column:{articles_count:!0,followers:!0}}]}})}}}};t.ZP=(0,a.combineReducers)({contributeRequests:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===l.GET_CONTRIBUTE_REQUEST.success?t.payload.data:e},deleteContributeIdList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===l.DELETE_CONTRIBUTE_REQUEST.success?(0,r._)(e).concat([t.id]):e},handledContributeIdList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===l.HANDLE_CONTRIBUTE_REQUEST.success?(0,r._)(e).concat([t.id]):e},recommendedColumns:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===l.GET_RECOMMENDED_CONTRIBUTE_COLUMNS.success?t.payload.data.recommendations:e},pinnedColumns:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===l.GET_RECOMMENDED_CONTRIBUTE_COLUMNS.success?t.payload.data.pinColumns:e},sentContributeRequestsIdList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(t.type===s.Hp.GET.success){var n=t.payload.contributions,o=(void 0===n?[]:n).map(function(e){return e.column.id});return(0,r._)(e).concat((0,r._)(o))}return l.ADD_CONTRIBUTE_REQUEST.success?(0,r._)(e).concat([t.columnId]):l.DELETE_CONTRIBUTE_REQUEST.success?e.filter(function(e){return e===t.columnId}):e}})},97712:function(e,t,n){"use strict";n.d(t,{Oe:function(){return d},R5:function(){return p},ZP:function(){return f}});var r=n(55164),o=n(57477),i=n(49899),a=n(80714),c=n(39288),s=(0,r._)({},(0,c.FH)("articleDrafts",["GET_DRAFTS","DELETE_DRAFT"])),l=s.GET_DRAFTS,u=s.DELETE_DRAFT;function d(){return function(e,t){var n=t().articleDrafts.items;return e({API:{types:l,endpoint:"articles/my_drafts",root:a.Z.fetchRoot.zhuanlan,query:{limit:10,offset:n.length,include:"$.data[*].schedule"}}})}}function p(e){return function(t){return t({meta:{id:e},API:{types:u,endpoint:"articles/".concat(e,"/draft"),root:a.Z.fetchRoot.zhuanlan,method:"DELETE",fetchOptions:{zsAutoSignature:!1}}})}}var h={isDrained:!1,isLoading:!1,items:[]};function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0,n=t.meta,a=t.type,c=t.payload;return a===l.request?(0,o._)((0,r._)({},e),{isLoading:!0}):a===l.success?(0,o._)((0,r._)({},e),{isDrained:c.paging.isEnd,isLoading:!1,items:(0,i._)(e.items).concat((0,i._)(c.data))}):a===u.success?(0,o._)((0,r._)({},e),{items:e.items.filter(function(e){return e.id!==n.id})}):e}},91777:function(e,t,n){"use strict";n.d(t,{H:function(){return i}});var r=n(87320),o=(0,n(39288).FH)("brand",["GET_URL"]),i=function(e){return{API:{types:o.GET_URL,endpoint:"/brand/track",method:"GET",fetchOptions:{credentials:"include",failsafe:!0,timeout:100},query:{target_url:"https://zhuanlan.zhihu.com/p/".concat(e)}},FAILSAFE:!0,UPDATE:{success:function(t){return{articles:(0,r._)({},e,{trackUrl:t.data||[]})}}}}}},83213:function(e,t,n){"use strict";n.d(t,{ZP:function(){return k},wD:function(){return y},IG:function(){return Z},mB:function(){return A},G1:function(){return R},XS:function(){return b},Ae:function(){return w},Fz:function(){return N},TP:function(){return I},Gw:function(){return S}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(75472),s=n.n(c),l=n(28953),u=n(84054),d=n.n(u),p=n(80714),h=n(39288),f=n(89250),_=n(7407),m=n(44765),v=n(84),g=n(74135),T=new v.fK.Union({answer:l.l.ANSWER,article:l.l.ARTICLE,pin:l.l.PIN,zvideo:l.l.ZVIDEO},function(e){var t=e.type;return(0,g.camelize)(t)}),E=new v.fK.Array(T),C=(0,h.FH)("column",["GET","UPDATE","REMOVE","GET_PINNED_ARTICLE","SET_PINNED_ARTICLE","GET_PINNED_ITEMS","TOGGLE_PINNED_ITEM","REMOVE_COLUMN_COLLECT","UNCOLLECT_ITEM","GET_ARTICLES","GET_ITEMS","REFRESH_ITEMS","REMOVE_COLUMN_ARTICLE","SET_COAUTHOR","GET_COAUTHORS","CHANGE_COAUTHOR_ROLE","REMOVE_COAUTHOR","UNSUBSCRIBE"]);d()({data:[{admin_closed_comment:!0,comment_count:!0,suggest_edit:!0,is_title_image_full_screen:!0,can_comment:!0,upvoted_followees:!0,can_open_tipjar:!0,can_tip:!0,voteup_count:!0,voting:!0,topics:!0,review_info:!0,author:{is_following:!0,is_labeled:!0,label_info:!0}}]});var y=function(e){return function(t){return t({API:{root:p.Z.fetchRoot.zhuanlan,types:C.GET,endpoint:"/columns/".concat(e),method:"GET",fetchOptions:{credentials:"include"}},schema:l.l.COLUMN})}},S=function(e,t){return function(n){return n({API:{root:p.Z.fetchRoot.zhuanlan,types:C.UPDATE,endpoint:"/columns/".concat(e),method:"PATCH",body:t},schema:l.l.COLUMN})}},I=function(e){return function(t){return t({API:{root:p.Z.fetchRoot.zhuanlan,types:C.UNSUBSCRIBE,endpoint:"/columns/".concat(e,"/followers"),method:"DELETE"}})}},b=function(e){return function(t){return t({API:{root:p.Z.fetchRoot.zhuanlan,types:C.REMOVE,endpoint:"/columns/".concat(e),method:"DELETE"},NOTIFICATION:{success:"删除专栏成功",fail:"删除专栏失败"}})}},A=function(e){return function(t){return t({columnId:e,API:{types:C.GET_PINNED_ITEMS,endpoint:"/columns/".concat(e,"/pinned-items"),fetchOptions:{credentials:"include"}},schema:E})}},Z=function(e,t){return function(n,r){var a=r(),c=(a.column[e]||a.entities.columns[e]||{}).paging,s=(0,_.Hs)(a),l=c?{endpoint:c.next}:{endpoint:"/columns/".concat(e,"/items"),query:(0,i._)((0,o._)({},t&&{offset:t}),{ws_qiangzhisafe:s?"1":"0"})};return n({id:e,API:(0,o._)({types:C.GET_ITEMS},l),schema:E})}},w=function(e){var t=e.columnId,n=e.contentType,r=e.contentId;return{columnId:t,contentType:n,contentId:r,API:{endpoint:"/columns/".concat(t,"/items"),types:C.REMOVE_COLUMN_COLLECT,method:"DELETE",body:{type:n,id:r}}}},R=function(e,t){return{id:e,API:(0,o._)({types:C.REFRESH_ITEMS,endpoint:"/columns/".concat(e,"/items")},t&&{offset:t}),schema:E}},N=function(e){var t=e.columnId,n=e.contentId,r=e.contentType,o=e.toPin;return{columnId:t,contentId:n,contentType:r,toPin:o,API:{types:C.TOGGLE_PINNED_ITEM,endpoint:"/columns/".concat(t,"/pinned-items"),method:o?"POST":"DELETE",body:{type:r,id:n}}}};function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C.GET_PINNED_ARTICLE.success:var n=e[t.columnId]||{};return(0,i._)((0,o._)({},e),(0,r._)({},t.columnId,(0,i._)((0,o._)({},n),{pinnedArticle:t.payload.id})));case C.SET_PINNED_ARTICLE.success:var c=e[t.columnId]||{};return(0,i._)((0,o._)({},e),(0,r._)({},t.columnId,(0,i._)((0,o._)({},c),{pinnedArticle:t.articleId})));case C.GET_ARTICLES.request:case C.REFRESH_ITEMS.request:case C.GET_ITEMS.request:var l=e[t.id]||{};return(0,i._)((0,o._)({},e),(0,r._)({},t.id,(0,i._)((0,o._)({},l),{isLoading:!0})));case C.GET_ARTICLES.success:var u=e[t.id]||{},d=t.payload,p=d.data,h=d.paging,_=u.articles||[];return(0,i._)((0,o._)({},e),(0,r._)({},t.id,(0,i._)((0,o._)({},u),{articlesPaging:h,articles:(0,a._)(_).concat((0,a._)(p.map(function(e){return e.id}))),isLoading:!1})));case C.GET_ARTICLES.failure:case C.GET_ITEMS.failure:var v=e[t.id]||{};return(0,i._)((0,o._)({},e),(0,r._)({},t.id,(0,i._)((0,o._)({},v),{isLoading:!1})));case C.GET_PINNED_ITEMS.success:var g=e[t.columnId]||{};return(0,i._)((0,o._)({},e),(0,r._)({},t.columnId,(0,i._)((0,o._)({},g),{pinnedItems:t.result})));case C.GET_ITEMS.success:var T=e[t.id]||{},E=t.payload,y=E.paging,S=E.needForceLogin,I=t.result,b=T.items||[];return(0,i._)((0,o._)({},e),(0,r._)({},t.id,(0,i._)((0,o._)({},T),{paging:y,needForceLogin:S,items:(0,a._)(b).concat((0,a._)(I)),isLoading:!1})));case C.REFRESH_ITEMS.success:var A=e[t.id]||{},Z=t.payload.paging,w=t.result;return(0,i._)((0,o._)({},e),(0,r._)({},t.id,(0,i._)((0,o._)({},A),{paging:Z,items:w,isLoading:!1})));case C.TOGGLE_PINNED_ITEM.success:var R=e[t.columnId]||{},N=t.columnId,k=t.contentType,O=t.contentId,x=t.toPin,P={schema:k,id:O};return(0,i._)((0,o._)({},e),(0,r._)({},N,(0,o._)({},R,x?{pinnedItems:[P].concat((0,a._)(R.pinnedItems)),items:R.items.filter(function(e){return!s()(e,P)})}:{pinnedItems:R.pinnedItems.filter(function(e){return!s()(e,P)}),items:[P].concat((0,a._)(R.items))})));case C.REMOVE_COLUMN_COLLECT.success:var D=e[t.columnId]||{},L=t.columnId,B={schema:t.contentType,id:t.contentId};return(0,i._)((0,o._)({},e),(0,r._)({},L,(0,o._)({},D,{pinnedItems:D.pinnedItems.filter(function(e){return!s()(e,B)}),items:D.items.filter(function(e){return!s()(e,B)})})));case C.REMOVE_COLUMN_ARTICLE.success:case m.Hp.DELETE.success:var U=t.columnId,M=t.articleId,G=e[U]||{},F=G.articles||[];return(0,i._)((0,o._)({},e),(0,r._)({},U,(0,i._)((0,o._)({},G),{pinnedArticle:G.pinnedArticle===M?null:G.pinnedArticle,articles:F.filter(function(e){return e!==M})})));case f.VA.LOAD_ARTICLE_RELATION_ENDORSEMENT.success:var z=t.meta,H=t.payload;return(0,i._)((0,o._)({},e),{relationEndorsement:(0,r._)({},z.id,H)});default:return e}}},24316:function(e,t,n){"use strict";n.d(t,{NG:function(){return l},ZP:function(){return u},dj:function(){return c},q0:function(){return s}});var r=n(87320),o=n(55164),i=n(57477),a=(0,n(39288).FH)("columnCollection",["TOGGLE_COLUMN_COLLECT"]),c=function(e,t){return e.columnCollection[t]},s=function(e){var t=e.type,n=e.id;return"".concat(t).concat(n)},l=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(r,i){var l,u=s(t),d=null===(l=c(i(),e))||void 0===l?void 0:l[u];return r((0,o._)({meta:{columnId:e,contentKey:u,optimisticCollected:!d},API:{endpoint:"/columns/".concat(e,"/items"),types:a.TOGGLE_COLUMN_COLLECT,method:d?"DELETE":"POST",body:t}},!1===n&&{NOTIFICATION:!1}))}};function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.TOGGLE_COLUMN_COLLECT.request:case a.TOGGLE_COLUMN_COLLECT.failure:var n=t.meta,c=n.columnId,s=n.contentKey,l=n.optimisticCollected,u=e[c]||{},d=t.type===a.TOGGLE_COLUMN_COLLECT.request?l:!l;return(0,i._)((0,o._)({},e),(0,r._)({},c,(0,i._)((0,o._)({},u),(0,r._)({},s,d))));default:return e}}},44765:function(e,t,n){"use strict";n.d(t,{Hp:function(){return f},Qo:function(){return E},R_:function(){return g},fR:function(){return v},g1:function(){return T},vM:function(){return _},xl:function(){return m}});var r=n(87320),o=n(55164),i=n(57477),a=n(94009),c=n(74135),s=n(28953),l=n(84054),u=n.n(l),d=n(74351),p=n(80714),h=n(4785),f=(0,n(39288).FH)("article",["GET","DELETE","UPDATE_COMMENT_PERMISSION","GET_COMMERCIAL_INFO","TOGGLE_LIKE","LOAD_MARKET_ARTICLE_PAID_CONTENT","LOAD_POST_SEARCH_ENTITY"]),_=function(e){return function(t){return t({API:{endpoint:"v3/entity_word",query:{type:"article",token:e},types:f.LOAD_POST_SEARCH_ENTITY},FAILSAFE:!0,UPDATE:{success:function(t){return{articles:(0,r._)({},e,{entityWords:(null==t?void 0:t.searchWords)||[]})}},failure:function(t){return(0,d.isBrowser)()?window.Raven.captureException(t,{logger:"searchEntityError",extra:{id:e,type:"article"}}):console.error("searchEntityError",t,{id:e,type:"article"}),{}}}})}},m=function(e,t){var n=t.zhiPlusFlag,c=t.isQiangZhiSafe;return function(t){var l=(0,a._)(/^\d+/.exec(String(e))||["0"],1)[0];if("0"===l){var u=Error();throw u.status=404,u}if(String(e)!==l){var d=Error();throw d.status=302,d.redirect="/p/".concat(l),d}return t({API:{root:p.Z.fetchRoot.zhuanlan,types:f.GET,endpoint:"/articles/".concat(l),method:"GET",fetchOptions:{credentials:"include"},query:(0,i._)((0,o._)({},n&&{zhiPlusFlag:decodeURIComponent(n)}),{ws_qiangzhisafe:c?"1":"0"})},UPDATE:{success:function(e){var t=e.author,n=e.contributions,o={};return(void 0===n?[]:n).forEach(function(e){var t=e.column;o[t.id]=t}),{users:t.urlToken?(0,r._)({},t.urlToken,t):{},columns:o}}},schema:s.l.ARTICLE})}},v=function(e,t){return{articleId:e,columnId:t,API:{types:f.DELETE,endpoint:"/articles/".concat(e),method:"DELETE",fetchOptions:{credentials:"include"}},schema:s.l.ARTICLE}};function g(e,t){return function(n,o){var i=o().entities.articles[e];return n({API:{types:f.UPDATE_COMMENT_PERMISSION,endpoint:"/articles/".concat(e,"/comment_permission"),method:"PUT",body:(0,h.z)((0,c.decamelizeKeys)({commentPermission:t}))},UPDATE:{request:{articles:(0,r._)({},e,{commentPermission:t})},failure:{articles:(0,r._)({},e,i)}}})}}var T=function(e){return function(t){return t({API:{root:p.Z.fetchRoot.zhuanlan,types:f.GET_COMMERCIAL_INFO,endpoint:"/articles/".concat(e,"/commercial"),method:"GET",fetchOptions:{credentials:"include"}},UPDATE:{success:function(t){return{articles:(0,r._)({},e,{commercialInfo:t.data||{}})}}}})}};function E(e){return{API:{endpoint:"/kmqa/articles/".concat(e,"/paid_content"),query:{include:u()({media_card:!0,btn_info:!0,goods_card:!0,za_info:!0,video_extra:!0})},types:f.LOAD_MARKET_ARTICLE_PAID_CONTENT},FAILSAFE:!0,UPDATE:{success:function(t){return{articles:(0,r._)({},e,{paidContent:t})}}}}}},379:function(e,t,n){"use strict";n.d(t,{Z:function(){return ty}});var r=n(55164),o=n(94009),i=n(49899),a=n(85879),c=n(30037),s=n(29229),l=n(83537),u=n(65733),d=n(58216),p=n(67814),h=n.n(p),f=n(88329),_=n.n(f),m=n(87363),v=n.n(m),g=n(36695),T=n(87641),E=n(93206),C=n(69383),y=n(43384),S=n(1733),I=n(31467),b=n(82926),A=n(99158),Z=n(38889),w=n(19495),R=n(30361),N=n(63362),k=n(102),O=n(12667),x=n(57386),P=n(24794),D=n(65939),L=n(4773),B=n(77100),U=n(18362),M=n(70938),G=n(57477),F=n(57730),z=n(67927),H=n(25229),q=function(e){var t=e.selectedQuestion,n=e.answerContent,o=e.checkRange,i=e.onClose,c=e.shouldPublish,s=e.setSelectedQuestion,l=e.selectedContribution,d=e.zvideoId,p=e.isEditing,h=e.duration,f=e.editorRef,v=e.closeAfterEdit,E=e.reset,C=e.MIN_RANGE,S=(0,y.Q4)(),I=(0,g.useDispatch)();return{onCancel:(0,u.Z)(function(){S.trackEvent({eventType:"Click",action:"Close",block:"Modal",elementLocation:{type:"Button"}}),t&&n?F.Z.confirm((0,a.tZ)(T.Box,{textAlign:"center",children:"当前视频投稿内容离开后不保存"}),{title:(0,a.tZ)(T.Box,{ml:"23px",children:"取消当前视频投稿编辑吗？"}),text:{ok:"继续编辑",cancel:"取消离开"}}).then(_(),i):i()}),onComplete:(0,u.Z)(function(){c?I((0,L.__)(d)).then(function(){I((0,z.c0)("投稿成功，审核后自动发布")),i()}):i()}),onSelectQuestion:(0,m.useCallback)(function(e){o&&o()||s(e)},[o,s]),onSubmit:(0,u.Z)(function(){var e={startTime:0,endTime:h,content:(0,H.Z)(n)};p?I((0,L.uw)(l.id,e)).then(function(){if(v)i();else{var e;E(),null===(e=f.current)||void 0===e||e.changeRange(0,f.current.getDuration())}}).catch(function(e){var t=e.payload.message;I((0,z.c0)(t||"添加失败"))}):I((0,L.gq)(d,(0,G._)((0,r._)({},e),{target:{parentObject:{type:"question",id:t.id,title:t.title},object:{type:"answer"}}}),h)).then(function(){var e;E(),null===(e=f.current)||void 0===e||e.autoNextRange(C)}).catch(function(e){var t=e.payload.message;I((0,z.c0)(t||"添加失败"))})}),onCancelEdit:(0,u.Z)(function(){p&&v?i():E()})}},V=n(66980),X=Object.assign,W=function(e){return v().createElement(V.Z,X({width:"153",height:"104",fill:"none",viewBox:"0 0 153 104"},e),v().createElement("path",{fill:"#F0F4F7",fillRule:"evenodd",d:"M95.97 102.732H45.137c-13.147 0-23.805-10.651-23.805-23.79 0-37.472 30.396-67.85 67.893-67.85 27.184 0 49.221 22.023 49.221 49.19 0 23.445-19.017 42.45-42.476 42.45Z",clipRule:"evenodd"}),v().createElement("path",{stroke:"#2B6BCC",strokeLinecap:"round",strokeWidth:".475",d:"M73.088 40.905v20.068M39.27 64.164v24.009M110.813 64.164v34.1"}),v().createElement("path",{stroke:"#D3E0ED",strokeLinecap:"round",strokeWidth:".475",d:"M110.813 14.992v16.205M39.199 29.223v8.56M33.03 37.754h99.165M28.754 64.125h112.104"}),v().createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M.015 101.856h152.816L76.423 11.907.015 101.856Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M81.32 27.703a4.895 4.895 0 0 1-4.897 4.894 4.895 4.895 0 0 1-4.897-4.894 4.895 4.895 0 0 1 4.897-4.893 4.895 4.895 0 0 1 4.897 4.893Z",clipRule:"evenodd"}),v().createElement("path",{stroke:"#D3E0ED",strokeWidth:".633",d:"M76.423 14.321V.811"}),v().createElement("path",{fill:"#D3E0ED",fillRule:"evenodd",d:"M61.587 29.415H91.26c.853 0 1.308-1.007.743-1.646L76.423 10.132 60.844 27.769c-.564.64-.11 1.646.743 1.646ZM8.472 103.516h142.657V96.19H8.472v7.326Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#ABBEDB",fillRule:"evenodd",d:"M15.014 96.116h33.27V88.79h-33.27v7.326ZM50.03 70.63l9.3 24.354-2.967 1.132-9.3-24.355 2.967-1.13Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#D3E0ED",fillRule:"evenodd",d:"m57.15 76.295 6.94 18.175-4.316 1.646-6.94-18.175 4.316-1.646Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#ABBEDB",fillRule:"evenodd",d:"M15.014 79.644H49.43V77.5H15.014v2.144Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#D3E0ED",fillRule:"evenodd",d:"M11.25 88.79h33.271v-3.663h-33.27v3.663ZM17.548 77.5h30.737v-2.642H17.548V77.5Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M17.809 84.866H48.25v-4.96H17.809v4.96Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#D3E0ED",fillRule:"evenodd",d:"M17.548 85.127h30.964v-5.483H17.548v5.483Zm.522-.522h29.92v-4.439H18.07v4.439Z",clipRule:"evenodd"}),v().createElement("path",{stroke:"#fff",strokeWidth:"1.095",d:"M76.423 33.84v2.178M79.776 33.063l1.541 1.54M82.135 31.197h2.18M68.363 31.197h2.18M71.436 34.603l1.54-1.54"}),v().createElement("path",{stroke:"#D3E0ED",strokeWidth:"1.133",d:"M140.533 96.372c-2.182-9.496-.74-19.823 4.845-28.733"}),v().createElement("path",{fill:"#D3E0ED",fillRule:"evenodd",d:"M147.924 67.603c-.988.704-2.073.877-2.422.387-.348-.49.17-1.457 1.159-2.16.989-.704 2.073-.876 2.422-.386.349.489-.17 1.456-1.159 2.16Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#D3E0ED",fillRule:"evenodd",d:"M144.759 65.51c.704.987.877 2.071.387 2.42-.49.348-1.458-.17-2.162-1.159-.703-.988-.876-2.071-.386-2.42.49-.348 1.458.17 2.161 1.158ZM145.6 73.984c-1.394.659-2.788.634-3.115-.057-.327-.69.538-1.784 1.931-2.443 1.394-.659 2.788-.633 3.115.057.327.69-.538 1.784-1.931 2.443Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#D3E0ED",fillRule:"evenodd",d:"M142.109 70.66c.66 1.393.634 2.786-.057 3.113-.69.327-1.785-.538-2.444-1.93-.659-1.393-.634-2.787.057-3.113.69-.327 1.785.537 2.444 1.93ZM143.964 81.107c-1.607.76-3.216.731-3.593-.065-.377-.796.621-2.058 2.228-2.818 1.608-.76 3.216-.73 3.593.066.377.796-.621 2.057-2.228 2.817Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#D3E0ED",fillRule:"evenodd",d:"M139.938 77.273c.761 1.607.732 3.214-.065 3.59-.797.378-2.059-.62-2.82-2.225-.761-1.607-.731-3.215.065-3.591.797-.377 2.06.62 2.82 2.226ZM143.224 87.524c-1.527.912-3.131 1.039-3.583.283-.452-.756.418-2.108 1.945-3.02 1.526-.912 3.13-1.038 3.582-.283.452.756-.418 2.108-1.944 3.02Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#D3E0ED",fillRule:"evenodd",d:"M138.845 84.098c.912 1.525 1.039 3.128.283 3.58-.757.452-2.11-.418-3.023-1.943-.912-1.525-1.039-3.128-.282-3.58.756-.452 2.109.418 3.022 1.943ZM144.305 93.69c-1.507 1.384-3.285 1.9-3.971 1.154-.686-.746-.021-2.473 1.487-3.857 1.507-1.384 3.285-1.9 3.971-1.153.686.746.02 2.473-1.487 3.856Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#D3E0ED",fillRule:"evenodd",d:"M138.571 90.849c1.384 1.506 1.901 3.283 1.154 3.97-.747.685-2.475.02-3.859-1.487-1.385-1.506-1.901-3.282-1.154-3.968.747-.687 2.474-.021 3.859 1.485ZM129.951 96.157h-10.3V84.28c0-.36.293-.654.655-.654h8.99c.362 0 .655.293.655.654v11.877Z",clipRule:"evenodd"}),v().createElement("path",{stroke:"#D3E0ED",strokeWidth:"1.634",d:"M129.296 87.595h1.069a2.31 2.31 0 0 1 2.311 2.31v.488a2.31 2.31 0 0 1-2.311 2.31h-1.069"}),v().createElement("path",{fill:"#D3E0ED",fillRule:"evenodd",d:"M125.974 72.734c-.263.388-.538.758-.701 1.174a2.514 2.514 0 0 0-.21 1.244c.089.826.641 1.546 1.238 2.216l.226.258c.08.103.164.202.238.31.139.22.265.456.33.714a2.376 2.376 0 0 1-.1 1.54c-.407.955-1.299 1.546-2.195 1.775.796-.48 1.47-1.145 1.715-1.95a1.985 1.985 0 0 0-.278-1.719c-.06-.082-.128-.157-.191-.237l-.237-.26c-.306-.358-.611-.736-.851-1.171-.232-.435-.412-.934-.404-1.452-.005-.518.177-1.011.437-1.419.263-.411.617-.735.983-1.023ZM123.249 77.57c-.312.404-.568.873-.518 1.339.048.463.356.865.686 1.237l.125.143c.044.056.09.11.131.169a1.304 1.304 0 0 1 .129 1.233c-.22.527-.712.85-1.202.988.445-.255.82-.628.961-1.074a1.108 1.108 0 0 0-.152-.967c-.034-.046-.072-.088-.107-.132l-.131-.144a3.948 3.948 0 0 1-.47-.646c-.128-.238-.227-.512-.224-.795a1.445 1.445 0 0 1 .236-.78c.146-.226.336-.41.536-.571Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#ABBEDB",fillRule:"evenodd",d:"M81.44 73.316h16.04v-5.712H81.44v5.712Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#D3E0ED",fillRule:"evenodd",d:"M112.063 96.19H66.857l1.491-15.342a10.45 10.45 0 0 1 10.404-9.436h21.416a10.45 10.45 0 0 1 10.403 9.436l1.492 15.342Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#ABBEDB",fillRule:"evenodd",d:"M70.543 96.157h43.929v-.68h-43.93v.68Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#fff",fillRule:"evenodd",d:"m72.252 92.11-1.007 3.368h21.262v-1.684s-7.61-2.467-20.255-1.684ZM112.762 92.11l1.007 3.368H92.507v-1.684s7.61-2.467 20.255-1.684Z",clipRule:"evenodd"}),v().createElement("path",{stroke:"#D3E0ED",strokeWidth:".368",d:"M92.507 93.794v1.684"}),v().createElement("path",{fill:"#D3E0ED",fillRule:"evenodd",d:"M99.775 69.924h-20.63a5.265 5.265 0 0 1-5.267-5.264v-1.992a5.265 5.265 0 0 1 5.267-5.264h20.63a5.265 5.265 0 0 1 5.267 5.264v1.992a5.265 5.265 0 0 1-5.267 5.264Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#BDCDE5",fillRule:"evenodd",d:"M111.419 95.41a.666.666 0 0 1 .648-.681l.578-.015.035 1.328-.579.015a.665.665 0 0 1-.682-.647Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#ABBEDB",fillRule:"evenodd",d:"m112.685 96.225-.045-1.695 6.832-.179.044 1.695-6.831.18ZM119.521 96.231l-.054-2.072 4.69-.123.054 2.072-4.69.123Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#BDCDE5",fillRule:"evenodd",d:"m124.211 96.108-.054-2.072 1.283.374.033 1.258-1.262.44Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#D3E0ED",fillRule:"evenodd",d:"m112.646 94.713.034 1.329-.407.01-.034-1.328.407-.01Z",clipRule:"evenodd"}),v().createElement("path",{fill:"#BDCDE5",fillRule:"evenodd",d:"m125.44 94.41.033 1.258 1.768-.672-1.801-.586Z",clipRule:"evenodd"}))},K=function(e){var t=e.defaultVideo,n=e.title,r=e.description,i=e.duration,c=e.show,s=e.onClose,l=e.closeAfterEdit,u=e.shouldPublish,d=void 0!==u&&u,p=e.isProduce,h=(0,g.useDispatch)(),f=t.id,_=(0,L.cF)(f).answer,v=(void 0===_?{}:_).totalCount,E=void 0===v?0:v,C=(0,L.oL)(),S=!!C,b=(0,L.fh)(f),A=!S&&b.length===E,w=(0,m.useRef)(),R=(0,o._)((0,m.useState)(null),2),N=R[0],k=R[1],O=(0,o._)((0,m.useState)(""),2),x=O[0],P=O[1],D=(0,m.useCallback)(function(){k(null),P(""),h((0,L.O)(null))},[h]),G=q({selectedQuestion:N,answerContent:x,onClose:s,shouldPublish:d,setSelectedQuestion:k,selectedContribution:C,zvideoId:f,isEditing:S,duration:i,editorRef:w,closeAfterEdit:void 0!==l&&l,reset:D,MIN_RANGE:6e4}),F=G.onCancel,z=G.onComplete,H=G.onSelectQuestion,V=G.onSubmit,X=G.onCancelEdit;return(0,m.useEffect)(function(){if(c){if(C){var e,t=C.target.parentObject,n=C.content,r=C.startTime,o=C.endTime;k(t),P(n),null===(e=w.current)||void 0===e||e.changeRange(r,o)}else D()}},[c,C,h,D]),(0,a.tZ)(I.Z,{maskClosable:!1,onClose:F,css:{width:"790px",maxHeight:"initial",".Modal-content":{lineHeight:"normal",padding:0,margin:0}},children:c&&(0,a.tZ)(y.eV,{block:"Modal",children:(0,a.BX)(y.Wi,{zaType:"Block",as:T.Flex,height:"600px",children:[(0,a.BX)(T.Flex,{flexDirection:"column",width:"216px",height:"100%",css:function(e){return{backgroundColor:"".concat(e.colors.GBK10A)}},children:[(0,a.BX)(T.Box,{as:"p",fontSize:"24px",fontFamily:"PingFang SC",fontWeight:"500",px:"10px",mt:"24px",mb:"4px",children:["已添加投稿 ",null==b?void 0:b.length,"/",E]}),(0,a.tZ)(T.Box,{flex:"1",overflowY:"auto",px:"20px",mt:"12px",paddingTop:"8px",children:b.length?(0,a.tZ)(B.Z,{isProduce:void 0!==p&&p,zvideoId:f,showSelect:!0}):(0,a.BX)(T.Flex,{justifyContent:"center",alignItems:"center",flexDirection:"column",height:"100%",children:[(0,a.tZ)(W,{}),(0,a.tZ)(T.Text,{fontSize:"17px",fontFamily:"PingFang SC",fontWeight:"500",mt:"46px",css:function(e){return{color:e.colors.GBK02A}},children:"选择相关问题投稿"}),(0,a.tZ)(T.Text,{fontSize:"14px",fontFamily:"PingFang SC",fontWeight:"400",css:function(e){return{color:e.colors.GBK06A}},mt:"4px",children:"让更多人看到你的视频"})]})}),!N&&d&&(0,a.tZ)(T.Flex,{alignItems:"center",justifyContent:"space-between",px:"20px",height:"82px",css:{button:{width:"162px"}},children:(0,a.tZ)(y.$U,{zaType:"Button",zaAction:"Save",zaText:!0,as:Z.ZP,onClick:z,preset:"primary",color:"blue",disabled:!b.length,children:"发布"})})]}),(0,a.tZ)(T.Flex,{flexDirection:"column",flex:"1",children:A?(0,a.BX)(a.HY,{children:[(0,a.tZ)(T.Box,{px:"20px",my:"24px",fontSize:"24px",fontWeight:"500",children:"选择投稿问题"}),(0,a.BX)(T.Flex,{flexDirection:"column",justifyContent:"center",alignItems:"center",flex:"1",children:[(0,a.tZ)(T.Image,{width:"160px",height:"160px",src:"https://pic3.zhimg.com/v2-aee0d50112db6c845a1b7e7bcd2d7a84.png"}),(0,a.tZ)(T.Box,{mt:"10px",fontWeight:"500",fontSize:"17px",children:"已达到投稿数量上限"}),(0,a.tZ)(T.Box,{mt:"4px",fontSize:"14px",color:"GBK06A",children:"可移除已添加投稿来继续投稿问题"})]})]}):N?(0,a.tZ)(U.Z,{value:x,onChange:P,onSubmit:V,onCancel:X,isEditing:S,selectedQuestion:N}):(0,a.tZ)(M.Z,{zvideoId:f,title:n,description:r,onSelect:H})})]})})})},j=n(95939),Y=n(8586),Q=n(7835),J=n(36892),$=n(75056),ee=n(53910),et=n(14914),en=n(76931),er=n.n(en),eo=n(47970),ei=n(99447),ea=n(84867),ec=n(27366),es=Object.assign,el=function(e){return v().createElement(V.Z,es({width:"12",height:"12",fill:"none",viewBox:"0 0 12 12"},e),v().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M0 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2Zm5.136 6.608.214.214 4.276-4.277-.707-.707-3.574 3.574-2.138-2.138-.707.707 2.632 2.632.004-.005Z",clipRule:"evenodd"}))},eu=Object.assign,ed=function(e){return v().createElement(V.Z,eu({width:"12",height:"12",fill:"none",viewBox:"0 0 12 12"},e),v().createElement("rect",{width:"10",height:"10",x:"1",y:"1",stroke:"#D3D3D3",strokeWidth:"2",rx:"1.5"}))},ep=function(e){var t=e.handleCancel,n=e.handleAgree,r=(0,o._)((0,m.useState)(!1),2),i=r[0],c=r[1];return(0,a.BX)(I.Z,{title:"联合创作协议",closeButton:null,color:"GBK02A",children:[(0,a.tZ)(T.Box,{mb:"24px",children:"知乎鼓励视频作者引用图文作者的优质图文内容进行视频联合创作。视频审核成功后，平台会以私信的方式告知图文作者。若图文作者同意升级为联合创作，引用关系会变为联合创作关系。在原图文内容下会展示联合创作的视频，同时图文作者会在他的个人主页下发布视频。"}),(0,a.BX)(T.Flex,{fontSize:"14px",lineHeight:"24px",alignItems:"center",children:[i?(0,a.tZ)(el,{css:{paddingRight:"11px"},onClick:function(){return c(!1)}}):(0,a.tZ)(ed,{css:{paddingRight:"11px"},onClick:function(){return c(!0)}}),"我已充分阅读并同意",(0,a.tZ)(T.Text,{display:"inline-block",color:"GBL01A",css:{cursor:"pointer"},onClick:function(){return window.open("/term/coopcreation","_blank")},children:"《联合创作用户协议》"})]}),(0,a.BX)(I.w,{direction:"horizontal",children:[(0,a.tZ)(Z.ZP,{onClick:t,children:"取消"}),(0,a.tZ)(Z.ZP,{preset:"primary",color:"blue",onClick:n,disabled:!i,children:"同意"})]})]})},eh=n(61514),ef=n(70400),e_=n(95377),em=n(45001),ev=function(e){var t=e.handleConfirm;return(0,a.BX)(I.Z,{title:"什么是「联合创作」",closeButton:null,children:[(0,a.tZ)("div",{children:"知乎鼓励视频作者引用图文作者的优质图文内容进行视频联合创作。视频审核成功后，平台会以私信的方式告知图文作者。若图文作者同意升级为联合创作，引用关系会变为联合创作关系。在原图文内容下会展示联合创作的视频，同时图文作者会在他的个人主页下发布视频。"}),(0,a.tZ)(I.w,{direction:"horizontal",children:(0,a.tZ)(Z.ZP,{preset:"primary",color:"blue",onClick:t,children:"我知道了"})})]})},eg=n(30016),eT=n(41492),eE=n(99178),eC=n(80565),ey=n(49274),eS=n(66263),eI=function(e){var t=e.handleSelect,n=(0,g.useSelector)(function(e){return e.zvideos.collectData}),o=n.list,i=void 0===o?[]:o,c=n.isFetching,s=n.isEnd,l=n.next,u=(0,g.useDispatch)();return(0,m.useEffect)(function(){u((0,eT.B$)())},[u]),(0,a.tZ)(a.HY,{children:c||i.length>0?(0,a.BX)(eE.ZP,{onLoad:function(){u((0,eT.B$)(l))},isLoading:c,isDrained:void 0!==s&&s,css:{flex:"1",overflow:"auto",marginTop:"68px"},getContainer:function(e){return e},placeholder:(0,a.tZ)(eE.i,{className:"List-item"}),children:[(0,a.tZ)(T.Text,{lineHeight:"25px",mb:"8px",px:"24px",color:"#1A1A1A",children:"以下为可引用的内容"}),i.map(function(e,n){var o=e.target,i=o.type,c=o.id,s=o.author,l=s.avatarUrl,u=s.name,d=s.description,p=o.title,h=o.question,f=(void 0===h?{}:h).title,_=o.excerpt;return(0,a.tZ)(y.eV,{content:{token:String(c),type:eS.LA[i]},children:(0,a.BX)(y.$U,{view:{elementLocation:{card:{index:n}}},shouldTrackShow:!0,zaType:"Card",as:T.Box,onClick:function(){return t({type:i,id:c})},css:{borderRadius:"6px",padding:"8px 24px",boxShadow:"inset 0px -0.5px 0px #EBEBEB","&:hover":{background:"rgba(0, 102, 255, 0.08)",cursor:"pointer"}},children:[(0,a.BX)(T.Flex,{fontSize:"14px",pb:"7px",alignItems:"center",children:[(0,a.tZ)(T.Image,{src:l,sx:{borderRadius:2},height:18,width:18,mr:"8px"}),(0,a.tZ)(T.Text,{color:"GBK03A",fontWeight:"600",children:u}),d&&(0,a.tZ)(T.Text,{color:"GBK04A",fontWeight:"600",children:"，"}),(0,a.tZ)(T.Text,{color:"GBK04A",css:(0,r._)({flex:1},(0,eC.S)(1)),children:d})]}),(0,a.tZ)(T.Text,{color:"GBK02A",fontWeight:"600",fontSize:"15px",children:"article"===i?p:f}),(0,a.tZ)(T.Text,{fontSize:"14px",lineHeight:"25px",color:"#1A1A1A",children:_})]})},n)})]}):(0,a.tZ)(ey.H.EI1,{image:"noCollection",content:"你还没有收藏可引用的内容"})})},eb=n(80714),eA=Object.assign,eZ=function(e){return v().createElement(V.Z,eA({width:"16",height:"16",fill:"none",viewBox:"0 0 16 16"},e),v().createElement("path",{fill:"#121212",fillRule:"evenodd",d:"M2.333 2.667a1 1 0 1 0 0 2 1 1 0 0 0 0-2Zm2.334 5a1 1 0 0 1 1-1h8a1 1 0 1 1 0 2h-8a1 1 0 0 1-1-1Zm0 4a1 1 0 0 1 1-1h8a1 1 0 0 1 0 2h-8a1 1 0 0 1-1-1Zm-3.334-4a1 1 0 1 1 2 0 1 1 0 0 1-2 0Zm1 3a1 1 0 1 0 0 2 1 1 0 0 0 0-2Zm2.334-7a1 1 0 0 1 1-1h8a1 1 0 1 1 0 2h-8a1 1 0 0 1-1-1Z",clipRule:"evenodd"}),v().createElement("mask",{id:"id-801532647-a",width:"14",height:"11",x:"1",y:"2",maskUnits:"userSpaceOnUse",style:{maskType:"alpha"}},v().createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M2.333 2.667a1 1 0 1 0 0 2 1 1 0 0 0 0-2Zm2.334 5a1 1 0 0 1 1-1h8a1 1 0 1 1 0 2h-8a1 1 0 0 1-1-1Zm0 4a1 1 0 0 1 1-1h8a1 1 0 0 1 0 2h-8a1 1 0 0 1-1-1Zm-3.334-4a1 1 0 1 1 2 0 1 1 0 0 1-2 0Zm1 3a1 1 0 1 0 0 2 1 1 0 0 0 0-2Zm2.334-7a1 1 0 0 1 1-1h8a1 1 0 1 1 0 2h-8a1 1 0 0 1-1-1Z",clipRule:"evenodd"})),v().createElement("g",{mask:"url(#id-801532647-a)"},v().createElement("path",{fill:"#8590A6",d:"M0 0h16v16H0z"})))},ew="https://".concat(eb.Z.wwwHost,"/image-text-cite?").concat(new URLSearchParams({source:"upload-video"}).toString()),eR=function(e){var t=e.handleCancel,n=e.handleConfirm,r=e.handleChange,o=e.link;return(0,a.BX)(T.Box,{px:"24px",mt:"68px",children:[(0,a.tZ)(e_.Z,{multiline:!0,placeholder:"粘贴你想引用的内容链接",rows:7,css:{height:"180px !important",width:"100%",margin:"12px 0",paddingTop:"12px"},onChange:r,value:o}),(0,a.BX)(y.$U,{extra:{link:{url:ew}},zaAction:"OpenUrl",zaText:"cite_image_text_go_list",zaType:"Button",as:Z.ZP,preset:"plain",onClick:function(){return window.open(ew,"_blank")},children:[(0,a.tZ)(eZ,{css:{marginRight:"8px",verticalAlign:"middle"}}),"可视化图文内容库"]}),(0,a.BX)(I.w,{direction:"horizontal",children:[(0,a.tZ)(Z.ZP,{onClick:t,children:"取消"}),(0,a.tZ)(y.$U,{zaText:"cite_image_text_stick_click",zaType:"Button",as:Z.ZP,preset:"primary",color:"blue",onClick:function(){return n(o)},disabled:!o,children:"确认"})]})]})},eN=[{title:"粘贴链接",key:"sticky"},{title:"我的收藏夹",key:"collect"}],ek=function(e){var t=e.handleCancel,n=e.handleSelect,r=(0,o._)((0,m.useState)("sticky"),2),i=r[0],c=r[1],s=(0,o._)((0,m.useState)(""),2),l=s[0],d=s[1],p=(0,u.Z)(function(e){d(e.target.value)}),h=(0,g.useDispatch)(),f=(0,u.Z)(function(e){"sticky"===i?h((0,eT.P6)(e)).then(function(e){var t=e.payload,n=t.canReference,r=t.contentType,o=t.contentId;return n?h((0,eT.XT)({type:r,id:o})):Promise.reject()}).then(function(e){n(e.payload)}).catch(function(){h((0,z.c0)("此内容不可引用","red"))}):"collect"===i&&h((0,eT.XT)(e)).then(function(e){n(e.payload)})});return(0,a.tZ)(I.Z,{closeButton:null,css:{height:"416px",width:"536px"},size:"fullPage",children:(0,a.BX)(T.Box,{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden",children:["sticky"===i&&(0,a.tZ)(eR,{link:l,handleChange:p,handleCancel:t,handleConfirm:f}),"collect"===i&&(0,a.tZ)(eI,{handleSelect:f}),(0,a.tZ)(eg.Z,{css:{display:"flex",justifyContent:"center",borderBottom:"0",paddingTop:"10px",position:"absolute",width:"100%"},children:eN.map(function(e){var t=e.title,n=e.key;return(0,a.tZ)(eg.O,{onClick:function(){return c(n)},children:(0,a.tZ)(T.Box,{css:function(e){return{color:i===n?e.colors.GBK02A:e.colors.GBL05A,fontWeight:600,fontSize:"15px",lineHeight:"30px",position:"relative","&:hover":{cursor:"pointer"},"&::after":i===n?{content:"''",position:"absolute",top:"46px",left:"50%",transform:"translateX(-50%)",height:"4px",width:"36px",background:e.colors.GBL01A,borderRadius:"29px"}:{}}},children:t})},n)})})]})})},eO=n(4627),ex=n(26921),eP=n(89774),eD=n(21220),eL=[{value:"original",label:"原创"},{value:"reprint",label:"转载"}],eB="https://pic2.zhimg.com/v2-feb96045745dac939aa2a900c6d6845d.jpg",eU=[{name:"answer",id:1},{name:"article",id:2}],eM=n(15030),eG=n(25076);function eF(e){var t=e.content;return(0,a.tZ)(T.Box,{css:function(e){return{backgroundColor:e.colors.GBL01A,borderRadius:"4px",fontSize:"12px",lineHeight:"14px",color:e.colors.GBK99B,padding:"8px 12px",position:"absolute",left:0,top:"-33px","::after":{content:'""',display:"block",width:"6px",height:"6px",background:e.colors.GBL01A,position:"absolute",left:"25px",bottom:"-3px",transform:"rotate(45deg)"}}},children:t})}var ez=function(e){var t=e.defaultVideo,r=e.title,i=e.description,c=e.active,u=t.id,d=(0,g.useDispatch)(),p=(0,o._)((0,m.useState)(0),2),h=p[0],f=p[1],_=(0,o._)((0,eG.Z)("zvideo_contribution_form:should_hide_tooltip"),2),v=_[0],T=_[1],E=(0,o._)((0,m.useState)(!1),2),C=E[0],S=E[1],I=(0,o._)((0,m.useState)(!1),2),b=I[0],A=I[1],Z=(0,L.cF)(u).answer,w=(void 0===Z?{}:Z).canContribute,R=void 0!==w&&w,N=(0,L.fh)(u),k=((0,s.Z)(function(){return Promise.all([n.e(8091),n.e(6765)]).then(n.bind(n,59908))}),(0,m.useCallback)(function(){r?(d((0,L.O)(null)),S(!0),A(!1)):d((0,z.c0)("输入标题后才可以投稿哦"))},[r,d])),O=(0,m.useCallback)(function(){S(!0),A(!0)},[]);return((0,m.useEffect)(function(){d((0,L.ub)(u,"edit"))},[d,u]),(0,m.useEffect)(function(){var e,n;t.file&&(0,eM._)(t.file,File)?(e=t.file,new Promise(function(t,n){try{var r=document.createElement("video");r.preload="metadata",r.onloadedmetadata=function(){URL.revokeObjectURL(r.src),t(Math.floor(1e3*r.duration))},r.onerror=n,r.src=URL.createObjectURL(e)}catch(e){n(e)}})).then(function(e){d((0,L.Xg)({zvideoId:u,duration:e})),f(e)}):((null===(n=t.video)||void 0===n?void 0:n.duration)&&f(parseInt(1e3*t.video.duration)),d((0,L.Xg)({zvideoId:u})))},[t,d,u]),(0,l.Z)(function(){return T(!0)},!v&&R&&c?5e3:null),R||N.length)?(0,a.BX)(y.eV,{block:"Contribution",children:[(0,a.BX)("div",{className:"VideoUploadForm-item",children:[(0,a.tZ)(y.Wi,{zaType:"Block",className:"VideoUploadForm-itemTitle VideoUploadForm-itemTitle--top",children:"投稿问题"}),c&&!v&&(0,a.tZ)(eF,{content:"投稿到问题，让更多人看到你的视频"}),(0,a.tZ)("div",{children:(0,a.tZ)(B.Z,{zvideoId:u,showCreateButton:!0,onAdd:k,onSelect:O})})]}),(0,a.tZ)(K,{show:C,defaultVideo:t,title:r,description:i,duration:h,closeAfterEdit:b,onClose:function(){return S(!1)},isProduce:!0})]}):null};function eH(e){var t=new URLSearchParams(location.search);return e&&"longer"===t.get("mode")?80:40}var eq=function(e){var t=e.citeId,n=e.citeType;return{reference:{referenceType:n&&eU.find(function(e){return e.name===n}).id||0,referenceContentToken:t?String(t):"0"}}},eV=n(57508),eX=n(2930),eW=n(79446),eK=function(e){var t=e.title;return t&&(0,a.tZ)(T.Text,{sx:{lineHeight:"15px",fontSize:"15px",fontWeight:"bold",color:"GBK02A",marginBottom:"16px"},children:t})},ej=function(e){var t=e.title,n=e.description,o=e.imageUrl,i=e.duration,c=(0,eW.Z)(["avatarUrl","name"]),s=c.avatarUrl,l=c.name;return(0,a.BX)(T.Box,{width:"278px",pl:"20px",sx:{position:"absolute",right:0,top:"26px",borderLeft:"1px solid",borderColor:"GBK09A",overflow:"auto"},children:[(0,a.tZ)(eK,{title:"移动端预览效果"}),(0,a.BX)(T.Box,{width:"236px",height:"494px",sx:{backgroundImage:'url("https://pic3.zhimg.com/v2-6b6281a5e31bfc1385d8d4462f31ea5c.png")',backgroundSize:"100% 100%",fontSize:"12px",position:"relative",marginTop:"26px"},children:[(0,a.BX)(T.Box,{width:"222px",height:"281px",bg:"GBK99A",sx:{position:"absolute",left:"7px",top:"158px",overflow:"hidden"},children:[(0,a.BX)(T.Flex,{pt:"4px",mx:"9px",alignItems:"center",bg:"GBK99A",children:[(0,a.tZ)(T.Box,{width:"19px",height:"19px",mr:"9px",bg:"GBK10A",sx:{borderRadius:"50%",overflow:"hidden"},children:s&&(0,a.tZ)(T.Image,{src:s,width:"100%",height:"100%"})}),(0,a.BX)(T.Box,{children:[(0,a.tZ)(T.Text,{width:l?"150%":"24px",height:"9px",bg:l?"transparent":"GBK10A",mb:l?"2px":"0px",sx:{borderRadius:"4px",color:"GBK02A",lineHeight:"9px",transformOrigin:"0 center",transform:"scale(0.67)"},children:l}),(0,a.tZ)(T.Text,{width:s?"170%":"113px",height:"9px",bg:s?"transparent":"GBK10A",sx:{borderRadius:"4px",color:"GBK06A",lineHeight:"9px",transformOrigin:"0 center",transform:"scale(0.58)"},children:s&&"1 分钟前・发布了视频"})]})]}),(0,a.tZ)(T.Box,{width:t?"auto":"175px",height:t?"auto":"13px",bg:t?"transparent":"GBK10A",m:"4px 9px",sx:(0,r._)({borderRadius:"4px",fontWeight:"bold",zoom:t?.83:1},(0,eC.S)(2)),children:t}),(0,a.tZ)(T.Box,{m:"0 9px 5px",sx:(0,r._)({color:"GBK03A",zoom:n?.67:1},(0,eC.S)(3)),children:n||(0,a.BX)(a.HY,{children:[(0,a.tZ)(T.Text,{width:"199px",height:"9px",mb:"3px",bg:"GBK10A",sx:{borderRadius:"4px"}}),(0,a.tZ)(T.Text,{width:"74px",height:"9px",bg:"GBK10A",sx:{borderRadius:"4px"}})]})}),(0,a.BX)(T.Box,{height:"115px",bg:o?"GBK02B":"GBK10A",mx:"9px",sx:{borderRadius:"4px",overflow:"hidden",position:"relative"},children:[o&&(0,a.tZ)(T.Image,{src:o,width:"100%",height:"100%",sx:{objectFit:"cover"}}),(0,a.tZ)(eX.o,{css:{width:"34px",height:"34px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}),(0,a.tZ)(T.Text,{width:i?"auto":"23px",bg:i?"transparent":"GBK09B",height:i?"auto":"6px",sx:{position:"absolute",bottom:"7px",right:"7px",zoom:i?.58:1,color:"GBK99A",borderRadius:"4px"},children:i})]}),(0,a.tZ)(T.Image,{src:"https://pic1.zhimg.com/v2-add740deb6bfded14b013d4b115aef7f.png",width:"100%"}),(0,a.tZ)(T.Image,{src:"https://pic3.zhimg.com/v2-c98b0c106781ed7b3e12c03c6c5b3c86.png",width:"100%"})]}),(0,a.tZ)(T.Box,{width:"222px",height:"56px",sx:{position:"absolute",left:"7px",bottom:"6px",backgroundImage:'url("https://pic2.zhimg.com/v2-c80434267f8c3e22ca3b5cd109e4b5d4.png")',backgroundSize:"100% 100%"}})]})]})},eY=(0,ex.ZP)({init:!0,getScene:function(){return{type:"zvideo"}}})(function(e){var t,c,l,d,p,f,v,T,S,I,b,A,w,R,N,k,O,x,P,D=e.className,L=e.defaultVideo,B=e.status,U=e.checkFormValid,M=e.onRemove,F=e.onSubmit,H=e.shouldShowScheduledPublish,q=e.active,V=e.citeType,X=e.citeId,W=e.showMobilePreview,K=void 0!==W&&W,en=e.writeShield,es=(0,eP.Z)();(0,Q.Z)(function(){var e;null==en||null===(e=en.setOnModalClose)||void 0===e||e.call(en,function(){if(K){location.href="https://www.zhihu.com";return}null==M||M()})});var el=(0,o._)((0,m.useState)((0,eD.hX)(null==L?void 0:L.id)||(null==L?void 0:null===(c=L.chapters)||void 0===c?void 0:c.map(function(e){return(0,G._)((0,r._)({},e),{start_time:e.startTime})}))||[]),2),eu=el[0],ed=el[1],eg=(0,o._)((0,m.useState)(null),2),eE=eg[0],eC=eg[1],ey=(0,o._)((0,m.useState)(!1),2),eI=ey[0],eb=ey[1],eA=(0,o._)((0,m.useState)(!1),2),eZ=eA[0],ew=eA[1],eR=(t=null==L?void 0:null===(l=L.reference)||void 0===l?void 0:l.referenceType)?eU.find(function(e){return e.id===t}).name:null,eN=(0,o._)((0,m.useState)({citeType:eR||V||null,citeId:(null==L?void 0:null===(d=L.reference)||void 0===d?void 0:d.referenceContentToken)||X||null}),2),ex=eN[0],eM=eN[1],eG=(0,o._)((0,m.useState)(!1),2),eF=eG[0],eX=eG[1],eW=(0,o._)((0,m.useState)(!1),2),eK=eW[0],eY=eW[1],eQ=(0,o._)((0,m.useState)(!1),2),eJ=eQ[0],e$=eQ[1],e0=et.Z(new Date,30),e1=(0,o._)((0,m.useState)(!1),2),e2=e1[0],e3=e1[1],e4=(0,o._)((0,m.useState)(e0),2),e5=e4[0],e6=e4[1],e7=(0,g.useSelector)(function(e){return e.zvideos.tagoreCategory},g.shallowEqual),e8=(0,o._)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=(0,g.useDispatch)(),r=Array.isArray(e),o=r?e:[e];return(0,m.useMemo)(function(){return r?o.map(function(e){return(0,E.bindActionCreators)(e,n)}):(0,E.bindActionCreators)(o[0],n)},[n].concat((0,i._)(o),(0,i._)(t)))}([eT.eJ,eT.XD,eT.DQ,eT.Es,eT.SM,z.c0,eT.XT,eT.b_,eT.My,eT.l0]),10),e9=e8[0],te=e8[1],tt=e8[2],tn=e8[3],tr=e8[4],to=e8[5],ti=e8[6],ta=e8[7],tc=e8[8],ts=e8[9],tl=(0,g.useSelector)(function(e){return e.zvideos.videoSource}),tu=(0,o._)((0,m.useState)((null==L?void 0:L.title)||""),2),td=tu[0],tp=tu[1],th=(0,o._)((0,m.useState)(null!==(k=null==L?void 0:L.description)&&void 0!==k?k:""),2),tf=th[0],t_=th[1],tm=(0,o._)((0,m.useState)(null!==(O=null==L?void 0:null===(p=L.category)||void 0===p?void 0:null===(f=p.firstLevel)||void 0===f?void 0:f.id)&&void 0!==O&&O),2),tv=tm[0],tg=tm[1],tT=e7.find(function(e){return e.data.id===tv}),tE=(0,o._)((0,m.useState)(null!==(x=null==L?void 0:null===(v=L.category)||void 0===v?void 0:null===(T=v.secondLevel)||void 0===T?void 0:T.id)&&void 0!==x&&x),2),tC=tE[0],ty=tE[1],tS=(0,o._)((0,m.useState)(),2),tI=tS[0],tb=tS[1];(0,m.useEffect)(function(){ta().then(function(e){var t=e.payload.canRef,n=void 0!==t&&t;return(eb(n),n)?tc():(eM({citeId:null,citeType:null}),Promise.reject())}).then(function(e){ew(e.payload.agreeState)}).catch(_())},[]);var tA=function(e){var t=e.author,n=t.avatarUrl,r=t.name,o=e.type,i={headPhoto:n,name:r};if("article"===o){var a=e.imageUrl,c=e.title;i.contentPhoto=a,i.title=c}if("answer"===o){var s=e.question.title,l=e.thumbnailInfo,u=er()(void 0===l?{}:l,"thumbnails[0].url",null);u&&(i.contentPhoto=u),i.title=s}return i};(0,m.useEffect)(function(){var e=ex.citeId,t=ex.citeType;e&&t&&ti({type:t,id:e}).then(function(e){eC(tA(e.payload||{}))})},[]),(0,m.useEffect)(function(){e7.length||tt()},[e7,tt]);var tZ=(0,o._)((0,m.useState)(!!(null==L?void 0:null===(S=L.category)||void 0===S?void 0:null===(I=S.firstLevel)||void 0===I?void 0:I.id)||!!(null==L?void 0:null===(b=L.category)||void 0===b?void 0:null===(A=b.secondLevel)||void 0===A?void 0:A.id)),2),tw=tZ[0],tR=tZ[1],tN=(0,J.Z)(function(e){tn(e).then(function(e){var t=e.payload.data[0];t&&(tg(t.firstLevel.id),ty(t.secondLevel.id))})},300);(0,m.useEffect)(function(){tw||tN({title:td,type:"zvideo",content:tf})},[td,tf,tw,tN]);var tk=(0,o._)((0,m.useState)(null!==(P=null==L?void 0:L.topics)&&void 0!==P?P:[]),2),tO=tk[0],tx=tk[1],tP=(0,o._)((0,m.useState)(!!(null==L?void 0:null===(w=L.topics)||void 0===w?void 0:w.length)),2),tD=tP[0],tL=tP[1],tB=(0,o._)((0,m.useState)(!1),2),tU=tB[0],tM=tB[1],tG=(0,J.Z)(function(e){tr(e).then(function(e){var t=e.payload.data;t.length&&tx(t)})},300);(0,m.useEffect)(function(){!tD&&tv&&tC&&tG({type:"zvideo",text:td,firstLevelCategoryId:tv,secondLevelCategoryId:tC,limit:6})},[td,tv,tC,tD,tG]);var tF=(0,o._)((0,m.useState)(!1),2),tz=tF[0],tH=tF[1],tq=(0,o._)((0,m.useState)(null==L?void 0:L.imageUrl),2),tV=tq[0],tX=tq[1],tW=(0,o._)((0,m.useState)(null==L?void 0:L.imageUrlFrom),2),tK=tW[0],tj=tW[1],tY=(0,m.useCallback)(function(e,t){tX(e),tH(!0),tj(t)},[tX]);(0,m.useEffect)(function(){!tV&&(null==L?void 0:L.imageUrl)?tX(L.imageUrl):tV===eB&&(null==L?void 0:L.imageUrl)&&L.imageUrl!==eB&&tX(L.imageUrl)},[tV,L]);var tQ=(0,s.Z)(function(){return n.e(1951).then(n.bind(n,50316))}),tJ=(0,o._)((0,m.useState)(null==L?void 0:L.zvideoType),2),t$=tJ[0],t0=tJ[1],t1=(null==L?void 0:L.zvideoState)==="published";(0,m.useEffect)(function(){if(tl.isLoaded&&L.queryVideoId){if(td||tp(tl.title||""),!tO.length){var e;tx(null!==(e=tl.topics)&&void 0!==e?e:[])}t$||t0(tl.zvideoType)}},[tl,td,tO,t$,L]);var t2=(0,J.Z)(function(e,t){te(e,t)},300);(0,m.useEffect)(function(){L.id&&t2(L.id,(0,G._)((0,r._)({title:td,description:tf,category:{firstLevel:tv||void 0,secondLevel:tC||void 0},zvideoType:t$,topicIds:tO.map(function(e){return e.id||e.urlToken}),imageUrl:tV,imageUrlFrom:tK||2,isVisible:!0},eq(ex)),{chapters:eu,contentSource:(0,ec.u)(tI)}))},[L.id,td,tf,tv,tC,t$,tO,tV,tK,t2,ex,eu,tI]);var t3=(0,J.Z)(function(e){return e9(e).then(function(e){var t,n,r,o,i,a,c,s,l=e.payload;l&&(td||tp(l.title),!tV&&l.imageUrl&&tX(l.imageUrl),tf||t_(null!==(i=l.description)&&void 0!==i?i:""),tv||tg(null!==(a=null===(t=l.category)||void 0===t?void 0:null===(n=t.firstLevel)||void 0===n?void 0:n.id)&&void 0!==a&&a),tC||ty(null!==(c=null===(r=l.category)||void 0===r?void 0:null===(o=r.secondLevel)||void 0===o?void 0:o.id)&&void 0!==c&&c),(null==tO?void 0:tO.length)||tx(null!==(s=l.topics)&&void 0!==s?s:[]),t$||t0(l.zvideoType))})},300);(0,m.useEffect)(function(){L.id&&t3(L.id)},[L,t3]);var t4=!!L.id,t5=["uploading","uploadError"].includes(B),t6=(0,u.Z)(function(){ts().then(function(e){var t=e.payload.success;void 0!==t&&t&&(eY(!1),e$(!0),ew(!0))})}),t7=(0,u.Z)(function(e){ed((0,i._)(e))}),t8=(0,s.Z)(function(){return Promise.all([n.e(8091),n.e(4055)]).then(n.bind(n,27194))}),t9=eH(es);return(0,a.tZ)(y.eV,{block:"VideoUploadForm",content:{type:"Zvideo",id:L.id},children:(0,a.BX)(y.Wi,{zaType:"Block",className:h()("VideoUploadForm",D),children:[(0,a.BX)("div",{className:"VideoUploadForm-content",children:[(0,a.BX)("div",{className:"VideoUploadForm-item",children:[(0,a.tZ)("div",{className:"VideoUploadForm-itemTitle VideoUploadForm-itemTitle--required VideoUploadForm-itemTitle--topBelow",children:"封面"}),(0,a.BX)("div",{className:"VideoUploadForm-imageContainer",children:[!t5&&(0,a.tZ)("img",{className:"VideoUploadForm-image",src:tV||eB,alt:""}),t5&&(0,a.tZ)("div",{className:"VideoUploadForm-uploadStatus",children:"uploading"===B?"视频上传中":"视频上传失败"}),(0,a.tZ)("div",{className:"VideoUploadForm-duration",children:(0,eo.Z)(null===(R=L.video)||void 0===R?void 0:R.duration)}),(0,a.tZ)(ef.SV,{children:tQ&&(0,a.tZ)(tQ,{defaultVideo:L,coverChanged:tz,imageUrl:tV,onVideoPosterChange:tY})})]})]}),(0,a.BX)("div",{className:"VideoUploadForm-item",children:[(0,a.tZ)("div",{className:"VideoUploadForm-itemTitle VideoUploadForm-itemTitle--required",children:"标题"}),(0,a.tZ)(e_.Z,{className:"VideoUploadForm-input",value:td,onChange:function(e){tp(e.target.value)},placeholder:"输入视频标题",large:!0,after:(0,a.tZ)("div",{className:"VideoUploadForm-itemLimit",children:"".concat(td.length,"/").concat(t9)})}),td.length<5&&(0,a.BX)("div",{className:"VideoUploadForm-itemError",children:["最少输入 ",5," 个字"]}),td.length>t9&&(0,a.BX)("div",{className:"VideoUploadForm-itemError",children:["已超出 ",td.length-t9," 个字"]})]}),(0,a.BX)("div",{className:"VideoUploadForm-item",children:[(0,a.tZ)("div",{className:"VideoUploadForm-itemTitle VideoUploadForm-itemTitle--topBelow",children:"简介"}),(0,a.tZ)(e_.Z,{className:"VideoUploadForm-input VideoUploadForm-input--multiline",value:tf,onChange:function(e){t_(e.target.value)},placeholder:"填写视频简介，让更多人找到你的视频",multiline:!0,large:!0,rows:4,after:(0,a.tZ)("div",{className:"VideoUploadForm-itemLimit VideoUploadForm-itemLimit--multiline",children:"".concat(tf.length,"/").concat(300)})}),tf.length>300&&(0,a.BX)("div",{className:"VideoUploadForm-itemError VideoUploadForm-itemError--multiline",children:["已超出 ",tf.length-300," 个字"]})]}),t4&&(0,a.tZ)(ez,{defaultVideo:L,title:td,description:tf,active:q}),(0,a.BX)("div",{className:"VideoUploadForm-item",children:[(0,a.tZ)("div",{className:"VideoUploadForm-itemTitle VideoUploadForm-itemTitle--required",children:"所属领域"}),(0,a.BX)("div",{className:"VideoUploadForm-selectContainer",children:[(0,a.BX)(em.Z,{className:"VideoUploadForm-select",listClassName:"VideoUploadForm-selectList",value:tv,onChange:function(e){tg(e),ty(!1),tR(!0)},children:[!tT&&(0,a.tZ)(em.W,{value:!1,text:"选择领域"},"all"),e7.map(function(e){var t=e.data;return(0,a.tZ)(em.W,{value:t.id,text:t.name},t.id)})]}),tT&&(0,a.BX)(em.Z,{className:"VideoUploadForm-select",listClassName:"VideoUploadForm-selectList",value:tC,onChange:function(e){ty(e),tR(!0)},children:[(0,a.tZ)(em.W,{value:!1,text:"选择领域"},"all"),tT.children.map(function(e){var t=e.data;return(0,a.tZ)(em.W,{value:t.id,text:t.name},t.id)})]})]})]}),(0,a.BX)("div",{className:"VideoUploadForm-item",children:[(0,a.tZ)("div",{className:"VideoUploadForm-itemTitle VideoUploadForm-itemTitle--required VideoUploadForm-itemTitle--topic",children:"绑定话题"}),(0,a.tZ)(eO.Z,{className:"VideoUploadForm-topicInput",value:tO,onChange:function(e){tx(e),tL(!0)},max:6,actived:tU,onToggleActived:function(){return tM(!tU)}})]}),(0,a.tZ)(eV.Z,{zvideo_id:L.id,defaultVideo:L,children:(0,a.tZ)(eV.o.Consumer,{children:function(e){return e.canUse&&t8&&(0,a.tZ)(t8,{onSubmit:t7,knowledges:eu,defaultVideo:L})}})}),(0,a.BX)("div",{className:"VideoUploadForm-item",children:[(0,a.tZ)("div",{className:"VideoUploadForm-itemTitle VideoUploadForm-itemTitle--required",children:"视频类型"}),(0,a.BX)("div",{className:"VideoUploadForm-typeContainer",children:[(0,a.tZ)("div",{className:h()("VideoUploadForm-radioContainer",{"VideoUploadForm-radioContainer--disabled":t1}),children:eL.map(function(e){return(0,a.BX)("label",{className:"VideoUploadForm-radioLabel",children:[(0,a.tZ)(j.Z,{className:"VideoUploadForm-radio",size:16,checked:e.value===t$,onChange:function(){t0(e.value)},disabled:t1}),e.label]},e.value)})}),"reprint"===t$&&(0,a.tZ)("div",{className:"VideoUploadForm-typeHint",children:"请确保转载视频符合版权使用规范，如被举报侵权，视频将会被删除"})]})]}),eI&&(0,a.BX)("div",{className:"VideoUploadForm-item",css:{alignItems:"flex-start"},children:[(0,a.BX)("div",{className:"VideoUploadForm-itemTitle",children:[(0,a.tZ)("span",{css:{marginRight:"4px",verticalAlign:"middle"},children:"联合创作"}),(0,a.tZ)($.rk,{size:16,fill:"#8590A6",css:{verticalAlign:"middle",cursor:"pointer"},onClick:function(){return eX(!0)}})]}),eE?(0,a.tZ)(y.eV,{content:{token:String(ex.citeId),type:eS.LA[ex.citeType]},children:(0,a.BX)(y.Wi,{zaType:"Card",view:{elementLocation:{card:{index:0}}},children:[(0,a.tZ)("div",{css:function(e){return{color:e.colors.GBL05A,fontSize:"14px",lineHeight:"14px",marginBottom:"13px",textAlign:"right"}},children:(0,a.tZ)(Z.ZP,{onClick:function(){(null==L?void 0:L.zvideoState)!=="published"?(eC(null),eM({citeId:null,citeType:null})):to("视频已发布，无法删除引用内容","red")},css:{padding:"0",lineHeight:"1",border:"none"},children:"删除"})}),(0,a.BX)("div",{css:function(e){return{width:"400px",padding:"12px 12px 12px 15px",background:e.colors.GBK10C,borderRadius:"3px",display:"flex",justifyContent:"space-between"}},children:[(0,a.BX)("div",{children:[(0,a.tZ)("div",{css:function(e){return{color:e.colors.GBK03A,fontSize:"14px",lineHeight:"18px",marginBottom:"13px",fontWeight:"500"}},children:eE.title}),(0,a.BX)("div",{children:[(0,a.tZ)("img",{css:{width:"16px",height:"16px",borderRadius:"50%",verticalAlign:"middle",objectFit:"cover"},src:eE.headPhoto,alt:""}),(0,a.tZ)("span",{css:function(e){return{fontSize:"13px",lineHeight:"18px",color:e.colors.GBK03A,marginLeft:"8px",verticalAlign:"middle"}},children:eE.name})]})]}),eE.contentPhoto&&(0,a.tZ)("img",{css:{width:"95px",height:"65px",borderRadius:"5px",objectFit:"cover"},src:eE.contentPhoto,alt:""})]})]})}):(0,a.tZ)(y.$U,{zaText:"cite_image_text_content_click",zaType:"Button",as:Z.ZP,onClick:function(){eZ?e$(!0):eY(!0)},css:{lineHeight:"30px"},icon:ee.nY,preset:"plain",color:"blue",children:"引用图文内容"})]}),H&&(0,a.BX)("div",{className:"VideoUploadForm-item VideoUploadForm-scheduledPublish",children:[(0,a.tZ)("span",{className:"VideoUploadForm-itemTitle",children:"定时发布"}),(0,a.tZ)(Y.Z,{className:"VideoUploadForm-scheduledPublish--switch",checked:e2,onChange:function(e){return e3(e.target.checked)}}),e2&&(0,a.BX)(a.HY,{children:[(0,a.tZ)(eh.Z,{className:"VideoUploadForm-scheduledPublish--timePicker",value:e5,min:e0,onChange:function(e){e6(Date.parse(e))}}),(0,a.tZ)($.rk,{className:"VideoUploadForm-scheduledPublish--tooltip",size:18,"data-tooltip":"时间需至少设置在30分钟以后","aria-label":"时间需至少设置在30分钟以后","data-tooltip-position":"top"})]})]}),(0,a.BX)("div",{className:"VideoUploadForm-item",css:{alignItems:"flex-start"},children:[(0,a.tZ)("div",{className:"VideoUploadForm-itemTitle",children:(0,a.tZ)("span",{css:{marginRight:"4px",verticalAlign:"middle"},children:"内容来源"})}),(0,a.tZ)(ea.b,{handleSubmit:tb,originInfo:tI})]}),eF&&(0,a.tZ)(ev,{handleConfirm:function(){eX(!1)}}),eK&&(0,a.tZ)(ep,{handleAgree:t6,handleCancel:function(){return eY(!1)}}),eJ&&(0,a.tZ)(ek,{handleCancel:function(){return e$(!1)},handleSelect:function(e){var t=e.id,n=e.type;eC(tA(e)),eM({citeId:t,citeType:void 0===n?"":n}),e$(!1)}})]}),(0,a.BX)("div",{className:"VideoUploadForm-buttonGroup",children:[(0,a.tZ)(y.$U,{zaText:!0,zaType:"Button",zaBlock:"CancelPublishVideo",zaAction:"Close",as:Z.ZP,preset:"secondary",color:"blue",css:{padding:"0 31px"},onClick:M,children:"取消发布"}),(0,a.tZ)(ei.r,{module:"Content",card:{content:{type:"Zvideo",token:L.id}},children:(0,a.tZ)(y.$U,{zaText:!0,zaType:"Button",zaBlock:"PublishVideo",zaAction:"Save",extra:{configMap:{publishSource:(null==L?void 0:L.zvideoState)||"upload"}},as:Z.ZP,className:"VideoUploadForm-submitButton",preset:"primary",color:"blue",disabled:"uploadError"===B,css:{padding:"0 31px"},onClick:function(e){var t=function(e,t,n){var r=e.title,o=e.description,i=e.categoryFirstLevel,a=e.categorySecondLevelId,c=e.topics,s=e.zvideoType,l=eH(n);if(!r||r.length<5)return"视频标题至少 ".concat(5," 个字");if(r.length>l)return"视频标题最多 ".concat(l," 个字");if(o.length>300)return"视频描述最多 ".concat(300," 个字");if(!i)return"请选择所属领域";if(!a)return"请选择所属二级领域";if(!c.length)return"请绑定话题";if(!s)return"请选择类型";if(t){var u=t();if(u)return u}}({title:td,description:tf,categoryFirstLevel:tT,categorySecondLevelId:tC,topics:tO,zvideoType:t$},U,es);if(t)return to(t,"red");C.Z.trackEvent(e.target,{id:7038,action:"Upload"},{button:{text:e2?"定时发布":"发布视频"}}),F((0,G._)((0,r._)({id:L.id,videoId:L.videoId,title:td,description:tf,category:{firstLevel:tv,secondLevel:tC},zvideoType:t$,topicIds:tO.map(function(e){return e.id||e.urlToken}),imageUrl:tV,imageUrlFrom:tK||2,publishAt:e5},eq(ex)),{chapters:eu}),e2)},children:e2?"定时发布":"发布视频"})})]}),K&&(0,a.tZ)(ej,{title:td,description:tf,imageUrl:tV,duration:(0,eo.Z)(null===(N=L.video)||void 0===N?void 0:N.duration)})]})})}),eQ=n(85576),eJ=n(64512),e$=n(61763),e0=n(74135),e1=n(6148),e2=n(92718),e3=n(62250),e4=n(27521),e5={zvideoIndex:"zvideoIndex",zvideoDraft:"zvideoDraft",CreationDraftVideoTab:"CreationDraftVideoTab",zvideoToolbar:"zvideoToolbar",CreationVideoTab:"CreationVideoTab"},e6=n(58909),e7=n(7407),e8=n(71728),e9=n(58245),te=n(99878),tt=function(e){var t,n,r,o,i=e.startTime,c=e.endTime,s=e.target,l=e.status,u=e.abnormalReason,d=s.parentObject,p=d.id,h=d.title,f=s.object.id,_=null;return 0===l?(t="已保存草稿",n="GBK06A",_=(0,a.tZ)(te.N,{}),r="GBK06A"):1===l?(t="发布中...",n="GBK06A",r="GBK06A"):2===l?"审核中"===u?(t="审核中",n="GBL05A",_=(0,a.tZ)(te.N,{}),r="GBK06A"):(t="已投稿",n="GBL01A",_=(0,a.tZ)(te.N,{}),r="GBK03A"):3===l&&(t="发布失败",n="GRD03A",_=(0,a.tZ)(te.N,{}),r="GBK06A",o=!0),{status:l,statusText:t,statusColor:n,StatusIcon:_,titleColor:r,hasAbnormalInfo:o,startTime:Math.floor(i/1e3),endTime:Math.floor(c/1e3),questionId:p,title:h,answerId:f,abnormalReason:u}},tn=function(e){var t=e.status,n=e.questionId,o=e.answerId,i=e.children,c=(0,e8._)(e,["status","questionId","answerId","children"]);return 2===t?(0,a.tZ)(T.Link,(0,G._)((0,r._)({target:"_blank",href:"https://www.zhihu.com/question/".concat(n,"/answer/").concat(o),css:{display:"block",cursor:"pointer"}},c),{children:i})):(0,a.tZ)(T.Box,(0,G._)((0,r._)({},c),{children:i}))},tr={已保存草稿:"已保存草稿",发布失败:"发布失败",已投稿:"投稿成功",审核中:"审核中","发布中...":"发布中..."},to={已保存草稿:"继续编辑",发布失败:"修改草稿",已投稿:"已投稿",审核中:"查看投稿","发布中...":""},ti=function(e){var t=e.item,n=(0,e8._)(e,["item"]),o=tt(t),i=o.status,c=o.statusText,s=o.statusColor,l=o.StatusIcon,u=o.titleColor,d=o.hasAbnormalInfo,p=o.questionId,h=o.title,f=o.answerId,_=o.abnormalReason;return(0,a.BX)(tn,(0,G._)((0,r._)({py:"20px",css:function(e){return(0,r._)({},0===i&&{cursor:"pointer"},(0,e9.M)({borderTop:"1px solid ".concat(e.colors.GBK09A)}))},status:i,questionId:p,answerId:f},n),{children:[(0,a.BX)(T.Flex,{color:s,alignItems:"center",mb:"8px",fontSize:"12px",children:[(0,a.tZ)(T.Text,{children:tr[c]}),(0,a.tZ)(T.Text,{ml:"auto",fontWeight:"bold",css:function(e){return{color:e.colors.GBL01A}},children:to[c]}),c===tr.发布失败?null:l]}),(0,a.tZ)(T.Text,{color:u,fontSize:"14px",children:h}),d&&(0,a.tZ)(T.Text,{p:"8px",mt:"8px",color:"GBK03A",fontSize:"14px",css:function(e){return{borderRadius:2,backgroundColor:e.colorMod(e.colors.GRD03A).alpha(.08)}},children:_})]}))},ta=Object.assign,tc=function(e){return v().createElement(V.Z,ta({width:"14",height:"16",fill:"none",viewBox:"0 0 14 16"},e),v().createElement("path",{fill:"#8590A6",fillRule:"evenodd",d:"M1 2.666c0-.736.597-1.333 1.334-1.333h9.333c.736 0 1.334.597 1.334 1.333v10.667c0 .736-.598 1.333-1.334 1.333h-1.666a.333.333 0 0 1-.334-.333v-4A2.333 2.333 0 0 0 7.334 8h-6A.333.333 0 0 1 1 7.667v-5Zm2.667 0a.667.667 0 1 0 0 1.334h6.667a.667.667 0 1 0 0-1.333H3.667ZM3 6c0-.368.299-.667.667-.667H9a.667.667 0 0 1 0 1.334H3.667A.667.667 0 0 1 3 6Zm-2 4.334a1 1 0 0 1 1-1h5.333a1 1 0 0 1 1 1v3.333a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3.333Zm5.167 1.377a.333.333 0 0 1 0 .578l-2 1.154a.333.333 0 0 1-.5-.288v-2.31c0-.256.277-.417.5-.288l2 1.154Z",clipRule:"evenodd"}))},ts=(0,m.forwardRef)(function(e,t){var n=e.label,o=e.onClick,i=(0,e8._)(e,["label","onClick"]);return(0,a.tZ)(y.$U,{zaText:!0,zaType:"Button",zaBlock:"VideoContributeButton",className:"ContentItem-action",children:(0,a.tZ)(Z.ZP,(0,r._)({ref:t,preset:"plain",onClick:o,icon:tc,label:n},i))})}),tl=n(71783),tu=(0,eQ.Z)(function(e){var t=e.isLiked,n=e.onClick,o=e.showIcon,i=e.authRequired,c=(e.currentUser,e.isLogin,(0,e8._)(e,["isLiked","onClick","showIcon","authRequired","currentUser","isLogin"])),s=(0,u.Z)(function(e){var r=!t,o=r?"Like":"UnLike";C.Z.trackEvent(e.target,{id:7448,action:o}),i(function(){return n(r)})()});return(0,a.tZ)(Z.ZP,(0,r._)({preset:"plain",onClick:s,icon:void 0===o||o?tl.sh:null,label:t?"取消喜欢":"喜欢","aria-live":"polite"},c))}),td=n(9338),tp=n(30971),th=n(6779),tf=n(61255),t_=n(5469),tm=(0,m.forwardRef)(function(e,t){var n=e.onClick,o=(0,e8._)(e,["onClick"]);return(0,a.tZ)(Z.ZP,(0,r._)({ref:t,preset:"plain",onClick:n,icon:th.T,label:"设置"},o))}),tv=function(e){var t,n,o,i=e.className,c=e.zvideo,s=e.onEdit,l=e.onToggleVisibility,u=e.onRemove,d=e.onChangeCommentPermission,p=e.togglerProps,f=(0,g.useDispatch)(),_=c.id,v=c.commentPermission,E=c.isVisible,C=c.creationRelationship,y=null==C?void 0:null===(n=C.coCreation)||void 0===n?void 0:null===(o=n.bizInfo)||void 0===o?void 0:o.canCancelPermission,I=(0,m.useCallback)((t=(0,td._)(function(e){var t;return(0,tp.__generator)(this,function(n){switch(n.label){case 0:return t="视频删除后将不可恢复",[4,f((0,eT.Hi)(_)).then(function(e){var n=e.payload.message;n&&(t=n)})];case 1:return n.sent(),F.Z.confirm((0,a.tZ)(T.Text,{textAlign:"center",children:t}),{title:"确定删除视频",text:{ok:"删除视频"}}).then(function(){u(e)}),[2]}})}),function(e){return t.apply(this,arguments)}),[f,_,u]),b=(0,a.BX)(a.HY,{children:[(0,a.tZ)(S.sN,{onClick:s,children:"编辑视频"}),(0,a.tZ)(S.sN,{onClick:l,children:"在视频列表内".concat(E?"隐藏":"显示")}),(0,a.tZ)(S.R,{}),(0,a.tZ)(t_.rt,{current:v,target:c,onChange:d}),(0,a.tZ)(S.R,{}),(0,a.tZ)(S.sN,{onClick:I,children:"删除"})]});return(0,a.tZ)(S.ZP,{arrowed:!!y,className:h()("ZVideoSettingMenu",i),itemClassName:"ZVideoSettingMenu-item",toggler:(0,a.tZ)(tm,(0,r._)({},p)),reversed:!0,children:y?(0,a.tZ)(S.sN,{children:(0,a.tZ)(tf.ZY,{contentType:"zvideo",contentId:_})}):b})},tg=n(50436),tT=n(28814),tE={up:1,neutral:0,down:-1};function tC(e){var t,p,f,v,E,b,B,U,M,G,F,H,q,V,X,W,j=(0,g.useDispatch)(),Y=e.className,Q=e.zvideo,J=e.author,$=e.commentsShown,ee=e.onCommentButtonClick,et=void 0===ee?_():ee,en=e.renderOptions,er=e.renderActionButtons,eo=e.enableContribute,ei=void 0!==eo&&eo,ea=e.customShareTitle,ec=e.authRequired,es=Q.id,el=Q.title,eu=Q.description,ed=Q.voting,ep=Q.voteCount,eh=Q.voteupCount,ef=Q.commentCount,e_=Q.isLiked,em=Q.isFavorited,ev=Q.contribute,eg=Q.video,eE=Q.video,eC=(void 0===eE?{}:eE).duration,ey=void 0===eC?0:eC,eI=Q.isOgv,eA=(t=Q.creationRelationship,f="string"==typeof(p=(0,tg.YJ)(t))?p:null==p?void 0:p.urlToken,v=(0,g.useSelector)(function(e){return(0,tT.np)(e,{urlToken:f})}),t?null!=v?v:p:null),eZ=(0,e6.xw)(eA),ew=(0,e6.xw)(J)&&!eZ,eR=ew||eZ,eN=(0,e7.dD)(),ek=(0,m.useMemo)(function(){return parseInt(1e3*ey)},[ey]),eO=(0,m.useMemo)(function(){return{id:es,video:eg}},[es,eg]),ex=(0,s.Z)(function(){return Promise.all([n.e(8091),n.e(6765)]).then(n.bind(n,59908))}),eP=(0,L.fh)(es),eD=(0,o._)((0,m.useState)(!1),2),eL=eD[0],eB=eD[1],eU=(0,L.cF)(es).answer,eM=(void 0===eU?{}:eU).canContribute,eF=void 0!==eM&&eM,ez=!!((null==ev?void 0:null===(W=ev.contributeList)||void 0===W?void 0:W.length)||(null==ev?void 0:ev.totals)),eH=ei&&!eN&&ew&&ez,eq=ei&&!eN&&ew&&eF&&!ez,eV=(0,o._)((0,eG.Z)("zvideo_toolbar:should_hide_contribution_tooltip"),2),eX=eV[0],eW=eV[1],eK=(0,m.useRef)();(0,l.Z)(function(){return eW(!0)},!eX&&eq?5e3:null);var ej=(0,m.useCallback)(function(){eB(!0),j((0,L.ub)(es,"edit"))},[es,j]),eQ=(0,m.useCallback)(function(){return j((0,L.Xg)({zvideoId:es,target:"answer",duration:ek}))},[j,es,ek]),e8=(0,m.useCallback)(function(e){return j((0,eT.qO)(es,tE[e]))},[es,j]),e9=(0,m.useCallback)(function(e){j((0,eT.SL)(es,e))},[j,es]),te=(0,o._)((0,m.useState)(!1),2),tt=te[0],tn=te[1],tr=ec(function(e){tn(!0),C.Z.trackEvent(e.target,{id:8213,action:"Collect",is_intent:!em})},eS.q0.favlists),to=(0,m.useCallback)(function(){tn(!1)},[]),ta=(0,m.useCallback)(function(e,t){j((0,eT.ER)(es,t))},[es,j]),tc=(0,m.useCallback)(function(){j((0,eT.MM)(es))},[es,j]),tl=(0,m.useCallback)(function(){j((0,eT.W2)(es)).then(function(){if(J){var e="https://www.zhihu.com/people/".concat(J.urlToken,"/zvideos");window.location.href=e}})},[es,J,j]),td=(0,o._)((0,m.useState)(null),2),tp=td[0],th=td[1],tf=(0,o._)((0,m.useState)(!1),2),t_=tf[0],tm=tf[1],tC=(0,o._)((0,m.useState)(!1),2),ty=tC[0],tS=tC[1];(0,m.useEffect)(function(){t_&&!tp&&j((0,eT.eJ)(es)).then(function(e){th(e.payload)})},[es,t_,tp,j]),(0,m.useEffect)(function(){ew&&!eN&&ei&&eQ()},[ew,eQ,eN,ei]);var tI=(E=e5.zvideoToolbar,b=(0,o._)((0,eJ.zb)(),1)[0],B="1"===(0,e2.Z)("ws_video_publish")&&"1"===eb.Z.apollo.content_publish_zvideo,M=(U=(0,e3.u)("zvideo",E)).publish,G=U.scheduledPublish,F=(0,g.useDispatch)(),H=(0,m.useState)({publish:function(e,t){return b.safeRecordStageStart("publish",{type:"publish",hitContentPublish:B}),F((0,eT.oi)(e,t))},scheduledPublish:function(e,t){return b.safeRecordStageStart("publish",{type:"scheduledPublish",hitContentPublish:B}),F((0,eT.KB)(e,t))}})[0],q=function(e){return{payload:e}},V=function(e){throw F((0,z.c0)((0,e$.n$)(e),"red")),e},X=(0,m.useState)({publish:function(e,t){return b.safeRecordStageStart("publish",{type:"publish",hitContentPublish:B}),b.safeRecordStageStart("pre-request"),M(function(e,t){var n=new e4.y;if(!t)return n.setDraft("id",e),n.setExtraInfo("publisher","pc"),n.build();var r=(0,e1.hZ)((0,e0.decamelizeKeys)(t));r&&n.setExtraInfo("pc_business_params",r);var o=t.videoId,i=t.title,a=t.description,c=t.category,s=t.zvideoType,l=t.topicIds,u=t.imageUrl,d=t.imageUrlFrom,p=t.chapters,h=t.contentSource,f=t.reference;return n.setDraft("id",e),n.addMedia({video:{cover:{originalUrl:u},videoId:o,image_url_from:d}}),n.setExtraInfo("publisher","pc"),h&&n.set("hybridInfo",{contentSource:h}),a&&n.set("description",{description:a}),n.set("title",{title:i}),n.set("originalReprint",{originalReprint:s}),n.set("topic",{topics:l.map(function(e){return{topic_id:e}})}),n.set("category",(0,e0.decamelizeKeys)({category:c})),n.set("chapters",(0,e0.decamelizeKeys)({chapters:p})),n.set("reference",(0,e0.decamelizeKeys)({reference:f})),n.build()}(e,t)).then(q,V)},scheduledPublish:function(e,t){b.safeRecordStageStart("publish",{type:"scheduledPublish",hitContentPublish:B}),b.safeRecordStageStart("pre-request");var n=new e4.y;return n.setDraft("id",e).set("schedule",{publishAt:t}),n.setExtraInfo("publisher","pc"),n.setExtraInfo("pc_business_params",(0,e1.hZ)((0,e0.decamelizeKeys)({publishAt:t}))),G(n.build()).then(q,V)}})[0],B?X:H).publish,tb=(0,o._)((0,eJ.zb)(),1)[0],tA=(0,m.useCallback)(function(e){tb.startFreshReport("zvideo",e5.zvideoToolbar),tI(es,e).then(function(){tb.safeRecordStageStart("post-publish"),j((0,L.__)(es));var e="https://www.zhihu.com/zvideo/".concat(es);window.location.href=e}).catch(function(e){throw tb.safeReport(e,"catch in publish"),e})},[es,j,tI,tb]),tZ=(0,o._)((0,m.useState)(!1),2),tw=tZ[0],tR=tZ[1],tN=(0,c.qC)().blockStrategies,tk=(0,A.Z)([(0,A.m)(tN)],er),tO=tk({componentList:[{name:"favlist",component:(0,a.tZ)(N.Z,{onClick:tr,label:"收藏",showIcon:!eN},"favlist")},{name:"like",component:(0,a.tZ)(tu,{isLiked:e_,onClick:e9,showIcon:!eN},"like")},{name:"report",component:!eR&&(0,a.tZ)(x.Z,{id:es,type:"zvideo",onModalShown:tR},"report")}]}).filter(Boolean),tx=(0,m.useCallback)(function(){th(null),tm(!1),j((0,eT.dc)(es))},[j,es]),tP=(0,u.Z)(function(e){ej(),j((0,L.O)(e.id)),tS(!1)}),tD=(0,u.Z)(function(e){eQ(),j((0,eT.dc)(e)),eB(!1)});return(0,a.BX)(a.HY,{children:[(0,a.tZ)("div",{css:{marginBottom:"14px"},children:(0,a.BX)(R.eX,{className:h()("ZVideoToolbar",Y),children:[tk({componentList:[{name:"vote",component:(0,a.tZ)(D.Z,{type:"zvideo",count:eh||ep,voting:ed,onVote:e8,isOwner:ew,zaIds:{voteUp:6599,voteDown:6600}},"vote")},{name:"comment",component:(0,a.tZ)(w.Z,{onClick:et,commentsShown:void 0!==$&&$,count:ef,positionStatus:"normal"},"comment")},{name:"share",component:(0,a.tZ)(P.Z,{id:es,type:"zvideo",url:"https://".concat(eb.Z.wwwHost,"/zvideo/").concat(es).concat(eI?"?page=ogv":""),title:ea||el,authorName:null==J?void 0:J.name,positionStatus:"normal"},"share")}]}),eN?(0,a.BX)(S.ZP,{preventCloseOnTarget:!0,globalClose:!tw,menuContainerClassName:"ZVideoToolbar-menuContainer",toggler:(0,a.tZ)(Z.ZP,{preset:"plain",icon:d.AZ,"aria-label":"更多"}),children:[tO.map(function(e){return(0,a.tZ)(S.sN,{className:"ZVideoToolbar-menuItem",children:e},e.key)}),!eR&&en()]}):(0,i._)(tO).concat((0,i._)(eR?[]:en())),eH&&(0,a.tZ)(ts,{label:"全部投稿",onClick:function(){j((0,L.ub)(es)),tS(!0)}}),eq&&(0,a.BX)(a.HY,{children:[(0,a.tZ)(ts,{ref:eK,label:"添加投稿",onClick:ej}),(0,a.tZ)(O.Z,{placement:"top",isOpen:!eX,target:eK.current,children:"投稿到问题，让更多人看到你的视频"})]}),eR&&(0,a.tZ)(tv,(0,r._)({zvideo:Q,onEdit:function(){return tm(!0)},onToggleVisibility:tc,onChangeCommentPermission:ta,onRemove:tl},eN&&{togglerProps:{label:null}}))]})}),ew&&(0,a.tZ)(I.Z,{className:"ZVideoToolbar-videoFormModal",title:"编辑视频",size:"fullPage",onClose:tx,css:{width:"734px",".Modal-inner":{"::-webkit-scrollbar":{display:"none"}},".Modal-title":{marginLeft:32}},children:t_&&tp&&(0,a.tZ)(eY,{defaultVideo:tp,onSubmit:tA,onRemove:tx})}),(0,a.tZ)(k.E,{id:es,type:"zvideo",shown:tt,onClose:to,zaEnabled:!0}),ei&&!eN&&ew&&(0,a.BX)(a.HY,{children:[(0,a.tZ)(I.Z,{title:(0,a.BX)(T.Flex,{px:"24px",justifyContent:"space-between",children:[(0,a.tZ)(T.Text,{fontSize:"24px",color:"GBK02A",children:"全部视频回答投稿"}),eF&&(0,a.tZ)("button",{css:function(e){return{width:90,height:34,border:"none",borderRadius:3,fontSize:14,fontWeight:"normal",color:e.colors.GBL01A,backgroundColor:e.colorMod(e.colors.GBL01A).alpha(.08)}},onClick:function(){ej(),tS(!1)},children:"添加投稿"})]}),css:function(e){return{width:536,height:554,backgroundColor:e.colors.GBK99A,".Modal-title":{marginTop:24},".Modal-inner::-webkit-scrollbar":{display:"none"}}},onClose:function(){return tS(!1)},children:ty&&eP.map(function(e){return(0,a.tZ)(ti,(0,r._)({item:e},0===e.status&&{onClick:function(){tP(e)}}),e.id)})}),!!ex&&(0,a.tZ)(y.eV,{block:"Contribution",children:(0,a.tZ)(K,{show:eL,defaultVideo:eO,title:el,description:eu,duration:ek,onClose:function(){tD(es)},shouldPublish:!0})})]})]})}tC.defaultProps={renderOptions:function(){return[null]},renderActionButtons:b.Z};var ty=(0,E.compose)(eQ.Z)(tC)},63020:function(e,t,n){"use strict";n.d(t,{Z:function(){return z}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(85626),d=n(85879),p=n(14168),h=n.n(p),f=n(87363),_=n(36695),m=n(93206),v=n(69383),g=n(67516),T=n.n(g),E=n(1785),C=n(45842),y=n(76741),S=n(94009),I=n(74128),b=n(38889),A=n(12506),Z=n(20072),w=n(77683),R=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{expanded:!0}),(0,a._)((0,r._)(e),"handleTitleClick",function(t){v.Z.trackEvent((0,r._)(e),{id:6121,action:"OpenUrl",element_name:"Title"}),window.open(t)}),(0,a._)((0,r._)(e),"renderHeader",function(){var t=e.props,n=t.title,r=t.url,o=t.author;return(0,d.BX)("div",{className:"AbstractCard-header",children:[(0,d.BX)("div",{className:"AbstractCard-desc",children:[(0,d.tZ)("span",{role:"button",tabIndex:0,className:"AbstractCard-title",onClick:function(){return e.handleTitleClick(r,n)},children:n}),(0,d.tZ)("span",{className:"AbstractCard-source",children:e.abstractSourceInfo})]}),(0,d.tZ)(w.Z,{zaId:6120,className:"AbstractCard-author",author:o,preset:"plain"})]})}),(0,a._)((0,r._)(e),"renderContent",function(){var t=e.props,n=t.content,r=t.member.name,o=t.theme;return(0,d.BX)("div",{className:"AbstractCard-content",children:[(0,d.tZ)("div",{className:"AbstractCard-text AbstractCard-text--".concat(o),children:n}),(0,d.tZ)("div",{className:"AbstractCard-tip",children:(0,d.BX)("span",{className:"AbstractCard-info",children:[r," 摘录于 ",e.createdFormat]})})]})}),e}return(0,i._)(n,[{key:"abstractSourceInfo",get:function(){return"answer"===this.props.type?"下的回答内容摘录":"下的内容摘录"}},{key:"createdFormat",get:function(){var e=this.props.created;return(0,A.Z)(e?new Date(1e3*e):new Date,"yyyy-MM-dd")}},{key:"componentDidMount",value:function(){(0,Z.y3)(this.node,function(){v.Z.trackCardShow(null,{id:6118})})}},{key:"render",value:function(){var e=this;return(0,d.BX)("div",{className:"AbstractCard",ref:function(t){e.node=t},children:[this.renderHeader(),this.renderContent()]})}}]),n}(f.Component);(0,a._)(R,"propTypes",{title:h().string.isRequired,url:h().string.isRequired,author:h().object,member:h().object,content:h().string.isRequired,created:h().number,theme:h().string.isRequired});var N=n(4627),k="TopicSelect",O=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{topics:[],actived:!1}),(0,a._)((0,r._)(e),"handleChange",function(t){(0,e.props.onChange)(t),e.setState(function(e){return(0,l._)((0,s._)({},e),{actived:!1,topics:t})})}),(0,a._)((0,r._)(e),"deactived",function(){e.setState({actived:!1})}),(0,a._)((0,r._)(e),"toggleActived",function(){e.setState(function(e){return(0,l._)((0,s._)({},e),{actived:!e.actived})})}),(0,a._)((0,r._)(e),"focus",function(){return e.topicsInput&&e.topicsInput.focus()}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.topics,r=t.actived;return(0,d.tZ)("div",{className:k,children:(0,d.tZ)(N.Z,{actived:r,placeholderNote:" ",max:1,inputProps:{className:"".concat(k,"-topicInput")},onRef:function(t){e.topicsInput=t},value:n,onChange:this.handleChange,onBlur:this.handleBlur,onToggleActived:this.toggleActived})})}}]),n}(f.Component),x=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{topics:[]}),(0,a._)((0,r._)(e),"handleChangeTopics",function(t){e.setState(function(e){return(0,l._)((0,s._)({},e),{topics:t})})}),(0,a._)((0,r._)(e),"handleSubmit",function(){var t=e.state,n=(0,S._)(t.topics,1)[0].urlToken;(0,e.props.onSubmit)(n)}),e}return(0,i._)(n,[{key:"disabled",get:function(){var e=this.state.topics,t=this.props.content;return 0===e.length||""===t}},{key:"render",value:function(){var e=this.props,t=e.type,n=e.author,r=e.currentUser,o=e.title,i=e.url,a=e.onClose,c=e.content,s=e.visible;return(0,d.tZ)(I.Z,{onClose:a,size:"large",title:"发送摘录到百科",className:"AbstractForm",children:s&&(0,d.BX)(f.Fragment,{children:[(0,d.tZ)(R,{type:t,author:n,member:r,title:o,url:i,content:c,theme:"scroll"}),(0,d.tZ)(O,{onChange:this.handleChangeTopics}),(0,d.tZ)("div",{className:"AbstractForm-footer",children:(0,d.tZ)(b.ZP,{preset:"primary",color:"blue",disabled:this.disabled,onClick:this.handleSubmit,children:"确定"})})]})})}}]),n}(f.Component);(0,a._)(x,"propTypes",{type:h().string.isRequired,author:h().object,currentUser:h().object,title:h().string.isRequired,content:h().string.isRequired,url:h().string.isRequired,visible:h().bool.isRequired,onClose:h().func.isRequired,onSubmit:h().func.isRequired});var P=n(21706),D=n(67814),L=n.n(D),B=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"hintInfo",get:function(){var e=this.props,t=e.content;if(!e.isCopyable)return{type:"danger",text:"该内容限制转载"};var n=t.length;return n<100?{type:"danger",text:"最少摘录 100 字"}:n>450&&n<=500?{type:"warning",text:"还可以摘录 ".concat(500-n," 字")}:n>500&&{type:"danger",text:"已经超出 ".concat(n-500," 字")}}},{key:"render",value:function(){var e=this.props,t=e.visible,n=e.top,r=e.onSelect,o=e.content,i=this.hintInfo,a=i&&"danger"===i.type;return(0,d.BX)("div",{className:L()("SharePopover",{"SharePopover--show":t}),style:{top:n},disabled:a,children:[(0,d.tZ)("span",{className:"SharePopover-arrow"}),(0,d.BX)("div",{role:"button",tabIndex:0,className:L()("SharePopover-content",{"SharePopover-content--danger":a}),onClick:function(){a||r(o)},children:[(0,d.tZ)(P.vZ,{className:"SharePopover-quote",size:24}),(0,d.tZ)("span",{className:"SharePopover-main",children:"发送到百科下的摘录"}),i&&(0,d.tZ)("span",{className:"SharePopover-hint",children:i.text})]})]})}}]),n}(f.Component);(0,a._)(B,"propTypes",{content:h().string,top:h().number,visible:h().bool});var U=n(9338),M=n(30971),G=function(e,t,n){var r,o=(r=(0,U._)(function(r){var o;return(0,M.__generator)(this,function(i){switch(i.label){case 0:return[4,new Promise(function(e){setTimeout(function(){e((document.selection?document.selection.createRange().text:document.getSelection()).toString())},0)})];case 1:return(o=i.sent())?t(o,r.target===e?r.offsetY:r.offsetY+e.offsetTop+r.target.offsetTop+30):n(),[2]}})}),function(e){return r.apply(this,arguments)});return null==e||e.addEventListener("mouseup",o),function(){return null==e?void 0:e.removeEventListener("mouseup",o)}},F=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{popoverVisible:!1,top:0,content:"",abstractModalVisible:!1}),(0,a._)((0,r._)(e),"handlePopoverShow",function(t,n){if(!e.hasAddBaikeSummaryPermission)return null;v.Z.trackCardShow(null,{id:6115}),e.setState(function(e){return(0,l._)((0,s._)({},e),{top:n,content:t,popoverVisible:!0})})}),(0,a._)((0,r._)(e),"handlePopoverClose",function(){if(!e.hasAddBaikeSummaryPermission)return null;e.setState(function(e){return(0,l._)((0,s._)({},e),{popoverVisible:!1})})}),(0,a._)((0,r._)(e),"handleAbstractModalClose",function(){e.setState(function(e){return(0,l._)((0,s._)({},e),{abstractModalVisible:!1})})}),(0,a._)((0,r._)(e),"handleAbstractSelected",function(t){v.Z.trackEvent(null,{id:6116,action:"Send"}),e.setState(function(e){return(0,l._)((0,s._)({},e),{content:t,popoverVisible:!1,abstractModalVisible:!0})})}),(0,a._)((0,r._)(e),"handleCreateAbstract",function(t){var n=e.props,r=n.type,o=n.objectId,i=n.createAbstract,a=e.state.content;v.Z.trackEvent(null,{id:6117,action:"Submit"}),i({type:r,token:o,topicId:t,content:a}).then(function(){e.setState(function(e){return(0,l._)((0,s._)({},e),{content:a,popoverVisible:!1,abstractModalVisible:!1})})})}),e}return(0,i._)(n,[{key:"isAuthor",get:function(){var e=this.props,t=e.currentUser,n=e.author;return(0,E.Z)(t,n)}},{key:"hasAddBaikeSummaryPermission",get:function(){var e=this.props.currentUser;return e&&e.hasAddBaikeSummaryPermission}},{key:"userDisabled",get:function(){return T().get("global::AddToBaikeDisabled")}},{key:"richContainer",get:function(){var e=this.props,t=e.type,n=e.objectId;return"article"===t?document.querySelector(".Post-RichText"):document.querySelector(".AnswerItem[name='".concat(n,"'] .RichContent-inner"))}},{key:"componentDidMount",value:function(){this.removeMouseUpListener=G(this.richContainer,this.handlePopoverShow,this.handlePopoverClose)}},{key:"componentWillUnmount",value:function(){this.removeMouseUpListener()}},{key:"render",value:function(){var e=this.state,t=e.popoverVisible,n=e.top,r=e.content,o=e.abstractModalVisible,i=this.props,a=i.type,c=i.author,s=i.currentUser,l=i.title,u=i.url,p=i.isCopyable;return!this.hasAddBaikeSummaryPermission||this.userDisabled?null:(0,d.BX)(f.Fragment,{children:[(0,d.tZ)(B,{top:n,visible:t,content:r,isCopyable:this.isAuthor||p,onBlur:this.handlePopoverClose,onSelect:this.handleAbstractSelected}),(0,d.tZ)(x,{type:a,onSubmit:this.handleCreateAbstract,author:c,visible:o,onClose:this.handleAbstractModalClose,currentUser:s,title:l,url:u,content:r})]})}}]),n}(f.Component);(0,a._)(F,"propTypes",{type:h().string.isRequired,author:h().object.isRequired,currentUser:h().object,title:h().string.isRequired,url:h().string.isRequired,objectId:h().number.isRequired,isCopyable:h().bool}),(0,a._)(F,"defaultProps",{isCopyable:!0});var z=(0,m.compose)(C.Z,(0,_.connect)(null,{createAbstract:y.sF}))(F)},82926:function(e,t,n){"use strict";function r(e){return e.componentList.filter(Boolean).filter(function(e){return!!e.component}).map(function(e){return e.component})}n.d(t,{Z:function(){return r}})},99158:function(e,t,n){"use strict";n.d(t,{Z:function(){return a},m:function(){return c}});var r=n(49899),o=n(82926),i=new Map([["vote","isBlockingVote"],["comment","isBlockingComment"],["like","isBlockingLike"],["favlist","isBlockingCollect"],["collect","isBlockingCollect"],["thank","isBlockingLike"],["share","isBlockingShare"]]);function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.Z;return function(){for(var n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];var a=e.length>0?e.reduce(function(e,t){return[t.apply(void 0,(0,r._)(e))]},(0,r._)(o)):(0,r._)(o);return t.apply(void 0,(0,r._)(a))}}var c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return{componentList:t.componentList.map(function(t){var n=t.name,r=t.component;return i.has(n)&&e[i.get(n)]?{name:n,component:null}:{name:n,component:r}})}}}},98731:function(e,t,n){"use strict";n.d(t,{HS:function(){return D},W9:function(){return r.Z}});var r=n(82926),o=n(85879),i=n(20857),a=n(22107),c=n(94707),s=n(87320),l=n(86325),u=n(55164),d=n(57477),p=n(49899),h=n(85626),f=n(71783),_=n(92769),m=n.n(_),v=n(14168),g=n.n(v),T=n(87363),E=n(36695),C=n(93206),y=n(69383),S=n(43384),I=n(1733),b=n(38889),A=n(97727),Z=n(80714),w=n(66263),R=n(85576),N=n(3028),k=n(8866),O={answer:g().object.isRequired,renderThankButtonText:g().func,zaInfo:g().number},x=(0,p._)(Object.keys(O)).concat(["updateAnswerThank","dispatch","authRequired","isLogin","currentUser"]),P=function(e){(0,l._)(n,e);var t=(0,h._)(n);function n(){var e;return(0,a._)(this,n),e=t.apply(this,arguments),(0,s._)((0,i._)(e),"buttonRef",(0,T.createRef)()),(0,s._)((0,i._)(e),"handleUpdateThanked",e.props.authRequired(function(){var t=e.props,n=t.answer,r=n.id,o=n.relationship,i=(void 0===o?{}:o).isThanked,a=t.zVideoId,c=t.updateAnswerThank,s=t.zaInfo,l=t.answer,d=!i;y.Z.trackEvent(e.buttonRef.current,(0,u._)({action:d?"Thank":"UnThank",element:"Button"},s&&{id:s})),c(r,d,{zVideoId:a},l)},w.q0.thank)),e}return(0,c._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.answer,r=t.renderThankButtonText,i=t.disabled,a=n.relationship,c=(void 0===a?{}:a).isThanked,s=m()(this.props,x),l=r(n);return Z.Z.isMobileEntry?(0,o.tZ)(I.sN,(0,d._)((0,u._)({ref:this.buttonRef,onClick:this.handleUpdateThanked},s),{children:l})):(0,o.BX)(o.HY,{children:[(0,o.tZ)(A.bY,{input:"l",action:function(t){e.buttonRef.current.focus(),e.handleUpdateThanked(t)}}),(0,o.tZ)(S.$U,(0,u._)({as:b.ZP,zaType:"Button",zaAction:c?"UnLike":"Like",zaText:!0,onRef:this.buttonRef,preset:"plain",onClick:this.handleUpdateThanked,icon:f.sh,label:l,disabled:i,"aria-live":"polite"},s))]})}}]),n}(T.Component);(0,s._)(P,"propTypes",O),(0,s._)(P,"defaultProps",{renderThankButtonText:function(e){var t,n=e.relationship,r=(void 0===n?{}:n).isThanked;return(t=e.question.title,w.lH.every(function(e){return t.includes(e)}))?r?"取消祈祷":"祈祷":r?"取消喜欢":"喜欢"}});var D=(0,C.compose)(R.Z,(0,E.connect)(null,{updateAnswerThank:k.TC}),(0,N.Z)(null))(P)},11264:function(e,t,n){"use strict";n.d(t,{_:function(){return T}});var r=n(55164),o=n(57477),i=n(85879),a=n(83697),c=n(65733),s=n(84871),l=n.n(s),u=n(87363),d=n(36695),p=n(76661),h=n(65033),f=n(22712),_=n(91269),m=n(70400),v=n(83821),g=function(e){var t=e.type,n=e.id,r=e.index,o=(0,d.useSelector)(function(e){return e.adPromotion[t][n]}),c=(0,h.zc)(),s=(0,a.n)();return(0,u.useEffect)(function(){c&&t&&n&&(0,_.nX)("".concat(t,"-").concat(n,"-").concat(r),c)},[c,t,n,r]),c?(0,i.tZ)(p.Z,{userAgent:s,action:o,data:c}):null},T=function(e){var t=e.dataPath;return function(e){return l()(function(n){var a,s=null!==(a=n[t])&&void 0!==a?a:{},l=s.type,u=s.id,p=(0,d.useDispatch)(),_=(0,h.zc)(),m=(0,c.Z)(function(e){_&&l&&u&&p((0,f.Cz)({type:l,id:u,currentAction:e}))}),v=(0,c.Z)(function(){return m(f.SE.comments.show)}),g=(0,c.Z)(function(){return m(f.SE.comments.close)}),T=(0,c.Z)(function(){return m(f.SE.comments.publish)}),E=(0,c.Z)(function(e){return m(e?f.SE.follow:f.SE.revertFollow)}),C=(0,c.Z)(function(){return m(f.SE.shareClick)});return(0,i.tZ)(e,(0,o._)((0,r._)({},n),{trackOpenCommentAdPromotion:v,trackCloseCommentAdPromotion:g,trackToggleFollowAdPromotion:E,trackShareAdPromotion:C,trackPublishCommentAdPromotion:T}))},e)}};t.Z=function(e){return(0,i.tZ)(m.SV,{replacement:null,children:(0,i.tZ)(v.Z,{children:(0,i.tZ)(g,(0,r._)({},e))})})}},4059:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(85879);function o(e){var t=e.annotationDetail;if(!t||!t.showOuter)return null;var n=t.reason,o=t.reasonDescription;return(0,r.tZ)("span",{className:"AnnotationTag",children:32300===n?"该内容已被标记":o})}},85944:function(e,t,n){"use strict";n.d(t,{Z:function(){return C}});var r=n(85879),o=n(48725),i=n(67814),a=n.n(i),c=n(9539),s=n(14168),l=n.n(s),u=n(87363),d=n(69383),p=n(43384),h=n(22701),f=n(61514),_=n(66263),m=n.p+"assets/logo.e049e9b9.png",v=n(48933),g=n(69578),T=n(19282),E=function(e,t){var n=e.isToolbarSticky,i=e.isFullscreen,s=e.toolbarMenuAttention,l=e.scheduledPublishAt,E=e.initialScheduledPublishAt,C=e.placeholder,y=e.draft,S=e.defaultValue,I=e.isLegacyVideoAnswer,b=e.defaultVideo,A=e.question,Z=e.videoAnswerEditable,w=e.videoAnswerPublished,R=e.editableReady,N=e.handleChangeContent,k=e.handleAfterChangeContent,O=e.handleFocusWithAuth,x=e.handleSelectText,P=e.handleSubmit,D=e.handleError,L=e.handleLoadStart,B=e.handleLoadEnd,U=e.handleUploadStart,M=e.handleUploadEnd,G=e.handleUploadError,F=e.handleBeforeVideoUpload,z=e.handleMCNLinkCardEdit,H=e.isVideoAnswer,q=e.handleInsertZVideo,V=e.getToolbarSidePlugins,X=e.getToolbarMenuPlugins,W=e.createEditorPlugins,K=e.getEditorBeforePlugins,j=e.setUseScheduledPublish,Y=e.allowToolbar,Q=e.onAnyChange,J=e.docPluginProps,$=e.tableOfContentsEnabled,ee=e.getMarkdownEnabled,et=e.videoSource,en=(0,u.useRef)(null);return(0,r.tZ)(v.vB,{name:T.Z.editableEdit,children:(0,r.tZ)(p.eV,{block:i?"FullScreen":"",children:(0,r.tZ)(g.Z,{className:a()("AnswerForm-editor","AnswerForm-container",{isToolbarSticky:n}),ref:t,hideImageToolbar:!0,allowDragAndDrop:!0,allowLinkCard:!0,allowMention:!0,allowToolbar:void 0===Y||Y,allowUploadDocument:!0,allowVideoTitleChange:!H,allowReference:!0,allowImageEditor:!0,allowZVideo:!H,allowTable:!H,allowCatalog:!H,catalogEnabled:$,useCatalogV2:!0,stickyOffset:117,allowHeaderThree:!1,allowToolbarSticky:!i,toolbarStickyOffset:_.BR,onInsertZVideo:q,getToolbarSidePlugins:V,getToolbarMenuPlugins:X,getEditorBeforePlugins:K,toolbarMenuAttention:s,createEditorPlugins:W,toolbarProps:{menuCallout:l&&E&&(0,r.BX)(h.LU,{className:"AnswerForm-scheduledPublishCallout",onClose:function(){j(!1),d.Z.trackEvent(t,{action:"Click",id:5734,name:"回答"})},children:["发布时间：",(0,r.tZ)(f.Z,{onRef:en,value:E,min:E,max:c.Z(E,7),onChange:function(e,t){j(!0,e),d.Z.setModule(en.current,{module:"Unknown",module_name:t.date?"日期":t.hours?"小时":t.minutes?"分钟":void 0}),d.Z.trackEvent(en.current,{action:"Click",id:5731,name:"回答"})}}),(0,r.BX)("a",{href:"/draft?type=answer&filter=schedule",target:"_blank","data-za-detail-view-id":5732,"data-za-detail-view-name":"回答",style:{marginLeft:"2em"},children:[(0,r.tZ)(o.E,{text:!0,center:!0})," 管理待发布内容"]})]})},minRows:6,placeholder:C,defaultValue:y?y.editableContent:S,videoAnswerEditable:Z,videoAnswerPublished:w,isLegacyVideoAnswer:I,defaultVideo:b,onReady:R,onChange:N,onAfterChange:k,onFocus:O,onSelectText:x,onSubmit:P,onError:D,onLoadStart:L,onLoadEnd:B,onUploadStart:U,onUploadEnd:M,onUploadError:G,onBeforeVideoUpload:F,logo:m,location:A.title,editingContentType:"answer",onMCNLinkCardEdit:z,useV2Feature:!0,useEditableV2:!0,useImageOperationV2:!0,onAnyChange:Q,docPluginProps:J,getMarkdownEnabled:ee,videoSource:et})})})};E.propTypes={isToolbarSticky:l().bool.isRequired,answer:l().object.isRequired,isFullscreen:l().bool.isRequired,toolbarMenuAttention:l().string,scheduledPublishAt:l().number,initialScheduledPublishAt:l().number,placeholder:l().string.isRequired,draft:l().object,defaultValue:l().string,isLegacyVideoAnswer:l().bool,defaultVideo:l().object,question:l().object,videoAnswerEditable:l().bool,videoAnswerPublished:l().bool,editableReady:l().func.isRequired,handleChangeContent:l().func.isRequired,handleAfterChangeContent:l().func.isRequired,handleFocusWithAuth:l().func.isRequired,handleSelectText:l().func.isRequired,handleSubmit:l().func.isRequired,handleError:l().func.isRequired,handleLoadStart:l().func.isRequired,handleLoadEnd:l().func.isRequired,handleUploadStart:l().func.isRequired,handleUploadEnd:l().func.isRequired,handleUploadError:l().func.isRequired,handleBeforeVideoUpload:l().func.isRequired,handleMCNLinkCardEdit:l().func.isRequired,isVideoAnswer:l().bool.isRequired,handleInsertZVideo:l().func.isRequired,getToolbarSidePlugins:l().func.isRequired,createEditorPlugins:l().func.isRequired,getToolbarMenuPlugins:l().func.isRequired,getEditorBeforePlugins:l().func.isRequired,setUseScheduledPublish:l().func.isRequired,getMarkdownEnabled:l().func};var C=(0,u.forwardRef)(E)},14214:function(e,t,n){"use strict";var r=n(94009),o=n(61533),i=n(87363),a=n(7835);t.Z=function(e){var t=e.disabled,n=e.children,c=(0,r._)((0,i.useState)(null),2),s=c[0],l=c[1];return((0,a.Z)(function(){l(document.querySelector("#AnswerFormPortalContainer"))}),t)?n:!!s&&(0,o.createPortal)(n,s)}},32515:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(85879),o=n(87363),i=n(1612),a=n(18341),c=n(80714),s=n(62095),l=n(92061),u=n(9710),d=n(54713),p=n(14982);function h(e){var t,n=e.onCommand,o=e.queryCommandState,i=e.queryCommandEnable,a=e.editorState,c=e.toolbarMainAreaData,s=e.toolbarMoreAreaData,h=e.toolbarFixtureAreaData,f=e.className;return(0,r.BX)(l.Z,{className:f,css:{".ToolbarButton.Button.Button--plain":{marginRight:"6px"},".ToolbarDivider":{marginLeft:"0",paddingLeft:"2px"},".toolbar-section":{marginRight:"8px"},".fixArea .toolbar-section, .moreArea .toolbar-section":{marginRight:"0px"},".fixArea .ToolbarButton.Button.Button--plain:last-child, .moreArea .ToolbarButton.Button.Button--plain:last-child":{marginRight:"0px"},"&.toolbarV3":{paddingLeft:"0px"}},children:[(0,r.tZ)(u.Z,{mainSections:c,moreSectionIsEmpty:(null===(t=s[0])||void 0===t?void 0:t.items[0].children.length)===0,onCommand:n,queryCommandState:o,queryCommandEnable:i,editorState:a}),(0,r.tZ)(p.Z,{fixSections:h,queryCommandEnable:i,queryCommandState:o,onCommand:n,editorState:a}),(0,r.tZ)(d.Z,{queryCommandState:o,queryCommandEnable:i,editorState:a,onCommand:n,moreSections:s})]})}var f=function(e){var t=e.editorState,n=e.onCommand,l=e.queryCommandEnable,u=e.queryCommandState,d=e.showUserProfitButton,p=e.isVideoAnswer,f=e.onInsertVideoClick,_=e.draftPage,m=e.className,v=e.useMediumEditor,g=e.getMarkdownEnabled,T=(0,s.Z)().jumpUrl,E=(0,o.useMemo)(function(){return(0,i.v$)({showProfit:d,onInsertVideoClick:f,isVideoAnswer:p,shouldAdaptNative:"1"===c.Z.apollo.editor_adapt_native})},[d,f,p]),C=(0,o.useMemo)(function(){return(0,i.vr)({draftPage:_})},[_]),y=(0,o.useMemo)(function(){return(0,i.vi)({getMarkdownEnabled:g,onHandleManageEditClick:function(){return window.open(T)}})},[g,T]),S=v?h:a.Z;return(0,r.tZ)(S,{editorState:t,onCommand:n,queryCommandEnable:l,queryCommandState:u,toolbarMainAreaData:E,toolbarMoreAreaData:y,toolbarFixtureAreaData:C,className:m})}},66766:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),l=n(85879),u=n(87363),d=n(74128),p=n(67516),h=n.n(p),f=n(38889),_="AnswerOrg::know",m=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleHide",function(){h().set(_,!0),e.props.onClose()}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.shown,n=e.onClose;return(0,l.tZ)(d.Z,{title:"机构账号提问规则",subtitle:"这是一个「机构提问」，请在回答前了解以下规则",onClose:n,children:t&&(0,l.BX)("div",{children:[(0,l.BX)("ul",{className:"AnswerModal-list",children:[(0,l.tZ)("li",{children:"1. 提问机构如需使用你的回答，由提问机构联系你，共同商定确认使用条件。"}),(0,l.tZ)("li",{children:"2.「机构提问」下的回答，站内传播与社区公共提问下的回答有所区别。"}),(0,l.tZ)("li",{children:"3. 提问机构可能「隐藏」回答，被「隐藏」回答不在社区内流通。"})]}),(0,l.tZ)("a",{className:"AnswerModal-moreLink",href:"/org-intro#org-question",target:"_blank",children:"了解更多"}),(0,l.BX)(d.w,{direction:"horizontal",children:[(0,l.tZ)(f.ZP,{onClick:this.handleHide,children:"不再显示"}),(0,l.tZ)(f.ZP,{color:"blue",preset:"primary",onClick:n,children:"知道了"})]})]})})}}],[{key:"getKnown",value:function(){return h().get(_)}}]),n}(u.Component)},86193:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(85879),o=n(87363),i=n(87641),a=n(8512),c=n(43384);function s(e){var t=e.handleClick,n=(0,o.useRef)(null);return(0,r.BX)(c.$U,{as:i.Flex,zaAction:"Unknown",zaText:"全屏编辑",zaType:"Button",aliginItem:"center",fontSize:14,color:"GBL05A",pr:"20px",lineHeight:"55px",css:{cursor:"pointer"},onClick:t,ref:n,children:[(0,r.tZ)(i.Text,{mr:"10px",children:"全屏编辑"}),(0,r.tZ)(a.R,{text:!0,center:!0})]})}},46305:function(e,t,n){"use strict";n.d(t,{Z:function(){return M}});var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(65733),s=n(82644),l=n(87363),u=n.n(l),d=n(87641),p=n(43384),h=n(67516),f=n.n(h),_=n(22107),m=n(94707),v=n(86325),g=n(71728),T=n(85626),E=n(67814),C=n.n(E),y=function(e){(0,v._)(n,e);var t=(0,T._)(n);function n(){return(0,_._)(this,n),t.apply(this,arguments)}return(0,m._)(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=(0,g._)(e,["className"]);return(0,a.tZ)("textarea",(0,o._)((0,r._)({},n),{className:C()(t,"TextArea")}))}}]),n}(l.Component),S=n(81956),I=n(16836),b=n(16e3),A=n(95548),Z=n.n(A),w=n(76490),R=n(66980),N=Object.assign,k=n(67689),O={success:(0,a.tZ)(b.Y,{size:24}),fail:(0,a.tZ)(function(e){return u().createElement(R.Z,N({width:"49",height:"48",viewBox:"0 0 49 48"},e),u().createElement("path",{fill:"currentColor",d:"M24 36a4 4 0 1 1 0 8 4 4 0 0 1 0-8Zm3-32c1.105 0 1.91.9 1.801 1.993l-2.593 26.009c-.055.551-.55.998-1.099.998h-2.218a1.127 1.127 0 0 1-1.1-.998L19.2 5.993c-.11-1.1.688-1.993 1.8-1.993H27Z"}))},{size:24})},x=function(e){var t=e.text,n=e.icon,c=e.onClose,s=e.delay,u=void 0===s?2e3:s,p=e.color,h=void 0===p?"GBK04A":p,f=(0,g._)(e,["text","icon","onClose","delay","color"]),_=(0,i._)((0,l.useState)(!0),2),m=_[0],v=_[1],T=(0,w.Yz)(m,null,{from:{opacity:0},enter:{opacity:1},leave:{opacity:0}});return n="string"==typeof n?O[n]:n,(0,l.useEffect)(function(){setTimeout(function(){v(!1),c&&c()},u)},[u,c]),T.map(function(e){var i=e.item,c=e.props,s=e.key;return i?(0,a.tZ)(w.q.div,{style:c,children:(0,a.BX)(d.Flex,(0,o._)((0,r._)({},f),{role:"alert",p:"18px",alignItems:"center",justifyContent:"center",flexDirection:"column",color:h,css:function(e){return{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",borderRadius:"14px",maxWidth:200,background:e.colorMod(e.colors.GBK99A).alpha(.85),pointerEvents:"none",textAlign:"center"}},children:[n,(0,a.tZ)(d.Text,{fontWeight:"bold",css:[{lineHeight:"20px"},n&&{marginTop:"8px"}],children:t})]}))},s):null})},P=function(){var e=(0,k.Z)(),t=e.addInstance,n=e.removeInstance;return(0,l.useCallback)(function(e){var r,o=e.icon,i=e.text,c=e.delay,s=e.color;return new Promise(function(e){t(r=(0,a.tZ)(I.Z,{children:(0,a.tZ)(x,{icon:o,text:i,onClose:e,delay:c,color:s})},Z()("toast")))}).finally(function(){var e;return e=r,setTimeout(function(){return n(e)},300)})},[t,n])},D={timer:"showEvaluatePanelTimer",hasShown:"isShowEvaluatePanel"},L=function(e){return(0,a.tZ)(p.$U,(0,o._)((0,r._)({as:"button",zaType:"Button",zaText:"关闭nps",css:{position:"absolute",top:"11px",right:"11px"}},e),{children:(0,a.tZ)(s.HN,{width:"16",height:"16"})}))},B=function(e){return(0,a.tZ)(d.Box,{css:{textAlign:"right"},children:(0,a.tZ)(p.$U,(0,o._)((0,r._)({as:"button",zaType:"Button",zaText:"提交nps",css:function(e){return{color:e.colors.GBL01A,fontSize:"12px"}}},e),{children:"确认提交"}))})},U=function(e){return(0,a.tZ)(p.$U,(0,r._)({as:"button",zaType:"Button",css:function(e){return{width:"25px",display:"inline-block",textAlign:"center",lineHeight:"25px",background:e.colors.GBK10A,borderRadius:"2px",color:e.colors.GBK06A,marginRight:"2px",cursor:"pointer","&:hover":{background:e.colors.GBK09A}}}},e))};function M(e){var t=e.editorFrom,n=e.storageKey,r=void 0===n?"":n,o=(0,i._)((0,l.useState)(""),2),s=o[0],u=o[1],h=(0,i._)((0,l.useState)("10"),2),_=h[0],m=h[1],v=(0,i._)((0,l.useState)(""),2),g=v[0],T=v[1],E=(0,l.useRef)(),C=P(),I=(0,S.Z)(),b=(0,c.Z)(function(e){I("https://api.zhihu.com/slytherin/fallback/".concat(t),{method:"POST",body:{score:e,content:g}})});return((0,l.useEffect)(function(){var e=new Date().getTime()>f().get(D.timer+r);if(f().get(D.hasShown+r)&&!e){u("");return}u(""),setTimeout(function(){u("0"),f().set(D.hasShown+r,"1"),f().set(D.timer+r,new Date().getTime()+5184e6),E.current=setTimeout(function(){u("")},6e4)},6e5)},[r]),""===s)?null:(0,a.tZ)(p.eV,{block:"editorEvaluatePanel",children:(0,a.tZ)(p.Wi,{zaText:"nps展示",zaType:"Block",children:(0,a.BX)(d.Box,{css:function(e){return{width:"310px",position:"fixed",bottom:"72px",right:"110px",background:e.colors.GBK99A,padding:"20px",boxShadow:"0px 1px 3px rgba(26, 26, 26, 0.1)",zIndex:"101"}},children:[(0,a.tZ)(L,{onClick:function(){u("")}}),"0"===s&&(0,a.BX)(d.Box,{children:[(0,a.tZ)(d.Box,{css:function(e){return{fontSize:"14px",color:e.colors.GBK02A}},children:"亲爱的创作者，感谢您对知乎内容的贡献"}),(0,a.tZ)(d.Box,{css:function(e){return{fontSize:"13px",color:e.colors.GBK06A,marginTop:"10px",marginBottom:"20px"}},children:"请选择您对编辑器的满意度，以帮助我们更好的服务于您的创作体验"}),(0,a.tZ)(d.Box,{className:"evaluate-box",children:[1,2,3,4,5,6,7,8,9,10].map(function(e,t){return(0,a.tZ)(U,{zaText:"打分-".concat(e),onClick:function(){clearTimeout(E.current),e<=6?u("1"):e>6&&(u(""),C({text:"感谢您的反馈",delay:2e3}),b(e)),m(e)},children:e},t)})}),(0,a.BX)(d.Flex,{justifyContent:"space-between",css:function(e){return{color:e.colors.GBK03A,marginTop:"15px",fontSize:"11px",lineHeight:"12px"}},children:[(0,a.tZ)("span",{role:"img","aria-label":"不满意",children:"不满意\uD83D\uDC4E"}),(0,a.tZ)("span",{role:"img","aria-label":"满意",children:"满意\uD83D\uDC4D"})]})]}),"1"===s&&(0,a.BX)(d.Box,{children:[(0,a.tZ)(d.Box,{css:function(e){return{fontSize:"14px",color:e.colors.GBK02A,marginBottom:"10px"}},children:"请写下您的意见或建议"}),(0,a.tZ)(d.Box,{children:(0,a.tZ)(y,{className:"Appeal-TextArea",rows:7,placeholder:"请写下您的建议...",css:{width:"270px",height:"85px"},value:g,onChange:function(e){T(e.target.value)}})}),(0,a.tZ)(d.Box,{css:{textAlign:"right"},children:(0,a.tZ)(B,{onClick:function(){u(""),b(_),C({text:"感谢您的反馈",delay:1e3})}})})]})]})})})}},94049:function(e,t,n){"use strict";n.d(t,{G:function(){return f}});var r=n(94009),o=n(85879),i=n(24486),a=n(28753),c=n(87363),s=n(87641),l=n(43384),u=n(21060),d=n(81488),p=n(7768),h=function(e){var t=e.children,n=e.className;return(0,o.tZ)("h1",{css:function(e){return{background:e.colors.GBK99A,color:e.colors.GBK02A,lineHeight:"31px",fontSize:"22px",fontWeight:"600"}},className:n,children:t})},f=function(e){var t=e.question,n=e.onClose,a=t.title,f=t.detail,_=(0,r._)((0,c.useState)(null),2),m=_[0],v=_[1],g=(0,c.useRef)(null),T=(0,c.useCallback)(function(){return g.current},[]);return(0,o.tZ)("div",{css:{position:"absolute",top:0,bottom:0,left:"100%",width:"calc((100vw - 100%)/2 - 20px)"},ref:g,children:(0,o.BX)(s.Box,{css:{overflow:"hidden",width:"326px",maxWidth:"326px"},children:[(0,o.tZ)(u.Z,{getStyle:function(){var e=T();return e?{top:85,left:e.getBoundingClientRect().left}:{top:85}},offset:85,container:T,children:(0,o.BX)(s.Box,{css:{width:"326px",maxWidth:"326px"},pl:"16px",children:[(0,o.BX)(s.Flex,{bg:"GBK99A",pl:"16px",sx:{borderBottom:"1px solid",borderColor:"GBK09A",height:"60px",alignItems:"center"},children:[(0,o.tZ)(h,{css:{fontSize:"18px",lineHeight:"24px"},children:"问题描述"}),(0,o.tZ)(l.$U,{zaType:"Button",zaAction:"Unknown",zaText:"关闭问题详情",as:i.eb,css:{marginLeft:"auto",padding:"16px"},onClick:n})]}),(0,o.BX)(s.Box,{bg:"GBK99A",px:"16px",css:{minHeight:"340px",maxHeight:"460px",overflow:"auto"},onClick:function(e){var t=e.target;"IMG"===t.tagName&&t.classList.contains("zh-lightbox-thumb")&&v(t)},children:[(0,o.tZ)(h,{css:{fontSize:"16px",lineHeight:"22px",marginBottom:"10px",marginTop:"10px"},children:a}),(0,o.tZ)(p.Z,{itemProp:"text",tag:"span",html:f})]})]})}),m&&(0,o.tZ)(d.Z,{img:m,onClose:function(){return v(null)}})]})})};t.Z=function(e){var t=e.question,n=e.onClick,r=t.title,i=t.excerpt;return(0,o.tZ)(s.Box,{bg:"GBK99A",css:{padding:"20px 64px 0"},children:(0,o.BX)(h,{css:function(e){return{paddingBottom:"20px",borderBottom:"1px solid ".concat(e.colors.GBK09A)}},children:[r,i&&(0,o.BX)(l.$U,{as:"button",zaType:"Button",zaText:!0,onClick:n,shouldTrackShow:!0,css:function(e){return{color:e.colors.GBL05A,lineHeight:"14px",fontSize:"14px",fontWeight:"normal",display:"inline-flex",alignItems:"center"}},children:["问题描述",(0,o.tZ)(a.f,{size:16})]})]})})}},19282:function(e,t){"use strict";t.Z={editableInit:"Editable.Init",editableEdit:"Editable.Edit",draftLoad:"DraftLoad",draftSave:"DraftSave",addAnswer:"AddAnswer",composition:"composition",hasFormula:"HasFormula"}},65233:function(e,t){"use strict";t.Z=function(e){return(null==e?void 0:e.length)&&e.filter(Boolean).find(function(e){return"8713324000"===String(e.id)&&"pass"===e.status})?{fileSizeLimit:31457280}:{fileSizeLimit:10485760}}},88782:function(e,t,n){"use strict";n.d(t,{$$:function(){return s},Cg:function(){return l},Tq:function(){return h},aH:function(){return u},jd:function(){return _},p4:function(){return f},t8:function(){return p},vi:function(){return d}});var r=n(87320),o=n(55164),i=n(57477),a=n(6148),c=n(66263),s=function(){return!!(window.__FullScreenAnswerEditor&&!window.__FullScreenAnswerEditor.closed)},l=function(){return!!(window.__FullScreenAnswerEditor&&window.__FullScreenAnswerEditor.closed)},u=function(e,t){if(!e)return null;if(s())return window.__FullScreenAnswerEditor.focus(),window.__FullScreenAnswerEditor;var n="FullScreenAnswerEditor_".concat(e),r=window.location,o=r.search,i=r.host,a=t?"//".concat(i,"/question/").concat(e,"/answer/").concat(t,"/edit").concat(o):"//".concat(i,"/question/").concat(e,"/write").concat(o);return window.__FullScreenAnswerEditor=window.open(a,n)},d=function(e){return e?Object.keys(e).reduce(function(t,n){var a=e[n];return"commercialReportInfo"===n?(0,i._)((0,o._)({},t),{isReport:!!(null==a?void 0:a.isReport)}):(0,i._)((0,o._)({},t),(0,r._)({},n,a))},{}):e},p=function(e){return e?{commentPermission:e.commentPermission}:e},h=function(e){return e?Object.keys(e).reduce(function(t,n){var a=e[n];return"canReward"===n?(0,i._)((0,o._)({},t),{rewardTagline:a?c.Sp:""}):(0,i._)((0,o._)({},t),(0,r._)({},n,a))},{}):e},f=function(e){return e?Object.keys(e=h(e)).reduce(function(t,n){var c=e[n];return"commercialReportInfo"===n?(0,i._)((0,o._)({},t),{isReport:!!(null==c?void 0:c.isReport)}):"disclaimerType"===n?(0,i._)((0,o._)({},t),{disclaimerType:c||"none",isDisclaimerChecked:!!(c&&"none"!==c)}):"thankInviter"===n?(0,i._)((0,o._)({},t),{thankInviterInfo:(0,a.dj)(c)}):"thankInviterStatus"===n?t:(0,i._)((0,o._)({},t),(0,r._)({},n,c))},{}):e};function _(e,t){if(!e)return{thankInviterStatus:"close",thankInviter:""};var n=e.urlToken,r=e.name,o=e.id;return{thankInviterStatus:"open",thankInviter:"answer"===t?o:JSON.stringify({url_token:n,name:r,id:o})}}},75334:function(e,t,n){"use strict";n.d(t,{j:function(){return f}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(85626),u=n(85879),d=n(87363),p=n(84871),h=n.n(p),f=(0,d.createContext)({updateFormData:function(){},formData:{}});t.Z=function(e){var t=function(t){(0,c._)(d,t);var n=(0,l._)(d);function d(){var e;return(0,o._)(this,d),e=n.apply(this,arguments),(0,a._)((0,r._)(e),"state",{}),(0,a._)((0,r._)(e),"answerFormDataProps",{updateFormData:function(t){return e.setState(t)},getFormData:function(){return e.state}}),e}return(0,i._)(d,[{key:"render",value:function(){return(0,u.tZ)(f.Provider,{value:(0,s._)({},this.answerFormDataProps),children:(0,u.tZ)(e,(0,s._)({},this.props,this.answerFormDataProps))})}}]),d}(d.Component);return h()(t,e)}},53741:function(e,t,n){"use strict";var r=n(22107),o=n(94707),i=n(86325),a=n(55164),c=n(85626),s=n(85879),l=n(87363),u=n(36695),d=n(84871),p=n.n(d),h=n(74351),f=n(40195),_=n(88782);t.Z=function(e){var t=function(t){(0,i._)(l,t);var n=(0,c._)(l);function l(e){var t;return(0,r._)(this,l),(t=n.call(this,e)).state={needReload:e.useMediumEditor&&(0,h.isBrowser)()&&(0,_.Cg)()},t}return(0,o._)(l,[{key:"componentDidMount",value:function(){var e=this;this.state.needReload&&this.props.loadDraft(this.props.question.id).finally(function(){requestAnimationFrame(function(){e.setState({needReload:!1},function(){requestAnimationFrame(function(){var t;null===(t=e.props.imperativeRef.current)||void 0===t||t.focus()})})})})}},{key:"render",value:function(){return this.state.needReload?null:(0,s.tZ)(e,(0,a._)({},this.props))}}]),l}(l.Component);return p()((0,u.connect)(null,{loadDraft:f.dY})(t),e)}},82022:function(e,t,n){"use strict";var r=n(85879),o=n(3707),i=n(85576),a=n(78970),c=n(97285);t.Z=(0,i.Z)(function(e){var t=e.id,n=e.voteupCount,i=e.authRequired,s=(0,a.Z)(i),l=s.modalShown,u=s.openVotersModal,d=s.closeVotersModal;return(0,r.BX)(r.HY,{children:[(0,r.tZ)(o.Z,{contentType:"answer",id:t,onClickVoterInfo:u}),(0,r.tZ)(c.Z,{id:t,type:"answer",voteupCount:n,modalShown:l,handleListHide:d})]})})},8618:function(e,t,n){"use strict";n.d(t,{v:function(){return d},m:function(){return v}});var r=n(85879),o=n(28740),i=n(36695),a=n(93206),c=n(85576),s=n(3028),l=n(8866);function u(e){var t,n=e.answer,a=e.isAnswerPage,c=e.authRequired,s=((0,i.useSelector)(function(e){return(0,l.Mn)(e,null==n?void 0:n.id)})||{}).result;if(!s)return null;var u=null==n?void 0:null===(t=n.paidInfo)||void 0===t?void 0:t.hasPurchased;return(0,r.tZ)(o.Z,{hasPurchased:u,paidContent:s,isShowPurchasePop:a,authRequired:c})}var d=(0,a.compose)((0,s.Z)(null),c.Z)(function(e){var t=e.answer,n=e.isAnswerPage,o=e.authRequired;return(null==t?void 0:t.answerType)==="paid"?(0,r.tZ)(u,{answer:t,isAnswerPage:void 0!==n&&n,authRequired:o}):null}),p=n(24405),h=n(81980),f=n(87363),_=n(7407),m=function(e){var t=e.answer,n=(0,i.useSelector)(function(e){return(0,l.Mn)(e,null==t?void 0:t.id)})||{},o=n.isRequesting,a=n.error,c=n.result,s=!!(!o&&!a&&!c),u=(0,i.useDispatch)();(0,f.useEffect)(function(){s&&u((0,l.bs)(t.id))},[s,u,t.id]);var d=(0,i.useSelector)(_.Uh),m=(0,p.F)().isDarkMode;return(0,r.tZ)(h.Z,{result:c,extra:{ua:d,isDarkMode:m},extraTxt:"\xa9 本内容版权为知乎及版权方所有，正在受版权保护中"})},v=(0,s.Z)(null)(function(e){var t=e.answer;return(null==t?void 0:t.answerType)==="paid"?(0,r.tZ)(m,{answer:t}):null})},79100:function(e,t,n){"use strict";var r=n(55164),o=n(71728),i=n(85879),a=n(7835),c=n(65733),s=n(36695),l=n(65939),u=n(66263),d=n(85576),p=n(8866),h=n(55344);t.Z=(0,d.Z)(function(e){var t,n=e.disabled,d=e.currentUser,f=e.authRequired,_=e.answer,m=e.isOwner,v=(0,o._)(e,["disabled","currentUser","authRequired","answer","isOwner"]),g=(0,s.useDispatch)(),T=!!(!n&&d);(0,a.Z)(function(){T&&g((0,h.X2)(["opposeRight"]))});var E=(0,c.Z)(f(function(e){g((0,p.i_)(_.id,e,{cardType:_.cardType},_))},u.q0.vote));return(0,i.tZ)(l.Z,(0,r._)({count:_.voteupCount,voting:_.relationship&&_.relationship.voting,isOwner:!!(m||(null===(t=_.relationship)||void 0===t?void 0:t.isAuthor)),onVote:E},v))})},9651:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(55164),o=n(57477),i=n(85879),a=n(14168),c=n.n(a),s=n(19076),l=n(2174);function u(e){var t=e.questionId,n=e.title,a=e.href,c=e.zaTitleId,u=e.showStickyMark,d=e.showHeightLight,p=e.onClick;return(0,i.BX)("div",{itemProp:"zhihu:question",itemType:"http://schema.org/Question",itemScope:!0,children:[(0,i.tZ)("meta",{itemProp:"url",content:"https://www.zhihu.com/question/".concat(t)}),(0,i.tZ)("meta",{itemProp:"name",content:n}),u&&(0,i.tZ)(l.Z,{}),(0,i.tZ)(s.Link,(0,o._)((0,r._)({to:a,target:"_blank","data-za-detail-view-element_name":"Title"},c&&{"data-za-detail-view-id":c}),{onClick:p,children:d?(0,i.tZ)("span",{dangerouslySetInnerHTML:{__html:n},className:"AnswerItem-highlight"}):n}))]})}u.propTypes={questionId:c().number.isRequired,title:c().string.isRequired,href:c().string.isRequired,zaTitleId:c().number,showStickyMark:c().bool,onClick:c().func}},19295:function(e,t,n){"use strict";var r=n(85879),o=n(14168),i=n.n(o),a=n(31467),c=n(38889),s=function(e){var t=e.shown,n=e.onClose;return(0,r.tZ)(a.Z,{onClose:n,title:"该问题暂时只支持客户端进行回答",children:t&&(0,r.tZ)("div",{className:"SlideshowEditBlockModal",children:(0,r.tZ)(c.ZP,{preset:c.EE.Primary,color:c.rp.Blue,onClick:n,children:"知道了"})})})};s.propTypes={shown:i().bool.isRequired,onClose:i().func.isRequired},t.Z=s},81168:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(55164),o=n(57477),i=n(85879),a=n(87641),c=n(29229);function s(e){var t=(0,c.Z)(function(){return n.e(3584).then(n.bind(n,85638))});return(0,i.tZ)(a.Box,(0,o._)((0,r._)({my:"14px",css:{minHeight:20}},e),{children:t?(0,i.tZ)(t,{width:"70px",height:"20px",css:{display:"block"}}):null}))}},7236:function(e,t,n){"use strict";n.d(t,{Z:function(){return E}});var r=n(55164),o=n(57477),i=n(85879),a=n(87641),c=n(61255),s=n(63573),l=n(81168),u=n(68159),d=n(87363),p=n.n(d),h=n(30722),f=n(93445),_=n(80714),m=n(66980),v=Object.assign,g=function(e){return p().createElement(m.Z,v({width:"8",height:"10",fill:"none",viewBox:"0 0 8 10"},e),p().createElement("path",{fill:"#121212",fillRule:"evenodd",d:"M1.315 9.302a.6.6 0 0 1-.915-.51v-7.52a.6.6 0 0 1 .914-.51l6.11 3.754a.6.6 0 0 1 0 1.022l-6.11 3.764Z",clipRule:"evenodd"}))};function T(e){var t=e.videoId,n=e.zvideoId,r=e.title,o=e.playCount,a=void 0===o?0:o,s=e.voteupCount,l=void 0===s?0:s,p=e.isComplete,m=e.startTime,v=e.creationReferences,T=e.creationRelationship,E=e.shouldExpandState,C=e.itemId,y=e.itemType,S=e.isRecommend,I=Number((void 0===m?0:m)/1e3),b=(0,d.useRef)({currentTime:0}),A=(0,d.useRef)((0,u.Wn)(t,"*",!0));return(0,d.useEffect)(function(){var e=A.current.subscribeMessage(function(e,t){e===u.FP.TIMEUPDATE&&(b.current.currentTime=t.currentTime)});return function(){return e.unsubscribe()}},[]),(0,i.BX)("div",{className:"VideoAnswerPlayer",children:[(0,i.tZ)("div",{className:"VideoAnswerPlayer-video",children:(0,i.tZ)(f.Z,{contentId:C,contentType:y,videoId:t,useSingle:S,zaProps:{type:"Answer",token:C}})}),E&&(0,i.BX)("div",{role:"button",tabIndex:0,"aria-label":"跳转到对应视频",className:"VideoAnswerPlayer-stateBar",onClick:function(){var e=(b.current.currentTime+I).toFixed(1);window.open("https://".concat(_.Z.wwwHost,"/zvideo/").concat(n,"?playTime=").concat(e))},children:[(0,i.BX)("div",{className:"VideoAnswerPlayer-state",children:[(0,i.tZ)("div",{className:"VideoAnswerPlayer-state--title",children:r}),(0,i.BX)("div",{className:"VideoAnswerPlayer-state--data",children:[(null==v?void 0:v.plainText)?"".concat(v.plaintext," \xb7 "):(0,c.Gz)(T)?"引用创作 \xb7 ":null,(0,h.Zh)(a),"播放",l>0?" \xb7 ".concat((0,h.Zh)(l),"赞同"):null]})]}),!(void 0!==p&&p)&&(0,i.BX)("div",{className:"VideoAnswerPlayer-action",children:[(0,i.tZ)(g,{style:{marginRight:"6px"}}),"完整版"]})]})]})}var E=function(e){var t=e.shouldExpand,n=e.showPlayer,u=e.campaign,d=e.answer,p=e.videoAnswerData,h=e.meta,f=e.videoRef,_=e.alwaysShowVolumeButton,m=e.hideCoCreationFeature,v=e.isRecommend,g=!m&&(0,c.HE)(null==p?void 0:p.creationRelationship);return(0,i.BX)(i.HY,{children:[n&&(0,i.tZ)(T,(0,r._)({itemId:d.id,itemType:d.type,videoRef:f,alwaysShowVolumeButton:_,shouldExpandState:t,isRecommend:v},p)),h,t&&(0,i.BX)(a.Flex,{mt:"14px",children:[g&&(0,i.tZ)(c.xJ,{mr:"12px"}),(0,i.tZ)(l.Z,{my:"0px"})]}),t&&u&&(0,i.tZ)(s.Z,{item:(0,o._)((0,r._)({},d),{campaign:u,collapseReason:null,type:"zvideo"})})]})}},59525:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(85879),o=n(87363),i=n(36695),a=n(8866),c=n(55344),s=n(65939),l={up:1,neutral:0,down:-1};function u(e){var t=e.id,n=e.voteupCount,u=e.voting,d=e.isOwner,p=e.answer,h=e.currentUser,f=e.disabled,_=(0,i.useDispatch)();(0,o.useEffect)(function(){!f&&h&&_((0,c.X2)(["opposeRight"]))},[f,h,_]);var m=(0,o.useCallback)(function(e){_((0,a.i_)(p.id,l[e],{zVideoId:t}))},[t,_,p.id]);return(0,r.tZ)(s.Z,{type:"zvideo",count:n,voting:u,onVote:m,isOwner:d})}},84069:function(e,t,n){"use strict";function r(e){var t,n=null==e?void 0:null===(t=e.reactionInstruction)||void 0===t?void 0:t.rEACTIONANONYMOUS;return void 0!==n?n||"该问题暂不支持启用匿名":""}function o(e){return 0===Number(null==e?void 0:e.id)}n.d(t,{S:function(){return o},i:function(){return r}})},6360:function(e,t,n){"use strict";n.d(t,{Z:function(){return r.Z}});var r=n(66392)},14742:function(e,t,n){"use strict";n.d(t,{Dm:function(){return s},fb:function(){return l},gh:function(){return a},xx:function(){return c}});var r=n(85879),o=n(8866),i=n(82311),a=function(e){var t=e.answer,n=e.canCollapse,o=t.collapsedBy,a=t.relationship,c=(void 0===a?{}:a).isAuthor,s=t.visibleOnlyToAuthor;return c&&s?(0,r.tZ)(i.Z,{}):"org"!==o||n?null:(0,r.BX)("div",{className:"AnswerItem-status",children:["回答被提问机构移至隐藏区（",(0,r.tZ)("a",{href:"/org-intro#org-question",target:"_blank",children:"为什么？"}),"）"]},"negativeLabels")},c=function(e){var t=e.isNormal,n=e.collapsedBy,r=e.suggestEdit,o=e.collapseReason,i=e.isCollapsed,a=e.question,c=(void 0===a?{}:a).brand,s=(void 0===c?{}:c).isPuQuestion;return!(void 0===t||t)&&(null==r?void 0:r.unnormalDetails)?{abnormalDetailProps:{abnormalDetail:r.unnormalDetails}}:("community"===n||s)&&i?{collapseReasonProps:{collapseReason:o}}:null},s=function(e){var t=e.answer,n=e.canCollapse,r=e.hideCommercialInviteLabel,i=t.collapsedBy,a=t.relevantInfo,c=void 0===a?{}:a,s=c.relevantType,l=c.brandSpecialExtra,u=void 0===l?{}:l;if((0,o.z)(t)||(0,o.G_)(t)||"org"===i&&!n){if("brand_special"===s&&!r)return{type:"answer",data:u};if("brand_best"===s)return{data:u}}return null},l=function(e){var t=e.annotationDetail,n=e.isNormal,r=e.collapsedBy;return(void 0===n||n)&&"community"!==r&&t?{annotationDetail:t}:null}},72638:function(e,t,n){"use strict";var r=n(85879),o=n(87363),i=n(99213);t.Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.contentExpanded,a=t.unescapable,c=e.labelInfo,s=e.hermesLabel;return(0,r.tZ)(o.Fragment,{children:!n&&!a&&(0,r.tZ)(i.vT,{labelInfo:c||s})})}},92120:function(e,t,n){"use strict";n.d(t,{Y:function(){return r}}),n(85879),n(87363),n(87641),n(30016),n(43384);var r={textAnswer:"textAnswer",videoAnswer:"videoAnswer"};r.textAnswer,r.videoAnswer},42735:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(69383),s=n(93653),l=n(80714),u=n(25734);t.Z=function(e){var t=e.color,n=e.onClick,d=(0,i._)(e,["color","onClick"]),p=(0,u.ZP)().themeTransition;return(0,a.tZ)("a",(0,o._)((0,r._)({href:"//".concat(l.Z.wwwHost),"aria-label":"知乎",onClick:function(e){n&&n(e),c.Z.trackEvent(e.target,{action:"OpenUrl",id:2730},{button:{text:"知乎"}})}},d),{children:(0,a.tZ)(s.Z,{color:void 0===t?"primary":t,css:(0,r._)({},p("fill"))})}))}},64074:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(36695),s=n(43384),l=n(54616),u=n(97476),d=n(258),p=n(80714),h=n(58909),f=n(7407),_=function(e){var t=(0,c.useSelector)(f.cM),n=t.sogouInput,_=t.oppoSearch,m=t.huaweiSearch,v=(0,c.useSelector)(h.ib),g=(0,s.Q4)().trackEvent,T=(0,i._)(_?["slogan","highlight"]:["searchBox","default"],2),E=T[0],C=T[1];return!n&&(0,a.tZ)(l.Z,(0,o._)((0,r._)({allowSignUp:p.Z.allowSignUp,currentUser:v,handleAriaClick:u.Gb},e),{searchHeaderPreset:E,oiaButtonPreset:C,showOpenAppButton:!0,handleOpenAppClick:m?function(){return location.href="https://onelink.zhihu.com/onelink?id=711"}:function(){return(0,d.Z)({trackEvent:g,zaV3Text:"顶部打开App按钮",noEnteringSignin:!!v})}}))}},86112:function(e,t,n){"use strict";n.d(t,{Z:function(){return eG}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(94009),d=n(85626),p=n(85879),h=n(72111),f=n(66011),_=n(82452),m=n(30037),v=n(84220),g=n(60811),T=n(67814),E=n.n(T),C=n(14168),y=n.n(C),S=n(87363),I=n(36695),b=n(19076),A=n(87641),Z=n(93206),w=n(69383),R=n(31252),N=n(99447),k=n(26820),O=n(42657),x=n(91777),P=n(38889),D=n(66223),L=n(47866),B=n(51081),U=function(e){var t=e.className,n=e.onClick,r=e.html,o=e.sourceId,i=(0,S.useCallback)(function(e){w.Z.trackEvent(e.target,{id:9857,action:"Click"}),n&&n(e)},[n]),a=(0,S.useMemo)(function(){return(0,B.f1)(r,o).catalog},[r,o]);return(null==a?void 0:a.length)?(0,p.tZ)(N.r,{trackCardShow:!0,view:{id:9856},children:(0,p.tZ)(P.ZP,{preset:"plain",className:t,onClick:i,icon:L.Ll,label:"目录"})}):null},M=n(79065),G=n(74128),F=n(44169),z=n(82806),H=n.n(z),q=n(71728),V=n(99878),X=n(80565),W=n(74314),K=function(e){var t=e.children,n=e.targetId,r=e.active,o=e.setCursor,i=(0,q._)(e,["children","targetId","active","setCursor"]);return(0,p.tZ)(A.Text,(0,l._)((0,s._)({color:r?"GBL01A":"GBK02A",fontWeight:r?"bold":"normal",css:{fontSize:"14px"}},i),{children:(0,p.tZ)(N.r,{module:"Content",moduleName:String(t),children:(0,p.BX)(A.Flex,{css:{cursor:"pointer",alignItems:"center",height:"48px"},sx:{borderBottom:"1px solid",borderColor:"GBK09A"},onClick:function(e){w.Z.trackEvent(e.target,{id:9745,action:"Click",name:"弹窗"});var t=document.querySelector("#"+n);o(n),t&&(0,W.TS)(t)},children:[(0,p.tZ)(A.Text,{css:(0,X.S)(1),children:t}),(0,p.tZ)(V.N,{size:"24px",css:function(e){return{color:e.colors.GBL05A,flex:"0 0 auto",marginLeft:"auto"}}})]})})}))},j=function(e){return(0,p.tZ)(K,(0,s._)({},e))},Y={1:j,2:function(e){return(0,p.tZ)(K,(0,s._)({pl:"20px"},e))}},Q=function(e){var t=e.catalog,n=e.className,r=e.zaContent,o=(0,u._)((0,S.useState)(null),2),i=o[0],a=o[1];return((0,S.useEffect)(function(){if(null==t?void 0:t.length){var e=null,n=(0,W.cx)();t.forEach(function(t){var r=document.querySelector("#"+t.targetId);(null==r?void 0:r.getBoundingClientRect().top)<=n+2&&(e=t.targetId)}),a(e)}},[]),null==t?void 0:t.length)?(0,p.tZ)(N.r,{trackCardShow:!0,view:{id:9744,name:"弹窗"},content:r,module:"Content",children:(0,p.tZ)(A.Box,{className:E()(n),children:(0,p.tZ)(A.Flex,{flexDirection:"column",css:{fontSize:"12px"},children:t.map(function(e){var t=e.titleLevel,n=e.text,r=e.targetId,o=Y[t]||j;return(0,p.tZ)(o,{targetId:r,active:i===r,setCursor:a,children:n},r)})})})}):null};function J(){var e=(0,M._)([""," 编辑于",""]);return J=function(){return e},e}var $=function(e){var t=e.className,n=e.shown,r=e.onClose,o=e.html,i=e.sourceId,a=e.updated,c=e.author,s=e.zaContent,l=(0,S.useMemo)(function(){return(0,B.f1)(o,i).catalog},[o,i]);return(0,p.tZ)(G.Z,{wrapperClassName:"CatalogModal-wrapper",className:E()("CatalogModal",t),title:"目录",subtitle:H()(J(),null==c?void 0:c.name,(0,F.KZ)(a)),onClose:r,children:n&&(0,p.tZ)(Q,{css:{paddingBottom:"16px"},catalog:l,zaContent:s})})},ee=n(8858),et=n(61255),en=n(63362),er=n(3707),eo=n(49906),ei=n(80714),ea=n(60736),ec=n(12421),es=n(85576),el=n(78970),eu=n(89250),ed=n(7407),ep=n(1606),eh=n(4059),ef=n(77683),e_=n(99213),em=n(63573),ev=n(91157),eg=n(24794),eT=n(65939),eE=n(97285),eC=n(66263),ey=n(57138),eS=n(98731),eI=n(99158),eb=n(11264),eA=n(24340),eZ=n(84344),ew=n(19495),eR=n(11797),eN=n(99830),ek=n(30361),eO=n(102),ex=n(57386),eP=n(8231),eD=n(2174),eL=function(e){return"plain"===e||"special-plain"===e},eB=function(e){var t=e.title,n=e.id,r=e.created,o=e.updated,i=e.commentCount,a=e.imageUrl,c=e.thumbnail;return{headline:t,url:"".concat(eC.vg,"/p/").concat(n),datePublished:new Date(1e3*r).toISOString(),dateModified:new Date(1e3*o).toISOString(),commentCount:i,image:a||c}},eU=(0,es.Z)(function(e){var t=e.id,n=e.type,r=e.voteupCount,o=e.authRequired,i=(0,el.Z)(o),a=i.modalShown,c=i.openVotersModal,s=i.closeVotersModal;return(0,p.BX)(p.HY,{children:[(0,p.tZ)(er.Z,{contentType:"article",id:t,onClickVoterInfo:c}),(0,p.tZ)("div",{className:"ArticleItem-extraInfo",children:(0,p.tZ)(eE.Z,{id:t,type:n,voteupCount:r,modalShown:a,handleListHide:s})},"articleExtraInfo")]})}),eM=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e,i,c,l,u,d,h;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{commentsShown:!1,commentsAutoFocus:!0,favlistsShown:!1,commentPattern:"fixed",positionStatus:null,guideShown:!1,contentExpanded:!1,hasFetchedLabels:!1,shownCatalogModal:!1,imageAspectRatio:1.6}),(0,a._)((0,r._)(e),"disableAuth",(u=(void 0===(l=(void 0===(c=(i=e.props).router)?{}:c).location)?{}:l).pathname,d=i.isMobile,h=i.currentUser,d&&!h&&!u.startsWith("/topic"))),(0,a._)((0,r._)(e),"handleCommentsShown",function(t,n){if(e.props.shouldOia){e.createOpenInAppHandler("comment_article")(t);return}e.setState(n),n.commentsShown?e.props.trackOpenCommentAdPromotion():e.props.trackCloseCommentAdPromotion()}),(0,a._)((0,r._)(e),"handleCommentsHide",function(){e.setState({commentsShown:!1}),e.props.trackCloseCommentAdPromotion()}),(0,a._)((0,r._)(e),"handlePositionStatusChange",function(t){e.setState({positionStatus:t})}),(0,a._)((0,r._)(e),"handleFavButtonClick",function(t){var n=e.props,r=n.zaInfos.favlists;if(n.shouldOia){e.createOpenInAppHandler("comment_article")(t);return}if(w.Z.trackEvent(e.favButtonRef,(0,s._)({action:"Collect",element:"Button",is_intent:!0},r&&{id:r})),e.disableAuth){e.handleToggleGuide();return}e.handleFavlistsShown()}),(0,a._)((0,r._)(e),"handleFavlistsShown",e.props.authRequired(function(){return e.setState({favlistsShown:!0})},eC.q0.favlists)),(0,a._)((0,r._)(e),"handleFavlistHide",function(){e.setState({favlistsShown:!1})}),(0,a._)((0,r._)(e),"handleToggleGuide",function(){e.setState({guideShown:!e.state.guideShown})}),(0,a._)((0,r._)(e),"toggleCatalogModal",function(){e.setState({shownCatalogModal:!e.state.shownCatalogModal})}),(0,a._)((0,r._)(e),"handleVote",function(t){var n=e.props,r=n.article.id;(0,n.updateArticleVote)(r,t)}),(0,a._)((0,r._)(e),"handleLogMoreClick",function(){var t=e.props.zaInfos.options;w.Z.trackEvent((0,r._)(e),(0,s._)({action:"Click",element_name:"MoreAction"},t&&{id:t}))}),(0,a._)((0,r._)(e),"loadArticleRelationEndorsement",function(){var t=e.props,n=t.article,r=t.relationEndorsement,o=t.loadArticleRelationEndorsement;r||o(n.id)}),(0,a._)((0,r._)(e),"handleToggleExpand",function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.trackUserAction,o=e.props,i=o.onToggleExpand,a=o.getTrackUrl,c=o.article,s=o.ua,l=o.trackPromotionClick;i&&i(t),t&&(e.loadArticleRelationEndorsement(),(void 0===r||r)&&((c.trackUrl?Promise.resolve():a(c.id)).then(function(){return(0,O.Z)(e.props.article,s)}),l&&l())),e.setState({contentExpanded:t})}),(0,a._)((0,r._)(e),"renderPrefix",function(){var t=e.props.article,n=t.labelInfo,r=t.hermesLabel,o=e.state.contentExpanded;return(n||r)&&!o?(0,p.tZ)(e_.vT,{labelInfo:n||r}):null}),(0,a._)((0,r._)(e),"createOpenInAppHandler",function(t){var n=e.props.article.id;return function(e){e.preventDefault(),eC.dd||(0,_.rH)((0,ey.MN)({type:"article",id:n}),{utm_content:t})}}),(0,a._)((0,r._)(e),"handleLike",function(t){return!!e.props.shouldOia&&(e.createOpenInAppHandler("like_article")(t),!0)}),(0,a._)((0,r._)(e),"handleCoverImageLoad",function(t){var n=e.props.article,r=t.target;n.imageUrl===e.coverProps.cover&&r.naturalWidth&&e.setState({imageAspectRatio:r.naturalWidth/r.naturalHeight})}),(0,a._)((0,r._)(e),"handleClickTitle",function(t){var n=e.props,r=n.trackPromotionClick,o=n.article.id,i=n.onClickTitle;t.preventDefault(),window.open(e.href),null==i||i(o),null==r||r()}),e}return(0,i._)(n,[{key:"href",get:function(){var e=this.props.article.id;return"//".concat(ei.Z.zhuanlanHost,"/p/").concat(e)}},{key:"renderLabels",value:function(){if(!this.state.contentExpanded)return null;var e=this.props.article,t=e.annotationDetail;return(0,p.tZ)(em.Z,{annotationProps:t&&{annotationDetail:t},item:e})}},{key:"renderArticleExtraInfo",value:function(){var e=this.props.article,t=e.voteupCount,n=e.id,r=e.type;return(0,p.tZ)(eU,{id:n,type:r,voteupCount:t})}},{key:"renderMeta",value:function(){var e=eB(this.props.article);return Object.keys(e).map(function(t){return(0,p.tZ)("meta",{itemProp:t,content:e[t]},t)})}},{key:"renderSuggestEdit",value:function(){var e=this.props.article,t=e.isNormal,n=e.suggestEdit,r=void 0===n?{}:n,o=r.title,i=r.status,a=r.reason;return i&&!(void 0===t||t)?(0,p.BX)("div",{className:"AnswerItem-statusContent",children:[(0,p.tZ)("div",{className:"AnswerItem-statusReason",children:a}),(0,p.BX)("div",{className:"AnswerItem-statusDescription",children:["作者修改内容通过后，文章会重新显示恢复正常\xa0",(0,p.tZ)("a",{target:"_blank",href:"/question/24752645",className:"AnswerItem-statusLink",children:o})]})]}):null}},{key:"render",value:function(){var e,t,n=this,r=this.props,o=r.article,i=r.article,a=i.id,c=i.title,d=i.author,_=i.excerpt,m=i.content,T=i.voteupCount,C=i.voting,y=i.type,S=i.created,I=i.updated,b=i.imageUrl,Z=i.commentCount,w=i.adminClosedComment,R=i.annotationDetail,N=i.creationRelationship,O=i.ipInfo,x=r.preset,L=r.lastreadTouchable,B=r.itemProp,M=r.ua,G=r.lessExcerpt,F=r.formatContent,z=r.zaInfos,H=z.expand,q=z.title,V=z.voteUp,X=z.voteDown,W=z.toggleComment,K=z.share,j=z.report,Y=z.options,Q=z.getCommentAction,J=r.renderOptions,er=r.isSticky,ei=r.handleToggleSticky,ea=r.renderActionButtons,es=r.className,el=r.isMobile,eu=r.ecommerce,ed=r.showHeightLight,ep=void 0!==ed&&ed,e_=r.truncateDisabled,em=r.currentUser,eE=r.blockStrategies,eC=r.trackShareAdPromotion,eS=r.trackPublishCommentAdPromotion,eb=r.adHint,eB=(0,eI.Z)([(0,eI.m)(eE)],ea),eU=this.state,eM=eU.positionStatus,eG=eU.favlistsShown,eF=eU.commentsShown,ez=eU.commentsAutoFocus,eH=eU.commentPattern,eq=eU.contentExpanded,eV=eU.shownCatalogModal,eX=eU.imageAspectRatio,eW=em&&em.urlToken===(null==d?void 0:d.urlToken),eK=this.renderSuggestEdit(),ej="function"==typeof ei,eY="special-plain"!==x&&(0,p.tZ)(ef.Z,(0,l._)((0,s._)({},eL(x)&&{preset:"plain"}),{author:d,userLinkV2:!0,className:"ArticleItem-authorInfo"}),"authorInfo"),eQ=this.renderArticleExtraInfo(),eJ=this.renderLabels(),e$=null==N?void 0:null===(e=N.coCreation)||void 0===e?void 0:e.refBy,e0=null==N?void 0:null===(t=N.reference)||void 0===t?void 0:t.refBy,e1=eq&&(e$||e0)&&(0,p.tZ)(A.Box,{my:"16px",children:(0,p.tZ)(et.j7,{type:"article",coCreationRefBy:e$,referenceRefBy:e0})}),e2=(0,u._)(eL(x)?[[eY,eJ,e1],eQ]:[[eY,eJ,e1,eQ],null],2),e3=e2[0],e4=e2[1],e5=!eK||eW,e6=F?F(m||_,o):m||_,e7=!el&&eq&&(0,ee.Z)(o,"article"),e8=this.coverProps=o.thumbnailExtraInfo&&"video"===o.thumbnailExtraInfo.type?{cover:o.thumbnail,hasVideo:!0}:{cover:o.imageUrl||o.thumbnail,hasVideo:!1};return(0,p.BX)(ek.ZP,{className:E()("ArticleItem",es),onRef:function(e){n.contentItem=e},"data-zop":JSON.stringify({authorName:null==d?void 0:d.name,itemId:a,title:c,type:"article"}),data:o,link:this.href,title:(0,p.BX)(p.HY,{children:[ej&&er&&(0,p.tZ)(eD.Z,{}),(0,p.tZ)(h._o,{zaAction:"OpenUrl",zaEventType:"Click",zaText:"标题跳转",zaType:"Text",zaModuleId:"card_title_text",children:(0,p.tZ)("a",(0,l._)((0,s._)({href:this.href,target:"_blank",rel:"noopener noreferrer","data-za-detail-view-element_name":"Title"},q&&{"data-za-detail-view-id":q}),{onClick:this.handleClickTitle,children:ep?(0,p.tZ)("span",{dangerouslySetInnerHTML:{__html:c},className:"ArticleItem-highlight"}):c}))})]}),meta:e3,lastreadTouchable:L,itemProp:void 0===B?"article":B,itemType:"http://schema.org/SocialMediaPosting",itemScope:!0,children:[this.renderMeta(),e5?(0,p.BX)(eP.Z,(0,l._)((0,s._)((0,l._)((0,s._)({truncateDisabled:void 0!==e_&&e_,className:E()({"ArticleItem-highlight":ep}),itemProp:"articleBody",data:o,excerpt:F?F(_,o):_,html:e6,ecommerce:eu,onToggleExpend:this.handleToggleExpand,prefix:this.renderPrefix(),contentNeedTruncated:o.contentNeedTruncated,before:(0,p.BX)("div",{children:[e4,b&&(0,p.tZ)(eA.Z,{mt:"10px",ratio:eX,children:(0,p.tZ)(f.G6,{width:"100%",height:"100%",src:b,alt:c})})]}),after:(0,p.tZ)(eP.O,{href:this.href,created:S,updated:I,ipInfo:O})},G?{limit:74}:{}),{onPositionStatusChange:this.handlePositionStatusChange}),e8),{onCoverImageLoad:this.handleCoverImageLoad,zaIds:{expand:H},children:[eB({componentList:[{name:"vote",component:!k.YP.includes(a)&&(el?(0,p.tZ)(ev.Z,{id:a,type:y,liked:!!C,count:T,disabled:eW,onClick:this.handleLike,handleToggleGuide:this.handleToggleGuide,disableAuth:this.disableAuth},"vote"):(0,p.tZ)(eT.Z,{type:y,count:T,onVote:this.handleVote,voting:C,isOwner:eW,handleToggleGuide:this.handleToggleGuide,zaIds:{voteUp:V,voteDown:X}},"vote"))},{name:"comment",component:(0,p.tZ)("div",{css:k.YP.includes(a)?{marginLeft:-24}:{},children:(0,p.tZ)(ew.Z,{onClick:this.handleCommentsShown,commentsShown:eF,commentClosed:w,count:Z,positionStatus:eM,zaInfos:{toggleComment:W,getCommentAction:Q}},"comment")},"comment")},{name:"catalog",component:e7&&(0,p.tZ)(U,{html:e6,sourceId:o.id,onClick:this.toggleCatalogModal},"catalog")},{name:"share",component:(0,p.tZ)(eg.Z,{id:a,type:"article",url:this.href,title:c,authorName:d&&d.name,positionStatus:eM,zaShareId:K,onShare:eC},"share")},{name:"favlist",component:(!em||!em.isOrg)&&(0,p.tZ)(en.Z,{onRef:function(e){return n.favButtonRef=e},onClick:this.handleFavButtonClick,label:el?"":"收藏"},"favlist")},{name:"sticky",component:!el&&ej&&eW&&(0,ec.U)(em)&&(0,p.tZ)(P.ZP,{preset:"plain",onClick:ei,icon:er?v.TX:g.rh,label:er?"取消置顶":"置顶"},"sticky")},{name:"report",component:!eW&&!el&&em&&(0,p.tZ)(ex.Z,{id:a,type:y,zaReportId:j},"report")},{name:"options",component:!el&&(null==J?void 0:J(function(){return n.contentItem},Y))},{name:"annotation",component:!eq&&(0,p.tZ)(eh.Z,{annotationDetail:R},"annotation")}]}),eb&&(0,p.tZ)(D.Z,{tag:eb})]})):this.renderSuggestEdit(),e5&&(0,p.tZ)(eZ.Z,{content:m,type:"article",urlToken:String(a)}),this.disableAuth&&this.state.guideShown&&(0,p.tZ)(eo.Z,{redirectUrl:this.href,urlScheme:(0,ey.MN)({type:"article",id:a}),buttons:[M.Wechat?{name:"wechat",text:"快速登录",fill:"#fff"}:"zhihu"],onClose:this.handleToggleGuide}),(0,p.tZ)(eN.Z,{parent:o,commentPattern:eH,commentPlugin:eR.Z,shown:eF,autoFocus:ez,onClose:this.handleCommentsHide,onComment:eS}),(0,p.tZ)(eO.E,{id:a,type:"article",shown:eG,onClose:this.handleFavlistHide,zaEnabled:!0}),e7&&(0,p.tZ)($,{shown:eV,html:e6,sourceId:o.id,onClose:this.toggleCatalogModal,created:S,updated:I,author:d,zaContent:{type:"Answer",token:String(o.id)}})]})}}]),n}(S.Component);(0,a._)(eM,"propTypes",{preset:y().string,lessExperpt:y().bool,formatContent:y().func,renderOptions:y().func,zaInfos:y().object,trackPromotionClick:y().func,renderActionButtons:y().func}),(0,a._)(eM,"defaultProps",{preset:"primary",zaInfos:{},renderActionButtons:eS.W9});var eG=(0,Z.compose)((0,ep.Ib)(function(e){var t=e.article,n=e.index;return(0,s._)({content:{type:"Post",token:String(t.id)}},void 0!==n&&{moduleIndex:n})}),(0,N.a)(function(e){var t,n=e.article,r=e.trackCardShow,o=e.zaInfos,i=(void 0===o?{}:o).cardShow;return(0,l._)((0,s._)({module:"PostItem",card:{has_image:!!(n.thumbnailExtraInfo&&"image"===n.thumbnailExtraInfo.type),has_video:!!(n.thumbnailExtraInfo&&"video"===n.thumbnailExtraInfo.type),content:{type:"Post",token:n.id.toString(),upvote_num:n.voteupCount,comment_num:n.commentCount,publish_timestamp:1e3*n.created,parent_token:n.column&&n.column.id,author_member_hash_id:null===(t=n.author)||void 0===t?void 0:t.id,video_id:n.thumbnailExtraInfo&&n.thumbnailExtraInfo.videoId}}},i&&{view:{id:i}}),{trackCardShow:void 0===r||r})}),b.withRouter,es.Z,(0,m.$_)({dataPath:"article"}),m.OW,(0,I.connect)(function(e,t){var n,r,o,i=t.article;return{article:(n=(0,ea.JP)(i))?(0,l._)((0,s._)({},i),{creationRelationship:n}):i,ua:e.env.userAgent,ecommerce:(0,R.G_)(e,{type:"article",urlToken:t.article.id}),shouldOia:(0,ed.XE)(e),isMobile:(0,ed.Hu)(e),relationEndorsement:null===(r=e.articles)||void 0===r?void 0:null===(o=r.relationEndorsement)||void 0===o?void 0:o[i.id]}},{updateArticleVote:eu.Pt,getTrackUrl:x.H,loadArticleRelationEndorsement:eu.iv}),(0,eb._)({dataPath:"article"}))(eM)},24340:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(87363),s=n(87641),l=function(e){var t=10*e;return(t-t%5)/10};t.Z=(0,c.forwardRef)(function(e,t){var n=e.ratio,c=void 0===n?1:n,u=e.children,d=(0,i._)(e,["ratio","children"]);return(0,a.tZ)(s.Box,(0,o._)((0,r._)({css:{position:"relative",paddingBottom:"".concat(l(1/c*100),"%"),height:"0",borderRadius:"inherit"}},d),{ref:t,children:(0,a.tZ)("div",{css:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",borderRadius:"inherit"},children:u})}))})},37705:function(e,t,n){"use strict";var r=n(55164),o=n(85879),i=n(87363),a=n(50373),c=n(80714);function s(){return Promise.all([n.e(5546),n.e(154),n.e(280),n.e(8400),n.e(1468),n.e(2156)]).then(n.bind(n,58051))}var l=(0,i.forwardRef)(function(e,t){return(0,o.tZ)(a.Z,(0,r._)({ref:t,getComponent:s,newLinkCard:!0,shouldAdaptNative:"1"===c.Z.apollo.editor_adapt_native,autoRotateImage:"1"===c.Z.apollo.editor_auto_rotate},e))});t.Z=l},77683:function(e,t,n){"use strict";n.d(t,{Z:function(){return ee}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(85626),d=n(85879),p=n(82452),h=n(80565),f=n(67814),_=n.n(f),m=n(71549),v=n.n(m),g=n(14168),T=n.n(g),E=n(87363),C=n(36695),y=n(19076),S=n(93206),I=n(69383),b=n(43384),A=n(80714),Z=n(66263),w=n(30256),R=n(7407),N=n(57138),k=n(73596),O=n(85661),x=n(94785),P=n(94226),D=n(58909),L=n(67516),B=n.n(L),U=n(31142),M=(0,C.connect)(function(e){var t;return{vipInfo:null===(t=(0,D.ib)(e))||void 0===t?void 0:t.vipInfo}})(function(e){var t=e.widget,n=e.className,r=e.vipInfo,o=t.id,i=t.url;return(0,d.tZ)(U.Z,{className:n,onClick:function(){var e;(null==r?void 0:null===(e=r.widget)||void 0===e?void 0:e.id)!=="".concat(o)&&(B().set("widgetId",o),B().set("widgetUrl",i))},preset:"link",a:!0,to:"https://".concat(A.Z.wwwHost,"/settings/stickers"),children:(0,d.tZ)("img",{src:i,style:{width:"100%"},alt:""})})}),G=n(94009),F=n(75798),z=n(53910),H=n(46829),q=n(79446),V=n(6438),X={isFollowing:!1,isFollowed:!1,isBlocking:!1,isBlocked:!1,type:null},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.isFollowing,n=e.isFollowed,r=e.isBlocking;return"boolean"==typeof t&&"boolean"==typeof n&&"boolean"==typeof r},K=function(e){var t=e.urlToken,n=e.user,r=e.onToggleFollow,o=(0,C.useDispatch)(),i=(0,q.n)(),a=i?n:X,c=(0,G._)((0,F.Z)({once:!0,rootMargin:"".concat(500,"px")}),2),s=c[0],l=c[1];(0,E.useEffect)(function(){if(!i)return function(){};!W(n)&&l&&o((0,V._u)(t))},[o,t,n,l,i]);var u=(null==a?void 0:a.isBlocking)||(null==a?void 0:a.isBlocked),p=(0,b.x3)({elementLocation:{block:{blockText:"详情页关注"},type:"Button",moduleId:"follow_button",content:{type:"User",token:null==a?void 0:a.id,id:null==a?void 0:a.id}}});return(0,d.BX)(d.HY,{children:[a&&!u&&(0,d.tZ)(b.eV,{content:{type:"User",token:a.id,id:a.id},moduleId:"follow_button",block:"详情页关注",children:(0,d.BX)(H.Z,{onRef:p,css:{minWidth:74,padding:0,userSelect:"none"},getButtonPresetAndColor:function(e){return e.isFollowing?{preset:"secondary",color:"grey"}:{preset:"secondary",color:"blue"}},canShowMutualFollowStatus:!0,id:t,type:a.type,isFollowing:a.isFollowing,isFollowed:a.isFollowed,onToggleFollow:r,children:[(0,d.tZ)(z.ZP,{text:!0,center:!0})," 关注"]})}),(0,d.tZ)("div",{ref:s,css:{position:"absolute",bottom:0,right:0,width:1,height:1}})]})};function j(e){var t=e.urlToken,n=e.onToggleFollow,r=(0,C.useSelector)(function(e){return e.entities.users[t]});return(0,D.xw)(r)?null:(0,d.tZ)(K,{urlToken:t,user:r,onToggleFollow:n})}var Y=n(87641),Q=n(24405),J=function(e){var t=e.text,n=(0,Q.F)();return(0,d.tZ)(Y.Box,{css:{color:n.colors.GBK04A,fontSize:14,lineHeight:1.6,fontWeight:"normal"},children:t})},$=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleClick",function(t){var n=e.props,r=n.zaId,o=n.zaExtra,i=n.zaInfo,a=n.author,c=a.urlToken,s=a.id,l=n.isSpecialQuestionOrAnswer,u=n.preventOpenUrl,d=n.isMobile,h=n.trackEvent;if(u){t.preventDefault();return}if(r&&I.Z.trackEvent(null,{id:r,action:"OpenUrl",element_name:"User"},o),i&&h({eventType:"Click",action:"OpenUrl",elementLocation:v()({type:"Card",content:{type:"User",id:s}},i.elementLocation)},v()({link:{url:t.target.href}},i.extra)),!d){if(l){location.href="zhihu://people/".concat(c,"?utm_app_name=zhihu_check"),t.preventDefault(),t.stopPropagation();return}A.Z.isMobileEntry&&e.props.isHuman&&e.props.shouldOia&&(t.preventDefault(),Z.dd&&A.Z.isMobileEntry||(0,p.rH)((0,N.MN)({type:"people",id:c},{utm_content:"user_link"})))}}),(0,a._)((0,r._)(e),"renderDetail",function(t){var n=e.props,r=n.extra,o=n.children,i=n.author,a=n.noHeadline,c=n.coCreationAuthorDescriptionText,u=n.followButtonAtFlexEnd;return c?(0,d.tZ)("div",{className:"AuthorInfo-badge",children:(0,d.tZ)(J,{text:c})}):t&&r||(0,d.tZ)("div",{className:"AuthorInfo-badge",children:o||(0,d.tZ)(k.Z,{className:"AuthorInfo-badgeText",css:u&&{"&.AuthorInfo-badgeText":(0,l._)((0,s._)({},(0,h.S)(1)),{width:490,whiteSpace:"unset"})},user:i,noHeadline:a})})}),e}return(0,i._)(n,[{key:"render",value:function(){var e,t="plain"===this.props.preset,n=this.props,r=n.author,o=n.noLink,i=n.avatarSize,a=void 0===i?t?24:38:i,c=n.className,l=n.extra,u=n.itemProp,p=n.roundAvatar,h=n.isMobile,f=n.target,m=n.noDetail,v=n.noHoverCard,g=n.router,T=n.noBadge,E=n.noVipBadge,C=n.showVipIcon,y=n.followButtonAtFlexEnd,S=n.onToggleFollow,I=null==r?void 0:null===(e=r.vipInfo)||void 0===e?void 0:e.widget,Z=g.getCurrentLocation().pathname,w=-1!==Z.indexOf("people")&&3===Z.split("/").length,R=this.renderDetail(t),N=this.props.userLinkV2;return(0,d.tZ)("div",{className:_()("AuthorInfo",c,{"AuthorInfo--plain":t}),itemProp:u,itemScope:!0,itemType:"http://schema.org/Person",children:(0,d.BX)(b.eV,{moduleId:"author_portrait_text_button",children:[(0,d.BX)("div",{className:_()("AuthorInfo",{"AuthorInfo--mobile":A.Z.isMobileEntry}),children:[(0,d.tZ)("meta",{itemProp:"name",content:r.name}),(0,d.tZ)("meta",{itemProp:"image",content:r.avatarUrl}),(0,d.tZ)("meta",{itemProp:"url",content:"https://www.zhihu.com/people/".concat(r.urlToken)}),(0,d.tZ)("meta",{itemProp:"zhihu:followerCount",content:r.followerCount}),N&&(0,d.BX)(d.HY,{children:[(0,d.tZ)(P.Z,(0,s._)({onClick:this.handleClick,noHoverCard:A.Z.isMobileEntry||h||v,noLink:o,user:r,className:"AuthorInfo-avatarWrapper",avatarProps:{className:"AuthorInfo-avatar",size:a,round:p}},f&&{target:f})),(0,d.BX)("div",{className:"AuthorInfo-content",children:[(0,d.BX)("div",{className:"AuthorInfo-head",children:[(0,d.tZ)(x.Z,(0,s._)({noHoverCard:A.Z.isMobileEntry||h||v,onClick:this.handleClick,noLink:o,user:r,noBadge:T,noVipBadge:E,showVipIcon:C,className:"AuthorInfo-name"},f&&{target:f})),!t&&l]}),!m&&(0,d.tZ)("div",{className:"AuthorInfo-detail",children:R})]})]}),!N&&(0,d.BX)(d.HY,{children:[(0,d.tZ)(O.Z,(0,s._)({onClick:this.handleClick,noHoverCard:A.Z.isMobileEntry||h||v,noLink:o,className:"AuthorInfo-avatarWrapper",user:r,avatar:!0,avatarProps:{className:"AuthorInfo-avatar",size:a,round:p}},f&&{target:f})),(0,d.BX)("div",{className:"AuthorInfo-content",children:[(0,d.BX)("div",{className:"AuthorInfo-head",children:[(0,d.tZ)(O.Z,(0,s._)({noHoverCard:A.Z.isMobileEntry||h||v,onClick:this.handleClick,className:"AuthorInfo-name",noLink:o,user:r},f&&{target:f})),!t&&l]}),!m&&(0,d.tZ)("div",{className:"AuthorInfo-detail",children:R})]})]})]}),w&&I&&I.id&&(0,d.tZ)(M,{className:"AuthorInfo-Widget",widget:I}),!!r.urlToken&&y&&(0,d.tZ)(j,{urlToken:r.urlToken,onToggleFollow:S})]})})}}]),n}(E.Component);(0,a._)($,"propTypes",{author:T().object.isRequired,noLink:T().bool,avatarSize:T().number,preset:T().oneOf(["plain","default"]),className:T().string,itemProp:T().string,roundAvatar:T().bool,isMobile:T().bool,noDetail:T().bool,relatedTo:T().string,zaId:T().number,zaExtra:T().object,zaInfo:T().object,noHoverCard:T().bool,noHeadline:T().bool,preventOpenUrl:T().bool,noBadge:T().bool,noVipBadge:T().bool,showVipIcon:T().bool,coCreationAuthorDescriptionText:T().oneOf(["视频作者","图文作者"])}),(0,a._)($,"defaultProps",{noLink:!1,roundAvatar:!1,itemProp:"author",noHoverCard:!1,noHeadline:!1,preventOpenUrl:!1,coCreationAuthorDescriptionText:null});var ee=(0,S.compose)(y.withRouter,w.Z,(0,C.connect)(function(e,t){var n=t.relatedTo,r=t.params,o=["question","answer"].includes(n),i=(0,R.Hu)(e,{includeTablet:!0});return{isHuman:(0,R.H8)(e),shouldOia:(0,R.XE)(e)&&o,isMobile:i,isSpecialQuestionOrAnswer:(0,R.hV)(e,{type:o&&n,id:o?"question"===n?null==r?void 0:r.id:null==r?void 0:r.answerId:""}),followButtonAtFlexEnd:!i&&o}}))($)},90656:function(e,t,n){"use strict";n.d(t,{Ci:function(){return c},F:function(){return a}});var r=n(55164),o=n(49899);function i(e,t){var n,o,i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c=arguments.length>3?arguments[3]:void 0;return fetch((i=Object.keys(o=(0,r._)({token:t,max_matches:10,use_similar:0},c)).map(function(e){return"".concat(e,"=").concat(encodeURIComponent(o[e]))}).join("&"),"".concat((n="undefined"!=typeof window?window.location.host:null)?"//".concat(n.replace(/[a-z|A-Z]+(\d?)(?=\.zhihu)/,function(e,t){return"www".concat(t)}),"/"):"//www.zhihu.com/").concat(e?"".concat(e,"/"):"","autocomplete?").concat(i))).then(function(e){return e.json().then(function(t){return{res:e,json:t}})}).then(function(t){var n=t.res,r=t.json;if(n.ok)return r[0].filter(Array.isArray).filter(function(t){return!e||t[0]===e}).filter(function(e){return!a.includes(e[1])});throw Error("fetch ".concat(e," error"))})}function a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.apply(void 0,["topic"].concat((0,o._)(t))).then(function(e){return e.map(function(e){return{name:e[1],urlToken:e[2],avatarUrl:e[3]}})})}function c(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.apply(void 0,["question"].concat((0,o._)(t))).then(function(e){return e.map(function(e){return{name:e[1],urlToken:e[3],answersCount:e[5]}})})}},5941:function(e,t,n){"use strict";n.d(t,{Z:function(){return I}});var r=n(85879),o=(n(55698),n(67814)),i=n.n(o),a=n(14168),c=n.n(a);n(87038),c().string,c().string,c().string;var s=n(20857),l=n(22107),u=n(94707),d=n(87320),p=n(86325),h=n(55164),f=n(57477),_=n(85626),m=n(99178),v=n(95548),g=n.n(v),T=n(87363),E=n(1733),C=n(95377),y=function(e){var t=e.name;return(0,r.tZ)("div",{className:"AutoComplete-DefaultItem",css:{lineHeight:"40px"},children:t})};y.propTypes={name:c().string},y.defaultProps={name:""};var S=function(e){(0,p._)(n,e);var t=(0,_._)(n);function n(e){(0,l._)(this,n),r=t.call(this,e),(0,d._)((0,s._)(r),"handleOpen",function(){var e=r.props,t=e.onChange,n=e.onOpen,o=r.state,i=o.value,a=o.menuOpened;r.isEmpty()||a||!r.menu||(r.menu.popover.open(),r.setState({selectedIndex:r.getDefaultSelectIndex(),menuOpened:!0},function(){"function"==typeof n&&n(),t(i)}))}),(0,d._)((0,s._)(r),"handleClose",function(e,t,n){if(r.state.menuOpened){var o,i=r.state.value,a=r.props,c=a.items,s=a.groups,l=a.getText,u=a.onSelect,d=a.onClose,p=a.onEnterInput;t=t||r.state.selectedIndex,e&&(r.openAvailable=!1,-1===t?p():(c?o=c[t]:s[n||r.state.selectedGroupKey]&&(o=s[n||r.state.selectedGroupKey][t]),o&&u(i=l(o),o))),r.menu&&r.menu.popover.close(),r.setState({value:i,menuOpened:!1,selectedIndex:r.getDefaultSelectIndex()},function(){"function"==typeof d&&d()})}}),(0,d._)((0,s._)(r),"handleChange",function(e){var t=e.target.value,n=r.props,o=n.onChange,i=n.inputProps.onChange;r.openAvailable=!0,r.setState({value:t}),i&&i(t),o(t)}),(0,d._)((0,s._)(r),"handleFocus",function(e){var t=r.props.onFocus;r.openAvailable=!0,r.handleOpen(),t&&t(e)}),(0,d._)((0,s._)(r),"handleBlur",function(e){var t=r.props.onBlur;r.openAvailable=!1,r.handleClose(),"function"==typeof t&&t(e)}),(0,d._)((0,s._)(r),"handleKeyDown",function(e){var t=e.keyCode;13!==t||r.isCompositing||(r.isAbleEnterToSearch=!0),(38===t||40===t)&&e.preventDefault();var n=r.props.inputProps;n&&n.onKeyDown&&n.onKeyDown(e)}),(0,d._)((0,s._)(r),"handleKeyUp",function(e){var t=r.props,n=t.items,o=t.groups,i=t.onEnterInput,a=e.keyCode;if(!r.isAbleEnterToSearch&&13===a){r.isAbleEnterToSearch=!0;return}if(13===a||27===a){if(r.state.menuOpened)r.openAvailable=!1,r.handleClose(13===a);else if(13===a){i();return}}else 38===a?n?r.setState(function(e){var t=e.selectedIndex;return{selectedIndex:t<=0?n.length-1:t-1}}):r.groupKeyArray&&r.groupKeyArray.length&&r.setState(function(e){var t=e.selectedIndex,n=e.selectedGroupKey,i=t-1,a=n;if(i<0){var c=r.groupKeyArray.indexOf(n),s=0===c?r.groupKeyArray.length-1:c-1;i=o[a=r.groupKeyArray[s]].length-1}return{selectedIndex:i,selectedGroupKey:a}}):40===a&&(n?r.setState(function(e){var t=e.selectedIndex;return{selectedIndex:t===n.length-1?0:t+1}}):r.groupKeyArray&&r.groupKeyArray.length&&r.setState(function(e){var t=e.selectedIndex,n=e.selectedGroupKey,i=t+1,a=n;if(i===o[n].length){var c=r.groupKeyArray.indexOf(n),s=c===r.groupKeyArray.length-1?0:c+1;a=r.groupKeyArray[s],i=0}return{selectedIndex:i,selectedGroupKey:a}}))}),(0,d._)((0,s._)(r),"handleCompositionStart",function(){r.isCompositing=!0,r.isAbleEnterToSearch=!1}),(0,d._)((0,s._)(r),"handleCompositionEnd",function(){r.isCompositing=!1});var r,o=r.props,i=o.value,a=o.items,c=o.groups;return r.state={id:null,value:i,selectedIndex:r.getDefaultSelectIndex(),selectedGroupKey:null,menuOpened:!1},r.openAvailable=!1,r.isCompositing=!1,r.isAbleEnterToSearch=!0,r.previous={items:a,groups:c},r}return(0,u._)(n,[{key:"componentDidMount",value:function(){this.setState({id:g()("AutoComplete")}),this.checkMenuStatus()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props.value,n=e.value,r=e.items,o=e.groups;t!==n&&this.setState({value:n}),o&&(this.groupKeyArray=Object.keys(o).filter(function(e){return o[e].length>0}),this.groupKeyArray.length&&this.setState({selectedIndex:this.getDefaultSelectIndex(),selectedGroupKey:this.groupKeyArray[0]})),this.isEmpty(e)||(this.previous={items:r,groups:o})}},{key:"componentDidUpdate",value:function(){this.checkMenuStatus()}},{key:"getDefaultSelectIndex",value:function(){return this.props.autoSelect?0:-1}},{key:"checkMenuStatus",value:function(){var e=this.state.menuOpened,t=this.isEmpty();t||e||!this.openAvailable?t&&e&&this.handleClose():this.handleOpen()}},{key:"isEmpty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=e.items,n=e.groups,r=e.isItemDisabled,o="function"==typeof r&&t?t.filter(function(e){return!r(e)}):t;return(!o||0===o.length)&&(!n||!Object.values(n).some(function(e){return e.length>0}))}},{key:"renderItems",value:function(e){var t=this,n=this.props,o=n.renderItem,i=n.isItemDisabled,a=this.state,c=a.id,s=a.selectedIndex;return e.map(function(e,n){return(0,r.tZ)(E.sN,{id:"".concat(c,"-").concat(n),tag:"div",disabled:i(e),hovered:n===s,onMouseEnter:function(){t.setState({selectedIndex:n})},onClick:function(){return t.handleClose(!0,n)},onMouseDown:function(e){return e.preventDefault()},role:"option",children:o(e)},n)})}},{key:"renderGroupItems",value:function(e,t){var n=this,o=this.props,i=o.renderItem,a=o.isItemDisabled,c=this.state,s=c.id,l=c.selectedIndex,u=c.selectedGroupKey;return e.map(function(e,o){return(0,r.tZ)(E.sN,{id:"".concat(s,"-").concat(t,"-").concat(o),tag:"div",disabled:a(e),hovered:o===l&&t===u,onMouseEnter:function(){n.setState({selectedIndex:o,selectedGroupKey:t})},onClick:function(){return n.handleClose(!0,o,t)},onMouseDown:function(e){return e.preventDefault()},role:"option",children:i(e)},o)})}},{key:"renderGroups",value:function(){var e=this,t=this.props,n=t.labels,o=t.groups,i=t.renderLabel;return Object.keys(o).filter(function(e){return o[e].length>0}).map(function(t,a){return(0,r.BX)("div",{className:"AutoComplete-group",children:[n[t]&&i("".concat(n[t])),e.renderGroupItems(o[t],t)]},a)})}},{key:"renderInner",value:function(){var e=this.props,t=e.items,n=e.groups,o=this.isEmpty(),i=o?this.previous.items:t,a=o?this.previous.groups:n;return(0,r.BX)(r.HY,{children:[i&&this.renderItems(i),a&&this.renderGroups(a)]})}},{key:"renderInfiLoading",value:function(){var e=this.props.infiLoaderProps;return(0,r.tZ)(m.ZP,(0,f._)((0,h._)({},e),{children:this.renderInner()}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.inputProps,o=t.menuProps,a=t.infiLoaderProps,c=t.className,s=t.onRef,l=t.autoFocus,u=this.state,d=u.id,p=u.value,_=u.selectedIndex,m=u.selectedGroupKey,v=(0,r.tZ)(C.Z,(0,f._)((0,h._)({},n),{value:p,onRef:function(t){e.inputNode=t,s&&s(t)},onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onChange:this.handleChange,onFocus:this.handleFocus,onBlur:this.handleBlur,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,autoComplete:"off",autoFocus:l,role:"combobox","aria-expanded":!1,"aria-autocomplete":"list","aria-activedescendant":"".concat(d).concat(m?"-".concat(m):"","-").concat(_)}));return(0,r.tZ)("div",{className:c,children:(0,r.tZ)(E.ZP,(0,f._)((0,h._)({},o),{menuClassName:i()("AutoComplete-menu",o.menuClassName),menuContainerClassName:o.menuContainerClassName,preventCloseOnTarget:void 0===o.preventCloseOnTarget||o.preventCloseOnTarget,toggler:v,placement:"bottom-left",arrowed:!1,ref:function(t){e.menu=t},toggleEvent:"keyup",ariaProps:{role:"listbox"},noLayer:!0,children:a?this.renderInfiLoading():this.renderInner()}))})}}]),n}(T.Component);S.defaultProps={renderItem:function(e){return(0,r.tZ)(y,(0,h._)({},e))},renderLabel:function(e){return(0,r.tZ)("span",{children:e})},getText:function(e){return e.name},value:"",autoFocus:!1,autoSelect:!0,onEnterInput:function(){},isItemDisabled:function(){return!1},inputProps:{},menuProps:{},onChange:function(){},onSelect:function(){}},S.propTypes={autoFocus:c().bool,autoSelect:c().bool,onRef:c().func,items:c().array,labels:c().object,groups:c().object,onChange:c().func,onSelect:c().func,onOpen:c().func,onClose:c().func,onFocus:c().func,onBlur:c().func,onEnterInput:c().func,inputProps:c().object,menuProps:c().object,isItemDisabled:c().func,renderItem:c().func,renderLabel:c().func,getText:c().func,value:c().string};var I=S},27258:function(e,t,n){"use strict";n.d(t,{Z:function(){return T}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),l=n(85879),u=n(14168),d=n.n(u),p=n(87363),h=n(19076),f=n(38889),_=n(66263),m=n(15408),v=function(e){var t=e.children,n=e.showPrivacyPage,r=e.authWrapperClassName,o=e.authChild,i=p.Children.only(t),a=o?p.Children.only(o):i;return n?(0,l.tZ)(m.Z,{wrapperClassName:r,loginButton:a}):i},g=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),(e=t.call(this)).state={expanded:!1},e.onExpand=e.handleExpand.bind((0,r._)(e)),e}return(0,i._)(n,[{key:"handleExpand",value:function(){this.setState({expanded:!0})}},{key:"render",value:function(){var e=this.props,t=e.topics,n=e.user,r=e.ellipsisLength,o=e.expandable,i=e.privacyEnabled,a=e.showPrivacyPage,c=this.state.expanded,s="等 ".concat(t.length," 个"),u=t;return(c||(u=t.slice(0,r)),0===t.length)?null:(0,l.BX)("span",{children:[u.map(function(e,t){return(0,l.BX)("span",{children:[(0,l.tZ)(v,{showPrivacyPage:i&&a,authWrapperClassName:"ProfileMainPrivacy-authWrapper",authChild:(0,l.tZ)("span",{className:"ProfileMainPrivacy-pointerWrapper",children:e.name}),children:(0,l.tZ)(h.Link,{to:"".concat(_.rX,"/").concat(n.isOrg?"org":"people","/").concat(n.urlToken,"/creations/").concat(e.id),children:e.name})}),t<u.length-1?"、":" "]},t)}),!c&&t.length>r&&(o?(0,l.tZ)(f.ZP,{preset:"plain",onClick:this.onExpand,children:s}):s),"话题"]})}}]),n}(p.Component);(0,a._)(g,"propTypes",{topics:d().array.isRequired,user:d().object,ellipsisLength:d().number,expandable:d().bool,noHoverCard:d().bool,privacyEnabled:d().bool,showPrivacyPage:d().bool}),(0,a._)(g,"defaultProps",{ellipsisLength:3,expandable:!0,noHoverCard:!1});var T=g},7453:function(e,t,n){"use strict";n.d(t,{Z:function(){return T}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),l=n(85879),u=n(87363),d=n(93206),p=n(36695),h=n(11017),f=n(42559),_=n.n(f),m=n(25834),v=n(58857),g=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{urls:null,logged:!1}),(0,a._)((0,r._)(e),"handleObserve",function(t){t&&e.log()}),(0,a._)((0,r._)(e),"log",function(){e.state.logged||Promise.resolve(e.state.urls||e.load().then(function(t){return t?(t=e.normalize(t),e.setState({urls:t}),t):[]})).then(function(e){return e.forEach(function(e){return e&&(0,m.WY)(e)})}).then(function(){return e.setState({logged:!0})})}),(0,a._)((0,r._)(e),"load",function(){var t=e.props,n=t.type,r=t.id;return(0,t.loadBrandEntityTrackUrl)({type:n,id:r}).then(function(e){return e&&e.payload&&e.payload.data})}),(0,a._)((0,r._)(e),"normalize",function(t){var n=_()(),r=e.props,o=r.ua,i=r.id,a=r.type,c=encodeURIComponent("其他");o.Android?c="android":o.iOS&&(c="ios");var s={os:c,id:i,sessionId:n,type:a};return t.map(function(e){var t,n,r,o;return t=s.os,n=s.id,r=s.sessionId,o=s.type,e.replace("__OS__",t).replace("__REQUESTID__",r).replace("__SESSIONID__",r).replace("__ATOKEN__",n).replace("__AID__",n).replace("__PAGETYPE__",o)})}),e}return(0,i._)(n,[{key:"render",value:function(){return!this.state.logged&&(0,l.tZ)(h.Z,{rootMargin:"0px 0px 0px 0px",onChange:this.handleObserve})}}]),n}(u.Component),T=(0,d.compose)((0,p.connect)(function(e){return{ua:e.env.userAgent}},{loadBrandEntityTrackUrl:v.c1}))(g)},38889:function(e,t,n){"use strict";n.d(t,{rp:function(){return a},EE:function(){return i},ZP:function(){return E}});var r,o,i,a,c,s=n(87320),l=n(55164),u=n(57477),d=n(71728),p=n(85879),h=n(65733),f=n(17103),_=n(67814),m=n.n(_),v=n(87363),g=n.n(v),T={Button:"FEfUrdfMIKpQDJDqkjte",grey:"ZdfrHW7Ef5ZjwFiiBJuS",blue:"JmYzaky7MEPMFcJDLNMG",green:"_uLbatyxkRXPgimqvo45",red:"izzcAj8OQYu6ydgaw42c",primary:"epMJl0lFQuYbC7jrwr_o",secondary:"E211w_M7Hzs0GMB7BEyA",plain:"fEPKGkUK5jyc4fUuT0QP",link:"yXNqP8Bkgas9d_XumHbv",spread:"GMKy5J1UWc7y8NF_V8YA",withIcon:"B46v1Ak6Gj5sL2JTS4PY",iconOnly:"hIwDV_tcL6XN1HprrnAq",withLabel:"RuuQ6TOh2cRzJr6WlyQp",icon:"t2ntD6J1DemdOdvh5FB4"};(r=i||(i={})).Primary="primary",r.Secondary="secondary",r.Outline="outline",r.Plain="plain",r.Link="link",(o=a||(a={})).Grey="grey",o.Blue="blue",o.Green="green",o.Red="red",(c||(c={})).Spread="spread";var E=g().forwardRef(function(e,t){var n,r=e.children,o=e.className,a=e.color,c=e.icon,_=e.label,v=e.size,g=e.onRef,E=e.onClick,C=e.preset,y=void 0===C?i.Outline:C,S=e.component,I=void 0===S?"button":S,b=e.type,A=e.disabled,Z=(0,d._)(e,["children","className","color","icon","label","size","onRef","onClick","preset","component","type","disabled"]),w=(0,h.Z)(function(e){e.currentTarget.disabled||A||!E||E(e)}),R=m()("Button",o,T.Button,(n={},(0,s._)(n,"Button--".concat(y),!!y&&y!==i.Outline),(0,s._)(n,"Button--".concat(a),!!a&&y!==i.Link),(0,s._)(n,"Button--".concat(v),!!v),(0,s._)(n,"Button--withIcon",!!c),(0,s._)(n,"Button--withLabel",!!_),(0,s._)(n,"Button--iconOnly",c&&!_),(0,s._)(n,T["".concat(y)],!!y&&y!==i.Outline),(0,s._)(n,T["".concat(a)],!!a&&y!==i.Link),(0,s._)(n,T["".concat(v)],!!v),(0,s._)(n,T.withIcon,!!c),(0,s._)(n,T.withLabel,!!_),(0,s._)(n,T.iconOnly,c&&!_),n));return(0,p.BX)(I,(0,u._)((0,l._)({},Z),{type:void 0===b?"button":b,disabled:A,ref:(0,f.Z)(t,g),className:R,onClick:w,children:[c&&(0,p.tZ)(c,{center:!0,text:!!_||y===i.Plain||y===i.Link,className:m()("Button-zi",T.icon)}),_,r]}))})},66223:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(85879);function o(e){var t=e.tag;return(0,r.tZ)("div",{css:{flex:1,display:"flex",justifyContent:"flex-end"},children:(0,r.tZ)("span",{css:function(e){return{display:"inline-block",boxSizing:"border-box",fontSize:11,lineHeight:"10px",border:"1px solid ".concat(e.colors.GBK09A),borderRadius:4,padding:"3px 4px",color:e.colors.GBK07A}},children:t})})}},8858:function(e,t){"use strict";t.Z=function(e,t){if(!e||!(t=t||e.type))return!1;if("answer"===t||"post"===t||"article"===t){var n,r;return null===(n=e.settings)||void 0===n?void 0:null===(r=n.tableOfContents)||void 0===r?void 0:r.enabled}return!1}},60683:function(e,t,n){"use strict";n.d(t,{AX:function(){return a},Gs:function(){return o},HG:function(){return i},WG:function(){return d},X:function(){return l},YX:function(){return c},g1:function(){return u},wF:function(){return s}});var r=n(94009),o={success:"success",failure:"failure",loading:"loading"},i={0:"text",1:"image",2:"sticker",5:"csevaluationcard",6:"ecomcard",7:"plugin"},a={GUESS_YOU_WANT_ASK:"GUESS_YOU_WANT_ASK"},c=Object.entries(i).reduce(function(e,t){var n=(0,r._)(t,2),o=n[0];return e[n[1]]=Number(o),e},{}),s={text:"text",image:"image",sticker:"sticker",ecomcard:"ecomcard",plugin:"plugin",csevaluationcard:"csevaluationcard",title:"title"},l=3e5,u=320,d=20},84344:function(e,t,n){"use strict";var r=n(87363),o=n(14168),i=n.n(o),a=n(36695),c=n(31252);function s(e){var t=e.content,n=e.type,o=e.urlToken,i=(0,a.useDispatch)(),s=(0,r.useCallback)(function(){i((0,c.Ll)({content:t,type:n,urlToken:o}))},[i,t,n,o]),l=(0,a.useSelector)(function(e){return(0,c.G_)(e,{type:n,urlToken:o})});return(0,r.useEffect)(function(){l||s()},[l,s]),null}s.propTypes={content:i().string.isRequired,type:i().oneOf(["answer","article"]).isRequired,urlToken:i().string.isRequired},t.Z=s},50436:function(e,t,n){"use strict";function r(e){var t,n,r,o;return!!(null==e?void 0:null===(t=e.coCreation)||void 0===t?void 0:null===(n=t.refTo)||void 0===n?void 0:null===(r=n.contents)||void 0===r?void 0:null===(o=r[0])||void 0===o?void 0:o.type)}function o(e){var t,n,o,i;return!r(e)&&!!(null==e?void 0:null===(t=e.reference)||void 0===t?void 0:null===(n=t.refTo)||void 0===n?void 0:null===(o=n.contents)||void 0===o?void 0:null===(i=o[0])||void 0===i?void 0:i.type)}function i(e){var t,n,r,o=null==e?void 0:null===(t=e.coCreation)||void 0===t?void 0:null===(n=t.refTo)||void 0===n?void 0:null===(r=n.contents)||void 0===r?void 0:r[0];return o?"answer"===o.type?o.answer:"article"===o.type?o.article:null:null}function a(e){var t,n,r,o=null==e?void 0:null===(t=e.reference)||void 0===t?void 0:null===(n=t.refTo)||void 0===n?void 0:null===(r=n.contents)||void 0===r?void 0:r[0];return o?"answer"===o.type?o.answer:"article"===o.type?o.article:null:null}function c(e,t){var n=t.contentAuthor;return n&&e.id!==(null==n?void 0:n.id)?n:e}function s(e){var t,n;return r(e)&&null!==(n=null===(t=i(e))||void 0===t?void 0:t.author)&&void 0!==n?n:null}n.d(t,{AQ:function(){return c},Ey:function(){return i},Gz:function(){return o},HE:function(){return r},YJ:function(){return s},y5:function(){return a}})},61255:function(e,t,n){"use strict";n.d(t,{ZY:function(){return j},xJ:function(){return u},j7:function(){return F},_N:function(){return L},HE:function(){return r.HE},Gz:function(){return r.Gz},SF:function(){return q}});var r=n(50436),o=n(55164),i=n(57477),a=n(85879),c=n(87641),s=n(24405),l=n(23579),u=function(e){var t=(0,s.F)();return(0,a.tZ)(c.Flex,(0,i._)((0,o._)({width:"58px",height:"20px",bg:(0,l.a)(t.colors.GYL01A).alpha(.08),color:t.colors.GYL01A,alignItems:"center",justifyContent:"center",css:{fontWeight:"normal",fontSize:12,borderRadius:4,overflow:"hidden"}},e),{children:"联合创作"}))},d=n(99878),p=n(43384),h=n(65733),f=n(87363),_=n.n(f),m=n(66980),v=Object.assign,g=function(e){return _().createElement(m.Z,v({width:"20",height:"20",fill:"none",viewBox:"0 0 20 20"},e),_().createElement("path",{fill:"url(#id-1711650925-a)",fillRule:"evenodd",d:"M2.8 2a.8.8 0 0 0-.8.8v11.4a.8.8 0 0 0 .8.8h11.4a.8.8 0 0 0 .8-.8V2.8a.8.8 0 0 0-.8-.8H2.8Zm1.051 1.25a.6.6 0 0 0-.6.6v9.3a.6.6 0 0 0 .6.6h9.3a.6.6 0 0 0 .6-.6v-9.3a.6.6 0 0 0-.6-.6h-9.3Z",clipRule:"evenodd"}),_().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M2.8 2a.8.8 0 0 0-.8.8v11.4a.8.8 0 0 0 .8.8h11.4a.8.8 0 0 0 .8-.8V2.8a.8.8 0 0 0-.8-.8H2.8Zm1.051 1.25a.6.6 0 0 0-.6.6v9.3a.6.6 0 0 0 .6.6h9.3a.6.6 0 0 0 .6-.6v-9.3a.6.6 0 0 0-.6-.6h-9.3Z",clipRule:"evenodd"}),_().createElement("rect",{width:"13",height:"13",x:"4.5",y:"4.5",fill:"url(#id-1711650925-b)",rx:".8"}),_().createElement("rect",{width:"13",height:"13",x:"4.5",y:"4.5",fill:"#06F",rx:".8"}),_().createElement("path",{fill:"#fff",stroke:"#fff",d:"M8.962 11.153h.725V13.5H8.3v-2.754c0-.66.293-1.181.7-1.567.064-.06.129-.116.196-.168a2.654 2.654 0 0 0-.205.227c-.295.369-.53.864-.53 1.415v.5h.5ZM12.974 11.153h.726V13.5h-1.387v-2.754c0-.66.293-1.181.7-1.567.063-.06.129-.116.195-.168a2.657 2.657 0 0 0-.204.227c-.295.369-.53.864-.53 1.415v.5h.5Z"}),_().createElement("defs",null,_().createElement("linearGradient",{id:"id-1711650925-a",x1:"15",x2:"2",y1:"2",y2:"15",gradientUnits:"userSpaceOnUse"},_().createElement("stop",{stopColor:"#06F"}),_().createElement("stop",{offset:"1",stopColor:"#00D1FF"})),_().createElement("linearGradient",{id:"id-1711650925-b",x1:"17.5",x2:"4.5",y1:"4.5",y2:"17.5",gradientUnits:"userSpaceOnUse"},_().createElement("stop",{stopColor:"#06F"}),_().createElement("stop",{offset:"1",stopColor:"#00D1FF"}))))},T=n(66263);function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,n=e.title,r=e.question,o=(void 0===r?{}:r).title,i=e.url,s=e.id,l=(0,h.Z)(function(){window.open(i)});return(0,a.tZ)(p.eV,{content:{type:T.LA[t],token:String(s)},children:(0,a.BX)(p.$U,{shouldTrackShow:!0,zaText:"zvideo_origin_content",zaType:"Card",zaAction:"OpenUrl",extra:{link:{url:i}},as:c.Flex,bg:"GBK10A",padding:"12px 10px 12px 18px",justifyContent:"space-between",onClick:l,css:{cursor:"pointer"},children:[(0,a.BX)(c.Flex,{children:[(0,a.tZ)(g,{css:{marginRight:"6.5px"}}),(0,a.tZ)(c.Text,{color:"GBK06A",fontSize:"14px",lineHeight:"19.6px",children:"answer"===t?"原回答：".concat(o):"原文章：".concat(n)})]}),(0,a.tZ)(d.N,{size:20,css:function(e){return{flexShrink:"0",fill:e.colors.GBK06A}}})]})})}var C=n(94009),y=n(55698),S=n(82452),I=n(80565),b=n(24187),A=n(36695),Z=n(31467),w=n(30722),R=n(80714),N=n(28814),k=n(41492),O=n(46829),x=function(e){var t=e.author,n=t.author,r=t.identity,o=t.id,i=(0,A.useSelector)(function(e){return(0,N.np)(e,{urlToken:n})}),s=i||{},l=s.avatarUrl,u=s.isFollowing,d=s.name,h=(0,f.useRef)(),_=(0,f.useCallback)(function(){return window.open("https://www.zhihu.com/people/".concat(n))},[n]),m=(0,f.useCallback)(function(){return h.current.trackEvent({eventType:"Click",elementLocation:{type:"Button",text:u?"取消关注":"关注"},action:u?"UnFollow":"Follow"}),!0},[u]);return i?(0,a.BX)(p.eV,{content:{type:"User",token:n,id:o},children:[(0,a.tZ)(p.pS,{ref:h}),(0,a.BX)(c.Flex,{mt:"16px",css:{"& + &":{marginTop:"24px"}},alignItems:"center",children:[(0,a.tZ)(y.qE,{url:l,size:38,css:{cursor:"pointer"},onClick:_}),(0,a.BX)(c.Box,{ml:"14px",flex:"1",children:[(0,a.tZ)(c.Box,{color:"GBK03A",fontSize:"15px",lineHeight:"17px",fontWeight:"bold",onClick:_,css:[(0,I.S)(1),{cursor:"pointer"}],children:d}),(0,a.tZ)(c.Box,{color:"GBK04A",fontSize:"14px",lineHeight:"16px",mt:"3px",children:r})]}),(0,a.tZ)(O.Z,{useCustomZa:!0,preset:"primary",type:"people",id:n,isFollowing:u,onClick:m,css:{padding:"0 14px",minWidth:"0px"}})]})]}):null},P=function(e){var t,n,r,o,i,s=e.item,l=e.index;if("ANSWER"===s.type)r="Answer",o=(i=s.answer).question.title;else{if("ARTICLE"!==s.type)return null;r="Post",o=(i=s.article).title}var u=i.id,d=i.thumbnailInfo,h=i.url,f=i.voteupCount,_=i.commentCount,m=null==d?void 0:null===(t=d.thumbnails)||void 0===t?void 0:null===(n=t[0])||void 0===n?void 0:n.url,v="".concat((0,w.Zh)(f),"赞同 \xb7 ").concat((0,w.Zh)(_),"评论");return(0,a.tZ)(p.eV,{content:{type:r,id:String(u)},children:(0,a.BX)(p.$U,{as:"a",view:{elementLocation:{card:{index:l}}},zaType:"Card",zaAction:"OpenUrl",zaText:"视频引用的原文",extra:{link:{url:h}},href:h,target:"_blank",css:function(e){return{marginTop:"16px",display:"flex",alignItems:"center",height:"84px",borderRadius:"8px",padding:"0 12px",backgroundColor:e.colors.GBK10A}},children:[m&&(0,a.tZ)(c.Image,{src:m,width:"60px",height:"60px",mr:"12px",css:{borderRadius:"6px"}}),(0,a.BX)(c.Box,{flex:"1",children:[(0,a.tZ)(c.Box,{fontWeight:"bold",fontSize:"15px",css:(0,I.S)(1),children:o}),(0,a.tZ)(c.Box,{color:"GBK06A",fontSize:"13px",children:v})]})]})})},D=function(e){var t,n,r=e.id,o=e.subAuthor,i=e.before,s=e.after,l=e.content,u=l||{},h=u.type,_=u.id,m=T.LA[h],v=(0,A.useDispatch)(),E=(0,A.useSelector)(function(e){return e.zvideos.creationReferences[r]}),w=(0,C._)((0,f.useState)(!1),2),N=w[0],O=w[1],D=(0,f.useCallback)(function(){R.Z.isMobileEntry?(0,S.rH)("zhihu://zvideo/".concat(r)):(O(!0),v((0,k.jl)(r)))},[v,r]);return o?(0,a.BX)(a.HY,{children:[(0,a.tZ)(p.eV,{block:"CreationReferencesBar",content:l?{type:m,token:String(_)}:{},children:(0,a.BX)(p.Wi,{zaText:!0,shouldTrackClick:!0,zaType:"Card",as:c.Flex,onClick:D,justifyContent:"space-between",alignItems:"center",pl:"16px",pr:"10px",py:"12px",color:"GBK06A",bg:"GBK10A",fontSize:"14px",lineHeight:"20px",css:{whiteSpace:"pre-wrap",cursor:"pointer"},children:[(0,a.BX)(c.Flex,{children:[(0,a.tZ)(g,{css:{marginRight:"6.5px"}}),(0,a.tZ)(c.Box,{flexShrink:"0",children:i}),(0,a.BX)(c.Flex,{alignItems:"center",mx:"6px",children:[(0,a.tZ)(y.qE,{url:o.avatarUrl,round:!0,size:18,css:function(e){return{border:"1px solid ".concat(e.colors.GBK99A)}}}),(0,a.tZ)(c.Box,{flex:"1",ml:"6px",css:(0,I.S)(1),children:o.name})]}),(0,a.tZ)(c.Box,{flexShrink:"0",children:s})]}),(0,a.tZ)(d.N,{size:20,css:{flexShrink:"0"}})]})}),!R.Z.isMobileEntry&&(0,a.tZ)(Z.Z,{onClose:function(){return O(!1)},title:"引用详情",children:N&&(E?(0,a.BX)(p.eV,{block:"CreationReferencesModal",children:[(0,a.tZ)(c.Box,{fontSize:"15px",fontWeight:"bold",children:"作者"}),null===(t=E.authors)||void 0===t?void 0:t.map(function(e){return(0,a.tZ)(x,{author:e},e.author)}),(0,a.tZ)(c.Box,{my:"24px",css:function(e){return{borderTop:"1px solid ".concat(e.colors.GBK10A)}}}),(0,a.tZ)(c.Box,{fontSize:"15px",fontWeight:"bold",children:"视频引用的原文"}),null===(n=E.originalContent)||void 0===n?void 0:n.map(function(e,t){return(0,a.tZ)(P,{item:e,index:t},t)})]}):(0,a.BX)(a.HY,{children:[(0,a.tZ)(b.O,{variant:"P01"}),(0,a.tZ)(b.O,{variant:"T02"})]}))})]}):null},L=function(e){var t=e.id,n=e.creationRelationship;if(!n)return null;if((0,r.HE)(n)){var i,c=(0,r.Ey)(n);return(null!==(i=null==c?void 0:c.author)&&void 0!==i?i:null)&&(0,a.tZ)(E,(0,o._)({},c))}if(!(0,r.Gz)(n))return null;var s,l=(0,r.y5)(n),u=null!==(s=null==l?void 0:l.author)&&void 0!==s?s:null,d=(null==l?void 0:l.type)==="answer"?"回答":"文章";return u&&(0,a.tZ)(D,{id:t,subAuthor:u,before:"本视频引用",after:"的".concat(d,"进行创作"),content:l})},B=n(29229),U=n(70400),M=function(e){var t=e.zvideo,n=t.id,r=t.imageUrl,o=t.author,i=t.video,a=t.playCount,c=t.voteupCount,s=e.stats,l=s.memberCount,u=s.count;return{zvideoId:n,thumbnail:r,duration:i.duration,avatarUrl:o.avatarUrl,userName:o.name,memberCount:l,videoCount:u,playCount:a,voteupCount:c}};function G(e){var t=e.coCreationRefBy,r=e.referenceRefBy,o=e.type,i=!!t,c=!i&&!!r,s=(0,B.Z)(function(){return n.e(7970).then(n.bind(n,34178))});if(i){if(!s)return(0,a.tZ)("div",{css:{height:82}});var l=M(t),u=l.zvideoId,d=l.thumbnail,p=l.duration,h=l.avatarUrl,f=l.userName,_=l.memberCount,m=l.videoCount,v=l.playCount,g=l.voteupCount;return(0,a.tZ)(s.CoCreationCard,{zaContentId:u,thumbnail:d,duration:p,avatarUrl:h,userName:f,isMultiMember:_>1,videoCount:m,playCount:v,voteupCount:g,linkToNativePage:!1,linkUrl:"https://www.zhihu.com/zvideo/".concat(u),showSingleVideoUI:!0})}if(c){if(!s)return(0,a.tZ)("div",{css:{height:44}});var T=M(r),E=T.zvideoId,C=T.avatarUrl,y=T.userName,S=T.memberCount;return(0,a.tZ)(s.ReferenceCard,{type:o,zaContentId:E,avatarUrl:C,userName:y,isMultiMember:S>1,linkToNativePage:!1,linkUrl:"https://www.zhihu.com/zvideo/".concat(E),showSingleVideoUI:!0})}return null}function F(e){return(0,a.tZ)(U.SV,{replacement:null,children:(0,a.tZ)(G,(0,o._)({},e))})}var z=n(77683),H=function(e){var t,n=e.mainAuthor,r=e.subAuthor,s="plain"===(t=e.preset)||"special-plain"===t;return(0,a.BX)(c.Flex,{mt:"10px",children:[(0,a.tZ)(z.Z,(0,i._)((0,o._)({},s&&{preset:"plain"}),{author:n,coCreationAuthorDescriptionText:"视频作者",userLinkV2:!0,noBadge:!0,noVipBadge:!0,showVipIcon:!1,css:{marginRight:s?16:30}})),(0,a.tZ)(z.Z,(0,i._)((0,o._)({},s&&{preset:"plain"}),{author:r,coCreationAuthorDescriptionText:"图文作者",userLinkV2:!0,noBadge:!0,noVipBadge:!0,showVipIcon:!1}))]})};function q(e,t,n,o){var i=(0,r.AQ)(t,n),c=(0,r.YJ)(n);return o&&(0,a.tZ)(H,{preset:e,mainAuthor:i,subAuthor:c},"coCreateAuthors")}var V=n(9338),X=n(30971),W=n(57730),K=(0,n(39288).FH)("coCreation",["CANCEL"]);function j(e){var t,n=e.contentType,r=e.contentId,o=(0,A.useDispatch)(),i=(t=(0,V._)(function(){return(0,X.__generator)(this,function(e){switch(e.label){case 0:return[4,W.Z.confirm("",{title:"你确定要取消联合创作吗？",text:{ok:"同意"}})];case 1:return e.sent(),[4,o({API:{types:K.CANCEL,endpoint:"creation-relationship/cancel",method:"PUT",body:{content_type:n,content_id:String(r)}}})];case 2:return e.sent(),window.location.reload(),[2]}})}),function(){return t.apply(this,arguments)});return(0,a.tZ)(p.$U,{zaType:"Button",zaText:!0,zaBlock:"CancelCoCreation",onClick:i,children:"取消联合创作"})}},94382:function(e,t,n){"use strict";n.d(t,{Z:function(){return L}});var r=n(22107),o=n(94707),i=n(87320),a=n(86325),c=n(55164),s=n(57477),l=n(71728),u=n(85626),d=n(85879),p=n(55698),h=n(72111),f=n(67814),_=n.n(f),m=n(92769),v=n.n(m),g=n(14168),T=n.n(g),E=n(87363),C=n(36695),y=n(93206),S=n(7407),I=n(66263),b=n(20857),A=n(77236),Z=n(33773),w=n(69383),R=n(44169),N=n(91770),k=n(10886),O=n(31142),x=function(e){(0,a._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,r._)(this,n),e=t.apply(this,arguments),(0,i._)((0,b._)(e),"load",function(){var t=e.props,n=t.dispatch,r=t.id;n((0,k.ly)(r))}),(0,i._)((0,b._)(e),"track",function(){var t,n=e.props.column;e.hoverCardElement&&n&&(w.Z.setModule(e.hoverCardElement,{module:"ColumnItem"},{card:{content:{type:"Column",token:n.id,item_num:n.articlesCount,follower_num:n.followers,publish_timestamp:1e3*n.updated,author_member_hash_id:null===(t=n.author)||void 0===t?void 0:t.id}}}),w.Z.trackCardShow(e.hoverCardElement))}),(0,i._)((0,b._)(e),"handleOpen",function(){e.load(),e.track()}),e}return(0,o._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.toggler,r=t.column,o=t.id,i=t.isLoading,a=t.onRef,u=(0,l._)(t,["toggler","column","id","isLoading","onRef"]),p=r||{},h=p.title,f=p.intro,_=p.itemsCount,m=p.voteupCount,v=p.lastArticle,g=p.articlesCount,T=p.followers,E=v||{},C=E.title,y=E.created,S="".concat(I.i7,"/column/").concat(o);return(0,d.BX)(A.Z,(0,s._)((0,c._)({toggler:n,preventCloseOnTarget:!0,isLoading:i,onOpen:this.handleOpen,size:"large"},u),{ref:function(t){a&&"function"==typeof a&&a(t),e.hoverCardElement=t},children:[(0,d.tZ)(A.O,{title:(0,d.tZ)("a",{target:"_black",href:S,children:h})}),f,v&&(0,d.BX)("div",{children:[(0,d.tZ)(Z.x8,{text:!0,center:!0})," 最后更新",(0,d.tZ)("span",{className:"HoverCard-separate",children:" | "}),C,(0,d.BX)("span",{children:["（",(0,R.rL)(y),"）"]})]}),(0,d.tZ)("div",{children:(0,d.BX)(N.Z,{children:[(0,d.tZ)(N.Z.Item,{tag:O.Z,preset:"plain",a:!0,to:S,name:_>=0?"内容":"文章",value:null!=_?_:g}),(0,d.tZ)(N.Z.Item,{tag:O.Z,preset:"plain",a:!0,to:S,name:m>=0?"赞同":"关注",value:null!=m?m:T})]})})]}))}}]),n}(E.Component),P=(0,C.connect)(function(e,t){var n=t.id,r=e.entities.columns,o=e.loading.local;return{column:r[n],isLoading:!!o["column/".concat(n)]}})(x),D=function(e){(0,a._)(n,e);var t=(0,u._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"render",value:function(){var e,t=this.props,n=t.isMobile,r=t.column,o=r.title,i=r.imageUrl,a=r.id,u=t.avatar,f=t.avatarProps,m=t.noHoverCard,g=t.style,T=t.className,E=t.children,C=(0,l._)(t,["isMobile","column","avatar","avatarProps","noHoverCard","style","className","children"]);return(e=u?(0,d.tZ)(p.qE,(0,c._)({url:i,alt:o},f)):E||o,(void 0===m?n:m)||(e=(0,d.tZ)(P,{toggler:e,id:a})),n&&I.dd)?e:(0,d.tZ)(h._o,{zaAction:"OpenUrl",zaEventType:"Click",zaType:"Text",children:(0,d.tZ)("a",(0,s._)((0,c._)({style:g,className:_()("ColumnLink",T),href:"".concat(I.i7,"/column/").concat(a)},v()(C,["dispatch"])),{children:e}))})}}]),n}(E.Component);(0,i._)(D,"propTypes",{column:T().object.isRequired,avatar:T().bool,avatarProps:T().object,noHoverCard:T().bool,style:T().object,className:T().string,children:T().node}),(0,i._)(D,"defaultProps",{avatar:!1});var L=(0,y.compose)((0,C.connect)(function(e){return{isMobile:(0,S.Hu)(e,{includeTablet:!0})}}))(D)},95790:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(94009),c=n(85879),s=n(8586),l=n(65733),u=n(87363),d=n(39658),p=n(36695),h=n(87641),f=n(69383),_=n(31467),m=n(83213),v=n(38889),g=n(95377),T=n(93547),E=n(96955),C=n(10886),y=n(58909),S=function(e){var t=e.required,n=e.getErrorText,o=e.initialValue,s=e.isModal,l=(0,i._)(e,["required","getErrorText","initialValue","isModal"]),d=(0,a._)((0,u.useState)(null!=o?o:""),2),p=d[0],f=d[1],_=n(p),m=!!(!_&&(!t||p)),v=(0,u.useMemo)(function(){return(0,c.BX)(h.Flex,{mx:s?"0":"24px",flexDirection:"column",children:[(0,c.tZ)(g.Z,(0,r._)({css:{width:"100%"},value:p,onChange:function(e){return f(e.target.value)}},l)),(0,c.tZ)(h.Text,{mt:"8px",mb:"12px",minHeight:"22px",color:"GRD03A",fontSize:"15px",textAlign:"end",children:_})]})},[s,p,l,_]);return[p,m,v]},I=function(e){return function(t){var n=t.length-e;return n>0?"超出 ".concat(n," 个字"):(0,T.Vq)(t)?"不能包含 emoji":/^\s+$/.test(t)?"不能为纯空白字符":""}};t.ZP=function(e){var t=e.done,n=e.editing,i=e.columnId,g=e.isModal,T=void 0===g||g,b=e.disableRedirect,A=(0,p.useDispatch)(),Z=(0,E.Z)(),w=(0,p.useSelector)(function(e){return e.entities.columns[i]}),R=(0,p.useSelector)(y.ib).hasApplyingColumn,N=(0,a._)(S({name:"专栏名称",required:!0,getErrorText:I(20),placeholder:"请输入专栏名称",initialValue:null==w?void 0:w.title,isModal:T}),3),k=N[0],O=N[1],x=N[2],P=(0,a._)(S({name:"一句话介绍",required:!1,getErrorText:I(25),placeholder:"请输入一句话介绍",multiline:!0,rows:4,initialValue:null==w?void 0:w.intro,isModal:T}),3),D=P[0],L=P[1],B=P[2],U=(0,a._)((0,u.useState)(null==w?void 0:w.acceptSubmission),2),M=U[0],G=U[1],F=function(){f.Z.trackEvent(null,{id:8173,action:"Click"})},z=(0,l.Z)(function(e){e.preventDefault(),F(),A((0,m.Gw)(i,(0,o._)((0,r._)({},w),{intro:D,title:k,acceptSubmission:M}))).then(function(){Z.alert("修改成功！该改动将在一个工作日内审核后生效。").then(t)})});return((0,u.useEffect)(function(){A((0,y.sF)(["hasApplyingColumn"]))},[A]),(0,u.useEffect)(function(){R&&Z.alert("你的专栏创建申请正在受理中。同时只能申请一个专栏。",{title:"你有正在申请的专栏",ok:"知道了"}).then(function(){t&&t()})},[t,R,Z]),R)?null:(0,c.BX)("div",{children:[!T&&(0,c.tZ)(d.ql,{title:n?"修改专栏介绍":"新建专栏"}),(0,c.tZ)(h.Flex,{fontSize:"24px",justifyContent:"center",mt:"40px",mb:"32px",fontWeight:"bold",children:n?"修改专栏介绍":"新建专栏"}),x,B,n&&(0,c.BX)(h.Flex,{justifyContent:"space-between","align-items":"center",mt:"-4px",fontSize:15,color:"GBL05A",children:["接受他人自荐内容",(0,c.tZ)(s.Z,{checked:M,onChange:function(e){G(e.target.checked)}})]}),(0,c.BX)(_.w,{direction:"horizontal",css:{marginTop:n?32:48},children:[T&&(0,c.tZ)(v.ZP,{color:v.EE.Primary,onClick:function(){return t&&t()},children:"取消"}),(0,c.tZ)(v.ZP,{type:"submit",preset:v.rp.Blue,color:v.EE.Primary,disabled:!O||!L,onClick:n?z:function(e){e.preventDefault(),F(),A((0,C.PG)({title:k,intro:D})).then(function(e){var n=e.res;n.payload.manualCensor?Z.alert("已收到您的申请，知乎会在 3 个工作日内处理并通过私信反馈结果。",{title:"正在审核",ok:"完成"}).then(function(){t&&t()}):(b||(location.href="https://www.zhihu.com/column/".concat(n.payload.id)),t&&t())}).catch(function(e){Z.alert(e.payload.message,{title:"出错了",ok:"知道了"}).then(function(){t&&t()})})},children:n?"保存":"新建专栏"})]})]})}},35865:function(e,t,n){"use strict";var r=n(85879),o=n(74128),i=n(95790);t.Z=function(e){var t=e.onClose,n=e.shown,a=e.editing,c=e.columnId,s=e.disableRedirect;return(0,r.tZ)(o.Z,{onClose:t,size:"large",children:n&&(0,r.tZ)(i.ZP,{isModal:!0,editing:void 0!==a&&a,columnId:c,done:t,disableRedirect:s})})}},19495:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(15030),l=n(55164),u=n(85626),d=n(85879),p=n(73108),h=n(14168),f=n.n(h),_=n(87363),m=n(69383),v=n(43384),g=n(30722),T=n(38889),E=n(97727),C=n(80714),y=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"buttonRef",(0,_.createRef)()),(0,a._)((0,r._)(e),"handleClick",function(t){var n=e.props,r=n.zaInfos,o=r.toggleComment,i=r.getCommentAction,a=n.positionStatus,c=n.onClick,u=n.commentsShown;if(m.Z.trackEvent(e.buttonRef.current,(0,l._)({action:i?i(!u):"Comment",element:"Button",is_intent:!0},o&&{id:o})),c){var d="fixed"===a||C.Z.isMobileEntry?"fixed":"bottom",p={commentsShown:!e.props.commentsShown,commentsAutoFocus:!(0,s._)(t,KeyboardEvent),commentPattern:d};(0,s._)(t,KeyboardEvent)&&"bottom"===d&&e.buttonRef.current.focus(),c(t,p)}}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){this.props.onInstance(this)}},{key:"componentWillUnmount",value:function(){this.props.onInstance(null)}},{key:"render",value:function(){var e,t=this.props,n=t.className,r=t.count,o=t.commentsShown,i=t.commentClosed;if(o)e="收起评论";else{var a=r&&!i;e=C.Z.isMobileEntry?a?"评论 ".concat((0,g.Zh)(r).trim()):"评论":a?"".concat((0,g.uf)(r)," 条评论"):"添加评论"}return(0,d.BX)(_.Fragment,{children:[(0,d.tZ)(E.bY,{input:"c",action:this.handleClick}),(0,d.tZ)(v.$U,{as:T.ZP,zaAction:o?"Collapse":"Expand",zaText:o?"收起评论":"展开评论",zaBlock:o?"收起评论":"展开评论",zaModuleId:"comment_area_expand_collapse_button",zaType:"Button",onRef:this.buttonRef,preset:"plain",className:n,onClick:this.handleClick,icon:p.b,label:e})]})}}]),n}(_.Component);(0,a._)(y,"propTypes",{commentsShown:f().bool,count:f().number,zaInfos:f().shape({id:f().number,getCommentAction:f().func}),onInstance:f().func}),(0,a._)(y,"defaultProps",{zaInfos:{},onInstance:function(){return null}}),t.Z=y},11797:function(e,t,n){"use strict";var r=n(55164),o=n(85879),i=n(29229);t.Z=function(e){var t=(0,i.Z)(function(){return n.e(6815).then(n.bind(n,27679)).then(function(e){return e.default})});return t?(0,o.tZ)(t,(0,r._)({},e)):null}},99830:function(e,t,n){"use strict";n.d(t,{Z:function(){return S}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),l=n(85879),u=n(14168),d=n.n(u),p=n(87363),h=n(36695),f=n(43384),_=new Set(["clickCommentInput","toggleLike"]),m=n(258),v=n(7407),g=n(55164),T=n(29229),E=function(e,t){var n=(0,p.useRef)(!!e);return n.current!==t&&!!e===t&&(n.current=!!e),n.current},C=function(e){var t=E(e.shown,!0),r=(0,T.Z)(function(){return Promise.all([n.e(6248),n.e(5680),n.e(213)]).then(n.bind(n,87075))},t);return r?(0,l.tZ)(r,(0,g._)({},e)):null},y=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"zaRef",(0,p.createRef)()),(0,a._)((0,r._)(e),"handlePackup",function(){var t=e.props,n=t.onClose,r=t.commentPattern;n&&n(),"bottom"===r&&window.scrollTo(0,e.originPageYOffset)}),(0,a._)((0,r._)(e),"openInApp",function(t){var n=e.props.skipOia;null!=n&&n(t)||(0,m.Z)({trackEvent:e.zaRef.current.trackEvent,zaV3Text:"评论弹层",noEnteringSignin:!!e.props.currentUser,from:t})}),e}return(0,i._)(n,[{key:"componentDidUpdate",value:function(e){"bottom"===this.props.commentPattern&&this.props.shown&&!e.shown&&(this.originPageYOffset=window.pageYOffset)}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.shown,r=e.showPackupButton,o=e.parent,i=e.isSelf,a=e.commentPattern,c=e.byComment,s=e.targetLink,u=e.commentPlugin,d=e.onComment,p=e.onMount,h=o.id,_=o.type,m=o.author;return(0,l.BX)(l.HY,{children:[(0,l.tZ)(f.pS,{ref:this.zaRef}),(0,l.tZ)(C,{shown:n,className:t,resourceId:String(h),resourceType:_,isSelf:i,author:m,commentPattern:a,hideFoldButton:!r,hideBottomEditorShadow:!r,byComment:c,targetLink:s,commentPlugin:u,onMount:p,onClose:this.handlePackup,onComment:d,openInApp:this.openInApp})]})}}]),n}(p.Component);(0,a._)(y,"propTypes",{className:d().string,containerClassName:d().string,byComment:d().oneOfType([d().number,d().string]),parent:d().object,shown:d().bool,showPackupButton:d().bool,commentPattern:d().string,commentInputPosition:d().oneOf(["top","bottom"]),onClose:d().func,needLoadCommentPermission:d().bool,onOrderChange:d().func,onItemLike:d().func,onPaginationClick:d().func,autoFocus:d().bool,onMount:d().func,zaInfo:d().object}),(0,a._)(y,"defaultProps",{commentPattern:"fixed",showPackupButton:!0,commentInputPosition:"bottom"});var S=(0,h.connect)(function(e){var t=(0,v.cM)(e);return{skipOia:function(e){return t.oppoSearch&&!_.has(e)}}})(y)},66238:function(e,t,n){"use strict";var r=n(85879),o=n(82452),i=n(82435),a=n(65733),c=n(36695),s=n(19076),l=n(38889),u=n(66263),d=n(57138),p=n(7407);t.Z=(0,s.withRouter)(function(e){var t=e.parent,n=t.type,s=t.id,h=t.question,f=e.location.pathname,_=(0,p.dD)(),m=(0,c.useSelector)(function(e){var t=null==f?void 0:f.includes("/answer/"),n=!t&&(null==f?void 0:f.includes("/question/"));return(0,p.hV)(e,{type:t?"answer":n?"question":"",id:s||(null==h?void 0:h.id)})}),v=(0,a.Z)(function(e,t){if(e&&e.stopPropagation(),!u.dd||!_){if("zvideo"===n){(0,o.rH)((0,d.MN)({type:n,id:s},{launch_button:t}));return}if(m){location.href="zhihu://".concat(n,"/").concat(s,"?utm_app_name=zhihu_check");return}(0,o.rH)((0,d.MN)({type:n,id:s},{launch_button:t})),e.preventDefault()}});return(0,r.tZ)("div",{className:"CommentsForOia",children:(0,r.tZ)(i.ZP,{css:{margin:0},showInteractions:!1,resourceType:n,resourceId:String(s),showCommentInput:!1,useHeartIcon:!0,openInApp:function(e){return v(e,u.dN.comment_list)},customHeader:function(){return null},customFooter:function(e){return e<=2||u.dd?null:(0,r.tZ)(l.ZP,{color:"blue",preset:"primary",onClick:function(e){return v(e,u.dN.comment_more)},children:"打开 App 查看更多评论"})}})})})},85703:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),l=n(85879),u=n(67814),d=n.n(u),p=n(87363),h=n(74128),f=n(38889),_=n(80714),m=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleSubmit",function(){var t=e.props,n=t.onSubmit,r=t.onCancel,o=t.needCancel;(void 0===o||o)&&r(),n()}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.subtitle,r=e.shown,o=e.onCancel,i=e.className,a=e.isMobile,c=e.confirmText,s=e.cancelText,u=e.showButtonHorizontal,p=e.showConfirmButtonRight,m=(0,l.tZ)(f.ZP,{preset:"primary",color:"blue",onClick:this.handleSubmit,children:c||"确认"},"confirm"),v=(0,l.tZ)(f.ZP,{onClick:o,children:s||"取消"},"cancel"),g=_.Z.isMobileEntry||a||p?[v,m]:[m,v];return(0,l.tZ)(h.Z,{wrapperClassName:"ConfirmModal-wrapper",className:d()("ConfirmModal",i),title:t,size:_.Z.isMobileEntry||a?"small":"default",subtitle:n,onClose:o,closeButton:!1,buttonGroupOnly:!0,children:r&&(0,l.tZ)(h.w,{direction:_.Z.isMobileEntry||a||u?"horizontal":"vertical",children:g})})}}]),n}(p.Component);t.Z=m},30361:function(e,t,n){"use strict";n.d(t,{PG:function(){return R},eX:function(){return A},n1:function(){return b},qb:function(){return Z}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(71728),d=n(85626),p=n(85879),h=n(72111),f=n(67814),_=n.n(f),m=n(92769),v=n.n(m),g=n(87363),T=n(43384),E=n(20072),C=n(97727),y=n(45842),S=n(59937);function I(e){var t=e.onRef,n=e.listClassName,r=e.itemClassName,o=e.className,i=e.children,a=(0,u._)(e,["onRef","listClassName","itemClassName","className","children"]);return(0,p.tZ)("div",(0,l._)((0,s._)({ref:t,className:_()(n,o)},a),{children:g.Children.map(i,function(e){return"string"==typeof e?(0,p.tZ)("span",{className:r,children:e}):e?(0,g.cloneElement)(e,{className:_()(r,e.props.className)}):e})}))}var b=function(e){return(0,p.tZ)(I,(0,s._)({listClassName:"ContentItem-cells",itemClassName:"ContentItem-cell"},e))},A=function(e){return(0,p.tZ)(I,(0,s._)({listClassName:"ContentItem-actions",itemClassName:"ContentItem-action"},e))},Z=function(e){return(0,p.tZ)(I,(0,s._)({listClassName:"ContentItem-status",itemClassName:"ContentItem-statusItem"},e))},w=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"onRef",function(t){e.domNode=t,e.props.onRef&&e.props.onRef(t)}),(0,a._)((0,r._)(e),"onAccessContent",function(t,n){n===document.activeElement&&window.open(e.props.link)}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){var e=this;(0,E.y3)(this.domNode,function(){var t=e.props,n=t.data,r=void 0===n?{}:n,o=r.type,i=r.id,a=t.lastreadTouchable;t.currentUser&&a&&o&&i&&(0,S.ZP)("article"===o?"post":o,i,S.Qm)})}},{key:"render",value:function(){var e,t=v()(this.props,["noTrackCardShow","lastreadTouchable","data","onRef","dispatch","currentUser","isLogin"]),n=t.className,r=t.title,o=t.meta,i=t.children,a=t.extra,c=t.image,d=t.link,f=(0,u._)(t,["className","title","meta","children","extra","image","link"]),m=(0,p.BX)(p.HY,{children:[r&&(0,p.tZ)(T.eV,{block:"卡片标题跳转",children:(0,p.tZ)("h2",{className:"ContentItem-title",children:(null===(e=r.props)||void 0===e?void 0:e.href)?(0,p.tZ)(h._o,{zaAction:"OpenUrl",zaEventType:"Click",zaText:"标题跳转",zaType:"Text",zaModuleId:"card_title_text",children:r}):(0,p.tZ)("span",{children:r})})}),!(!o||Array.isArray(o)&&!o.some(Boolean))&&(0,p.tZ)("div",{className:"ContentItem-meta",children:o})]});return(0,p.BX)("div",(0,l._)((0,s._)({ref:this.onRef,className:_()("ContentItem",n)},f),{children:[d&&(0,p.tZ)(C.bY,{input:"enter",action:this.onAccessContent}),c||a?(0,p.BX)("div",{className:"ContentItem-main",children:[c&&(0,p.tZ)("div",{className:"ContentItem-image",children:c}),(0,p.tZ)("div",{className:"ContentItem-head",children:m}),a&&(0,p.tZ)("div",{className:"ContentItem-extra",children:a})]}):m,i]}))}}]),n}(g.Component),R={plain:"plain",default:"default",interactive:"interactive"};t.ZP=(0,y.Z)(w)},26299:function(e,t,n){"use strict";n.d(t,{zV:function(){return T},sJ:function(){return R},ZP:function(){return E}});var r=n(94009),o=n(85879),i=n(16836),a=n(75798),c=n(43897),s=n(55164),l=n(57477),u=n(71728),d=n(89174),p=n(19818),h=n(67814),f=n.n(h),_=n(14168),m=n.n(_),v=function(e){var t=e.visible,n=e.children;return(0,o.tZ)("div",{className:f()("CornerAnimayedFlex",{"CornerAnimayedFlex--hidden":!t}),children:n})};v.defaultProps={visible:!0};var g=function(e){var t=e.className,n=e.visible,r=e.tooltip,i=e.children,a=(0,u._)(e,["className","visible","tooltip","children"]);return(0,o.tZ)(v,{visible:n,children:(0,o.tZ)(d.ZP,(0,l._)((0,s._)({},a),{"data-tooltip":r,"data-tooltip-position":"left","data-tooltip-will-hide-on-click":!0,className:f()(t,"CornerButton"),"aria-label":r,preset:"plain",css:function(e){return(0,l._)((0,s._)({display:"flex",alignItems:"center",justifyContent:"center",background:e.colors.GBK99A,borderRadius:"4px",width:"40px",height:"40px",color:e.colors.GBL05A},(0,p.d)(e)),{"&:hover":{background:e.colors.GBK08A}})},children:i}))})};g.propTypes={className:m().string,tooltip:m().string.isRequired,visible:m().bool,children:m().node};var T=function(e){var t=e.className,n=e.onClick,s=e.threshold,l=(0,r._)((0,a.Z)(),3),u=l[0],d=l[1],p=l[2];return(0,o.BX)(o.HY,{children:[(0,o.tZ)(g,{visible:!d&&!!p,className:t,tooltip:"回到顶部",onClick:function(e){n&&n(e),e.defaultPrevented||window.scrollTo({top:0,behavior:"smooth"})},children:(0,o.tZ)(c.z,{"aria-hidden":!0})}),(0,o.tZ)(i.Z,{children:(0,o.tZ)("div",{ref:u,css:{position:"absolute",top:0,height:void 0===s?1200:s}})})]})},E=function(e){var t=e.className,n=e.children;return(0,o.tZ)("div",{className:f()("CornerButtons",t),children:n})},C=n(22107),y=n(94707),S=n(87320),I=n(86325),b=n(85626),A=n(87363),Z=n(73480),w=function(e){(0,I._)(n,e);var t=(0,b._)(n);function n(){return(0,C._)(this,n),t.apply(this,arguments)}return(0,y._)(n,[{key:"navigationToZhiyisheng",value:function(){location.href="https://www.zhihu.com/messages/3d198a56310c02c4a83efb9f4a4c027e?message=".concat(encodeURIComponent("您好，我遇到的问题的场景是：\n具体功能是：\n具体反馈是："))}},{key:"render",value:function(){var e=this.props.className;return(0,o.tZ)(g,{className:e,tooltip:"建议反馈",onClick:this.navigationToZhiyisheng,children:(0,o.tZ)(Z.a,{"aria-label":"建议反馈"})})}}]),n}(A.Component);(0,S._)(w,"propTypes",{className:m().string});var R=w},25773:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(71728),d=n(85626),p=n(85879),h=n(67814),f=n.n(h),_=n(92769),m=n.n(_),v=n(14168),g=n.n(v),T=n(87363),E=n(38889),C=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(e){var i;return(0,o._)(this,n),i=t.call(this,e),(0,a._)((0,r._)(i),"clearTimer",function(){i.timer&&window.clearInterval(i.timer)}),(0,a._)((0,r._)(i),"handleClick",function(e){i.state.isCounting||i.startTiming(e)}),i.state={countDownTime:e.countDownTime,isCounting:!1},i.isInitialState=!0,i}return(0,i._)(n,[{key:"componentDidMount",value:function(){this.props.startAtOnce&&this.startTiming()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.interceptTime,r=t.reStartTime,o=e.interceptTime,i=e.reStartTime;n!==o&&this.resetTiming(),r!==i&&(this.resetTiming(),this.startTiming())}},{key:"componentWillUnmount",value:function(){this.clearTimer()}},{key:"resetTiming",value:function(){this.clearTimer(),this.setState({countDownTime:this.props.countDownTime,isCounting:!1})}},{key:"startTiming",value:function(e){var t=this,n=this.props,r=n.event,o=n.countDownEndEvent,i=null,a=function(){t.isInitialState=!1,t.setState({isCounting:!0}),t.timer=setInterval(function(){var e=t.state.countDownTime;e<=0?(o&&o(),t.resetTiming()):t.setState({countDownTime:e-1})},1e3)};"function"==typeof r&&(i=r(e,a)),!1!==i&&a()}},{key:"renderText",value:function(){var e=this.props,t=e.initialText,n=e.resetText,r=e.countingText,o=this.state,i=o.countDownTime;return o.isCounting?r({count:i}):this.isInitialState?t:n||t}},{key:"render",value:function(){var e=m()(this.props,["initialText","resetText","countingText","startAtOnce","countDownTime","event","interceptTime","countDownEndEvent","reStartTime"]),t=e.className,n=e.disabled,r=(0,u._)(e,["className","disabled"]),o=this.state.isCounting;return(0,p.tZ)(E.ZP,(0,l._)((0,s._)({className:f()("CountingDownButton",t,{"is-counting":o})},r),{onClick:this.handleClick,disabled:n||o,children:this.renderText()}))}}]),n}(T.Component);(0,a._)(C,"propTypes",{countDownTime:g().number,startAtOnce:g().bool,initialText:g().string.isRequired,resetText:g().string,countingText:g().func.isRequired,event:g().func,countDownEndEvent:g().func,interceptTime:g().number,reStartTime:g().number}),(0,a._)(C,"defaultProps",{countDownTime:60,startAtOnce:!1,interceptTime:-1,reStartTime:-1}),t.Z=C},69661:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var r=n(94009),o=n(85879),i=n(67814),a=n.n(i),c=n(87363),s=n(69383),l=n(31467),u=n(38889),d=n(31142),p=n.p+"assets/background_blue.970aad09.svg",h=n.p+"assets/liukanshan_coin.32323a56.svg",f=n.p+"assets/liukanshan_paper.6d897558.svg",_=n(4757),m={answerAdmireCouldOpen:{image:h,title:"开启「赞赏」权益",content:"你已经获得了「赞赏」权益，使用「赞赏」可以得到更多收益。快去开启权益吧。",buttonText:"立即开启",buttonLink:"https://www.zhihu.com/creator/reward/community",detailViewName:"admire",cardShowId:4922,buttonClickId:4924,readAlwaysId:4926,readNextId:4928},answerAdmireCouldUse:{image:h,title:"使用「赞赏」权益",content:"你可以为这篇内容开启「赞赏」。「赞赏」开启后，读者将可以付费支持你的创作。",buttonText:"开启赞赏",detailViewName:"admire",cardShowId:4923,buttonClickId:4925,readAlwaysId:4927,readNextId:4929},recommendationCouldOpen:{image:f,title:"开启「内容自荐」权益",content:"你已经获得了「内容自荐」权益，优质内容通过自荐后可以展示给更多人。快去开启权益吧。",buttonText:"立即开启",buttonLink:"https://www.zhihu.com/creator/recommend",detailViewName:"recommend",cardShowId:4922,buttonClickId:4924,readAlwaysId:4926,readNextId:4928},recommendationCouldUse:{image:f,title:"使用「内容自荐」权益",content:"你可以使用「内容自荐」权益，让更多人看到这篇内容。快去使用权益吧。",buttonText:"立即自荐",detailViewName:"recommend",cardShowId:4923,buttonClickId:4925,readAlwaysId:4927,readNextId:4929}},v=function(e){var t=e.notification,n=void 0===t?{}:t,i=e.className,h=e.onRead,f=e.onUseAdmire,v=e.onUseRecommend,g=(0,r._)((0,_.Ue)(),2),T=g[0],E=g[1],C=Object.keys(n).find(function(e){return n[e]}),y=m[C]||{},S=y.title,I=y.image,b=y.content,A=y.buttonText,Z=y.buttonLink,w=y.detailViewName,R=y.cardShowId,N=y.buttonClickId,k=y.readAlwaysId,O=y.readNextId;return((0,c.useEffect)(function(){C&&E()},[C]),(0,c.useEffect)(function(){C&&s.Z.trackCardShow(null,{id:R,name:w})},[C,R,w]),T)?(0,o.tZ)(l.Z,{className:a()("CreatorRightsNotification",i),onClose:function(){h("next"),s.Z.trackEvent(null,{id:O,name:w})},children:C&&(0,o.BX)(c.Fragment,{children:[(0,o.tZ)("img",{className:"CreatorRightsNotification-background",src:p,alt:"blue background"}),(0,o.tZ)("img",{className:"CreatorRightsNotification-liukanshan",src:I,alt:"liukanshan image"}),(0,o.tZ)("div",{className:"CreatorRightsNotification-title",children:S}),(0,o.tZ)("div",{className:"CreatorRightsNotification-content",children:b}),(0,o.BX)(l.w,{className:"CreatorRightsNotification-buttonGroup",children:[Z?(0,o.tZ)(d.Z,{className:"CreatorRightsNotification-button",preset:"primary",color:"blue",to:Z,target:"_blank",onClick:function(){h("current"),s.Z.trackEvent(null,{id:N,name:w})},children:A}):(0,o.tZ)(u.ZP,{className:"CreatorRightsNotification-button",preset:"primary",color:"blue",onClick:function(){h("current"),s.Z.trackEvent(null,{id:N,name:w}),"answerAdmireCouldUse"===C&&f(),"recommendationCouldUse"===C&&v()},children:A}),(0,o.tZ)(u.ZP,{className:"CreatorRightsNotification-dismiss",preset:"plain",color:"grey",onClick:function(){h("always"),s.Z.trackEvent(null,{id:k,name:w})},children:"不再提醒"})]})]})}):null}},4757:function(e,t,n){"use strict";n.d(t,{Ue:function(){return l}});var r=n(94009),o=n(85879),i=n(87363),a=n(88329),c=n.n(a),s=(0,i.createContext)([!0,c(),c()]);s.displayName="DisplayPriorityContext";var l=function(){return(0,i.useContext)(s)},u=function(e){var t=e.children,n=e.readyStatus,r=e.shownStatus,a=e.index,c=e.setReadyStatusList,l=(0,i.useRef)(n);(0,i.useEffect)(function(){l.current=n},[n]);var u=(0,i.useCallback)(function(){"pending"===l.current&&c(function(e){return e.map(function(e,t){return t===a?"resolved":e})})},[c,a]),d=(0,i.useCallback)(function(){"pending"===l.current&&c(function(e){return e.map(function(e,t){return t===a?"rejected":e})})},[c,a]),p=(0,i.useMemo)(function(){return[r,u,d]},[r,u,d]);return(0,o.tZ)(s.Provider,{value:p,children:t})};t.ZP=function(e){var t=e.children,n=(0,r._)((0,i.useState)(function(){return i.Children.map(t,function(e){return e?"pending":"rejected"})}),2),a=n[0],c=n[1],s=(0,i.useMemo)(function(){var e=!1;return a.map(function(t){return!e&&"rejected"!==t&&(e=!0,"pending"!==t)})},[a]);return(0,o.tZ)(o.HY,{children:i.Children.map(t,function(e,t){return(0,o.tZ)(u,{readyStatus:a[t],shownStatus:s[t],index:t,setReadyStatusList:c,children:e},t)})})}},8846:function(e,t,n){"use strict";n.d(t,{rD:function(){return a}}),n(87363);var r=n(6735),o=n(27663),i={published:"".concat("editorEventPublisher",".post-publish")},a=function(e){e.pipe((0,r.h)(function(e){var t;if((null==e?void 0:e.type)==="post-publish"&&!(null===(t=e.context)||void 0===t?void 0:t.error)){var n=e.context.data;return(null==n?void 0:n.type)==="answer"}return!1}),(0,o.U)(function(e){var t=e.context.data||{};return{type:t.type,contentId:t.contentId,targetId:t.targetId}})).subscribe(function(e){if(e&&e.contentId&&e.type){var t={action:i.published,payload:e};window.opener&&window.opener.postMessage(t,location.origin),window.postMessage(t,location.origin)}})}},84469:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var r=n(94009),o=n(85879),i=n(87363),a=n(11809),c=n(20944),s=n(22701),l=n(57730),u=n(19760),d=n(59013),p=n(31467),h=n(78920),f=function(e){var t=e.shown,n=e.onClose,r=e.onSubmit,a=(0,i.useCallback)(function(e){var t=e.type,o=e.payload;if("browser/closeCurrentPage"===t){n();return}if("editor/submitAttachment"===t){r(o.files);return}},[r,n]);return(0,o.tZ)(p.Z,{className:"BaiduFileSelector",size:"large",onClose:n,children:t&&(0,o.tZ)("div",{className:"BaiduFileSelector-content",children:(0,o.tZ)(h.Z,{className:"BaiduFileSelector-iframe",src:"https://www.zhihu.com/appview/editor/attachment/baidu",onMessage:a})})})},_=(0,i.forwardRef)(function(e,t){var n=(0,r._)((0,i.useState)(!1),2),a=n[0],c=n[1];return(0,i.useImperativeHandle)(t,function(){return{setBaiduFileSelectorShown:c}},[]),(0,o.tZ)(f,{shown:a,onClose:function(){return c(!1)},onSubmit:function(t){c(!1),e.onSubmit(t)}})}),m=function(){var e={},t=function(t){e.getEditorRef().props.handleCommand("insert-file-link-card:".concat(JSON.stringify(t)))},n=function(){return(0,d.Z)(e.getEditorState()).filter(function(e){return"file-link-card"===e.getType()})},r=function(){if(n().size>=10){l.Z.alert(null,{title:"一篇内容最多可添加 ".concat(10," 个附件")});return}e.containerRef.current.setBaiduFileSelectorShown(!0)};return e.containerRef=(0,i.createRef)(),{initialize:function(t){Object.assign(e,t)},components:(0,o.tZ)(_,{handleSubmit:t,ref:e.containerRef,onSubmit:t}),handleCommand:function(e){return"insert-file-from-baidu-wangpan"===e?(r(),"handled"):"not-handled"},toolbar:{section:a.Z.CUSTOM_MAIN,label:"上传附件",icon:u._,toolType:s._W.ENTITY,onClick:function(){if(n().size>=10){l.Z.alert(null,{title:"一篇内容最多可添加 ".concat(10," 个附件")});return}e.containerRef.current.setBaiduFileSelectorShown(!0)},priority:2},toolbarV2:{section:c.Z.BUSINESS_MEDIA,label:"上传附件",text:"网盘",icon:u._,toolType:s._W.ENTITY,onClick:function(){r()},priority:2}}}},86341:function(e,t,n){"use strict";n.d(t,{Z:function(){return B}});var r=n(94009),o=n(85879),i=n(87363),a=n.n(i),c=n(69383),s=n(65733),l=n(33773),u=n(20857),d=n(22107),p=n(94707),h=n(87320),f=n(86325),_=n(85626),m=n(14168),v=n.n(m),g=n(31467),T=n(36695),E=n(74065),C=n(70877),y=n(99178),S=n(67814),I=n.n(S),b=n(78160),A=n(38889),Z=n(7768),w=n(66980),R=Object.assign,N=function(e){return a().createElement(w.Z,R({width:"150",height:"120",viewBox:"0 0 150 120"},e),a().createElement("path",{fill:"#EBEEF5",d:"M102 30.998A2.996 2.996 0 0 0 98.998 28H50.002A2.996 2.996 0 0 0 47 30.998v58.147l.193-.125c1.453-.939 3.473-.94 4.927 0l2.537 1.64 2.536-1.64c1.453-.939 3.473-.94 4.927 0l2.537 1.64 2.536-1.64c1.453-.939 3.473-.94 4.927 0l2.537 1.64 2.536-1.64c1.453-.939 3.473-.94 4.927 0l2.537 1.64 2.536-1.64c1.453-.939 3.473-.94 4.927 0l2.537 1.64 2.536-1.64c1.413-.913 3.363-.94 4.807-.075V30.998zm-1.508 60.542c-.464-.3-1.209-.298-1.67 0l-4.165 2.692-4.165-2.692c-.464-.3-1.209-.298-1.67 0l-4.165 2.692-4.165-2.692c-.464-.3-1.209-.298-1.67 0l-4.165 2.692-4.165-2.692c-.464-.3-1.209-.298-1.67 0l-4.165 2.692-4.165-2.692c-.464-.3-1.209-.298-1.67 0l-4.165 2.692-4.165-2.692c-.464-.3-1.209-.298-1.67 0l-4.316 2.79A1.997 1.997 0 0 1 44 93V30.997A5.996 5.996 0 0 1 50.002 25h48.996A5.996 5.996 0 0 1 105 30.998V93a2 2 0 0 1-.396 1.2l-4.112-2.66z"}),a().createElement("path",{fill:"#F7F8FA",d:"M55 38.999c0-.552.439-.999.999-.999H75c.552 0 .999.439.999.999V58a.993.993 0 0 1-.999.999H56a.993.993 0 0 1-.999-.999V39zm25 .501c0-.828.675-1.5 1.498-1.5h11.004c.827 0 1.498.666 1.498 1.5 0 .828-.675 1.5-1.498 1.5H81.498A1.495 1.495 0 0 1 80 39.5zm0 9c0-.828.675-1.5 1.498-1.5h11.004c.827 0 1.498.666 1.498 1.5 0 .828-.675 1.5-1.498 1.5H81.498A1.495 1.495 0 0 1 80 48.5zm0 9c0-.828.675-1.5 1.498-1.5h11.004c.827 0 1.498.666 1.498 1.5 0 .828-.675 1.5-1.498 1.5H81.498A1.495 1.495 0 0 1 80 57.5zm-25 9c0-.828.677-1.5 1.505-1.5h35.99a1.499 1.499 0 1 1 0 3h-35.99A1.499 1.499 0 0 1 55 66.5zm0 9c0-.828.665-1.5 1.505-1.5h24.99a1.499 1.499 0 1 1 0 3h-24.99A1.499 1.499 0 0 1 55 75.5z"}))},k={current:"当前草稿",saved:"自动保存",published:"发布过的版本"},O=function(e){(0,f._)(n,e);var t=(0,_._)(n);function n(){var e;return(0,d._)(this,n),e=t.apply(this,arguments),(0,h._)((0,u._)(e),"formatDate",function(e){return b.Z("current"===e.versionType?1e3*e.updatedAt:1e3*e.createdAt,"yyyy-MM-dd HH:mm")}),(0,h._)((0,u._)(e),"handleDraftClick",function(e){e.preventDefault()}),e}return(0,p._)(n,[{key:"renderCurrentDraft",value:function(){var e=this.props,t=e.currentDraft,n=e.onRevert,r=e.draftId,a=e.draftType,c=t.isFetching,s=t.data;return(0,o.BX)("div",{className:"DraftHistory-main",children:[c&&(0,o.tZ)(C.Z,{className:"DraftHistory-loading"}),!c&&s&&(0,o.BX)(i.Fragment,{children:[s.draft.title&&(0,o.tZ)("div",{className:"DraftHistory-draftTitle",children:s.draft.title}),(0,o.tZ)("div",{className:"DraftHistory-draft",children:(0,o.tZ)(Z.Z,{html:s.draft.content,onClick:this.handleDraftClick,sourceType:a,sourceId:r})}),(0,o.BX)("div",{className:"DraftHistory-actions",children:[(0,o.BX)("div",{className:"DraftHistory-meta",children:[this.formatDate(s)," ",k[s.versionType]]}),(0,o.tZ)(A.ZP,{className:"DraftHistory-revert",disabled:"current"===s.versionType,onClick:function(){return n(s)},children:"恢复此版本"})]})]})]})}},{key:"render",value:function(){var e=this,t=this.props,n=t.history,r=t.currentVersion,i=t.currentDraft,a=t.getHistory,c=t.onSelect;return n?n.isFetching&&!n.items?(0,o.tZ)("div",{className:"DraftHistory",children:(0,o.tZ)(C.Z,{className:"DraftHistory-loading"})}):(0,o.BX)("div",{className:"DraftHistory",children:[(0,o.BX)("div",{className:"DraftHistory-side",children:[(0,o.tZ)("div",{className:"DraftHistory-title",children:"历史版本"}),(0,o.tZ)(y.ZP,{className:"DraftHistory-history",getContainer:function(e){return e},isLoading:n.isFetching,isDrained:n.isDrained,onLoad:a,children:(0,o.tZ)("div",{children:n.items&&n.items.map(function(t,n){return(0,o.BX)("a",{href:"#",className:I()("DraftHistory-version",{"DraftHistory-version--selected":r&&t.versionType===r.versionType&&t.id===r.id}),onClick:function(e){e.preventDefault(),c(t)},children:[(0,o.tZ)("div",{className:"DraftHistory-versionDate",children:e.formatDate(t)}),(0,o.tZ)("div",{className:"DraftHistory-versionType",children:k[t.versionType]})]},n)})})})]}),n.items&&!n.items.length&&(0,o.tZ)("div",{className:"DraftHistory-main",children:(0,o.BX)("div",{className:"DraftHistory-empty",children:[(0,o.tZ)(N,{className:"DraftHistory-emptyIcon"}),(0,o.tZ)("div",{className:"DraftHistory-emptyText",children:"还没有历史版本"})]})}),i&&this.renderCurrentDraft()]}):null}}]),n}(i.Component);(0,h._)(O,"propTypes",{history:v().object,currentVersion:v().object,currentDraft:v().object,onSelect:v().func,onRevert:v().func});var x=function(e){(0,f._)(n,e);var t=(0,_._)(n);function n(){var e;return(0,d._)(this,n),e=t.apply(this,arguments),(0,h._)((0,u._)(e),"state",{currentVersion:null}),(0,h._)((0,u._)(e),"getHistory",function(){var t=e.props,n=t.type,r=t.id;(0,t.getHistory)(n,r)}),(0,h._)((0,u._)(e),"handleSelect",function(t){e.setState({currentVersion:t})}),(0,h._)((0,u._)(e),"handleRevert",function(t){var n=e.props,r=n.revert,o=n.onReverted;r(t.versionType,t.id).then(function(){o&&o(t)})}),e}return(0,p._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.type,n=e.id;(0,e.getHistory)(t,n)}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,r=n.drafts,o=n.getDraft,i=this.state.currentVersion,a=t.currentVersion;!i||a&&a.versionType===i.versionType&&a.id===i.id||r["".concat(i.versionType,"_").concat(i.id)]||o(i.versionType,i.id)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.type,n=e.id;(0,e.reset)(t,n)}},{key:"render",value:function(){var e=this.props,t=e.history,n=e.drafts,r=e.draftId,i=e.draftType,a=this.state.currentVersion;return(0,o.tZ)(O,{history:t,currentVersion:a,currentDraft:a?n["".concat(a.versionType,"_").concat(a.id)]:null,draftId:r,draftType:i,getHistory:this.getHistory,onSelect:this.handleSelect,onRevert:this.handleRevert})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.history&&e.history.items&&e.history.items.length&&!t.currentVersion?{currentVersion:e.history.items[0]}:null}}]),n}(i.Component);(0,h._)(x,"propTypes",{type:v().string.isRequired,id:v().number.isRequired,onReverted:v().func});var P=(0,T.connect)(function(e,t){var n=t.type,r=t.id;return{history:e.draftHistory.history["".concat(n,"_").concat(r)],drafts:e.draftHistory.drafts}},{getHistory:E.s1,getDraft:E.eJ,revert:E.CU,reset:E.mc})(x),D=function(e){(0,f._)(n,e);var t=(0,_._)(n);function n(){var e;return(0,d._)(this,n),e=t.apply(this,arguments),(0,h._)((0,u._)(e),"handleReverted",function(t){var n=e.props,r=n.onClose,o=n.onReverted;o&&o(t),r&&r(),c.Z.trackEvent(null,{id:5016,action:"Click"})}),(0,h._)((0,u._)(e),"handleClose",function(){var t=e.props.onClose;t&&t(),c.Z.trackEvent(null,{id:5015,action:"Click"})}),e}return(0,p._)(n,[{key:"render",value:function(){var e=this.props,t=e.shown,n=e.type,r=e.id,i=e.draftId,a=e.draftType;return(0,o.tZ)(g.Z,{className:"DraftHistoryModal",size:"fullPage",onClose:this.handleClose,children:t&&(0,o.tZ)(P,{type:n,id:r,draftId:i,draftType:a,onReverted:this.handleReverted})})}}]),n}(i.Component);(0,h._)(D,"propTypes",{shown:v().bool.isRequired,onClose:v().func,type:v().string.isRequired,id:v().number.isRequired,onReverted:v().func}),(0,h._)(D,"defaultProps",{shown:!0});var L=(0,i.forwardRef)(function(e,t){var n,a,c=e.type,l=e.id,u=e.getId,d=e.handleReverted,p=e.draftId,h=e.draftType,f=e.getDraftId,_=(0,r._)((0,i.useState)(!1),2),m=_[0],v=_[1],g=(0,s.Z)(function(){return v(!0)}),T=(0,s.Z)(function(){return v(!1)});return(0,i.useImperativeHandle)(t,function(){return{handleOpen:g,handleClose:T}},[g,T]),(0,o.tZ)(D,{shown:m,onClose:function(){return v(!1)},type:c,id:null!==(n=null==u?void 0:u())&&void 0!==n?n:l,draftId:null!==(a=null==f?void 0:f())&&void 0!==a?a:p,draftType:h,onReverted:d})}),B=function(e){var t=e.type,n=e.id,r=e.syncDraft,a=e.getId,s=e.getDraftId,u=e.draftId,d=e.draftType,p=e.shouldShowToolbarButton,h={};return h.draftModalRef=(0,i.createRef)(null),{initialize:function(e){Object.assign(h,e)},handleCommand:function(e){return"toggle-draft-history-modal"===e?(h.draftModalRef.current.handleOpen(),"handled"):"not-handled"},components:[(0,o.tZ)(L,{type:t,id:n,getId:a,draftId:u,getDraftId:s,draftType:d,ref:h.draftModalRef,handleReverted:function(e){h.getEditorRef().props.resetWithValue(e.draft.content)}},"draft_history_modal")],toolbar:{section:"menu",label:"历史版本",icon:l.x8,onClick:function(){r.flush(),h.draftModalRef.current.handleOpen(),c.Z.trackEvent(null,{id:5013,action:"Click",name:"历史版本入口"})},shouldShow:void 0===p?function(){return!0}:p}}}},23074:function(e,t,n){"use strict";n.d(t,{Z:function(){return X}});var r=n(94009),o=n(85879),i=n(87363),a=n(91850),c=n(55164),s=n(71728),l=n(87641),u=n(24486),d=n(43384),p=n(29229),h=n(83697),f=n(83688),_=n(25405),m=n(40933),v=n(28545),g=n(11690),T=n(59280),E=n(21706),C=n(15881),y=n(2347),S=n(16427),I=n(28124),b=n(7629),A=n(47866),Z=n(2325),w=n(29126),R=n(65389),N=n(48936),k=n(80714),O=function(e){var t=e.name,n=e.isFirst;return(0,o.BX)(o.HY,{children:[!n&&(0,o.tZ)(l.Text,{color:"GBK06A",fontSize:"12px",mx:"4px",children:"+"}),(0,o.tZ)(l.Flex,{px:"4px",css:function(e){return[{minWidth:"24px",borderRadius:"2px",height:"24px",lineHeight:"26px",background:e.colors.GBK10C,textAlign:"center",color:e.colors.GBK05A,fontSize:"14px",alignItems:"center",justifyContent:"center"},n&&{marginLeft:"auto"}]},children:t})]})},x=function(e){var t=e.label,n=e.Icon,r=e.shortcut;return(0,o.BX)(l.Flex,{alignItems:"center",css:{"&+&":{marginTop:"20px"}},children:[(0,o.tZ)(n,{size:20,css:function(e){return{color:e.colors.GBK03A}}}),(0,o.tZ)(l.Text,{ml:"8px",color:"GBK03A",fontSize:"14px",children:t}),r.split("+").map(function(e,t){return(0,o.tZ)(O,{name:e,isFirst:!t},t)})]})},P=n(26030),D=n(19012),L=n(73927),B=n(93975),U=n(68796),M=n(62095),G=function(e){var t=e.name,n=e.describe,r=e.isFirst;return(0,o.BX)(l.Box,{css:function(e){return{color:e.colors.GBK03A,paddingTop:r?"0":"20px"}},fontSize:14,fontWeight:400,children:[(0,o.tZ)(l.Text,{css:function(e){return{color:e.colors.GBK02A}},mb:"8px",fontWeight:500,children:t}),n.map(function(e){return"string"==typeof e?(0,o.tZ)(l.Text,{lineHeight:"20px",children:e}):(0,o.tZ)(o.HY,{children:e})})]})},F=[{name:"快捷键",component:function(e){var t,n=e.activeTabName,r=(0,h.n)().isAppleDevice;return(0,o.tZ)(d.Wi,{zaType:"Text",zaText:n,as:l.Box,py:"20px",css:function(e){return{background:e.colors.GBK99A}},children:(t="1"===k.Z.apollo.editor_adapt_native,[{icon:f.Z,label:"粗体",shortcut:"⌘+B",shortcutWin:"Ctrl+B"},{icon:t?_.ZP:m.ZP,label:t?"标题":"一级标题",shortcut:"⌘+⌥+1",shortcutWin:"Ctrl+Alt+1"},!t&&{icon:v.ZP,label:"二级标题",shortcut:"⌘+⌥+2",shortcutWin:"Ctrl+Alt+2"},{icon:g.ZP,label:"有序列表",shortcut:"⌘+⇧+L",shortcutWin:"Ctrl+Shift+L"},{icon:T.ZP,label:"无序列表",shortcut:"⌘+L",shortcutWin:"Ctrl+L"},{icon:E.ZP,label:"引用块",shortcut:"⌘+⇧+U",shortcutWin:"Ctrl+Shift+U"},{icon:C.Z,label:"代码块",shortcut:"⌘+⌥+C",shortcutWin:"Ctrl+Alt+C"},{icon:y.ZP,label:"撤销",shortcut:"⌘+Z",shortcutWin:"Ctrl+Z"},{icon:S.ZP,label:"重做",shortcut:"⌘+Y",shortcutWin:"Ctrl+Y"},{icon:I.Z,label:"清除格式",shortcut:"⌘+\\",shortcutWin:"Ctrl+\\"},{label:"插入链接",icon:b.ZP,shortcut:"⌘+K",shortcutWin:"Ctrl+K"},{icon:A.ZP,label:"目录",shortcut:"⌘+⌥+J",shortcutWin:"Ctrl+Alt+J"},{icon:Z.Z,label:"插入注释",shortcut:"⌘+⌥+R",shortcutWin:"Ctrl+Alt+R"},{icon:w.Z,label:"插入分割线",shortcut:"⌘+⌥+S",shortcutWin:"Ctrl+Alt+S"},{label:"插入表格",icon:R.Z,shortcut:"⌘+⌥+T",shortcutWin:"Ctrl+Alt+T"},{label:"插入公式",icon:N.Z,shortcut:"⌘+⌥+E",shortcutWin:"Ctrl+Alt+E"}].filter(Boolean)).map(function(e,t){var n=e.label,i=e.icon,a=e.shortcut,c=e.shortcutWin;return(0,o.tZ)(x,{label:n,Icon:i,shortcut:r?a:c},"ShortcutDoc"+t)})})}},{name:"Markdown",component:function(e){var t,n=e.activeTabName,r=(0,M.Z)().jumpUrl;return(0,o.BX)(d.Wi,{zaType:"Text",zaText:n,as:l.Box,py:"20px",css:function(e){return{background:e.colors.GBK99A}},children:[(0,o.BX)(l.Box,{fontSize:12,css:function(e){return{color:e.colors.GBK06A,margin:"-10px 0 20px 0"}},children:[(0,o.tZ)(l.Text,{children:"在工具栏-更多中设置为 Markdown 模式后，才会自动识别后续输入内容，转化为对应格式；"}),(0,o.BX)(l.Text,{children:["如你希望每篇内容均为此格式，可在",(0,o.tZ)(l.Link,{css:{cursor:"pointer",textDecoration:"underline",margin:"0 5px"},onClick:function(){return window.open(r)},children:"默认设置"}),"中修改默认编辑器偏好"]})]}),[{icon:(t="1"===k.Z.apollo.editor_adapt_native)?_.ZP:m.ZP,label:t?"标题":"一级标题",shortcut:"#+空格"},!t&&{icon:v.ZP,label:"二级标题",shortcut:"##+空格"},{icon:g.ZP,label:"有序列表",shortcut:"1+.+空格"},{icon:T.ZP,label:"无序列表",shortcut:"*+空格"},{icon:f.Z,label:"粗体",shortcut:"**文字**"},!t&&{icon:P.ZP,label:"斜体",shortcut:"*文字*"},!t&&{icon:D.Z,label:"倾斜加粗",shortcut:"***文字***"},{icon:L.Z,label:"行内代码",shortcut:"`文字`"},{icon:C.Z,label:"代码块",shortcut:"```+回车"},{icon:E.ZP,label:"引用块",shortcut:">+空格"},{icon:w.Z,label:"分割线",shortcut:"---+回车"},{icon:B.Z,label:"插入图片",shortcut:"![描述](链接)+空格"},{icon:U.Z,label:"LaTeX 语法",shortcut:"$$文字$$+空格"},{icon:b.ZP,label:"插入链接",shortcut:"[标题](链接)+空格"}].filter(Boolean).map(function(e,t){var n=e.label,r=e.icon,i=e.shortcut;return(0,o.tZ)(x,{label:n,Icon:r,shortcut:i},"MarkdownDoc"+t)})]})}},{name:"功能说明",component:function(e){var t,n=e.activeTabName;return(0,o.tZ)(d.Wi,{zaType:"Text",zaText:n,as:l.Box,py:"20px",css:function(e){return{background:e.colors.GBK99A}},children:(t="1"===k.Z.apollo.editor_adapt_native,[{tabName:"目录",describe:["选中工具栏的目录功能后，在编辑器中添加标题，左侧自动识别标题生成目录；",(0,o.BX)(o.HY,{children:[(0,o.tZ)(l.Text,{my:"8px",children:"若不想添加此标题至目录中，可将鼠标悬浮在目录区域的对应标题上，点击「删除」按钮即可移除；"}),(0,o.tZ)(l.Image,{my:"8px",src:t?"https://pic1.zhimg.com/v2-3fe6c6228a545148c1fe24c4f84208f6.png":"https://pic1.zhimg.com/v2-3173fb93f4c628ebc8245a2ae2ecea1d.png?source=6a64a727"}),(0,o.tZ)(l.Text,{my:"8px",children:"若想重新添加标题至目录中，可以在正文中选中此标题，并在目录区域找到对应标题，点击「固定」按钮即可重新添加。"}),(0,o.tZ)(l.Image,{my:"8px",src:t?"https://picx.zhimg.com/v2-17b7a5f82f5dfb856ce853188233d7cd.png":"https://pic2.zhimg.com/v2-1cabcd37bc16361cf95f172fc3ef86f0.png?source=6a64a727"})]})]},{tabName:"代码",describe:[t?"点击工具栏中的代码块图标后，编辑器内生成代码卡片。":"点击工具栏中的代码块图标后，编辑器内生成代码卡片，右上方选择语法，可在代码块中展示语法高亮。"]},{tabName:"公式",describe:["点击工具栏中的公式图标后，在公式编辑器输入 LaTeX 语法，下方为预览区。",(0,o.BX)(o.HY,{children:["您可在",(0,o.tZ)(l.Link,{css:function(e){return{color:e.colors.GBL01A}},target:"_blank",href:"https://math.meta.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference",children:"LaTeX基础教程"}),"中参考更多语法"]})]},{tabName:"注释",describe:["点击工具栏中的注释图标，在注释编辑弹框中输入注释文本及链接后，文本对应的注释会出现在文末。"]},{tabName:"历史版本",describe:["点击工具栏中的历史版本后，可在自动保存的草稿版本中查看历史草稿，点击恢复此版本可还原历史草稿。"]},{tabName:"文档导入",describe:["点击工具栏中的文档图标，导入 .docx/.md 文档后，编辑器会自动解析内容并展示在编辑器中。若粘贴图片失败，建议使用文档导入功能。"]}].filter(Boolean)).map(function(e,t){var n=e.tabName,r=e.describe;return(0,o.tZ)(G,{name:n,describe:r,isFirst:!t},"FunctionDoc"+t)})})}}],z=function(e){var t=e.children,n=e.className;return(0,o.tZ)("h1",{css:function(e){return{background:e.colors.GBK99A,color:e.colors.GBK02A,lineHeight:"31px",fontSize:"22px",fontWeight:"600"}},className:n,children:t})},H=function(e){var t=e.active,n=(0,s._)(e,["active"]);return(0,o.tZ)(d.$U,(0,c._)({zaType:"Button",zaText:!0,as:"button",css:function(e){return[{display:"inline-block",width:"88px",borderRadius:"999px",height:"26px",lineHeight:"26px",background:t?e.colorMod(e.colors.primary).alpha(.1):e.colors.GBK10C,textAlign:"center",cursor:"pointer",color:t?e.colors.primary:e.colors.GBK06A,fontSize:"13px",marginRight:"7px",marginBottom:"14px"},t&&{fontWeight:"500"}]}},n))};function q(e){var t=e.className,a=e.onClose,c=e.getInitialOffset,s=e.getShouldHide,h=(0,r._)((0,i.useState)(0),2),f=h[0],_=h[1],m=F[f].component,v=(0,p.Z)(function(){return Promise.all([n.e(5423),n.e(2607),n.e(2174),n.e(5052)]).then(n.bind(n,99063))});return v?(0,o.tZ)(d.eV,{block:"EditorHelpDoc",children:(0,o.BX)(v,{className:t,getInitialOffset:c,getShouldHide:s,children:[(0,o.tZ)(d.Wi,{zaType:"Popup",zaText:"帮助文档"}),(0,o.BX)(l.Flex,{bg:"GBK99A",pl:"16px",sx:{borderBottom:"1px solid",borderColor:"GBK09A",height:"52px",alignItems:"center"},children:[(0,o.tZ)(z,{css:{fontSize:"18px",lineHeight:"24px"},children:"帮助文档"}),(0,o.tZ)(l.Text,{color:"GBK06A",fontSize:"12px",lineHeight:"17px",fontWeight:"400",ml:"8px",mt:"4px",children:"支持拖拽和调整高度"}),(0,o.tZ)(d.$U,{zaType:"Button",zaAction:"Unknown",zaText:"关闭帮助文档",as:u.eb,css:{marginLeft:"auto",padding:"16px",cursor:"pointer"},onClick:a})]}),(0,o.BX)(l.Box,{ml:"16px",mr:"9px",pt:"14px",children:[F.map(function(e,t){return(0,o.tZ)(H,{active:f===t,onClick:function(){f!==t&&_(t)},children:e.name},t)}),(0,o.tZ)(l.Box,{mr:"7px",sx:{height:"2px",borderBottom:"1px solid",borderColor:"GBK09A",alignItems:"center"}})]}),(0,o.tZ)(l.Box,{px:"16px",css:{height:"calc(100% - 112px)",overflow:"auto"},children:m&&(0,o.tZ)(m,{activeTabName:F[f].name})})]})}):null}var V=(0,i.forwardRef)(function(e,t){var n=e.getInitialOffset,c=e.getShouldHide,s=e.forceUpdate,l=(0,r._)((0,a.Z)(!1),2),u=l[0],d=l[1];return(0,i.useImperativeHandle)(t,function(){return{toggle:d.toggle,getShown:function(){return u}}},[d,u]),u&&(0,o.tZ)(q,{onClose:function(){d.toggle(),s&&requestAnimationFrame(function(){s()})},getInitialOffset:n,getShouldHide:c})}),X=function(e){var t=e.getInitialOffset,n=e.getShouldHide,r=e.forceUpdate,a={};return a.helpDocRef=(0,i.createRef)(null),{initialize:function(e){Object.assign(a,e)},handleCommand:function(e){return"toggle-help-document"===e?(a.helpDocRef.current.toggle(),r&&requestAnimationFrame(function(){r()}),"handled"):"not-handled"},queryCommandState:function(e){if("toggle-help-document"===e){var t;return!!(null===(t=a.helpDocRef.current)||void 0===t?void 0:t.getShown())}},components:[(0,o.tZ)(V,{getInitialOffset:t,getShouldHide:n,ref:a.helpDocRef,forceUpdate:r},"EditorHelpDocContainer")]}}},36212:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(85879),o=n(23141),i=n(80230),a=n(87641),c=n(19319),s=n(38455),l=n(38889),u=function(e,t){var n=e.store,r=e.getSentences;return Promise.resolve(null==r?void 0:r()).then(function(e){if(null==e?void 0:e.length){var r=n.getEditorState(),o=r.getCurrentContent(),a=o.getBlockMap();e.filter(function(e){var t;return(null==e?void 0:null===(t=e.position)||void 0===t?void 0:t.start)&&e.position.end}).forEach(function(e){var c=e.position,s=c.start,l=s.paragraphId,u=s.offset,d=c.end,p=d.paragraphId,h=d.offset,f=null,_=null,m=h,v=a.skipUntil(function(e){var t,n=null===(t=e.getData())||void 0===t?void 0:t.get("pid"),r=e.getKey();return n===l&&(f=r,!0)}).takeUntil(function(e){if(_)return!0;var t,n=null===(t=e.getData())||void 0===t?void 0:t.get("pid"),r=e.getKey();return n===p&&(_=r,m=Math.min(e.getLength(),h)),!1});if(!f||!_){console.error("句子互动：无法找到对应的互动句子，startPid：".concat(l,"，startKey：").concat(f,"，endPid：").concat(p,"，endKey：").concat(_));return}var g=i.SelectionState.createEmpty(f).merge({anchorOffset:u,focusKey:_,focusOffset:m});o=i.Modifier.applyInlineStyle(o,g,"INTERACT"),r=i.EditorState.set(r,{currentContent:o}),n.setEditorState(r),t(v)})}})};function d(e){var t=e.getSentences,n={},i=new Set,d=!1,p=!1,h=!1,f=null,_=function(){if(d){null==f||f(),f=null;return}(0,s.Z)(function(e){return f=e,(0,r.tZ)(c.Z,{css:{top:"126px"},delay:36e5,notification:{text:(0,r.BX)(a.Text,{css:{display:"flex",alignItems:"center"},children:[(0,r.tZ)(o.Z,{size:18,css:{marginRight:"8px"}}),"修改有互动的句子时，app 端对应的句子互动划线将不再外显"]}),key:"notificationInteractTexts",timeStamp:new Date().getDate()},actions:(0,r.tZ)(l.ZP,{preset:l.EE.Link,color:l.rp.Blue,onClick:function(){e(),p=!0},children:"知道了"})})})};return{initialize:function(e){Object.assign(n,e),u({store:n,getSentences:t},function(e){(null==e?void 0:e.size)&&e.forEach(function(e){var t=e.getKey();i.add(t)})})},customStyleMap:{INTERACT:{borderBottom:"1px dashed #BFBFBF"}},onChange:function(e){if(!i.size||p)return e;var t=!1,n=e.getCurrentContent(),r=e.getSelection(),o=r.getHasFocus()&&h;if(h=r.getHasFocus(),o){var a=n.getBlockMap(),c=r.getStartKey(),s=r.getEndKey(),l=!1;a.skipUntil(function(e){return e.getKey()===c}).takeUntil(function(e){return!!l||(e.getKey()===s&&(l=!0),!1)}).toArray().forEach(function(e,n){t||e.findStyleRanges(function(e){return e.hasStyle("INTERACT")},function(o,i){if(n>0){t=!0;return}t=r.hasEdgeWithin(e.getKey(),0,i)})})}return t!==d&&(_(),d=t),e}}}},99616:function(e,t){"use strict";t.Z=function(e){var t=e.onToggle;return{handleCommand:function(e){return"toggle-markdown-enabled"===e?(t(),"handled"):"not-handled"}}}},19220:function(e,t,n){"use strict";n.d(t,{Z:function(){return te}});var r,o=n(55164),i=n(57477),a=n(85879),c=n(87363),s=n.n(c),l=n(20944),u=n(11809),d=n(99445),p=n(94009),h=n(65733),f=n(14168),_=n.n(f),m=n(43384),v=n(31467),g=n(87320),T=n(71728),E=n(87641),C={LOCAL:{type:"local",name:"上传图片"},EMOTICON:{type:"emoticon",name:"表情包"},PUBLIC:{type:"public",name:"网络素材"},PRIVATE:{type:"private",name:"个人素材"},LATEST:{type:"latest",name:"最近使用"}},y=Object.values(C),S=Object.keys(C).reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,g._)({},t,C[t].type))},{});Object.keys(C).reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,g._)({},C[t].type,C[t].name))},{});var I={ALL:{type:"all",name:"全部"},STATIC:{type:"static",name:"普通图片"},DYNAMIC:{type:"dynamic",name:"动图"}};Object.values(I),Object.keys(I).reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,g._)({},t,I[t].type))},{}),Object.keys(I).reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,g._)({},I[t].type,I[t].name))},{});var b=function(e){var t=e.active,n=(0,T._)(e,["active"]);return(0,a.tZ)(m.$U,(0,o._)({as:"button",zaType:"Button",zaText:!0,zaAction:"Unknown",color:"GBK03A",shouldTrackShow:!0,css:function(e){return[{marginRight:"20px",lineHeight:"50px",fontSize:"15px",cursor:"pointer"},t&&{position:"relative",fontWeight:"bold","::after":{position:"absolute",left:"0",bottom:"0",content:"''",display:"block",width:"100%",height:"4px",backgroundColor:e.colors.GBL01A,flexShrink:"0"}}]}},n))},A=function(e){var t=e.tabType,n=e.tabChange,r=e.tabs,o=r?y.filter(function(e){var t=e.type;return r.includes(t)}):y;return(0,a.BX)(E.Flex,{alignItems:"center",justifyContent:"space-between",css:function(e){return{height:"50px",padding:"0 20px",boxShadow:"inset 0px -0.5px 0px ".concat(e.colors.GBK09A)}},children:[(0,a.tZ)(E.Flex,{children:o.map(function(e){return(0,a.tZ)(b,{active:t===e.type,onClick:function(){n(e.type)},children:e.name},e.type)})}),(0,a.tZ)("div",{className:"MaterialLibrary-SearchInputContainer"})]})};A.propTypes={tabType:_().string,tabChange:_().func};var Z=n(10840),w=n(20382),R=n(49274),N=n(79091),k=n(81956),O=n(88423),x=n(45401),P=n(62641),D=n(80565),L=n(43831),B=function(){return new Promise(requestAnimationFrame)},U=function(e,t,n){e({eventType:"Click",action:"Unknown",elementLocation:{type:t,text:n}})},M=function(e){var t=(0,m.Q4)().trackEvent,n=(0,p._)((0,c.useState)(null),2),r=n[0],o=n[1],i="ready"===r,s=function(n){n.stopPropagation(),"loading"!==r&&(o("loading"),U(t,"Button","加载 gif"),Promise.all([(0,O.loadImage)(e),B().then(B)]).then(function(){o("ready")}).catch(function(){o("error")}))},l=null;return l="loading"===r||i?(0,a.tZ)(x.e1,{className:"MaterialLibrary-GifIcon",onClick:s}):"error"===r?(0,a.tZ)(x.wT,{className:"MaterialLibrary-GifIcon",onClick:s}):(0,a.tZ)(x.OU,{className:"MaterialLibrary-GifIcon",onClick:s}),{isGifReady:i,gifIcon:l}},G=function(){return(0,a.tZ)(E.Box,{color:"GBK02A",width:"96px",css:function(e){return{position:"absolute",left:"4px",bottom:"4px",width:"48px",height:"16px",lineHeight:"16px",textAlign:"center",fontSize:"12px",background:e.colors.GBL05A,color:e.colors.GBK99A,borderRadius:"2px",zIndex:1}},children:"已删除"})},F=function(e){return(0,a.tZ)(m.$U,(0,o._)({as:E.Flex,zaType:"Button",zaAction:"Unknown",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",css:{borderRadius:"2px",position:"absolute",lineHeight:"24px"}},e))},z=function(e){var t=e.data,n=e.chooseImage,r=e.deleted,c=e.deleteSingleImage,s=e.imageUrl,l=e.poster,u=e.isPrivate,d=void 0!==u&&u,p=(0,m.Q4)().trackEvent,h=(0,P.D)(),f=(0,O.imgUrl)(s||(null==t?void 0:t.origin),"100w"),_=M(f),v=_.isGifReady,g=_.gifIcon,T=v?f:(0,O.imgUrl)(l||(null==t?void 0:t.thumbnail),"100w"),C="dynamic"===t.subtype?T:f;return(0,a.BX)(E.Box,{color:"GBK02A",width:d?"96px":"105px",css:[{display:"inline-block",marginBottom:"10px",marginLeft:d?"14px":"5px",verticalAlign:"top",".MaterialLibrary-GifIcon":{position:"absolute",width:"46px",height:"46px",marginLeft:"-23px",marginTop:"-23px",top:"50%",left:"50%",transition:"0.3s ease-out",transitionProperty:"transform, opacity",transform:"scale(1)",transformOrigin:"center",opacity:"1"}},v&&{".MaterialLibrary-GifIcon":{transform:"scale(0.3)",opacity:"0",width:0,height:0,margin:0}}],children:[(0,a.BX)(E.Box,{width:d?"96px":"105px",height:d?"96px":"105px",css:function(e){return{borderRadius:"2px",cursor:"pointer",position:"relative",backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.08),"&:hover > .MaterialLibrary-imgListItemHover":{display:"flex",backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.3)}}},onClick:function(){r||(n(t),U(p,"Image","".concat((null==t?void 0:t.checked)?"取消选中图片":"选中图片")))},children:[(0,a.tZ)(E.Image,{src:C,loading:"lazy",size:"100%",css:(0,o._)({position:"absolute",left:0,right:0,objectFit:"cover",borderRadius:"inherit",opacity:r?"0.3":"1"},h)}),(0,a.tZ)(E.Box,{sx:{color:"GBK99A",border:"2px solid",borderColor:"GBL01A"},css:function(e){return(0,o._)({display:(null==t?void 0:t.checked)?"flex":"none",position:"absolute",top:"0",left:"0",right:"0",width:"100%",height:"100%",borderRadius:"inherit"},(null==t?void 0:t.checked)&&{backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.3)})},className:"MaterialLibrary-imgListItemHover",children:r?(0,a.tZ)(F,{zaText:"删除图片",title:"删除",css:function(e){return{bottom:"2px",right:"2px",backgroundColor:e.colors.GBL01A}},onClick:function(e){e.stopPropagation(),c(t)},children:(0,a.tZ)(L.R,{fill:"currentColor",size:18})}):(0,a.tZ)(F,{zaType:"Image",zaText:"选中图片",title:"选中图片",onClick:function(e){e.stopPropagation(),n(t)},css:function(e){return{top:"6px",right:"6px",border:"2px solid ".concat((null==t?void 0:t.checked)?e.colors.GBL01A:e.colors.GBK99A),borderRadius:"50%"}}})}),(null==t?void 0:t.checked)&&(0,a.tZ)(F,{zaType:"Image",zaText:"取消选中图片",title:"取消选中图片",onClick:function(e){e.stopPropagation(),n(t)},css:function(e){return{top:"8px",right:"8px",fontSize:"14px",textAlign:"center",backgroundColor:e.colors.GBL01A,color:e.colors.GBK99A,borderRadius:"50%"}},children:null==t?void 0:t.checkedIndex}),"dynamic"===t.subtype&&g,r&&(0,a.tZ)(G,{})]}),(0,a.tZ)(E.Box,{mt:"4px",fontSize:"10px",lineHeight:"20px",css:(0,i._)((0,o._)({},(0,D.S)(1)),{wordBreak:"break-all"}),title:"文件名称",children:null==t?void 0:t.name})]})};z.propTypes={data:_().string,chooseImage:_().func,getLatestList:_().func};var H=n(99178),q=function(e){return(0,a.tZ)("i",(0,o._)({css:{marginLeft:"14px",width:"96px"}},e))},V=function(e){var t=e.children,n=(0,T._)(e,["children"]);return(0,a.BX)(H.ZP,(0,i._)((0,o._)({css:{display:"flex",flex:1,overflow:"auto",flexWrap:"wrap",justifyContent:"space-between",alignContent:"flex-start",height:"100%",marginLeft:"-5px",padding:"0 20px 0"}},n),{children:[t,(0,a.tZ)(q,{}),(0,a.tZ)(q,{}),(0,a.tZ)(q,{}),(0,a.tZ)(q,{}),(0,a.tZ)(q,{}),(0,a.tZ)(q,{})]}))},X=n(96813),W=function(e){var t=e.checked,n=e.onChange,r=(0,T._)(e,["checked","onChange"]);return(0,a.BX)(E.Flex,(0,i._)((0,o._)({alignItems:"center",css:function(e){return{fontSize:"13px",color:e.colors.GBL04A}}},r),{children:[(0,a.tZ)(X.C,{type:"checkbox",checked:t,onChange:function(e){n(e.target.checked)},size:15,css:{marginRight:"5px",marginTop:"1px"}}),"本页全选"]}))},K=n(49899),j=n(57730),Y=n(74135),Q=(0,c.createContext)({}),J=function(){return(0,c.useContext)(Q)},$=function(e){var t=e.onClose,n=e.sourceType,r=e.sourceId,o=e.insertImage,i=e.setTabType,s=e.initLocalList,l=e.setInitLocalList,u=e.children,d=e.maxImage,p=e.imgAutoRotate;return(0,a.tZ)(Q.Provider,{value:(0,c.useMemo)(function(){return{onClose:t,sourceType:n,sourceId:r,insertImage:o,setTabType:i,initLocalList:s,setInitLocalList:l,maxImage:d,imgAutoRotate:p}},[t,n,r,o,i,s,l,d,p]),children:u})},ee=function(e){var t=e.itemKey,n=(0,k.Z)(),r=(0,m.Q4)().trackEvent,a=J(),s=a.sourceId,l=a.sourceType,u=a.insertImage,d=a.onClose,f=(0,p._)((0,c.useState)([]),2),_=f[0],v=f[1],g=(0,p._)((0,c.useState)(!0),2),T=g[0],E=g[1],C=(0,p._)((0,c.useState)(!1),2),y=C[0],S=C[1],I=(0,p._)((0,c.useState)(!1),2),b=I[0],A=I[1],Z=(0,p._)((0,c.useState)(!1),2),w=Z[0],R=Z[1],N=(0,p._)((0,c.useState)("all"),2),O=N[0],x=N[1],P=(0,p._)((0,c.useState)(null),2),D=P[0],L=P[1],B=_.length&&_.every(function(e){return e.checked}),U=function(){E(!0),R(!1),A(!1),L(null),v([]),S(!1)},M=(0,h.Z)(function(e,t){if(E(!1),t)R(!0);else{var n;j.Z.alert((null==e?void 0:e.message)||(null==e?void 0:null===(n=e.error)||void 0===n?void 0:n.message)||"网络错误，稍后重试吧!")}}),G=(0,h.Z)(function(e){var t,n=(0,Y.camelizeKeys)(e.payload||{});E(!1),A(null==n?void 0:null===(t=n.paging)||void 0===t?void 0:t.isEnd),L(null==n?void 0:n.paging),v(function(e){return e.concat((null==n?void 0:n.data)||[])})}),F=(0,h.Z)(function(e){v(function(n){var r,o=(0,K._)(n),i=o.find(function(n){return e[t]===n[t]}),a=(null===(r=null==o?void 0:o.map(function(e){return null==e?void 0:e.checkedIndex}).sort(function(e,t){return t-e}))||void 0===r?void 0:r[0])||0;return i&&(i.checked=!i.checked,i.checked?i.checkedIndex=a+1:(o.forEach(function(e){(null==e?void 0:e.checkedIndex)>i.checkedIndex&&e.checkedIndex--}),delete i.checkedIndex)),o})});return{materialList:_,setMaterialList:v,paging:D,isLoading:T,setIsLoading:E,hasInited:y,setHasInited:S,isDrained:b,setIsDrained:A,isPageError:w,setIsPageError:R,subTypeCatch:O,setSubTypeCatch:x,selectAllChecked:B,toggleSelectAll:function(e){e&&r({action:"Unknown",eventType:"Click",elementLocation:{type:"Button",text:"本页全选"}}),v(function(t){return t.map(function(t,n){return(0,i._)((0,o._)({},t),{checked:e,checkedIndex:e?n+1:void 0})})})},reset:U,handleSubTypeChange:function(e){y&&e!==O&&(x(e),U())},handleResponseErrorData:M,handleResponseData:G,chooseImage:F,insertImages:(0,h.Z)(function(e){u(e.map(function(e){return e.origin})),n("".concat(location.origin,"/api/v4/materials/pc_editor/recently-materials"),{method:"POST",body:{source_type:l,source_id:String(s),material_type:"image",material_ids:e.map(function(e){return e.materialId})}}),d()})}},et=function(e){return(0,a.tZ)(E.Flex,(0,o._)({justifyContent:"space-between",css:{padding:"10px 20px 10px 8px"}},e))},en=function(e){return(0,a.tZ)("div",(0,i._)((0,o._)({css:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"}},e),{children:"加载中..."}))},er=function(e){return(0,a.tZ)(m.$U,(0,o._)({as:"button",zaType:"Button",zaText:!0,zaAction:"Unknown",css:{marginRight:"10px",padding:"7px 15px",fontSize:"14px",borderRadius:"3px","&:last-child":{marginRight:0}}},e))},eo=function(e){var t=e.active,n=(0,T._)(e,["active"]);return(0,a.tZ)(er,(0,o._)({css:function(e){return[{background:e.colorMod(e.colors.GBL01A).alpha(.3),color:e.colors.GBK99A,"&[disabled]":{opacity:.5,cursor:"default"}},t&&{background:e.colors.GBL01A}]}},n))},ei=function(e){return(0,a.tZ)(er,(0,o._)({css:function(e){return{background:e.colors.GBK10A,color:e.colors.GBK03A}}},e))},ea=function(e){return(0,a.tZ)(er,(0,o._)({css:function(e){return{background:e.colors.GBK10A,color:e.colors.GRD03A}}},e))},ec=function(e){return(0,a.tZ)("svg",(0,i._)((0,o._)({},e),{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 0C11.4477 0 11 0.447716 11 1V11H1C0.447715 11 0 11.4477 0 12C0 12.5523 0.447716 13 1 13H11V23C11 23.5523 11.4477 24 12 24C12.5523 24 13 23.5523 13 23V13H23C23.5523 13 24 12.5523 24 12C24 11.4477 23.5523 11 23 11H13V1C13 0.447715 12.5523 0 12 0Z",fill:"#999999"})}))},es=function(e){return(null==e?void 0:e.length)?e.sort(function(e,t){return(null==e?void 0:e.checkedIndex)-(null==t?void 0:t.checkedIndex)}):[]},el=function(e){var t=e.isPageError,n=e.keywordCatch,r=e.reset;return t?(0,a.tZ)(R.H.EI1A,{image:"loadingError",content:"网络连接失败",buttonText:"刷新页面",buttonOnClick:r}):(0,a.tZ)(R.H.EI1A,{image:"default",content:"没有找到".concat(n?"「"+n+"」":"","相关内容"),buttonText:"搜索其他内容",buttonOnClick:function(){var e;null===(e=document.querySelector(".materials_library_public_search"))||void 0===e||e.focus()}})},eu=function(e){var t=e.dataList,n=e.insertImages,r=(0,T._)(e,["dataList","insertImages"]),c=(t||[]).filter(function(e){return!0===e.checked});return(0,a.tZ)(E.Flex,(0,i._)((0,o._)({css:{padding:"13px 20px"},justifyContent:"flex-end"},r),{children:(0,a.tZ)(eo,{active:c.length>0,onClick:function(){n(es(c))},css:{margin:0},zaText:"插入图片；图片数：".concat(c.length||0),children:"插入图片"})}))},ed=function(e){var t=e.keywordCatch,n=(0,T._)(e,["keywordCatch"]),r=(0,k.Z)(),s=J(),l=s.insertImage,u=s.onClose,d=ee({itemKey:"id"}),p=d.materialList,f=d.paging,_=d.isLoading,m=d.setIsLoading,v=d.hasInited,g=d.setHasInited,C=d.isDrained,y=d.isPageError,S=d.setIsPageError,I=d.selectAllChecked,b=d.toggleSelectAll,A=d.reset,Z=d.handleResponseErrorData,w=d.handleResponseData,R=d.chooseImage,O=!p.length,x=(0,h.Z)(function(){return m(!0),S(!1),r((null==f?void 0:f.next)||(0,N.D)("".concat(location.origin,"/api/v4/materials/pc_editor/search"),{offset:null==p?void 0:p.length,limit:24,keyword:t||"表情包"}))}),P=(0,h.Z)(function(){return x().then(w).catch(function(e){Z(e.payload)})}),D=(0,h.Z)(function(e){l(e.map(function(e){return e.origin})),u()});(0,c.useEffect)(function(){v||x().then(w).catch(function(e){Z(e.payload,!0)}).finally(function(){g(!0)})},[v,g,x,w,Z]);var L=O?!_&&(0,a.tZ)(el,{isPageError:y,keywordCatch:t,reset:A}):(0,a.BX)(a.HY,{children:[(0,a.tZ)(V,{getContainer:function(e){return e},onLoad:P,isLoading:_,isDrained:C,children:p.map(function(e,t){return(0,a.tZ)(z,{data:e,insertImages:D,chooseImage:R},String([e.id,t]))})}),(0,a.tZ)(eu,{dataList:p,insertImages:D})]});return(0,a.BX)(E.Flex,(0,i._)((0,o._)({flexDirection:"column",color:"GBL05A",css:{height:"530px",fontSize:"12px"}},n),{children:[(0,a.BX)(et,{children:[(0,a.tZ)("div",{className:"MaterialLibrary-SearchTipsContainer",children:t&&!O&&!_&&!y&&(0,a.BX)(E.Box,{color:"GBK03A",width:"200px",css:{margin:"0px 12px",fontSize:"12px"},children:["以下为「",t,"」相关搜索内容"]})}),(0,a.tZ)(W,{checked:I,onChange:b})]}),v?L:(0,a.tZ)(en,{})]}))},ep="materialId",eh=function(e){var t=e.isPageError,n=e.reset,r=J().setTabType;return t?(0,a.tZ)(R.H.EI1A,{image:"loadingError",content:"网络连接失败",buttonText:"刷新页面",buttonOnClick:n}):(0,a.tZ)(R.H.EI1A,{image:"default",content:"最近使用为空，请搜索网络素材或上传图片",buttonText:"上传图片",buttonOnClick:function(){r(S.PRIVATE)}})},ef=function(e){var t=e.dataList,n=e.deleteImages,r=e.insertImages,c=(0,T._)(e,["dataList","deleteImages","insertImages"]),s=(t||[]).filter(function(e){return!0===e.checked});return(0,a.BX)(E.Flex,(0,i._)((0,o._)({css:{padding:"13px 20px"},justifyContent:s.length>0?"space-between":"flex-end"},c),{children:[s.length>0&&(0,a.tZ)(ea,{onClick:function(){0!==s.length&&j.Z.confirm((0,a.BX)("div",{className:"MaterialLibrary-alert",children:[(0,a.BX)("h2",{children:["是否删除已选择共 ",s.length," 张图片？"]}),(0,a.tZ)("p",{children:"插入至内容中的图片不会受到影响"})]}),{text:{ok:"删除",cancel:"取消"}}).then(function(){n(s.map(function(e){return e[ep]}))},function(){})},children:"删除图片"}),(0,a.tZ)(eo,{active:s.length>0,onClick:function(){r(es(s))},zaText:"插入图片；图片数：".concat(s.length||0),children:"插入图片"})]}))},e_=n(87376),em=n(29229),ev=n(95548),eg=n.n(ev),eT=n(36695),eE=n(17132),eC=n.n(eE),ey=n(67927),eS=n(48825),eI=n(38020),eb=n(82644),eA=n(44812),eZ=function(e){var t,n=e.data,r=e.deleteImage,i=e.reUploadImage,c=e.dragWrapRef,s=n||{},l=s.tag,u=s.index,d=(null==c?void 0:null===(t=c.current)||void 0===t?void 0:t.clientWidth)||746,p={cursor:"pointer",userDrag:"none",userSelect:"none",WebkitUserDrag:"none",WebkitUserSelect:"none"};return(0,a.BX)(E.Box,{id:l.originSrc+u,css:function(e){return(0,o._)({position:"relative",display:"inline-block",width:"105px",height:"105px",margin:"0 calc(".concat(d-655,"px / 12) 15px"),borderRadius:"2px",background:e.colors.GBK10C,"&:active":{filter:"drop-shadow(0px 3px 6px rgba(0, 0, 0, 0.15)) drop-shadow(0px 0px 4px rgba(0, 0, 0, 0.3))"}},"pending"===l.status&&p)},children:[(0,a.tZ)(E.Image,{src:l.originSrc,width:"100%",height:"100%",css:{borderRadius:"2px"},sx:{objectFit:"cover"}}),(0,a.BX)(E.Box,{css:function(e){return{position:"absolute",top:0,left:0,width:"105px",height:"105px",borderRadius:"2px",zIndex:2,backgroundColor:e.colorMod(e.colors.GBK02A).alpha("success"===l.status?0:.4),"& .CircleLoadingBar .path":{stroke:e.colors.GBK99A},"&:hover":{".close":{display:"block"}}}},children:["pending"===l.status&&(0,a.tZ)(eI.Z,{}),(0,a.tZ)(E.Box,{className:"close",css:function(e){return(0,o._)({position:"absolute",top:"-10px",right:"-9px",zIndex:3,width:"20px",height:"20px",lineHeight:"21px",fontSize:"15px",textAlign:"center",borderRadius:"50%",display:"none",backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.4),color:e.colors.GBK99A,"&>span":{marginLeft:"1px"}},p)},onClick:function(){return r(l,u)},children:(0,a.tZ)(eb.HN,{center:!0,width:"13px",height:"13px"})}),"error"===l.status&&(0,a.BX)(a.HY,{children:[(0,a.BX)(E.Flex,{fontSize:"15px",fontWeight:"400",height:"82px",color:"GBK99A",alignItems:"center",justifyContent:"center",css:p,onClick:function(){return i(l.file,u)},children:[(0,a.tZ)(eA.x,{width:"20px",height:"22px"}),(0,a.tZ)(E.Text,{ml:"3px",children:"重试"})]}),(0,a.tZ)(E.Box,{css:function(e){return{position:"absolute",bottom:0,left:0,zIndex:3,width:"100%",height:"23px",lineHeight:"23px",fontSize:"12px",fontWeight:400,textAlign:"center",backgroundColor:e.colorMod(e.colors.GBK99A).alpha(.8),color:e.colors.GRD03A,borderRadius:"0 0 1px 1px"}},children:"上传失败"})]})]})]},l.originSrc+u)},ew=n(91199),eR=function(e){var t=e.handleUploadImage,n=e.content,r=e.style,i=void 0===r?{}:r,s=e.isLocal,l=(0,c.useRef)(),u=(0,m.Q4)().trackEvent;return(0,a.BX)(a.HY,{children:[(0,a.tZ)("input",{css:{display:"none"},ref:l,type:"file",onChange:function(e){t(e),s&&(l.current.value=null);var n,r=e.target.files;(null==r?void 0:r.length)&&(null===(n=Array.from(r))||void 0===n||n.forEach(function(e){(0,O.loadImage)(window.URL.createObjectURL(e)).then(function(t){var n=t.height,r=t.width;u({eventType:"Click",action:"Upload",elementLocation:{type:"Button",moduleId:"image_upload"}},{configMap:{fileSize:String(e.size),imageWidth:String(r),imageHeight:String(n),imageFormat:e.name.split(".").pop(),pixels:String(n*r)}})})}))},accept:"image/*",multiple:!0}),(0,a.tZ)(m.$U,{zaType:"Button",zaText:"本地上传图片",as:E.Flex,role:"button",width:"92px",height:"32px",lineHeight:"32px",fontSize:"12px",color:"GBL05A",alignItems:"center",justifyContent:"center",ml:"19px",mb:"6px",onClick:function(){return l.current.click()},css:function(e){return(0,o._)({verticalAlign:"top",display:"inline-flex",cursor:"pointer",borderRadius:"2px",backgroundColor:e.colorMod(e.colors.GBL05A).alpha(.08)},i)},children:n||(0,a.BX)(a.HY,{children:[(0,a.tZ)(ew.We,{}),(0,a.tZ)(E.Text,{ml:"3px",mt:"2px",children:"本地上传"})]})})]})},eN=function(e){var t=e.handleUploadImage,n=(0,T._)(e,["handleUploadImage"]);return(0,a.tZ)(E.Flex,(0,i._)((0,o._)({},n),{height:"100%",alignItems:"center",justifyContent:"center",children:(0,a.BX)(E.Box,{textAlign:"center",children:[(0,a.tZ)(eR,{handleUploadImage:t,style:{width:"104px",height:"104px",border:"1px dashed #d3d3d3",margin:0,background:"transparent",borderRadius:"8px","&:hover":{background:"rgba(246, 246, 246, 0.3)"}},content:(0,a.tZ)(ec,{})}),(0,a.tZ)(E.Text,{color:"GBK02A",fontSize:"14px",fontWeight:"500",mt:"10px",children:"上传图片"}),(0,a.tZ)(E.Text,{color:"GBK06A",fontSize:"12px",mt:"4px",children:"支持 JPG、JPEG、PNG 等格式"})]})}))},ek=function(e){var t=e.src,n=e.originalSrc,r=e.watermarkSrc,o=e.privateWatermarkSrc,i=e.watermark,a=e.dataRawwidth,c=e.dataRawheight,s=e.hash,l=(0,O.imgUrl)(t,{quality:eC()(navigator.userAgent).Mobile?50:80,size:window.devicePixelRatio>=1.5?"1440w":"720w"});return{src:l,url:l,originalSrc:n,watermarkSrc:r,privateWatermarkSrc:o,watermark:i,rawWidth:a,rawHeight:c,id:s}},eO=function(e){var t=e.dataList,n=e.insertImages,r=e.onClose,c=e.maxImage,s=(0,T._)(e,["dataList","insertImages","onClose","maxImage"]),l=!!c&&t.length>c;return(0,a.BX)(E.Flex,(0,i._)((0,o._)({css:{padding:"13px 20px",position:"relative"},alignItems:"center",justifyContent:"flex-end"},s),{children:[c&&(null==t?void 0:t.length)>0&&(0,a.BX)(E.Box,{css:{position:"absolute",left:20,top:20,display:"flex"},color:"GBK03A",fontSize:"13px",children:[(0,a.tZ)(E.Text,{css:{color:l&&"red"},children:t.length}),"/",c,(0,a.BX)(E.Text,{css:{opacity:.9,marginLeft:5},children:["(最多上传 ",c," 张图片)"]})]}),(null==t?void 0:t.length)>0&&(0,a.BX)(E.Text,{color:"GBK03A",fontSize:"14px",fontWeight:"400",mr:"10px",children:["已上传 ",t.length," 张图片，拖拽可调整顺序"]}),(0,a.tZ)(eo,{active:t.length>0,onClick:function(){n(t.map(function(e){return e.data||{}}),!0),r()},disabled:l,zaText:"插入图片；图片数：".concat(t.length||0),children:"插入图片"})]}))},ex=function(e){var t=e.handleUploadImage,n=e.errorList,r=e.reUpload;return(0,a.BX)(E.Flex,{alignItems:"center",justifyContent:"space-between",children:[(0,a.tZ)(eR,{handleUploadImage:t,style:{margin:"5px 0 4px 20px",height:"32px"},isLocal:!0}),(null==n?void 0:n.length)>0&&(0,a.BX)(E.Flex,{alignItems:"center",mr:"20px",mt:"1px",fontSize:"14px",children:[(0,a.BX)(E.Text,{color:"GRD03A",children:[n.length," 张上传失败"]}),(0,a.tZ)(E.Text,{css:function(e){return{width:"114px",height:"32px",lineHeight:"32px",marginLeft:"10px",borderRadius:"3px",cursor:"pointer",background:e.colors.GBK10A,color:e.colors.GBL01A,fontWeight:500,textAlign:"center"}},onClick:r,children:"批量重新上传"})]})]})},eP=function(){var e=((0,em.Z)(function(){return n.e(5389).then(n.t.bind(n,50526,23))})||{}).DraggableArea,t=(0,c.useRef)(),r=(0,eT.useDispatch)(),s=J().sourceType,l=J(),u=l.insertImage,d=l.onClose,h=l.initLocalList,f=l.setInitLocalList,_=l.maxImage,m=l.imgAutoRotate,v=(0,p._)((0,c.useState)(h||[]),2),g=v[0],T=v[1],C=(0,c.useRef)(g);(0,c.useEffect)(function(){C.current=g},[g]),(0,c.useEffect)(function(){return T(h),function(){var e;f(null===(e=C.current)||void 0===e?void 0:e.map(function(e){return(0,o._)({},e,"pending"===e.status&&{status:"error"})}))}},[]);var y=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.findIndex(function(e){return e.id===t}),i=(0,K._)(e);return -1!==r&&i.splice(r,1,(0,o._)({},e[r],n)),i},S=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e){var a=(null==n?void 0:n.isUpload)?null==n?void 0:n.imageList:g;a.splice(t,1,(0,i._)((0,o._)({},a[t]),{status:"pending"})),T(function(){return(0,K._)(a)}),r((0,eS.Ix)(e,"default",s,m)).then(function(e){var n=e.payload;T(function(e){var r;return y(e,null===(r=a[t])||void 0===r?void 0:r.id,{data:ek(n),status:"success"})})}).catch(function(){T(function(e){var n;return y(e,null===(n=a[t])||void 0===n?void 0:n.id,{status:"error"})})})}},I=function(e,t){var n=t.length-1;S(t[n].file,n,{isUpload:!0,imageList:t})},b=function(e){var t,n=e.target.files;if(null==n?void 0:n.length){if((null==n?void 0:n.length)>100){j.Z.alert("添加图片请不要超过 100 张哦~");return}null===(t=Array.from(n))||void 0===t||t.forEach(function(e){(0,e_.fs)({file:e,preset:e_.PG.content}).then(function(){T(function(t){var r=(0,K._)(t).concat([{originSrc:window.URL.createObjectURL(e),status:"pending",id:eg()("image"),file:e}]);return I(n,r),r})}).catch(function(e){r((0,ey.c0)(e.message||"图片上传未完成，请稍后发布","red"))})})}},A=function(e,t){var n=(0,K._)(g);n.splice(t,1),T(n)},Z=function(e){var t=[];return null==e||e.forEach(function(e,n){"error"===e.status&&t.push((0,i._)((0,o._)({},e),{index:n}))}),t};return(null==g?void 0:g.length)?(0,a.BX)(a.HY,{children:[(0,a.tZ)(ex,{handleUploadImage:b,errorList:Z(g),reUpload:function(){var e;null===(e=Z(g))||void 0===e||e.forEach(function(e){return S(e.file,e.index)})}}),(0,a.tZ)(E.Box,{ref:t,css:{position:"relative",width:"100%",height:"505px",overflowY:"scroll",padding:"10px 12.5px 16px",lineHeight:"0.8"},children:e?(0,a.tZ)(e,{tags:g.map(function(e){return(0,i._)((0,o._)({},e),{id:"".concat(e.id,"_").concat(e.status)})}),render:function(e){return(0,a.tZ)(eZ,{data:e,deleteImage:A,reUploadImage:S,dragWrapRef:t})},onChange:function(e){T(e.map(function(e){var t,n;return(0,i._)((0,o._)({},e),{id:(null===(t=null===(n=e.id)||void 0===n?void 0:n.split("_"))||void 0===t?void 0:t[0])||eg()("image")})}))}}):g.map(function(e,n){return(0,a.tZ)(eZ,{data:{tag:e,index:n},deleteImage:A,reUploadImage:S,dragWrapRef:t},"".concat(e.id,"_").concat(n))})}),(0,a.tZ)(eO,{dataList:g.filter(function(e){return"success"===e.status}),onClose:d,insertImages:u,maxImage:_})]}):(0,a.tZ)(eN,{css:{marginTop:"-20px"},handleUploadImage:b})},eD=n(33961),eL=n(71746),eB=n(45001),eU=function(e){var t=(0,k.Z)(),n=(0,p._)((0,c.useState)({}),2),r=n[0],o=n[1],i=(0,p._)((0,c.useState)(!1),2),a=i[0],s=i[1],l=(0,p._)((0,c.useState)(""),2),u=l[0],d=l[1],f=(0,p._)((0,c.useState)(!1),2),_=f[0],m=f[1],v=(0,h.Z)(function(){m(!1),o({}),s(!1)}),g=(0,h.Z)(function(){return t("".concat(location.origin,"/api/v4/materials/pc_editor/folders?type=").concat(e,"&material_type=image")).then(function(e){var t,n=(0,Y.camelizeKeys)((null===(t=e.payload)||void 0===t?void 0:t.data)||{});return o(n),n})});return(0,c.useEffect)(function(){a||g().then(function(e){var t,n;d(null==e?void 0:null===(t=e.child)||void 0===t?void 0:null===(n=t[0])||void 0===n?void 0:n.id)}).catch(function(){m(!0)}).finally(function(){s(!0)})},[a,g]),{hasInited:a,isPageError:_,setIsPageError:m,reset:v,folders:r,getFoldersList:g,activeFolderId:u,setActiveFolderId:d}},eM=n(93975),eG=n(19760),eF=n(51695),ez=n(55890),eH=n(67814),eq=n.n(eH),eV=function(e){var t=e.type,n=e.className,r=e.inputShowName,o=e.resetInput,i=e.folderId,s=e.getFoldersList,l=(0,k.Z)(),u=(0,c.useRef)(),d=(0,p._)((0,c.useState)(void 0===r?"":r),2),h=d[0],f=d[1],_=function(){"add"!==t&&h&&l("".concat(location.origin,"/api/v4/materials/pc_editor/folders/").concat(i),{method:"PUT",body:{name:h}}).then(function(){var e;null===(e=u.current)||void 0===e||e.blur(),s&&s()}).catch(function(e){var t,n,r;j.Z.alert((null===(t=e.payload)||void 0===t?void 0:t.message)||(null===(n=e.payload)||void 0===n?void 0:null===(r=n.error)||void 0===r?void 0:r.message)||"网络错误，稍后重试吧!")})};return(0,a.tZ)("input",{ref:u,type:"text",className:eq()("MaterialLibrary-input-module",n),placeholder:"请输入文件名称",autoFocus:"autofocus",onChange:function(e){f(e.target.value)},value:h,onBlur:function(){o&&o(""),_()},onKeyUp:function(e){if(13===e.keyCode){var t;null===(t=u.current)||void 0===t||t.blur()}}})};eV.propTypes={inputShowName:_().string,resetInput:_().func};var eX=function(e){return(0,a.tZ)(m.$U,(0,o._)({as:E.Flex,zaType:"Button",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",css:function(e){return{borderRadius:"12px",backgroundColor:e.colors.GBK99A,cursor:"pointer","&+&":{marginLeft:"4px"}}}},e))},eW=function(e){var t,n=e.folders,r=void 0===n?{}:n,o=e.activeFolderId,i=e.getFoldersList,s=e.folderClick,l=e.reset,u=(0,k.Z)(),d=(0,p._)((0,c.useState)(""),2),h=d[0],f=d[1],_=(0,p._)((0,c.useState)(""),2),m=_[0],v=_[1],g=function(e,t){"nav-edit"===e?(f(t.id),v(t.name)):"nav-delete"===e&&j.Z.confirm((0,a.BX)("div",{className:"MaterialLibrary-alert",children:[(0,a.tZ)("h2",{children:"是否删除已选择分类？"}),(0,a.tZ)("p",{children:"分类中的图片将归入未分类中"})]}),{text:{ok:"删除",cancel:"取消"}}).then(function(){u("".concat(location.origin,"/api/v4/materials/pc_editor/folders/").concat(t.id),{method:"DELETE",body:{delete_material:!1}}).then(function(e){var t,n;(null===(t=e.payload)||void 0===t?void 0:t.success)?(j.Z.alert("已成功删除分组，该分组的图片已移动至「我的图片-未分类」"),l()):j.Z.alert((null===(n=e.payload)||void 0===n?void 0:n.message)||"网络错误，稍后重试吧！")})},function(){})};return(null==r?void 0:r.hidden)?null:(0,a.BX)("div",{className:"MaterialLibraryNav",children:[(0,a.BX)("div",{className:"MaterialLibraryNav-nav",children:[(0,a.BX)(E.Flex,{className:"MaterialLibraryNav-Mine",justifyContent:"space-between",alignItems:"center",children:[(0,a.BX)(E.Flex,{justifyContent:"space-between",alignItems:"center",children:[(0,a.tZ)(eM.y,{className:"nav-icon"}),null==r?void 0:r.name]}),(0,a.tZ)("div",{className:"nav-num",children:null==r?void 0:r.materialCount})]}),null==r?void 0:null===(t=r.child)||void 0===t?void 0:t.map(function(e){return(0,a.BX)(E.Flex,{className:eq()("MaterialLibraryNav-Folder",{active:o===e.id}),justifyContent:"space-between",alignItems:"center",onClick:function(){s(e.id)},children:[(0,a.BX)(E.Flex,{justifyContent:"space-between",alignItems:"center",children:[(0,a.tZ)(eG._,{className:"nav-icon"}),h!==e.id&&(0,a.tZ)("div",{className:"nav-name",children:e.name})]}),h!==e.id&&(0,a.tZ)("div",{className:eq()("nav-num",{"disable-hover":!e.supportEdit&&!e.supportDelete}),children:e.materialCount||0}),h!==e.id&&(e.supportEdit||e.supportDelete)&&(0,a.BX)(E.Flex,{className:"nav-handle",children:[e.supportEdit&&(0,a.tZ)(eX,{zaText:"编辑",onClick:function(t){t.stopPropagation(),g("nav-edit",e)},children:(0,a.tZ)(eF.yc,{fill:"currentColor",size:10})}),e.supportDelete&&(0,a.tZ)(eX,{zaText:"删除",onClick:function(t){t.stopPropagation(),g("nav-delete",e)},children:(0,a.tZ)(eb.HN,{fill:"currentColor",size:10})})]}),h===e.id&&(0,a.tZ)(eV,{folderId:e.id,inputShowName:m,getFoldersList:i,resetInput:function(e){f(e)}})]},e.id)})]}),(0,a.BX)(E.Flex,{className:"MaterialLibraryNav-Add",justifyContent:"space-between",alignItems:"center",onClick:function(){var e;if((null==r?void 0:null===(e=r.child)||void 0===e?void 0:e.length)>15){j.Z.alert("分组已达上限，请删除已有的分类后再行添加");return}j.Z.confirm((0,a.BX)("div",{className:"MaterialLibrary-alert",children:[(0,a.tZ)("h2",{children:"添加分类"}),(0,a.tZ)(eV,{type:"add",className:"MaterialLibraryNav-input-module"})]}),{text:{ok:"添加",cancel:"取消"}}).then(function(){var e,t=null===(e=document.querySelector(".MaterialLibrary-input-module"))||void 0===e?void 0:e.value;u("".concat(location.origin,"/api/v4/materials/pc_editor/folders"),{method:"POST",body:{name:t,material_type:"image"}}).then(function(){i()}).catch(function(e){var t,n,r;j.Z.alert((null===(t=e.payload)||void 0===t?void 0:t.message)||(null===(n=e.payload)||void 0===n?void 0:null===(r=n.error)||void 0===r?void 0:r.message)||"网络错误，稍后重试吧!")})},function(){})},children:[(0,a.tZ)(ez.dU,{className:"nav-icon"}),"添加分类"]})]})};eW.propTypes={folders:_().object,getFoldersList:_().func,folderClick:_().func};var eK="uniqueId",ej=function(e){var t=e.isPageError,n=e.handleUploadImage,r=e.reset;return t?(0,a.tZ)(a.HY,{children:(0,a.tZ)(R.H.EI1A,{image:"loadingError",content:"网络连接失败",buttonText:"刷新页面",buttonOnClick:r})}):(0,a.tZ)(eN,{css:{marginTop:"-50px"},handleUploadImage:n})},eY=function(e){var t=e.dataList,n=e.activeFolderId,r=e.folders,s=e.getFoldersList,l=e.insertImages,u=(0,T._)(e,["dataList","activeFolderId","folders","getFoldersList","insertImages"]),d=(0,k.Z)(),p=(t||[]).filter(function(e){return!0===e.checked}),h=(0,c.useMemo)(function(){var e;return null==r?void 0:null===(e=r.child)||void 0===e?void 0:e.filter(function(e){return e.id!==n})},[r,n]);return(0,a.BX)(E.Flex,(0,i._)((0,o._)({css:{padding:"13px 20px"},justifyContent:p.length>0?"space-between":"flex-end"},u),{children:[p.length>0&&(0,a.tZ)(ea,{onClick:function(){0!==p.length&&j.Z.confirm((0,a.BX)("div",{className:"MaterialLibrary-alert",children:[(0,a.BX)("h2",{children:["是否删除已选择共 ",p.length," 张图片？"]}),(0,a.tZ)("p",{children:"插入至内容中的图片不会受到影响"})]}),{text:{ok:"删除",cancel:"取消"}}).then(function(){d("".concat(location.origin,"/api/v4/materials/pc_editor/folders/").concat(n,"/materials"),{method:"DELETE",body:{material_type:"image",folder_material_ids:p.map(function(e){return e[eK]})}}).then(function(e){var t,n;(null===(t=e.payload)||void 0===t?void 0:t.success)?s():j.Z.alert((null===(n=e.payload)||void 0===n?void 0:n.message)||"网络错误，稍后重试吧！")})},function(){})},children:"删除图片"}),(0,a.BX)(E.Box,{children:[p.length>0&&(null==h?void 0:h.length)>0&&(0,a.tZ)(ei,{css:{width:"86px"},onClick:function(){if(0!==p.length){var e=h[0].id;j.Z.confirm((0,a.BX)("div",{className:"MaterialLibrary-alert",children:[(0,a.BX)("h2",{children:["为已选择共 ",p.length," 张图片分类"]}),(0,a.tZ)(eB.Z,{buttonClassName:"MaterialLibraryContent-select",listClassName:"MaterialLibraryContent-option",value:n,onChange:function(t){e=t},children:h.map(function(e){var t=e.name,n=e.id;return(0,a.tZ)(eB.W,{value:n,text:t,children:t},n)})})]}),{text:{ok:"确定",cancel:"取消"}}).then(function(){d("".concat(location.origin,"/api/v4/materials/pc_editor/material-move"),{method:"POST",body:{folder_id:n,target_folder_id:e,folder_material_ids:p.map(function(e){return e[eK]})}}).then(function(e){var t,n;(null===(t=e.payload)||void 0===t?void 0:t.success)?s():j.Z.alert((null===(n=e.payload)||void 0===n?void 0:n.message)||"网络错误，稍后重试吧！")})},function(){})}},children:"移动"}),(0,a.tZ)(eo,{active:p.length>0,onClick:function(){l(es(p))},zaText:"插入图片；图片数：".concat(p.length||0),children:"插入图片"})]})]}))},eQ=function(e){var t=e.activeFolderId,n=e.getFoldersList,r=e.folders,o=(0,k.Z)(),i=(0,eT.useDispatch)(),s=ee({itemKey:eK}),l=s.materialList,u=s.paging,d=s.isLoading,p=s.setIsLoading,f=s.hasInited,_=s.setHasInited,m=s.isDrained,v=s.isPageError,g=s.setIsPageError,T=s.selectAllChecked,C=s.toggleSelectAll,y=s.reset,S=s.handleResponseErrorData,I=s.handleResponseData,b=s.chooseImage,A=s.insertImages,Z=!l.length,w=(0,h.Z)(function(){return p(!0),g(!1),o((null==u?void 0:u.next)||(0,N.D)("".concat(location.origin,"/api/v4/materials/pc_editor/folders/").concat(t,"/materials"),{offset:null==l?void 0:l.length,limit:24}))}),R=(0,h.Z)(function(){return w().then(I).catch(function(e){S(e.payload)})}),O=function(e){o("".concat(location.origin,"/api/v4/materials/pc_editor/folders/").concat(t,"/materials"),{method:"POST",body:{material_type:"image",materials:e}}).then(function(e){var t,r;(null===(t=e.payload)||void 0===t?void 0:t.success)?n():j.Z.alert((null===(r=e.payload)||void 0===r?void 0:r.message)||"网络错误，稍后重试吧！")}).catch(function(e){var t,n,r;j.Z.alert((null===(t=e.payload)||void 0===t?void 0:t.message)||(null===(n=e.payload)||void 0===n?void 0:null===(r=n.error)||void 0===r?void 0:r.message)||"网络错误，稍后重试吧!")})},x=function(e){var t=e.target.files;if(null==t?void 0:t.length){if((null==t?void 0:t.length)>100){j.Z.alert("添加图片请不要超过 100 张哦~");return}var n=[],r=!0,o=!1,a=void 0;try{for(var c,s=t[Symbol.iterator]();!(r=(c=s.next()).done);r=!0)!function(){var e=c.value;(0,e_.fs)({file:e,preset:e_.PG.content}).then(function(){(0,eD.Z)(e).then(function(r){(0,eL.Z)(r).then(function(r){(n=n.concat({name:null==e?void 0:e.name,source:null==r?void 0:r.original_hash})).length===t.length&&O(n)})})}).catch(function(e){i((0,ey.c0)(e.message||"图片上传未完成，请稍后发布","red"))})}()}catch(e){o=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}}};(0,c.useEffect)(function(){!f&&t&&w().then(I).catch(function(e){S(e.payload,!0)}).finally(function(){_(!0)})},[f,_,t,w,I,S]);var P=Z?!d&&(0,a.tZ)(ej,{handleUploadImage:x,isPageError:v,reset:y}):(0,a.BX)(a.HY,{children:[(0,a.tZ)(E.Box,{mt:"-36px",width:"100px",children:(0,a.tZ)(eR,{handleUploadImage:x},l.length)}),(0,a.tZ)(V,{getContainer:function(e){return e},onLoad:R,isLoading:d,isDrained:m,css:{marginLeft:"-14px"},children:l.map(function(e,t){return(0,a.tZ)(z,{data:e,chooseImage:b,insertImages:A,isPrivate:!0},String([e[eK],t]))})}),(0,a.tZ)(eY,{dataList:l,folders:r,activeFolderId:t,getFoldersList:n,insertImages:A})]});return(0,a.BX)(a.HY,{children:[(0,a.tZ)(et,{children:(0,a.tZ)(W,{css:{marginLeft:"auto"},checked:T,onChange:C})}),f?P:(0,a.tZ)(en,{})]})},eJ=n(44066),e$=n(61533),e0=n(95377),e1=function(e){var t=e.onSearch,n=(0,T._)(e,["onSearch"]),r=(0,p._)((0,c.useState)(""),2),i=r[0],s=r[1],l=(0,p._)((0,c.useState)(null),2),u=l[0],d=l[1];return(0,c.useEffect)(function(){d(document.querySelector(".MaterialLibrary-SearchInputContainer"))},[]),u&&(0,e$.createPortal)((0,a.tZ)(e0.Z,(0,o._)({className:"materials_library_public_search",onChange:function(e){return s(e.target.value)},value:i,after:(0,a.tZ)(eJ.J7,{text:!0,onClick:function(){t(i)}}),onKeyUp:function(e){13===e.keyCode&&t(i)},css:function(e){return{width:"198px",height:"28px",lineHeight:"28px",fontSize:"12px",color:e.colors.GBL05A,backgroundColor:e.colors.GBK99A,border:"1px solid",borderColor:e.colors.GBK08A}}},n)),u)};_().string,_().func;var e2="uniqueId",e3=function(e){var t=e.isPageError,n=e.keywordCatch,r=e.reset;return t?(0,a.tZ)(R.H.EI1A,{image:"loadingError",content:"网络连接失败",buttonText:"刷新页面",buttonOnClick:r}):(0,a.tZ)(R.H.EI1A,{image:"default",content:"没有找到".concat(n?"「"+n+"」":"","相关内容"),buttonText:"搜索其他内容",buttonOnClick:function(){var e;null===(e=document.querySelector(".materials_library_public_search"))||void 0===e||e.focus()}})},e4=function(e){var t=e.dataList,n=e.insertImages,r=(0,T._)(e,["dataList","insertImages"]),c=(t||[]).filter(function(e){return!0===e.checked});return(0,a.tZ)(E.Flex,(0,i._)((0,o._)({css:{padding:"13px 20px"},justifyContent:"flex-end"},r),{children:(0,a.tZ)(eo,{active:c.length>0,onClick:function(){n(es(c))},zaText:"插入图片；图片数：".concat(c.length||0),children:"插入图片"})}))},e5=function(e){var t=e.keywordCatch,n=e.activeFolderId,r=J(),o=r.sourceId,i=r.sourceType,s=(0,k.Z)(),l=ee({itemKey:e2}),u=l.materialList,d=l.paging,p=l.isLoading,f=l.setIsLoading,_=l.hasInited,m=l.setHasInited,v=l.isDrained,g=l.isPageError,T=l.setIsPageError,C=l.subTypeCatch,y=(l.handleSubTypeChange,l.selectAllChecked),S=l.toggleSelectAll,I=l.reset,b=l.handleResponseErrorData,A=l.handleResponseData,Z=l.chooseImage,w=l.insertImages,R=!u.length,O=(0,h.Z)(function(){return f(!0),T(!1),s((null==d?void 0:d.next)||(0,N.D)("".concat(location.origin,"/api/v4/materials/pc_editor/folders/").concat(n,"/search"),{offset:null==u?void 0:u.length,limit:24,keyword:t,source_type:i,source_id:o,sub_type:C}))}),x=(0,h.Z)(function(){return O().then(A).catch(function(e){b(e.payload)})});(0,c.useEffect)(function(){!_&&n&&O().then(A).catch(function(e){b(e.payload,!0)}).finally(function(){m(!0)})},[_,n,m,O,A,b]);var P=R?!p&&(0,a.tZ)(e3,{isPageError:g,keywordCatch:t,reset:I}):(0,a.BX)(a.HY,{children:[(0,a.tZ)(V,{getContainer:function(e){return e},onLoad:x,isLoading:p,isDrained:v,children:u.map(function(e,t){return(0,a.tZ)(z,{data:e,insertImages:w,chooseImage:Z},String([e[e2],t]))})}),(0,a.tZ)(e4,{dataList:u,insertImages:w})]});return(0,a.BX)(a.HY,{children:[(0,a.BX)(et,{children:[(0,a.BX)("div",{className:"MaterialLibrary-SearchTipsContainer",children:[!1,t&&!R&&!p&&!g&&(0,a.BX)(E.Box,{color:"GBK03A",width:"200px",css:{margin:"0px 12px",fontSize:"12px"},children:["以下为「",t,"」相关搜索内容"]})]}),(0,a.tZ)(W,{checked:y,onChange:S})]}),_?P:(0,a.tZ)(en,{})]})},e6=(r={},(0,g._)(r,S.LOCAL,function(e){var t=(0,Z._)({},(0,w._)(e));return(0,a.tZ)(a.HY,{children:(0,a.tZ)(E.Flex,(0,i._)((0,o._)({flexDirection:"column",color:"GBL05A",css:{height:"530px",fontSize:"12px"}},t),{children:(0,a.tZ)(eP,(0,o._)({},t))}))})}),(0,g._)(r,S.EMOTICON,function(e){var t=(0,Z._)({},(0,w._)(e)),n=(0,p._)((0,c.useState)(""),1)[0];return(0,a.tZ)(a.HY,{children:(0,a.tZ)(ed,(0,o._)({keywordCatch:n},t),n)})}),(0,g._)(r,S.PUBLIC,function(e){var t=(0,Z._)({},(0,w._)(e)),n=(0,p._)((0,c.useState)(""),2),r=n[0],s=n[1],l=eU(S.PUBLIC),u=l.hasInited,d=l.reset,h=l.isPageError,f=l.activeFolderId,_=h?(0,a.tZ)(e3,{isPageError:!0,reset:d}):(0,a.tZ)(e5,(0,o._)({keywordCatch:r,activeFolderId:f},t),r);return(0,a.BX)(a.HY,{children:[(0,a.tZ)(e1,{placeholder:"搜索网络素材库",onSearch:s}),(0,a.tZ)(E.Flex,(0,i._)((0,o._)({flexDirection:"column",color:"GBL05A",css:{height:"530px",fontSize:"12px"}},t),{children:u?_:(0,a.tZ)(en,{css:{marginTop:42}})}))]})}),(0,g._)(r,S.PRIVATE,function(e){var t,n=(0,Z._)({},(0,w._)(e)),r=eU(S.PRIVATE),c=r.hasInited,s=r.getFoldersList,l=r.reset,u=r.isPageError,d=r.folders,p=r.activeFolderId,h=r.setActiveFolderId,f=null===(t=d.child)||void 0===t?void 0:t.find(function(e){return e.id===p}),_=u?(0,a.tZ)(ej,{isPageError:!0,reset:l}):(0,a.tZ)(eQ,(0,o._)({folders:d,activeFolderId:p,getFoldersList:s},n),String([p,null==f?void 0:f.materialCount]));return(0,a.BX)(E.Flex,{color:"GBL05A",css:{height:"530px",overflow:"hidden",fontSize:"12px"},children:[!u&&(0,a.tZ)(eW,{folders:d,activeFolderId:p,folderClick:function(e){p!==e&&h(e)},getFoldersList:s,reset:l}),(0,a.tZ)(E.Flex,(0,i._)((0,o._)({flexDirection:"column",color:"GBL05A",css:{height:"530px",fontSize:"12px",flex:1}},n),{children:c?_:(0,a.tZ)(en,{css:{marginTop:42}})}))]})}),(0,g._)(r,S.LATEST,function(e){var t=(0,Z._)({},(0,w._)(e)),n=(0,k.Z)(),r=ee({itemKey:ep}),s=r.materialList,l=r.paging,u=r.isLoading,d=r.setIsLoading,p=r.hasInited,f=r.setHasInited,_=r.isDrained,m=r.isPageError,v=r.setIsPageError,g=r.selectAllChecked,T=r.toggleSelectAll,C=r.reset,y=r.handleResponseErrorData,S=r.handleResponseData,I=r.chooseImage,b=r.insertImages,A=!s.length,R=(0,h.Z)(function(){return d(!0),v(!1),n((null==l?void 0:l.next)||(0,N.D)("".concat(location.origin,"/api/v4/materials/pc_editor/recently-materials"),{offset:null==s?void 0:s.length,limit:24,material_type:"image"}))}),O=(0,h.Z)(function(){return R().then(S).catch(function(e){y(e.payload)})}),x=(0,h.Z)(function(e){return n("".concat(location.origin,"/api/v4/materials/pc_editor/recently-materials"),{method:"DELETE",body:{material_type:"image",material_ids:e}}).then(function(e){var t,n;(null===(t=e.payload)||void 0===t?void 0:t.success)?C():j.Z.alert((null===(n=e.payload)||void 0===n?void 0:n.message)||"网络错误，稍后重试吧！")})}),P=(0,h.Z)(function(e){j.Z.confirm((0,a.BX)("div",{className:"MaterialLibrary-alert",children:[(0,a.tZ)("h2",{children:"是否从最近使用删除图片？"}),(0,a.tZ)("p",{children:"插入至内容中的图片不会受到影响"})]}),{text:{ok:"删除",cancel:"取消"}}).then(function(){x([e[ep]])},function(){})});(0,c.useEffect)(function(){p||R().then(S).catch(function(e){y(e.payload,!0)}).finally(function(){f(!0)})},[p,f,R,S,y]);var D=A?!u&&(0,a.tZ)(eh,{isPageError:m,reset:C}):(0,a.BX)(a.HY,{children:[(0,a.tZ)(V,{getContainer:function(e){return e},onLoad:O,isLoading:u,isDrained:_,children:s.map(function(e,t){return(0,a.tZ)(z,{data:e,chooseImage:I,insertImages:b,deleted:e.deleted,deleteSingleImage:P},String([e[ep],t]))})}),(0,a.tZ)(ef,{dataList:s,deleteImages:x,insertImages:b})]});return(0,a.BX)(E.Flex,(0,i._)((0,o._)({flexDirection:"column",color:"GBL05A",css:{height:"530px",fontSize:"12px"}},t),{children:[(0,a.tZ)(et,{children:(0,a.tZ)(W,{css:{marginLeft:"auto"},checked:g,onChange:T})}),p?D:(0,a.tZ)(en,{})]}))}),r),e7=function(e){var t=e.onClose,n=e.sourceType,r=e.sourceId,o=e.insertImage,i=e.maxImage,s=e.tabs,l=e.imgAutoRotate,u=e.initImage,d=(0,p._)((0,c.useState)(S.LOCAL),2),h=d[0],f=d[1],_=(0,p._)((0,c.useState)(void 0===u?[]:u),2),v=_[0],g=_[1],T=e6[h];return(0,c.useEffect)(function(){var e=function(e){return e.preventDefault()};return document.addEventListener("drop",e,!1),document.addEventListener("dragover",e,!1),function(){document.removeEventListener("drop",e,!1),document.removeEventListener("dragover",e,!1)}},[]),(0,a.tZ)($,{onClose:t,sourceType:n,sourceId:r,insertImage:o,setTabType:f,initLocalList:v,setInitLocalList:g,maxImage:i,imgAutoRotate:l,children:(0,a.BX)("div",{children:[(0,a.tZ)(A,{tabType:h,tabChange:f,tabs:s}),T&&(0,a.tZ)(m.eV,{block:h,children:(0,a.tZ)(T,{})})]})})};e7.propTypes={sourceType:_().string,sourceId:_().number,onClose:_().func,insertImage:_().func,imgAutoRotate:_().bool};var e8=function(e,t){var n=e.sourceType,r=e.sourceId,o=e.insertImage,i=e.maxImage,s=e.tabs,l=e.initImage,u=e.imgAutoRotate,d=(0,p._)((0,c.useState)(!1),2),f=d[0],_=d[1],g=(0,h.Z)(function(){return _(function(e){return!e})});return(0,c.useImperativeHandle)(t,function(){return{toggleShown:g}},[g]),(0,a.tZ)(v.Z,{css:{minWidth:"746px",".Modal-content":{margin:0,padding:0}},onClose:g,children:f&&(0,a.tZ)(m.eV,{block:"MaterialLibrary",children:(0,a.tZ)(e7,{onClose:g,sourceType:n,sourceId:r,insertImage:o,maxImage:i,tabs:s,initImage:l,imgAutoRotate:u})})})};e8.propType={sourceType:_().string.isRequired,sourceId:_().number.isRequired,insertImage:_().func.isRequired};var e9=(0,c.forwardRef)(e8),te=function(e){var t=e.sourceType,n=e.sourceId,r=s().createRef(null),c={},p=!1,h=null,f=function(e){p=!0,h=c.getEditorState(),e(),c.setEditorState(h),p=!1},_=function(e,t,n){p?h=(0,d.Z)(h,"image","IMMUTABLE",(0,i._)((0,o._)({},t?null==e?void 0:e.value:{upload:e}),{size:"normal"}),void 0,{isBatched:!0,isLastOneOfBatch:n}):c.setEditorState((0,d.Z)(c.getEditorState(),"image","IMMUTABLE",{upload:e,size:"normal"}))};return{initialize:function(e){Object.assign(c,e)},components:[(0,a.tZ)(e9,{ref:r,sourceType:t,sourceId:n,insertImage:function(e,t){f(function(){for(var n=0;n<e.length;n++){var r=n===e.length-1;_({value:e[n]},t,r)}})}},"material_library")],handleCommand:function(e){if("insert-image-from-library"===e){var t;return null===(t=r.current)||void 0===t||t.toggleShown(),"handled"}return"not-handled"},toolbar:{label:"插入图片",section:u.Z.BASIC_MEDIA,text:"图片",icon:eM.y,priority:2,onClick:function(){var e;null===(e=r.current)||void 0===e||e.toggleShown()}},toolbarV2:[{label:"插入图片",section:l.Z.BASIC_MEDIA,text:"图片",icon:eM.y,priority:2,onClick:function(){var e;null===(e=r.current)||void 0===e||e.toggleShown()}}]}}},62102:function(e,t,n){"use strict";n.d(t,{ZP:function(){return S},AB:function(){return C},VQ:function(){return E}});var r=n(94009),o=n(85879),i=n(87363),a=n(86481),c=n(65733),s=n(11809),l=n(20944),u=n(75334),d=n(87641),p=n(69383),h=n(74128),f=n(38889),_=n(77683),m=function(e){var t=e.className,n=e.onClose,r=e.shown,i=e.allInviters,a=e.onChoose;return(0,o.tZ)(h.Z,{title:"添加「谢邀」卡片",subtitle:"选择邀请人，添加感谢他的卡片",onClose:n,className:t,css:{width:"536px"},children:r&&i.map(function(e){return(0,o.BX)(d.Flex,{css:{padding:"12px 0"},children:[(0,o.tZ)(_.Z,{author:e}),(0,o.tZ)(f.ZP,{color:"color",preset:"blue",css:{height:"32px",marginLeft:"auto"},onClick:function(){p.Z.trackEvent(null,{id:7682,action:"Click"}),a&&a(e)},children:"选择"})]},e.id)})})},v=n(63573),g=function(e){var t=e.shown,n=e.hasShown,r=e.children,o=(0,i.useRef)(n),a=(0,i.useRef)(t);return(0,i.useEffect)(function(){!t&&a.current&&(o.current=!0),a.current=t},[t]),t&&!o.current&&r},T=function(e){var t=e.className,n=e.shown,a=e.hasShown,c=e.inviters,s=e.onConfirm,l=e.onCancel,u=(0,r._)((0,i.useState)(n),2),h=u[0],f=u[1],_=(0,i.useRef)(n);return(0,i.useEffect)(function(){_.current!==n&&f(n),_.current=n},[n]),(null==c?void 0:c.length)>0&&(0,o.tZ)(g,{shown:h,hasShown:a,children:(0,o.BX)(d.Flex,{className:t,pb:"12px",px:"16px",mx:"-20px",mb:"16px",color:"GBK05A",justifyContent:"space-between",alignItems:"center",sx:{borderBottom:"1px solid",borderColor:"GBK09A",fontSize:"15px",lineHeight:"20px",position:"relative",zIndex:"0"},children:[(0,o.BX)(d.Flex,{alignItems:"center",children:[c.map(function(e,t){return(0,o.tZ)(d.Image,{src:c[t].avatarUrl,size:24,sx:{borderRadius:"50%",border:"2px solid",borderColor:"GBK99A",position:"relative",zIndex:c.length-t,marginLeft:t?"-14px":"0"}},e.id)}),(0,o.tZ)(d.Text,{ml:"8px",children:c[0].name+(c.length>1?"等 ".concat(c.length," 人"):"")}),"邀请你回答"]}),(0,o.BX)(d.Flex,{alignItems:"center",children:[(0,o.tZ)(d.Text,{color:"primary",ml:"16px",css:{cursor:"pointer"},onClick:function(){p.Z.trackEvent(null,{id:7683,action:"Click",path:[{module_name:1===c.length?"0":"1"}]},{button:{text:"添加谢邀"}}),s&&s(c)},children:"添加谢邀"}),(0,o.tZ)(d.Text,{ml:"16px",css:{cursor:"pointer"},onClick:function(){f(!1),p.Z.trackEvent(null,{id:7683,action:"Click",path:[{module_name:1===c.length?"0":"1"}]},{button:{text:"忽略"}}),l&&l()},children:"忽略"})]})]})})},E=function(e){var t;return(null==e?void 0:null===(t=e.thankInviterInfo)||void 0===t?void 0:t.member)?{thankInviterInfo:e.thankInviterInfo.member}:null},C=function(e){var t;return e?{tableOfContentsEnabled:null==e?void 0:null===(t=e.tableOfContents)||void 0===t?void 0:t.enabled}:null},y=(0,i.forwardRef)(function(e,t){var n=e.getAllInviters,a=e.inviterQuery,s=e.getStore,l=e.syncDraftImmediately,d=(0,i.useContext)(u.j),p=d.updateFormData,h=(0,d.getFormData)().thankInviterInfo,f=(0,r._)((0,i.useState)(!1),2),_=f[0],g=f[1],E=function(e){p({thankInviterInfo:e}),requestAnimationFrame(function(){l()})},C=(0,r._)((0,i.useState)(null),2),y=C[0],S=C[1],I=(0,c.Z)(function(){return g(!1)});return(0,i.useImperativeHandle)(t,function(){return{openInviterListModal:function(){return g(!0)},getInvitersData:function(){return y},getThankInviterInfo:function(){return h}}},[y,h]),(0,i.useEffect)(function(){n().then(function(e){S(e.payload.data);var t=s();t.setEditorState(t.getEditorState())})},[]),(0,o.BX)(o.HY,{children:[h&&(0,o.tZ)(v.Z,{css:{marginBottom:16,marginTop:"4px !important"},showDeleteButton:!0,item:{isLabeled:!0},inviter:h,onDelete:function(){E(null)}}),(null==y?void 0:y.length)>0&&(0,o.tZ)(T,{hasShown:!!a||!!h,shown:!h,inviters:y,onConfirm:function(e){if(null==e?void 0:e.length){if(1===e.length){E(e[0]);return}g(!0)}}}),(0,o.tZ)(m,{onClose:I,shown:_,allInviters:y,onChoose:function(e){E(e),I()}})]})}),S=function(e){var t=e.getShouldShowToolbarButton,n=e.getAllInviters,r=e.inviterQuery,c=e.getInitialThankInviterInfo,u=e.syncDraftImmediately,d={},p=(0,i.createRef)(null);return{initialize:function(e){Object.assign(d,e)},componentsBeforeEditor:[{component:(0,o.tZ)(y,{getAllInviters:n,inviterQuery:r,ref:p,getStore:function(){return d},getInitialThankInviterInfo:c,syncDraftImmediately:u}),priority:0}],toolbar:{label:"添加谢邀",section:s.Z.CUSTOM_MAIN,priority:3,icon:a.E,onClick:function(){p.current.openInviterListModal()},shouldShow:t,shouldDisabled:function(){var e,t,n;return!!(!(null===(e=null===(t=p.current)||void 0===t?void 0:t.getInvitersData())||void 0===e?void 0:e.length)||(null===(n=p.current)||void 0===n?void 0:n.getThankInviterInfo()))}},toolbarV2:{label:"添加谢邀",section:l.Z.BUSINESS_MEDIA,text:"谢邀",icon:a.E,priority:3,onClick:function(){p.current.openInviterListModal()},shouldShow:t,shouldDisabled:function(){var e,t,n;return!!(!(null===(e=null===(t=p.current)||void 0===t?void 0:t.getInvitersData())||void 0===e?void 0:e.length)||(null===(n=p.current)||void 0===n?void 0:n.getThankInviterInfo()))}}}}},64875:function(e,t,n){"use strict";n.d(t,{Z:function(){return C}});var r=n(94009),o=n(85879),i=n(55283),a=n(80874),c=n(87363),s=n(36695),l=n(69383),u=n(78920),d=n(57730),p=n(22701),h=n(11809),f=n(20944),_=n(59013),m=n(31467),v=n(38765),g=n(96354),T={Ecommerce:"1",Hotel:"2",Tickets:"3",Advertising:"4",Store:"5",RedPacket:"6",Vop:"7",Kepler:"8",SelfPurchase:"9",SelfPublishedBooks:"10",Education:"11"},E=(0,c.forwardRef)(function(e,t){var n=e.getStore,a=e.getContentInfo,l=(0,r._)((0,c.useState)(!1),2),p=l[0],h=l[1],f=(0,s.useSelector)(function(e){return e.userProfit}).linkCardLimit,E=a(),C=E.id,y=E.type;(0,c.useImperativeHandle)(t,function(){return{setShowUserProfitCardSelector:h}},[]);var S=(0,s.useDispatch)();(0,c.useEffect)(function(){S((0,g.nh)())},[S]);var I=function(){return(0,_.Z)(n().getEditorState()).filter(function(e){return"ad-link-card"===e.getType()})};return(0,o.tZ)(o.HY,{children:(0,o.tZ)(m.Z,{className:"UserProfitCardSelector",size:"large",onClose:function(){h(!1)},children:p&&(0,o.tZ)("div",{className:"UserProfitCardSelector-content",children:(0,o.tZ)(u.Z,{className:"UserProfitCardSelector-iframe",src:(0,v.NY)({contentId:C,contentType:y}),onMessage:function(e){var t=n().getEditorRef();if((null==e?void 0:e.type)==="ProfitCardSelector/submitProfitCardInfo"&&(null==e?void 0:e.payload)){var r=e.payload,o=r.type,a=r.id,c=r.url,s=r.preventClose,l=r.goods;if(s||h(!1),"inserLinkCard"===o&&t.props.handleCommand("insert-link-card:".concat(c)),"insertMCNLinkCard"===o){var u=!!l&&(l.productType.toString()===T.RedPacket||l.productType.toString()===T.Advertising);if(Array.from(n().getProps().root.querySelectorAll('[data-draft-type="mcn-link-card"]')).filter(function(e){return e.getAttribute("data-mcn-product-type")!==T.Advertising&&e.getAttribute("data-mcn-product-type")!==T.RedPacket}).length>=f&&!u&&0!==f){d.Z.alert(null,{title:"一篇内容最多可添加 ".concat(f," 个商品")});return}t.props.handleCommand("insert-mcn-link-card:".concat(a))}if("insertEduCard"===o){if((0,_.Z)(n().getEditorState()).filter(function(e){return e.getType()===i.o6.TYPE}).size>=i.o6.EDU_CARD_LIMIT){d.Z.alert(null,{title:"一篇内容最多可添加 ".concat(i.o6.EDU_CARD_LIMIT," 个教育卡片")});return}t.props.handleCommand("".concat(i.o6.WebInsertCommand).concat(a))}if("insertAdLinkCard"===o){if(a.startsWith("ZhiTask_")&&I().filter(function(e){return e.getData().id.startsWith("ZhiTask_")}).size>=5){d.Z.alert("一篇内容最多可添加 ".concat(5," 个「知+自选」卡片"));return}if(a.startsWith("fee_")&&I().filter(function(e){return e.getData().id.startsWith("fee_")}).size>=1){d.Z.alert("一篇内容最多可添加 ".concat(1," 个「付费回答」卡片"));return}t.props.handleCommand("insert-ad-link-card:".concat(a))}}}})})})})}),C=function(e){var t=e.shouldDisabled,n=e.shouldShow,r=void 0===n?function(){return!0}:n,i=e.getContentInfo,s={};return s.containerRef=(0,c.createRef)(),{initialize:function(e){Object.assign(s,e)},handleCommand:function(e){return"toggle-user-profit-modal"===e?(s.containerRef.current.setShowUserProfitCardSelector(!0),"handled"):"not-handled"},toolbar:{label:"用户收益",icon:a.Fo,shouldShow:r,shouldDisabled:function(){return null!=t&&!!t()||null},section:h.Z.CUSTOM_MAIN,toolType:p._W.ENTITY,onClick:function(){s.containerRef.current.setShowUserProfitCardSelector(!0),l.Z.trackEvent(null,{id:6097,action:"Click"})},priority:1},toolbarV2:{label:"收益",text:"收益",icon:a.Fo,shouldShow:r,shouldDisabled:function(){return!!t()||null},section:f.Z.BUSINESS_MEDIA,toolType:p._W.ENTITY,onClick:function(){s.containerRef.current.setShowUserProfitCardSelector(!0),l.Z.trackEvent(null,{id:6097,action:"Click"})},priority:1},components:(0,o.tZ)(E,{ref:s.containerRef,getStore:function(){return s},getContentInfo:void 0===i?function(){}:i})}}},60908:function(e,t){"use strict";t.Z=function(){var e=document.createEvent("HTMLEvents");e.initEvent("compositionend",!0,!1),document.querySelector(".public-DraftEditor-content").dispatchEvent(e)}},48933:function(e,t,n){"use strict";n.d(t,{Dt:function(){return k},KW:function(){return b},ct:function(){return N},hx:function(){return w},l0:function(){return O},vB:function(){return x}});var r=n(22107),o=n(94707),i=n(86325),a=n(15030),c=n(55164),s=n(49899),l=n(85626),u=n(85879),d=n(62082),p=n(54231),h=n(84871),f=n.n(h),_=n(12592),m=n.n(_),v=n(88329),g=n.n(v),T=n(87363),E=n(67516),C=n.n(E),y=n(80714),S=n(65277),I=n(35102),b={success:"success",fail:"fail",request:"request"},A="EDITABLE_STATSC",Z=function(e){var t=e.name;return"ResponseError"===t?"".concat(t,"_").concat(e.status||0):t||"Unknown"};function w(){var e=C().get(A);e&&(e.forEach(function(e){p.ZP.increment(e)}),C().delete(A))}var R={get pageName(){return"UnknownPage"},reportRequest:g(),reportSuccess:g(),reportFail:g(),recordError:function(e){return e},wrapAutoRecord:function(e){return e}},N=(0,T.createContext)(R),k=function(){return(0,T.useContext)(N)},O=function(e){return f()(function(t){var n=k();return(0,u.tZ)(e,(0,c._)({reporter:n},t))},e)},x=O(function(e){(0,i._)(n,e);var t=(0,l._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"componentDidCatch",value:function(e,t){var n=this.props,r=n.reporter,o=n.name;throw r&&r.reportFail(o,e,{extra:{errorInfo:t}},!0),e}},{key:"render",value:function(){return this.props.children}}]),n}(T.Component));t.ZP=function(e,t){var n=function(t,n){p.ZP.increment("".concat(e,".").concat(t,".").concat(n,".count"))},r=function(t,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,a._)(n,Error)&&(null===(r=window.Raven)||void 0===r||r.captureException(n,(0,c._)({tags:{scope:"".concat(e,":").concat(t)}},o)))},o=function(e){return n(e,b.request)},i=function(e){return n(e,b.success)},l=function(n,o,i,c){if(!(!(0,a._)(o,Error)||(0,I.hu)(o.message))){var s=Z(o);if(p.ZP.increment([e,n,b.fail,s,"count"].join(".")),r(n,o,i),!c){var l,u,h={type:"EditorActionError-"+n,appName:"heifetz",spanName:e,currentUser:(null==t?void 0:t())||"Unknown",release:y.Z.release,isBadBrowserPlugin:null!==(u=(0,S.Yz)())&&void 0!==u?u:"Unknown",error:{name:s,message:o.message,payload:o.payload||"Unknown",stack:o.stack}};(0,d.zB)(h),null===(l=window.webReporter)||void 0===l||l.report("heifetz_editor_error",h)}}},u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.intent,a=void 0===r||r,c=n.success,u=void 0===c||c;return function(){for(var n=arguments.length,r=Array(n),c=0;c<n;c++)r[c]=arguments[c];try{a&&o(e);var d=function(){return u?i(e):void 0},p=t.apply(void 0,(0,s._)(r));if(m()(p))return p.then(function(e){return d(),e},function(t){throw l(e,t),t});return d(),p}catch(t){throw l(e,t),t}}};return{get pageName(){return e},reportRequest:o,reportSuccess:i,reportFail:l,wrapAutoRecord:u,recordError:function(e,t){return u(e,t,{success:!1})},stash:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];if(n.length){var o=C().get(A)||[];o.push("".concat(e,".").concat(n.join("."),".count")),C().set(A,o)}}}}},20826:function(e,t,n){"use strict";n.d(t,{eU:function(){return g},m5:function(){return T}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(94009),d=n(85626),p=n(85879),h=n(84871),f=n.n(h),_=n(87363),m=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"commonMessage",{}),e}return(0,i._)(n,[{key:"setCommonMessage",value:function(e){this.commonMessage=e}},{key:"fire",value:function(e){var t;(null===(t=this.observers)||void 0===t?void 0:t.length)&&this.next((0,l._)((0,s._)({},e,this.commonMessage),{_t:Date.now()}))}}]),n}(n(23483).xQ),v=(0,_.createContext)(new m),g=function(e){return f()(function(t){var n=(0,u._)((0,_.useState)(function(){return new m}),1)[0];return(0,p.tZ)(v.Provider,{value:n,children:(0,p.tZ)(e,(0,l._)((0,s._)({},t),{editorEventPublisher:n}))})},e)},T=function(){return(0,_.useContext)(v)}},89137:function(e,t){"use strict";t.Z=function(e){var t=document.querySelector(e||".public-DraftEditor-content");if(!t)return{html:"",text:""};var n=t.cloneNode(!0),r=Array.from(n.querySelectorAll(".ztext-math")),o=!0,i=!1,a=void 0;try{for(var c,s=r[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var l,u=c.value,d=document.createElement("a"),p=u.dataset,h=p.tex,f=p.eeimg;h&&(d.setAttribute("alt",h),d.setAttribute("eeimg",f),null===(l=u.parentNode)||void 0===l||l.replaceChild(d,u))}}catch(e){i=!0,a=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw a}}var _=Array.from(n.querySelectorAll('sup[data-draft-type="reference"]')),m=!0,v=!1,g=void 0;try{for(var T,E=_[Symbol.iterator]();!(m=(T=E.next()).done);m=!0){var C=T.value,y=C.dataset.numero;C.textContent="[".concat(y,"]")}}catch(e){v=!0,g=e}finally{try{m||null==E.return||E.return()}finally{if(v)throw g}}var S=Array.from(n.querySelectorAll('[data-draft-type="link-card"]')),I=!0,b=!1,A=void 0;try{for(var Z,w=S[Symbol.iterator]();!(I=(Z=w.next()).done);I=!0){var R,N,k=Z.value;k.textContent=k.dataset.text||k.querySelector(".LinkCard-title").textContent||"",null===(R=k.parentNode)||void 0===R||null===(N=R.parentNode)||void 0===N||N.replaceChild(k,k.parentNode)}}catch(e){b=!0,A=e}finally{try{I||null==w.return||w.return()}finally{if(b)throw A}}var O=Array.from(n.querySelectorAll(".Image-captionContainer")),x=!0,P=!1,D=void 0;try{for(var L,B=O[Symbol.iterator]();!(x=(L=B.next()).done);x=!0){var U,M,G=L.value,F=G.querySelector(".Image");F&&(null===(U=G.parentNode)||void 0===U||null===(M=U.parentNode)||void 0===M||M.replaceChild(F,G.parentNode))}}catch(e){P=!0,D=e}finally{try{x||null==B.return||B.return()}finally{if(P)throw D}}var z=Array.from(n.querySelectorAll(".TableToolbar-container")),H=!0,q=!1,V=void 0;try{for(var X,W=z[Symbol.iterator]();!(H=(X=W.next()).done);H=!0){var K,j,Y=X.value;null===(K=Y.parentNode)||void 0===K||null===(j=K.parentNode)||void 0===j||j.replaceChild(Y,Y.parentNode)}}catch(e){q=!0,V=e}finally{try{H||null==W.return||W.return()}finally{if(q)throw V}}var Q=n.innerHTML,J=Array.from(n.querySelectorAll('[contenteditable="false"]')),$=!0,ee=!1,et=void 0;try{for(var en,er=J[Symbol.iterator]();!($=(en=er.next()).done);$=!0)en.value.remove()}catch(e){ee=!0,et=e}finally{try{$||null==er.return||er.return()}finally{if(ee)throw et}}return{html:Q,text:n.textContent.replace(/\n/g,"")}}},38814:function(e,t,n){"use strict";var r=n(54231);t.Z=function(e){var t=void 0,n=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default";r.ZP.increment("".concat(e,".").concat(t,".").concat(n,".").concat(o,".default.default.count"))},o=function(){o.count++,t=setTimeout(function(){n("compositionReporter","timer","".concat(o.count,"min")),o()},6e4)};return o.count=0,o.cancel=function(){void 0!==t&&(t=clearTimeout(t)),o.count=0},o}},20303:function(e,t,n){"use strict";var r=n(12627),o=n(93547),i=n(65277),a=n(89137),c=function(e,t){try{var n=e.getCreateContent(),o=e.EditableCore.html2draftMiddlewares,i=e.EditableCore.draft2htmlMiddlwares,a=n(t,o);return(0,r.Z)(a,"p",i)}catch(e){return"".concat(e.name," - ").concat(e.message)}};t.Z=function(e,t,n,r){var s=(0,o.Vt)(t),l=(0,a.Z)(n&&"".concat(n," .public-DraftEditor-content")),u=l.html,d=l.text,p=s.length,h=d.length,f=h-p;if(f>50){var _=Error("partial draft content lost - diff: ".concat(f)),m=c(r,u),v=(0,o.Vt)(m),g=v.length,T=h-g;_.payload={diff:f,fixedDiff:T,textLength:p,snapshotTextLength:h,fixedTextLength:g,browserContentScripts:(0,i.l)(),text:s,snapshotText:d,fixedText:v,fixedHtml:m,html:t,snapshotHtml:u},e.reportFail("DraftPartialLost",_)}}},72004:function(e,t,n){"use strict";n.d(t,{$:function(){return I}});var r=n(55164),o=n(57477),i=n(62082),a=n(91277),c=n(69436),s=n(25490),l=n(55759),u=n(23483),d=n(6735),p=n(22679),h=n(68521),f=n(96688),_=n(27663),m=n(43405),v=n(89137),g=n(93547),T=n(65277),E=n(64512),C=function(e){var t=(0,g.Vt)(e),n=(0,v.Z)(".public-DraftEditor-content").text;return{contentLength:t.length,snapshotContentLength:n.length,diffLength:n.length-t.length}},y=i.zB,S=function(e,t){},I=function(e){var t=(0,a.x)([e.pipe((0,d.h)(function(e){return["unmount","post-publish"].includes(e.type)})),(0,c.F)(3e5),(0,s.R)(window,"visibilitychange").pipe((0,d.h)(function(){return"hidden"===document.visibilityState}))],l.z).pipe((0,p.J)()),n=new u.xQ;n.pipe((0,h.b)(function(e){S("message",e)}),(0,f.f)(t)).subscribe(function(e){if(0!==e.length){S("report",e);var t,n={type:"pcEditorPublishEvent",appName:"heifetz",spanName:"editor",payload:e,error:{name:"Not a Error",message:"Must have error field to report"}};null==window||null===(t=window.webReporter)||void 0===t||t.report("pc_editor_publish_event",(0,E.Ss)(n)),y(n)}});var i=null;e.pipe((0,d.h)(function(e){return["mount","loadDraftSuccess","post-upload","pre-publish","post-publish","unmount"].includes(e.type)}),(0,_.U)(function(e){if("mount"===e.type||"loadDraftSuccess"===e.type||"pre-publish"===e.type){var t=(0,o._)((0,r._)({},e),{context:(0,o._)((0,r._)({},C(e.context.content||""),e.context),{content:void 0})});return"pre-publish"===e.type&&(t.context.browserContentScripts=(0,T.l)(),i=(0,r._)({},t.context,e.context)),t}if("post-publish"===e.type){if(i){var n=null===(a=e.context)||void 0===a?void 0:null===(c=a.data)||void 0===c?void 0:c.content;if(n){var a,c,s,l=(0,g.Vt)(n),u=Math.max(i.diffLength,i.snapshotContentLength-l.length);return(0,o._)((0,r._)({},e),{context:(0,r._)((0,o._)((0,r._)({},null===(s=e.context)||void 0===s?void 0:s.data),{content:void 0,preContentLength:i.contentLength,postContentLength:l.length,snapshotContentLength:i.snapshotContentLength}),u>50?{postContent:n,snapshotContent:i.content,isBigDiff:!0}:{})})}i=null}return(0,o._)((0,r._)({},e),{context:(0,r._)({},e.context)})}return e})).subscribe(n),e.pipe((0,d.h)(function(e){return"saveDraft"===e.type}),(0,m.e)(6e4),(0,_.U)(function(e){return(0,o._)((0,r._)({},e),{context:C(e.context.content)})})).subscribe(n)}},68455:function(e,t,n){"use strict";n.d(t,{GM:function(){return _},Uh:function(){return p},Wb:function(){return d},Wf:function(){return f},yN:function(){return m}});var r,o=n(49899),i=n(41807),a=n.n(i),c=n(67516),s=n.n(c),l="EMOTICON_EMOJI",u=s().get(l);function d(){return!!r}function p(e){u=e,s().set(l,e)}function h(e){var t=function(){if(r)return r;var e=(u&&(u=s().get(l)),u);return e?(r={},e.forEach(function(e){r[e.placeholder]=e.staticImageUrl}),r):{}}()[e];return t?'<img data-zhihu-emoticon="'.concat(e,'" src="').concat(t,'" alt="').concat(e,'" />'):e}function f(e){return e?e.replace(/\[.{1,8}?\]/g,h):""}function _(e,t){return t.map(function(t){var n=t.id,r=t.type,i=e[n],c="emoji"===r?45:8;return i?a()(i.stickers,c).map(function(e,t){return{groupId:n,id:"".concat(n,"-").concat(t),data:e,type:r}}):a()((0,o._)(Array(t.stickerCount)),c).map(function(e,t){return{groupId:n,id:"".concat(n,"-").concat(t),data:[],type:r}})}).flat()}function m(e,t){return e?t:t.filter(function(e){return"vip"!==e.type})}},28435:function(e,t,n){"use strict";n.d(t,{g:function(){return T}});var r=n(22107),o=n(94707),i=n(86325),a=n(55164),c=n(85626),s=n(85879),l=n(62082),u=n(54231),d=n(84871),p=n.n(d),h=n(87363),f=n(36695),_=n(65277),m=n(80714),v=function(e){(0,i._)(n,e);var t=(0,c._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"componentDidCatch",value:function(e,t){var n,r,o,i,a,c=null!==(r=(0,u.j0)())&&void 0!==r?r:"Unknown",s=null!==(o=null==e?void 0:e.name)&&void 0!==o?o:"Unknown",d=null!==(i=this.props.currentUser)&&void 0!==i?i:"Unknown",p=m.Z.release;(0,l.Tb)(e,{logger:"EditorErrorReport",fingerprint:["editor-fail"],extra:{passWhitelistUrlsTest:!0,pageName:c,currentUser:d}});var h={type:"EditorRenderError",appName:"heifetz",spanName:c,currentUser:d,release:p,isBadBrowserPlugin:null!==(a=(0,_.Yz)())&&void 0!==a?a:"Unknown",error:{name:s,message:e.message,stack:e.stack,payload:e.payload||"Unknown",componentStack:t.componentStack}};throw(0,l.zB)(h),null===(n=window.webReporter)||void 0===n||n.report("heifetz_editor_error",h),e}},{key:"render",value:function(){return this.props.children}}]),n}(h.Component),g=(0,f.connect)(function(e){return{currentUser:e.currentUser}})(v),T=function(e){var t=function(t){(0,i._)(l,t);var n=(0,c._)(l);function l(){return(0,r._)(this,l),n.apply(this,arguments)}return(0,o._)(l,[{key:"render",value:function(){return(0,s.tZ)(g,{children:(0,s.tZ)(e,(0,a._)({},this.props))})}}]),l}(h.Component);return p()(t,e)}},38267:function(e,t,n){"use strict";var r=n(85879),o=n(39658),i=n(36695),a=n(26299),c=n(31142);t.Z=function(e){var t=e.subtitle,n=e.errorImage,s=(0,i.useSelector)(function(e){return e.env.ctx.query.error_title})||e.title;return(0,r.BX)("div",{className:"ErrorPage",children:[(0,r.tZ)(o.ql,{title:s}),(0,r.BX)("div",{className:"ErrorPage-container",children:[(0,r.BX)("div",{className:"ErrorPage-text",children:[(0,r.tZ)("h1",{className:"ErrorPage-title",children:s}),(0,r.tZ)("p",{className:"ErrorPage-subtitle",children:t}),(0,r.tZ)(c.Z,{a:!0,preset:"primary",color:"blue",className:"ErrorPage-primaryButton",to:"https://www.zhihu.com",children:"去往首页"})]}),(0,r.tZ)("div",{className:"ErrorPage-errorImageContainer",children:(0,r.tZ)("img",{className:"ErrorPage-errorImage",src:void 0===n?"//zhstatic.zhihu.com/assets/error/liukanshan_wire.svg":n,alt:"page error"})})]}),(0,r.tZ)(a.ZP,{children:(0,r.tZ)(a.sJ,{})})]})}},70400:function(e,t,n){"use strict";n.d(t,{SV:function(){return y},mf:function(){return S.Z},ds:function(){return x},Ko:function(){return E}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(71728),d=n(97614),p=n(85626),h=n(85879),f=n(62082),_=n(54231),m=n(87363),v=n(80714),g=n(19076),T=function(e){(0,c._)(n,e);var t=(0,p._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.message,n=e.location.pathname;return(0,h.tZ)("div",{className:"UnknownError",children:t||(0,h.BX)("div",{children:["遇到不可预料的问题，请检查「网络连接」或",(0,h.tZ)("a",{href:n,children:"刷新重试"}),"。"]})})}}]),n}(m.Component),E=(0,g.withRouter)(T),C=function(e,t){var n,r,o,i,a,c,s,l=t.name,u=t.errorInfo;return{type:l,appName:"heifetz",pageName:null!==(n=(0,_.j0)())&&void 0!==n?n:"Unknown",errorName:null!==(r=null==e?void 0:e.name)&&void 0!==r?r:"Unknown",release:v.Z.release,error:{name:null!==(o=null==e?void 0:e.name)&&void 0!==o?o:"Unknown",message:null!==(i=null==e?void 0:e.message)&&void 0!==i?i:"Unknown",stack:null!==(a=null==e?void 0:e.stack)&&void 0!==a?a:"Unknown",payload:null!==(c=null==e?void 0:e.payload)&&void 0!==c?c:"Unknown",componentStack:null!==(s=null==u?void 0:u.componentStack)&&void 0!==s?s:"Unknown"}}},y=function(e){(0,c._)(n,e);var t=(0,p._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{hasError:!1}),e}return(0,i._)(n,[{key:"componentDidCatch",value:function(e,t){var n,r=this.props,o=r.target,i=r.config,a=r.config,c=void 0===a?{}:a,l=c.name,u=c.presets,d=void 0===u?[]:u;if(window.Raven&&window.Raven.captureException(e,{logger:"ErrorBoundary",fingerprint:["ErrorBoundary"],extra:(0,s._)({info:t},o&&{target:o})}),i){var p=C(e,{name:l,errorInfo:t});d.includes("sc-report")&&(0,f.zB)(p),d.includes("web-report")&&(null===(n=window.webReporter)||void 0===n||n.report(l,p))}}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.replacement,r=e.message,o=(0,u._)(e,["children","replacement","message"]);if(this.state.hasError){var i=void 0===n?"undefined":(0,d._)(n);return"undefined"===i?(0,h.tZ)(E,{message:r||"遇到不可预料的问题"}):"function"===i?n((0,l._)((0,s._)({},o),{children:t})):n}return t}}],[{key:"getDerivedStateFromError",value:function(){return{hasError:!0}}}]),n}(m.Component),S=n(38267),I=n.p+"assets/liukanshan_wire.dc5adecf.svg",b=n(36695),A=n(94009),Z=n(76867),w=n.p+"assets/liukanshan_desert.ecf3c388.svg",R=function(e){var t=/^\/question\/(\d+)\/answer\/(\d+)/.exec(e);return t&&t[1]&&t[2]?{destination:"回答所在的问题页",targetUrl:"/question/".concat(t[1])}:{destination:"知乎首页",targetUrl:"https://www.zhihu.com"}};function N(e){var t=e.seconds,n=e.source,r=e.title,o=(0,A._)((0,m.useState)(void 0===t?5:t),2),i=o[0],a=o[1],c=R(n),s=c.targetUrl,l=c.destination;return(0,Z.Z)(function(){a(i-1)},0===i?null:1e3),(0,m.useEffect)(function(){0===i&&(location.href=s)},[i,s]),(0,h.tZ)(S.Z,{title:r,subtitle:"".concat(i," 秒后自动跳转至").concat(l),errorImage:w})}var k=n.p+"assets/liukanshan_delete.5086fe3e.png",O=n.p+"assets/liukanshan_delivery.a6651701.svg",x=function(){return(0,h.tZ)(S.Z,{title:"出了一点问题",subtitle:"我们正在解决",errorImage:O})};n(84871),n.p,n(44812),n(38889),m.Component;var P=n(58909),D=n(7407),L=[{name:"BadRequestErrorPage",path:"/400",component:function(){return(0,h.tZ)(S.Z,{title:"请求错误",subtitle:"无法访问当前页面",errorImage:I})}},{name:"UnauthorizedErrorPage",path:"/401",component:function(){return(0,h.tZ)(S.Z,{title:"未认证",subtitle:"无法访问当前页面",errorImage:I})}},{name:"ForbiddenErrorPage",path:"/403",component:function(){return(0,h.tZ)(S.Z,{title:"没有权限",subtitle:"无法访问当前页面",errorImage:I})}},{name:"NotFoundErrorPage",path:"/404",component:function(){var e=(0,b.useSelector)(function(e){return e.env.ctx.query}),t=e.redirect,n=e.error_title,r=e.error_from;return t?(0,h.tZ)(N,{source:r,seconds:5,title:n}):(0,h.tZ)(S.Z,{title:"404",subtitle:"你似乎来到了没有知识存在的荒原",errorImage:I})},revalidate:864e5,getStaticPath:function(e){var t,n=e.data,r="NotFoundErrorPageCacheKey",o=null==n?void 0:n.initialState;o&&(r+=((0,D.Hu)(o)?"_mobile":"_pc")+((0,P.dd)(o)?"_login":"_notLogin"));var i=/error_title=([^&]+)/.exec(null==n?void 0:null===(t=n.ctx)||void 0===t?void 0:t.originalUrl);return i&&i[1]&&(r+="data-".concat(i[1])),r}},{name:"GoneErrorPage",path:"/410",component:function(){return(0,h.tZ)(S.Z,{title:"该内容已删除",subtitle:"你似乎来到了没有知识存在的荒原",errorImage:k})},revalidate:864e5,getStaticPath:function(e){var t=e.data,n="GoneErrorPageCacheKey",r=null==t?void 0:t.initialState;return r&&(n+=((0,D.Hu)(r)?"_mobile":"_pc")+((0,P.dd)(r)?"_login":"_notLogin")),n}}];g.Route,L.map(function(e){return(0,h.tZ)(g.Route,{revalidate:e.revalidate,getStaticPath:e.getStaticPath,name:e.name,path:e.path,component:e.component},e.path)})},63362:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(85879),o=n(16839),i=n(87363),a=n(43384),c=n(38889),s=n(97727),l=function(e){var t=e.className,n=e.onClick,l=e.label,u=e.onRef,d=e.disabled,p=e.showIcon;return(0,r.BX)(i.Fragment,{children:[(0,r.tZ)(s.bY,{input:"f",action:n}),(0,r.tZ)(a.$U,{as:c.ZP,zaText:"收藏",zaType:"Button",zaModuleId:"pop_up_panel_collect_button",zaBlock:"收藏",onRef:u,className:t,preset:"plain",onClick:n,icon:void 0===p||p?o.mH:null,label:l,disabled:d})]})};l.defaultProps={label:"收藏"};var u=l},102:function(e,t,n){"use strict";n.d(t,{E:function(){return b}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(71728),d=n(49899),p=n(85626),h=n(85879),f=n(87363),_=n(36695),m=n(93206),v=n(31824),g=n(50373),T=n(85576),E=n(35528),C=function(){return Promise.all([n.e(9165),n.e(632)]).then(n.bind(n,29165)).then(function(e){return e.FavlistsModal})},y={ids:[],isFetching:!1,isDrained:!1},S=(0,v.P1)(function(e){return e.favlists[e.currentUser]||y},function(e){return e.entities.favlists},function(e,t){var n=e.ids,r=(0,u._)(e,["ids"]);return(0,l._)((0,s._)({},r),{items:n.map(function(e){return t[e]})})}),I=function(e){(0,c._)(n,e);var t=(0,p._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"onFavlistAdd",function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=e.props,i=o.type,a=o.id;return o.onFavlistAdd.apply(void 0,(0,d._)(n).concat([{type:i,id:a}]))}),(0,a._)((0,r._)(e),"onLoad",function(){var t=e.props,n=t.onLoad,r=t.type,o=t.id,i=t.onUpdateReaction;return n(r,o).then(function(e){i({contentType:r,contentId:o,relations:e.payload.data.reduce(function(e,t){return(0,l._)((0,s._)({},e),(0,a._)({},t.id,t.isFavorited))},{})})})}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.currentUser,n=e.authRequired,r=(0,u._)(e,["currentUser","authRequired"]);return(0,h.tZ)(g.Z,(0,l._)((0,s._)({getComponent:C},r),{authRequired:n,isUserActive:!!(null==t?void 0:t.isActive),onLoad:this.onLoad,onFavlistAdd:this.onFavlistAdd}))}}]),n}(f.Component),b=(0,m.compose)(T.Z,(0,_.connect)(function(e,t){var n=t.id,r=t.type,o=e.favlists.relations,i=e.currentUser,a=S(e);return{isFetching:a.isFetching,isDrained:a.isDrained,items:a.items,relations:o["".concat(r,"_").concat(n)],zaEnabled:!0,urlToken:i}},function(e,t){return{onUpdateFav:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e(E.NK.apply(void 0,(0,d._)(n)))},onFavlistAdd:t.onFavlistAdd||function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e(E.Vf.apply(void 0,(0,d._)(n)))},onLoad:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e(E.n2.apply(void 0,(0,d._)(n)))},onUpdateReaction:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e(E.k1.apply(void 0,(0,d._)(n)))}}}))(I)},46829:function(e,t,n){"use strict";n.d(t,{Z:function(){return F}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(85626),d=n(85879),p=n(53910),h=n(67814),f=n.n(h),_=n(12592),m=n.n(_),v=n(14168),g=n.n(v),T=n(87363),E=n(36695),C=n(93206),y=n(69383),S=n(43384),I=n(4534),b=n(38889),A=n(80714),Z=n(66263),w=n(85576),R=n(10886),N=n(7407),k=n(35528),O=n(40195),x=n(67036),P=n(87964),D=n(76741),L=n(28814),B=n(84871),U=n.n(B),M={default:"default",primary:"primary"},G=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"zaRef",(0,T.createRef)()),(0,a._)((0,r._)(e),"state",{hovered:!1,isFetching:!1}),(0,a._)((0,r._)(e),"handleMouseEnter",function(){e.setState({hovered:!0})}),(0,a._)((0,r._)(e),"handleMouseLeave",function(){e.setState({hovered:!1})}),(0,a._)((0,r._)(e),"toggleFollow",function(t){var n=e.props,r=n.isFollowing,o=n.type,i=n.id,a=n.zaId,c=n.useCustomZa,l=n.onFollowButtonClick,u=n.onToggleFollow,d=!r;if(!c){y.Z.trackEvent(t.target,(0,s._)({action:d?"Follow":"UnFollow",element:"Button",element_name:Z.ur[o]},a&&{id:a}));var p=d?"关注":"取消关注";e.zaRef.current.trackEvent({action:d?"Follow":"UnFollow",eventType:"Click",elementLocation:{type:"Button",text:p},block:p})}null==u||u(d);var h="toggleFollow".concat(o.slice(0,1).toUpperCase()).concat(o.slice(1)),f=e.props[h](i,d);m()(f)&&(e.setState({isFetching:!0}),f.then(function(){e.setState({isFetching:!1}),l&&l()}).catch(function(){return e.setState({isFetching:!1})}))}),(0,a._)((0,r._)(e),"handleToggleFollow",function(t){var n=e.props,r=n.authRequired,o=n.globalAuthRequired,i=n.ua;if(r){r(e.toggleFollow,Z.q0.follow,!0)(t);return}i.Zhihu?e.toggleFollow(t):o(e.toggleFollow,Z.q0.follow)(t)}),(0,a._)((0,r._)(e),"handleClick",function(t){e.setState({hovered:!1});var n=e.props.onClick;(!n||n(t))&&(e.handleToggleFollow(t),t.stopPropagation())}),(0,a._)((0,r._)(e),"getButtonPresetAndColor",function(e,t){var n=e.isFollowing,r=e.preset,o=e.getButtonPresetAndColor;return o&&"function"==typeof o?o(e,t):n?{preset:"primary",color:"grey"}:{preset:r,color:"blue"}}),(0,a._)((0,r._)(e),"getButtonInner",function(e,t){var n=e.isFollowing,r=e.canShowMutualFollowStatus,o=e.isFollowed,i=e.children,a=e.type,c=e.gender,s=e.entityHidden,l=e.getButtonInner;if(l&&"function"==typeof l)return l(e,t);var u=t.hovered;return n?{inner:u?"取消关注":r&&o?"互相关注":"已关注"}:i?{inner:i}:"people"===a||"rewardPeople"===a?{inner:[(0,d.tZ)(p.nY,{className:"FollowButton-icon",text:!0,center:!0},"icon"),"关注".concat("number"==typeof c&&-1!==c?Z.K_[c]:"")]}:{inner:"关注".concat(s?"":I.iB[a])}}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.onRef,n=e.className,r=e.isMobile,o=e.disabled,i=this.getButtonPresetAndColor(this.props,this.state),a=i.preset,c=i.color,u=this.getButtonInner(this.props,this.state).inner,p=this.state.isFetching;return(0,d.BX)(b.ZP,(0,l._)((0,s._)({onRef:t,preset:a,color:c,onClick:this.handleClick,className:f()("FollowButton",n)},!A.Z.isMobileEntry&&!r&&{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave}),{disabled:o||p,children:[(0,d.tZ)(S.pS,{ref:this.zaRef}),u]}))}}]),n}(T.Component);(0,a._)(G,"propTypes",{preset:g().oneOf(Object.values(M)),type:g().oneOf(I.eX).isRequired,id:g().oneOfType([g().number,g().string]).isRequired,zaId:g().number,useCustomZa:g().bool}),(0,a._)(G,"defaultTypes",{preset:M.default}),(0,a._)(G,"PRESETS",M);var F=(0,C.compose)(function(e){return U()(function(t){var n=t.type,r=void 0===n?"":n,o=t.id,i=void 0===o?"":o;return r&&"people"===r||"rewardPeople"===r?(0,d.tZ)(S.eV,{content:{type:"User",token:i,id:i},children:(0,d.tZ)(e,(0,s._)({},t))}):(0,d.tZ)(e,(0,s._)({},t))},e)},(0,w.M)("globalAuthRequired"),(0,E.connect)(function(e){return{ua:e.env.userAgent,isMobile:(0,N.Hu)(e,{includeTablet:!0})}},{toggleFollowQuestion:O.XX,toggleFollowCollection:k.I3,toggleFollowColumn:R.As,toggleFollowRoundtable:P.OQ,toggleFollowTopic:D.KS,toggleFollowPeople:L.KX,toggleFollowRewardPeople:x.Ad}))(G)},74914:function(e,t,n){"use strict";var r=n(22107),o=n(94707),i=n(86325),a=n(85626),c=n(85879),s=function(e){(0,i._)(n,e);var t=(0,a._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"render",value:function(){var e=this.props,t=e.isFollowed,n=e.isFollowing;return t?(0,c.tZ)("span",{className:"FollowStatus",children:n?"相互关注":"关注了你"}):null}}]),n}(n(87363).Component);t.Z=s},87843:function(e,t,n){"use strict";n.d(t,{$:function(){return A},Z:function(){return w}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(71728),d=n(49899),p=n(85626),h=n(85879),f=n(14168),_=n.n(f),m=n(87363),v=n(61533),g=n(36695),T=n(12592),E=n.n(T),C=n(92769),y=n.n(C);function S(e,t){return t?e.trim():e}var I={useTrim:!0},b={required:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=(arguments.length>1&&arguments[1],(arguments.length>2&&void 0!==arguments[2]?arguments[2]:I).useTrim);return""!==S(e,t)},maxLength:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:I).useTrim;return S(e,n).length<=t},minLength:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:I).useTrim;return S(e,n).length>=t},pattern:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:I).useTrim;return t.test(S(e,n))}};function A(){return function(e){var t,n,r,o;return t=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=o[e];return"function"==typeof i?i.apply(void 0,(0,d._)(n)):void 0},n=e.contextTypes,r=e.defaultProps,o=Object.assign({},e.prototype),Object.assign(e.prototype,{UNSAFE_componentWillMount:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=this.context.form;return o&&(o.attachToForm(this),this.setState({_value:"",_validations:[]})),t.apply(void 0,["componentWillMount"].concat((0,d._)(n)))},componentWillUnmount:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=this.context.form;return o&&o.detachFromForm(this),t.apply(void 0,["componentWillUnmount"].concat((0,d._)(n)))},getValue:function(){var e=(this.state||{})._value;return null==e?"":e},setValue:function(e,t){this.setState({_value:e},function(){"function"==typeof t&&t()})},getValidationMessage:function(){var e=this.getValidationMessages();return e&&e[0]},getValidationClassName:function(){var e=(this.state||{})._validations;return e&&e[0]&&e[0].className},getValidationMessages:function(){var e=(this.state||{})._validations;return null==e?void 0:e.map(function(e){var t=e.message;return t?"string"==typeof t?t:t.message||"未知错误":""})},setValidations:function(e){var t=this;this.setState({_validations:e},function(){return t.forceUpdate()})},clearValidations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=(this.state||{})._validations;n&&n.length>0&&this.setState((0,l._)((0,s._)({},e),{_validations:[]}),t)},addValidation:function(e){this.setState(function(t){var n=t._validations;return{_validations:[e].concat((0,d._)(n||[]))}})},addManualValidation:function(e){this.addValidation({type:"manual",message:e})},validate:function(){this.context.form.validate(this)}}),Object.assign(e,{contextTypes:(0,l._)((0,s._)({},n),{form:_().object}),defaultProps:(0,l._)((0,s._)({},r),{validations:[]})}),e}}var Z=function(e){(0,c._)(n,e);var t=(0,p._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{isValid:!0}),(0,a._)((0,r._)(e),"inputs",[]),(0,a._)((0,r._)(e),"attachToForm",function(t){var n=t.props.name;if(!n||e.inputs.includes(n))throw Error("form input must specify a unqie name, but current is ".concat(n));e.inputs.push(t)}),(0,a._)((0,r._)(e),"detachFromForm",function(t){var n=e.inputs.indexOf(t);-1!==n&&(e.inputs=(0,d._)(e.inputs.slice(0,n)).concat((0,d._)(e.inputs.slice(n+1))))}),(0,a._)((0,r._)(e),"validate",function(e){var t=e.state._value,n=e.props.validations,r=[],o=[];return n?(!Array.isArray(n)&&n.type&&(n=[n]),n.forEach(function(e){var n=e.type,i=e.value,a=e.options,c=b[n];if(!c)throw Error("no ".concat(n," rules, please define it at Form.validateRules"));var s=c(t,i,a);E()(s)?o=(0,d._)(o).concat([s.then(function(){},function(){r.push(e)})]):s||(r=(0,d._)(r).concat([e]))}),Promise.all(o).then(function(){return e.setValidations(r),r})):r}),(0,a._)((0,r._)(e),"handleSubmit",function(t){t.preventDefault();var n=e.props,r=n.onPreSubmit,o=n.onSubmit,i=n.isWechat;if(r(),i){new Promise(function(t){var n=e.inputs.find(function(e){return"username"===e.props.name});n&&!n.state._value&&(0,v.findDOMNode)(n.inputEl).value&&n.handleChange({target:{value:(0,v.findDOMNode)(n.inputEl).value}});var r=e.inputs.find(function(e){return"password"===e.props.name});r&&!r.state._value&&n&&(0,v.findDOMNode)(n.inputEl).value&&r.handleChange({target:{value:(0,v.findDOMNode)(r.inputEl).value}}),t()}).then(function(){e.validateAll().then(function(t){t&&o(e.inputs.reduce(function(e,t){return(0,l._)((0,s._)({},e),(0,a._)({},t.props.name,t.state._value))},{}))})});return}e.validateAll().then(function(t){t&&o(e.inputs.reduce(function(e,t){return(0,l._)((0,s._)({},e),(0,a._)({},t.props.name,t.state._value))},{}))})}),e}return(0,i._)(n,[{key:"getChildContext",value:function(){return{form:{attachToForm:this.attachToForm,detachFromForm:this.detachFromForm,getValue:this.getValue,setValue:this.setValue,validate:this.validate}}}},{key:"componentDidMount",value:function(){}},{key:"validateAll",value:function(){var e=this,t=this.props,n=t.onValid,r=t.onInvalid,o=[],i=[];return this.inputs.forEach(function(t){var n=e.validate(t);E()(n)?i=(0,d._)(i).concat([n.then(function(e){o=(0,d._)(o).concat((0,d._)(e))})]):n&&(o=(0,d._)(o).concat((0,d._)(n)))}),Promise.all(i).then(function(){var t=0===o.length;return e.setState({isValid:t},function(){t?n():r(o.map(function(e){return e.message}))}),t})}},{key:"render",value:function(){var e=y()(this.props,["onValid","onInvalid","onSubmit","onPreSubmit","isWechat","dispatch"]),t=e.children,n=e.onRef,r=(0,u._)(e,["children","onRef"]);return(0,h.tZ)("form",(0,l._)((0,s._)({noValidate:!0,onSubmit:this.handleSubmit,ref:n},r),{children:t}))}}]),n}(m.Component);(0,a._)(Z,"childContextTypes",{form:_().object}),(0,a._)(Z,"propTypes",{onValid:_().func,onInvalid:_().func,onSubmit:_().func,onPreSubmit:_().func}),(0,a._)(Z,"validateRules",b),(0,a._)(Z,"defaultProps",{onValid:function(){},onInvalid:function(){},onSubmit:function(){},onPreSubmit:function(){}});var w=(0,g.connect)(function(e){return{isWechat:e.env.userAgent.Wechat}})(Z)},35374:function(e,t,n){"use strict";n.d(t,{A6:function(){return z},qH:function(){return F},iH:function(){return B}});var r=n(85879),o=n(89174),i=n(3028),a=n(94009),c=n(4551),s=n(87363),l=n.n(s),u=n(32210),d=n(91850),p=n(36892),h=n(65733),f=n(24405),_=n(24486),m=n(87641),v=n(43384),g=n.p+"assets/liukanshan-peek.a71ecf3e.png",T=function(e){var t=e.onLoginClick,n=e.onXMarkClick,i=(0,f.F)().colors;return(0,r.tZ)(v.eV,{block:"bottom_layer",children:(0,r.BX)(v.Wi,{as:m.Box,bg:"GBK99A",p:"32px 20px",css:{borderRadius:4},zaType:"Popup",children:[(0,r.tZ)(v.$U,{zaType:"Button",zaText:"关闭",as:_.ZP,size:12,css:{position:"absolute",right:12,top:12,color:i.GBK06A,cursor:"pointer"},onClick:n}),(0,r.tZ)(m.Image,{css:{position:"absolute",right:0,top:44},width:82,src:g}),(0,r.BX)(m.Text,{as:"span",fontWeight:"bold",fontSize:17,color:"GBK02A",children:["登录即可查看",(0,r.tZ)(m.Text,{as:"span",color:"GBL01A",children:" 超5亿 "}),"专业优质内容"]}),(0,r.tZ)(m.Text,{color:"GBK03A",lineHeight:1.6,mt:12,fontSize:14,pr:36,children:"超 5 千万创作者的优质提问、专业回答、深度文章和精彩视频尽在知乎。"}),(0,r.tZ)(v.$U,{zaType:"Button",zaText:!0,as:o.ZP,css:{marginTop:24,width:"100%",position:"relative"},preset:"primary",onClick:function(){t(),n()},color:"blue",children:"立即登录/注册"})]})})},E={from:{opacity:0,translateY:4},enter:{opacity:1,translateY:0},leave:{opacity:0,translateY:4},config:{ease:"easeOut",duration:.3}},C=(0,i.Z)(null)(function(e){var t=e.onLoginClick,n=(0,a._)((0,d.Z)(!1),2),o=n[0],i=n[1],l=(0,s.useRef)(null),f=(0,p.Z)(function(){window.scrollY>700&&i.on()},100),_=(0,h.Z)(function(){var e;i.off(),null===(e=l.current)||void 0===e||e.unsubscribe()});return(0,s.useEffect)(function(){return l.current=(0,u.subscribe)("scroll",f),function(){var e;null===(e=l.current)||void 0===e||e.unsubscribe()}},[f]),(0,r.tZ)(c.Z,{target:null,isOpen:o,animation:E,css:{position:"fixed",bottom:50,right:64,width:336,zIndex:2},arrowed:!1,children:(0,r.tZ)(T,{onLoginClick:t,onXMarkClick:_})})}),y=n(10748),S=n(66980),I=Object.assign,b=Object.assign,A=Object.assign,Z=Object.assign,w=[{Icon:function(e){return l().createElement(S.Z,I({width:"28",height:"28",fill:"none",viewBox:"0 0 28 28"},e),l().createElement("circle",{cx:"14",cy:"14",r:"14",fill:"url(#id-2307047740-a)"}),l().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M11.111 7.972c-.181 0-.506.22-.506.734v7.627a.583.583 0 1 1-1.167 0v-3.957H7.591a.77.77 0 0 0-.008.114v5.81a.77.77 0 0 0 .008.115H10.02c.322 0 .584.261.584.583v.685c0 .513.325.733.506.733h7.632c.181 0 .506-.22.506-.733V8.706c0-.513-.325-.734-.506-.734h-7.631Zm-1.673 11.61v.1c0 .942.65 1.901 1.673 1.901h7.632c1.022 0 1.673-.959 1.673-1.9V8.706c0-.942-.65-1.9-1.673-1.9h-7.631c-1.023 0-1.674.958-1.674 1.9v2.503h-2.09c-.436 0-.674.338-.768.527a1.71 1.71 0 0 0-.164.754v5.81c0 .264.052.532.164.755.094.188.332.527.768.527h2.09Zm2.811-8.693c0-.322.261-.584.584-.584h3.889a.583.583 0 0 1 0 1.167h-3.89a.583.583 0 0 1-.583-.583Zm.584 2.139a.583.583 0 0 0 0 1.166h3.889a.583.583 0 0 0 0-1.166h-3.89Zm-.584 3.305c0-.322.261-.583.584-.583h2.333a.583.583 0 1 1 0 1.166h-2.333a.583.583 0 0 1-.584-.583Zm-4.623 2.205-.001-.002v.002Zm0-6.285-.001.001v-.001Z",clipRule:"evenodd"}),l().createElement("defs",null,l().createElement("linearGradient",{id:"id-2307047740-a",x1:"1.5",x2:"26",y1:"-2",y2:"32",gradientUnits:"userSpaceOnUse"},l().createElement("stop",{stopColor:"#CDE1FF"}),l().createElement("stop",{offset:".155",stopColor:"#D5E5FE",stopOpacity:".869"}),l().createElement("stop",{offset:".758",stopColor:"#E2E2FF",stopOpacity:".256"}),l().createElement("stop",{offset:".942",stopColor:"#E5E1FF",stopOpacity:".115"}))))},text:"更懂你的优质内容"},{Icon:function(e){return l().createElement(S.Z,b({width:"28",height:"28",fill:"none",viewBox:"0 0 28 28"},e),l().createElement("circle",{cx:"14",cy:"14",r:"14",fill:"url(#id-2832850787-a)"}),l().createElement("path",{stroke:"#06F",strokeWidth:"1.167",d:"M20.028 12.444c0 3.082-2.665 5.64-6.028 5.64-3.363 0-6.028-2.558-6.028-5.64 0-3.081 2.665-5.639 6.028-5.639 3.363 0 6.028 2.558 6.028 5.64Z"}),l().createElement("path",{stroke:"#06F",strokeLinecap:"round",strokeWidth:"1.167",d:"M10.111 19.055v1.804c0 .44.445.74.854.577l2.573-1.029c.297-.119.628-.119.924 0l2.574 1.03a.622.622 0 0 0 .853-.578v-1.804"}),l().createElement("path",{stroke:"#06F",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.167",d:"M11.666 12.574c.273-.348.549-.693 1.152-.746 1.214-.106 1.328 1.189 2.542 1.082.61-.053.885-.406 1.162-.758"}),l().createElement("defs",null,l().createElement("linearGradient",{id:"id-2832850787-a",x1:"1.5",x2:"26",y1:"-2",y2:"32",gradientUnits:"userSpaceOnUse"},l().createElement("stop",{stopColor:"#CDE1FF"}),l().createElement("stop",{offset:".155",stopColor:"#D5E5FE",stopOpacity:".869"}),l().createElement("stop",{offset:".758",stopColor:"#E2E2FF",stopOpacity:".256"}),l().createElement("stop",{offset:".942",stopColor:"#E5E1FF",stopOpacity:".115"}))))},text:"更专业的大咖答主"},{Icon:function(e){return l().createElement(S.Z,A({width:"28",height:"28",fill:"none",viewBox:"0 0 28 28"},e),l().createElement("circle",{cx:"14",cy:"14",r:"14",fill:"url(#id-2666423292-a)"}),l().createElement("path",{fill:"#06F",d:"m8.077 17.025.408-.417a.583.583 0 0 1 .148.593l-.556-.176Zm2.268 1.414-.174-.557a.583.583 0 0 1 .37.007l-.196.55Zm-2.222.694.174.557-.174-.557Zm-.54-.542-.557-.176.556.176Zm-.653-5.602c0 1.397.586 2.672 1.555 3.62l-.816.833c-1.175-1.149-1.906-2.718-1.906-4.453H6.93Zm5.639-5.25c-3.15 0-5.64 2.385-5.64 5.25H5.764c0-3.579 3.083-6.417 6.806-6.417V7.74Zm5.639 5.25c0-2.865-2.489-5.25-5.64-5.25V6.572c3.723 0 6.806 2.838 6.806 6.417h-1.166Zm-5.64 5.25c3.151 0 5.64-2.386 5.64-5.25h1.166c0 3.579-3.083 6.416-6.805 6.416V18.24Zm-2.026-.35c.628.226 1.31.35 2.027.35v1.166a7.16 7.16 0 0 1-2.421-.418l.394-1.098Zm-2.593.687 2.222-.694.348 1.113-2.222.695-.348-1.114Zm.19.19a.152.152 0 0 0-.19-.19l.348 1.114a1.015 1.015 0 0 1-1.271-1.275l1.113.352Zm.494-1.565-.494 1.566-1.113-.352.494-1.565 1.113.35Z"}),l().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M20.423 12.742a.583.583 0 0 1 .764.311c.376.893.542 1.879.454 2.876-.09 1.023-.478 2.03-1.065 2.917a.39.39 0 0 1-.005.006l.003.012a.7.7 0 0 1 .006.028l.257 1.249.002.011c.065.353-.06.7-.337.914a.943.943 0 0 1-.936.117l-1.064-.42-.015-.006a.083.083 0 0 0-.027-.008c-.004 0-.013 0-.034.004a1.31 1.31 0 0 0-.276.114l-.008.005c-.936.446-2.05.612-3.032.526a6.05 6.05 0 0 1-1.83-.46.584.584 0 0 1 .457-1.074c.473.201.972.327 1.475.371.795.07 1.695-.068 2.424-.415l.004-.002c.277-.137.745-.37 1.297-.137l.668.264-.165-.806a1.155 1.155 0 0 1 .17-.948c.493-.746.799-1.566.869-2.364a4.877 4.877 0 0 0-.367-2.32.583.583 0 0 1 .31-.765Z",clipRule:"evenodd"}),l().createElement("defs",null,l().createElement("linearGradient",{id:"id-2666423292-a",x1:"1.5",x2:"26",y1:"-2",y2:"32",gradientUnits:"userSpaceOnUse"},l().createElement("stop",{stopColor:"#CDE1FF"}),l().createElement("stop",{offset:".155",stopColor:"#D5E5FE",stopOpacity:".869"}),l().createElement("stop",{offset:".758",stopColor:"#E2E2FF",stopOpacity:".256"}),l().createElement("stop",{offset:".942",stopColor:"#E5E1FF",stopOpacity:".115"}))))},text:"更深度的互动交流"},{Icon:function(e){return l().createElement(S.Z,Z({width:"28",height:"28",fill:"none",viewBox:"0 0 28 28"},e),l().createElement("circle",{cx:"14",cy:"14",r:"14",fill:"url(#id-2355950134-a)"}),l().createElement("path",{stroke:"#06F",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.167",d:"M15.457 8.089H9.29a1.2 1.2 0 0 0-1.2 1.2v9.42a1.2 1.2 0 0 0 1.2 1.2h9.422a1.2 1.2 0 0 0 1.2-1.2v-6.167M13.999 14.002l5.835-5.836"}),l().createElement("defs",null,l().createElement("linearGradient",{id:"id-2355950134-a",x1:"1.5",x2:"26",y1:"-2",y2:"32",gradientUnits:"userSpaceOnUse"},l().createElement("stop",{stopColor:"#CDE1FF"}),l().createElement("stop",{offset:".155",stopColor:"#D5E5FE",stopOpacity:".869"}),l().createElement("stop",{offset:".758",stopColor:"#E2E2FF",stopOpacity:".256"}),l().createElement("stop",{offset:".942",stopColor:"#E5E1FF",stopOpacity:".115"}))))},text:"更高效的创作环境"}],R=function(e){var t=e.onLoginClick,n=e.onMouseEnter,i=e.onMouseLeave;return(0,r.tZ)(v.eV,{block:"top_layer",children:(0,r.BX)(v.Wi,{zaType:"Popup",as:m.Box,p:24,fontSize:14,css:{borderRadius:4},width:361,bg:"GBK99A",onMouseEnter:n,onMouseLeave:i,children:[(0,r.tZ)(m.Text,{fontWeight:"bold",children:"登录知乎，您可以享受以下权益："}),(0,r.tZ)(m.Flex,{mt:"24px",flexWrap:"wrap",justifyContent:"space-between",css:{"@supports (gap: 16px)":{gap:"16px"}},children:w.map(function(e){var t=e.Icon,n=e.text;return(0,r.BX)(m.Flex,{alignItems:"center",css:{flex:"none","@supports not (gap: 16px)":{marginTop:16}},children:[(0,r.tZ)(t,{width:"28px"}),(0,r.tZ)(m.Text,{ml:"6px",children:n})]},n)})}),(0,r.tZ)(v.$U,{zaType:"Button",zaText:!0,as:o.ZP,css:{marginTop:16,width:"100%"},preset:"primary",onClick:t,color:"blue",children:"立即登录/注册"})]})})},N=n(7835),k=n(83537),O=n(88329),x=n.n(O),P=n(66263),D=(0,s.createContext)(null),L=(0,s.createContext)(!1),B=function(e){var t=e.children,n=(0,a._)((0,d.Z)(!1),2),o=n[0],i=n[1],c=i.on,l=i.off,u=(0,s.useRef)({authModalOpenCount:0,firstGuideConsumed:!1}),p=(0,h.Z)(function(e){e?(u.current.authModalOpenCount++,c()):l()}),f=(0,h.Z)(function(){u.current.firstGuideConsumed=!0});return(0,r.tZ)(D.Provider,{value:(0,s.useState)({statusRef:u,collectModalOpen:p,consumeFirstGuide:f})[0],children:(0,r.tZ)(L.Provider,{value:o,children:t})})},U=function(){var e=(0,s.useContext)(D);(0,N.Z)(function(){return null==e||e.collectModalOpen(!0),function(){null==e||e.collectModalOpen(!1)}})},M=function(e){var t=(0,s.useContext)(D),n=(0,s.useContext)(L);(0,k.Z)(function(){if(!t)return x();var r=t.consumeFirstGuide,o=t.statusRef.current,i=o.authModalOpenCount,a=o.firstGuideConsumed;n||1!==i&&0!==i||a||!(window.scrollY<P.BR)||(r(),e())},n?null:0)},G=function(e){var t=e.onLoginClick,n=(0,s.useRef)(null),i=(0,a._)((0,d.Z)(!1),2),l=i[0],u=i[1],p=u.on,f=u.off,_=(0,s.useRef)(!1);M(p);var m=(0,h.Z)(function(){f(),null==t||t()}),g=(0,h.Z)(function(){l&&f()}),T=(0,h.Z)(function(){p(),_.current=!0}),E=(0,h.Z)(function(){_.current=!1,setTimeout(function(){_.current||f()},300)});return(0,r.BX)(r.HY,{children:[(0,r.tZ)(v.Wi,{as:o.ZP,zaType:"Button",zaText:"login",preset:"primary",color:"blue",css:{marginRight:16},ref:n,onMouseEnter:T,onMouseLeave:E,onClick:m,children:"登录/注册"}),(0,r.tZ)(y.Z,{onScrollDown:g,threshold:20}),(0,r.tZ)(c.Z,{isOpen:l,target:n.current,placement:"bottom",onClose:f,globalClose:!0,listenResize:!0,arrowed:!0,fixed:!0,children:(0,r.tZ)(R,{onLoginClick:m,onMouseEnter:T,onMouseLeave:E})})]})},F=(0,i.Z)((0,r.tZ)(o.ZP,{className:"AppHeader-login",children:"登录"}))(function(e){var t=e.onClick;return(0,r.BX)(r.HY,{children:[(0,r.tZ)(G,{onLoginClick:t}),(0,r.tZ)(C,{onLoginClick:t})]})}),z=function(){return U(),null}},26609:function(e,t,n){"use strict";n.d(t,{Z:function(){return J}});var r=n(85879),o=n(14168),i=n.n(o),a=n(87363),c=n(43384),s=n(20857),l=n(9338),u=n(22107),d=n(94707),p=n(87320),h=n(86325),f=n(55164),_=n(71728),m=n(85626),v=n(30971),g=n(55698),T=n(72111),E=n(42849),C=n(9219),y=n(27723),S=n(6779),I=n(13707),b=n(34473),A=n(82644),Z=n(67814),w=n.n(Z),R=n(4667),N=n.n(R),k=n(36695),O=n(19076),x=n(87641),P=n(93206),D=n(69383),L=n(1733),B=n(97476),U=n(38889),M=n(7181),G=n(80714),F=n(45842),z=n(36591),H=n(40382),q=n(55344),V=n(83821),X=function(e){var t=e.href,n=e.className,o=(0,_._)(e,["href","className"]);return(0,r.tZ)(T._o,{zaText:!0,children:(0,r.tZ)(L.sN,(0,f._)({tag:x.Link,className:w()("AppHeaderProfileMenu-item",n),css:function(e){return{color:e.colors.GBL05A,fontSize:"14px"}},href:(0,z.Z)(t)},o))})},W=function(e){(0,h._)(n,e);var t=(0,m._)(n);function n(){var e;return(0,u._)(this,n),e=t.apply(this,arguments),(0,p._)((0,s._)(e),"state",{isMenuOpen:!1}),(0,p._)((0,s._)(e),"handleMenuOpen",function(){D.Z.trackEvent((0,s._)(e),{id:2764,action:"Click"}),e.setState({isMenuOpen:!0}),e.closeCreatorHint()}),(0,p._)((0,s._)(e),"handleMenuClose",function(){e.setState({isMenuOpen:!1}),e.openCreatorHint()}),(0,p._)((0,s._)(e),"handleCreatorHintRef",function(t){e.creatorHintPopover=t,e.openCreatorHint()}),(0,p._)((0,s._)(e),"openCreatorHint",function(){e.props.creatorNotification.invitationBubble>0&&e.creatorHintPopover&&!e.props.routes.find(function(e){return"Creator"===e.name})&&(e.creatorHintPopover.open(),e.trackCreatorHintCardshow())}),(0,p._)((0,s._)(e),"closeCreatorHint",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.closeForever;e.creatorHintPopover.close(),void 0!==n&&n&&e.props.readNotification("invitation_bubble")}),(0,p._)((0,s._)(e),"trackCreatorHintCardshow",N()(function(){D.Z.trackCardShow(null,{id:4229})})),(0,p._)((0,s._)(e),"handleCreatorHintCloseIconClick",function(){D.Z.trackEvent(null,{id:4232,action:"Click"}),e.closeCreatorHint({closeForever:!0})}),e}return(0,d._)(n,[{key:"componentDidMount",value:function(){this.loadData()}},{key:"loadData",value:function(){var e=this;return(0,l._)(function(){return(0,v.__generator)(this,function(t){switch(t.label){case 0:return[4,e.props.loadSwitches(["isCreator"])];case 1:if(!t.sent().isCreator)return[3,3];return[4,e.props.loadCreatorApplyStatus()];case 2:t.sent(),t.label=3;case 3:return e.props.creatorNotification.invitationBubble>0&&e.openCreatorHint(),[2]}})})()}},{key:"render",value:function(){if(!this.props.isLogin)return null;var e=this.props,t=e.className,n=e.currentUser,o=e.currentUserIsCreator,i=e.creatorNotification,a=e.location,s=this.state.isMenuOpen,l=G.Z.isMobileEntry?24:30,u="https://".concat(G.Z.wwwHost,"/").concat("organization"===n.userType?"org":"people","/").concat(n.urlToken||n.id),d=(0,r.BX)(c.$U,{as:U.ZP,zaType:"Image",zaAction:"Unknown",zaText:"用户头像",className:"AppHeader-profileEntry",preset:"plain",children:[(0,r.tZ)(g.qE,{className:"AppHeader-profileAvatar",size:l,url:n.avatarUrl,alt:"点击打开".concat(n.name,"的主页")}),!s&&o&&i.accessed>0&&(0,r.tZ)("div",{className:"AppHeader-profileAvatarRedDot"})]});return(0,r.BX)(V.Z,{placeholder:d,children:[(0,r.BX)(L.ZP,{className:t,menuClassName:"AppHeaderProfileMenu",menuContainerClassName:"AppHeaderProfileMenu-container",positionStatus:"fixed",toggler:d,boundary:{padding:16},onOpen:this.handleMenuOpen,onClose:this.handleMenuClose,arrowed:!0,children:[(0,r.BX)(X,{href:u,children:[(0,r.tZ)(E.Z,{size:16}),"我的主页"]}),(0,r.BX)(X,{href:"",onClick:function(e){e.preventDefault(),(0,B.Gb)()},children:[(0,r.tZ)(C.Z,{}),"无障碍"]}),(0,r.BX)(X,{href:(0,B.cg)((null==a?void 0:a.pathname)||""),children:[(0,r.tZ)(y.Z,{}),"关怀版"]}),(0,r.BX)(X,{href:"https://".concat(G.Z.wwwHost,"/settings/profile"),children:[(0,r.tZ)(S.Z,{size:16}),"设置"]}),(0,r.BX)(X,{href:"https://".concat(G.Z.wwwHost,"/logout"),children:[(0,r.tZ)(I.Z,{size:16}),"退出"]})]}),(0,r.BX)(M.Z,{className:"AppHeaderProfileMenu-creatorHintPopover",toggler:(0,r.tZ)("div",{className:w()("AppHeaderProfileMenu-creatorHintToggler",G.Z.isMobileEntry&&"AppHeaderProfileMenu-creatorHintToggler--small")}),toggleEvent:null,targetClassName:"AppHeaderProfileMenu-creatorHint",placement:"bottom",positionStatus:"fixed",globalClose:!1,boundary:{padding:16},ref:this.handleCreatorHintRef,arrowed:!0,children:[(0,r.tZ)(b.Z,{className:"AppHeaderProfileMenu-creatorHintCreatorIcon",size:20}),(0,r.tZ)("div",{className:"AppHeaderProfileMenu-creatorHintText",children:"你已被邀请入驻创作中心，"}),(0,r.tZ)("a",{className:"AppHeaderProfileMenu-creatorHintLink",href:"https://".concat(G.Z.wwwHost,"/creator"),"data-za-detail-view-id":4231,children:"立即入驻"}),(0,r.tZ)("div",{className:"AppHeaderProfileMenu-creatorHintCloseContainer",onClick:this.handleCreatorHintCloseIconClick,children:(0,r.tZ)(A.ZP,{size:20})})]})]})}}]),n}(a.PureComponent);(0,p._)(W,"propTypes",{currentUser:i().object,currentUserIsCreator:i().bool});var K=(0,P.compose)(F.Z,O.withRouter,(0,k.connect)(function(e){return{currentUserIsCreator:e.switches.isCreator,creatorNotification:(0,H.EtQ)(e).notification||{}}},{readNotification:H.iGT,loadSwitches:q.X2,loadCreatorApplyStatus:H.bGQ}))(W),j=n(35374),Y=n(45471);function Q(e){var t=e.currentUser,n=e.enableGuidesForLogin;return t&&"guest"!==t.userType?(0,r.tZ)(K,{className:"AppHeader-menu"}):(0,r.tZ)(Y.Vy,{loginButtonWithZa:void 0!==n&&n?(0,r.tZ)(j.qH,{}):(0,r.tZ)(c.Wi,{as:U.ZP,className:"AppHeader-login",zaType:"Button",zaText:"login",color:"blue",css:{whiteSpace:"nowrap"},children:"登录/注册"})})}var J=(0,a.memo)(Q);Q.propTypes={currentUser:i().object}},94307:function(e,t,n){"use strict";n.d(t,{pl:function(){return E}});var r=n(55164),o=n(57477),i=n(71728),a=n(94009),c=n(85879),s=n(83697),l=n(71549),u=n.n(l),d=n(87363),p=n(87641),h=n(43384),f=n(59590),_=function(e,t){if(!t)return e;var n=(0,a._)(e.split("#"),2),r=n[0],o=n[1],i=r+(r.includes("?")?"&":"?")+t;return o?i+"#"+o:i},m=function(e,t){var n,r=function(){var n,r,o,i,a,c=null,s=null;t.WxMiniProgram?c=null===(r=window.wx)||void 0===r?void 0:null===(o=r.miniProgram)||void 0===o?void 0:o.navigateTo:t.JDMiniProgram&&(c=null===(i=window.jd)||void 0===i?void 0:null===(a=i.miniProgram)||void 0===a?void 0:a.navigateTo);var l=null===(n=/\/topic\/(\d+)/.exec(e))||void 0===n?void 0:n[1];if(l&&(t.WxMiniProgram?s="/pages/topic?id=".concat(l):t.JDMiniProgram&&(s="/pages/topic/index?id=".concat(l))),s){null==c||c({url:s});return}/^http(s)?:/.test(e)&&(location.href=e)};!t.WxMiniProgram||(null===(n=window.WeixinJSBridge)||void 0===n?void 0:n.invoke)?r():document.addEventListener("WeixinJSBridgeReady",r,!1)},v=function(e){return/^\w+:\/\//.test(e)||"undefined"==typeof window?e:/^\/\//.test(e)?location.protocol+e:location.origin+e},g=function(e,t){var n=t.params,r=t.onRequestOpen,o=(0,s.n)();return function(t){var i=e.href,a=e.onClick;if(a&&a(t),!t.defaultPrevented){var c=_(v(i),n);if(o.ZhihuHybrid){t.preventDefault(),(0,f.Z)("base/openURL").dispatch({url:c});return}if(o.isMiniProgram){t.preventDefault(),m(c,o);return}(null==r?void 0:r({ua:o,url:c}))&&t.preventDefault()}}},T=function(e,t){var n=t.extra;return{zaType:"Button",zaAction:"OpenUrl",zaEventType:"Click",shouldTrackClick:!0,extra:u()({link:{get url(){return v(e)}}},n)}},E=(0,d.forwardRef)(function(e,t){var n=e.params,a=e.onRequestOpen,s=e.extra,l=(0,i._)(e,["params","onRequestOpen","extra"]);return(0,c.tZ)(h.KC,(0,o._)((0,r._)({as:p.Link},T(l.href,{extra:s}),l),{ref:t,onClick:g(l,{params:n,onRequestOpen:a})}))})},81488:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(85626),u=n(85879),d=n(16836),p=n(92073),h=n(67814),f=n.n(h),_=n(14168),m=n.n(_),v=n(87363),g=n.n(v),T=n(87641),E=n(88423),C=n(17132),y=n.n(C),S={top:10,left:20},I={top:0,left:0},b=function(e){(0,c._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"scrollerRef",g().createRef()),(0,a._)((0,r._)(e),"state",{transEnded:!1,rect:null,translate:null,scale:null}),(0,a._)((0,r._)(e),"getBoundingClientRect",function(){var t=e.props,n=t.img,r=t.data,o=n.getBoundingClientRect(),i=o.left,a=o.top,c=o.width,s=o.height,l=r.width,u=r.height,d={left:i,top:a,width:c,height:s},p=1;return l>u?(d.height=s,p=s/u,d.width=l*p,d.left=i+(c-d.width)/2,d.top=a+(s-d.height)/2):l<u&&(d.width=c,p=c/l,d.height=u*p,d.left=i+(c-d.width)/2,d.top=a+(s-d.height)/2),d}),(0,a._)((0,r._)(e),"handleClick",function(t){t.stopPropagation(),e.setState({translate:null,scale:null})}),(0,a._)((0,r._)(e),"handleKeyDown",function(t){"Escape"===t.key&&(t.stopPropagation(),t.preventDefault(),e.setState({translate:null,scale:null}))}),(0,a._)((0,r._)(e),"handleTransitionEnd",function(){var t=e.state,n=t.translate,r=t.scale,o=e.props.onClose;n&&r?(e.setState({transEnded:!0}),e.scrollerRef.current.style.overflow="auto"):o()}),e}return(0,i._)(n,[{key:"originalSrc",get:function(){return this.props.img.dataset.original}},{key:"currentSrc",get:function(){var e=this.props.img;return e.currentSrc||e.src}},{key:"UNSAFE_componentWillMount",value:function(){var e=this.props,t=e.img,n=e.isOriginalUrl;this.originalSrc!==this.currentSrc&&(new Image().src=this.originalSrc),this.setState({rect:!1===n?this.getBoundingClientRect():t.getBoundingClientRect()})}},{key:"componentDidMount",value:function(){var e=this;(0,p.disableBodyScroll)(this.scrollerRef.current);var t=this.props.img;setTimeout(function(){return e.setState((0,s._)({},e.computeTransition(e.state.rect,{width:t.dataset.rawwidth||t.naturalWidth})))})}},{key:"componentWillUnmount",value:function(){(0,p.enableBodyScroll)(this.scrollerRef.current)}},{key:"computeTransition",value:function(e,t){var n,r=this.props,o=r.transitionType,i=r.data,a=y()(navigator.userAgent).Mobile?I:S,c=a.top,s=a.left,l={left:0,top:0,width:window.innerWidth,height:window.innerHeight},u={x:l.left+l.width/2,y:l.top+l.height/2},d={width:l.width-2*s,height:l.height-2*c},p={},h={};return 1===o?(p.width=d.width>i.width?i.width:d.width,n=p.width/i.width,p.height=i.height*n,h={x:(d.width-p.width)/2+s,y:p.height<d.height?(d.height-p.height)/2+c:S.top}):(p.width=d.width>t.width?t.width:d.width,n=p.width/e.width,p.height=e.height*n,h={x:u.x-e.width/2,y:(p.height<d.height?u.y:S.top+p.height/2)-e.height/2}),{translate:h,scale:n}}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.img,o=n.isOriginalUrl,i=n.data,a=n.transitionType,c=n.className,s=this.state,l=s.translate,p=s.scale,h=s.rect,_=s.transEnded,m=l&&p,v=1,g="";if(1===a){var C=(y()(navigator.userAgent).Mobile?I:S).left;e=Math.min(window.innerWidth-2*C,i.width);var b=h.width/e;g=m?"translate(".concat(l.x,"px, ").concat(l.y,"px) scale(1) "):"translate(".concat(h.left,"px, ").concat(h.top,"px) scale(").concat(b,") "),v=m?1:0}else g=m?"translate(".concat(l.x,"px ,").concat(l.y,"px) scale(").concat(p,") "):"translate(".concat(h.left,"px,").concat(h.top,"px)");return(0,u.tZ)(d.Z,{children:(0,u.tZ)(T.Box,{className:f()("ImageView",c,{"is-active":m}),style:{paddingBottom:S.top},onClick:this.handleClick,onKeyDown:this.handleKeyDown,children:(0,u.tZ)("div",{className:"ImageView-inner",ref:this.scrollerRef,children:(0,u.tZ)("img",{ref:function(e){t.imgEl=e},src:!1===o?(0,E.imgUrl)(r.dataset.original,"r"):_&&this.originalSrc||this.currentSrc,className:f()("ImageView-img",{"ImageView-transformOrigin":1===a}),style:{width:e||h.width,transform:g,opacity:v},onTransitionEnd:this.handleTransitionEnd,alt:"preview"})})})})}}]),n}(v.Component);(0,a._)(b,"propTypes",{img:m().object.isRequired,onClose:m().func.isRequired}),t.Z=b},13844:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(55164),o=n(71728),i=n(85879),a=n(67814),c=n.n(a),s=n(87363),l=n(38889),u={InputButton:"W2ewFU1c0bx6tahox08q"},d=n(57477),p={InputLike:"EQvEDwRqICOvs_x_kUWW"},h=(0,s.forwardRef)(function(e,t){var n=e.as,a=void 0===n?"div":n,s=e.className,l=e.large,u=e.isFocus,h=(0,o._)(e,["as","className","large","isFocus"]);return(0,i.tZ)(a,(0,d._)((0,r._)({},h),{ref:t,className:c()("InputLike",p.InputLike,s,{"is-focus":u,"is-large":l})}))}),f=(0,s.forwardRef)(function(e,t){var n=e.className,a=e.large,s=(0,o._)(e,["className","large"]);return(0,i.tZ)(h,(0,r._)({as:l.ZP,className:c()("InputButton",u.InputButton,n),large:a,ref:t},s))})},95377:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var r=n(87320),o=n(55164),i=n(57477),a=n(71728),c=n(94009),s=n(85879),l=n(17103),u=n(67814),d=n.n(u),p=n(87363),h=n.n(p),f={wrapper:"QZcfWkCJoarhIYxlM_sG",grey:"evPjxqnqXpIBzSRrcIDv",spread:"qfAmOtjvjgHNSfCPTpcX",multiline:"SPwbMsVc_0aH1eDVWflY",large:"ju2X6TRIjoJMT4oPHAtz",disabled:"boPCcYOmq77n3IFk97nE",noPadding:"wwIaO3dKFgOr8Ft1HHUg",Input:"i7cW1UcwT6ThdhTakqFm",validationError:"re7iEHUAbZCEqcG5SwA8"},_=h().forwardRef(function(e,t){var n,u=e.onRef,h=e.className,_=e.targetClassName,m=e.multiline,v=void 0!==m&&m,g=e.grey,T=void 0!==g&&g,E=e.spread,C=void 0!==E&&E,y=e.before,S=e.after,I=e.large,b=void 0!==I&&I,A=e.disabled,Z=e.placeholder,w=e.validationError,R=e.tag,N=e.noPadding,k=void 0!==N&&N,O=e.onFocus,x=e.onBlur,P=(0,a._)(e,["onRef","className","targetClassName","multiline","grey","spread","before","after","large","disabled","placeholder","validationError","tag","noPadding","onFocus","onBlur"]),D=(0,c._)((0,p.useState)(!1),2),L=D[0],B=D[1],U=R||(v?"textarea":"input");return(0,s.BX)("label",{className:d()(h,"Input-wrapper",f.wrapper,(n={"Input-wrapper--grey":T,"Input-wrapper--spread":C,"Input-wrapper--multiline":v,"Input-wrapper--large":b,"Input-wrapper--disabled":A,"Input-wrapper--noPadding":k,"is-focus":L},(0,r._)(n,f.grey,T),(0,r._)(n,f.spread,C),(0,r._)(n,f.multiline,v),(0,r._)(n,f.large,b),(0,r._)(n,f.disabled,A),(0,r._)(n,f.noPadding,k),n)),children:[y,(0,s.tZ)(U,(0,i._)((0,o._)({},P),{disabled:A,className:d()("Input",f.Input,_,(0,r._)({"Input--validationError":!!w},f.validationError,!!w)),placeholder:w||Z,ref:(0,l.Z)(t,u),onFocus:function(e){O&&O(e),B(!0)},onBlur:function(e){x&&x(e),B(!1)}})),S]})})},51397:function(e,t,n){"use strict";n.d(t,{Z:function(){return b}});var r=n(87320),o=n(55164),i=n(57477),a=n(85879),c=n(67814),s=n.n(c),l=n(38003),u=n(3028),d=n(42951),p=n(64884),h=n(27834),f=n(30577),_=n(6788),m=n(37986),v=n(31458),g=n(17924),T=n(41884),E={online_roundtable:d.T,relevant:p.o,editor_recommendation:h.N,roundtable:d.T,special:f.xl,weekly:_.S,daily:m.N,professional:v.W,zhizhi_plan_recommend:g.z,zhizhi_plan_edu_recommend:g.z,zhizhi_plan_baby_recommend:g.z,zhizhi_plan_acg_recommend:g.z,zhizhi_plan_outing_recommend:g.z,zhizhi_plan_rumour_deny:T.E,zhizhi_plan:g.z},C={alpha:1,group:"GYL02A"},y={alpha:.08,group:"GYL02A"},S={brand_special:l.T},I=(0,i._)((0,o._)({},E),{COMMERCIAL_ICONS:S}),b=(0,u.Z)(null)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.labelInfo,n=e.extra,o=void 0===n?{}:n,i=e.className;if(!t)return null;var c=t.type,l=t.text,u=t.foregroundColor,d=t.backgroundColor,p=o.customIcon,h=o.customIconClassName,f="GBL07A"===(u||C).group?"commercial":"positive",_="GBL07A"===(d||y).group?"commercial":"positive",m=p||I["recognition"===c?"professional":c];return m?(0,a.BX)("span",{className:s()("Label-icon","Label-iconColor--".concat(f),(0,r._)({},"Label-iconColor--".concat(_,"Background"),d),i),children:[(0,a.tZ)(m,{center:!0,className:s()("Label-iconImg",h)}),l]}):null})},63573:function(e,t,n){"use strict";var r=n(55164),o=n(85879),i=n(29229),a=n(87363),c=n(36695),s=n(10416),l=function(){return(0,o.tZ)("div",{className:"LabelContainer-loading"})};t.Z=function(e){var t=e.item,u=e.abnormalDetailProps,d=e.collapseReasonProps,p=e.showDeleteButton,h=e.inviter,f=t.type,_=t.id,m=t.isLabeled,v=(0,c.useDispatch)(),g=(0,c.useSelector)(function(e){return u||d?{}:p?{thankInviterInfo:h}:(0,s.yM)(e,t)}),T=(0,i.Z)(function(){return n.e(2033).then(n.bind(n,54662))});return((0,a.useEffect)(function(){m&&!g&&f&&_&&v((0,s.T$)(f,_))},[v,f,_,m,g]),T)?(0,o.tZ)(T,(0,r._)({data:g},e)):m?(0,o.tZ)(l,{}):null}},99213:function(e,t,n){"use strict";n.d(t,{vT:function(){return r.Z}});var r=n(51397);n(85879);var o=n(87363);n(84871);var i=(0,o.createContext)({showLabelInfo:!0,showLabels:!0});i.Provider,i.Consumer},91157:function(e,t,n){"use strict";n.d(t,{Z:function(){return L}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),l=n(85879),u=n(71783),d=n(63722),p=n(67814),h=n.n(p),f=n(14168),_=n.n(f),m=n(87363),v=n(36695),g=n(93206),T=n(69383),E=n(4534),C=n(30722),y=n(38889),S=n(66263),I=n(85576),b=n(89250),A=n(55164),Z=n(57477),w=n(39288),R=(0,w.FH)("ebook",["FOLLOW","UNFOLLOW"]),N=(0,w.FH)("live",["UPDATE_LIKED","UPDATE_COURSE_LIKED"]),k=n(26797),O=n(67927),x=(0,w.FH)("promotion",["LIKE"]),P={ebook:"updateEBookVoters",live:"updateLiveLiked",live_course:"updateLiveCourseLiked",article:"updateArticleLike",promotion:"updatePromotionLike",pin:"updatePinsLike"},D=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleToggleVote",e.props.authRequired(function(t){var n=e.props,r=n.liked,o=n.type,i=n.id,a=!r;T.Z.trackEvent(t.target,{action:a?"Upvote":"UnUpvote",element:"Button"});var c=P[o];e.props[c](i,a)},S.q0.vote)),(0,a._)((0,r._)(e),"handleClick",function(t){var n=e.props,r=n.disableAuth,o=n.handleToggleGuide,i=n.onClick;i&&i(t)||(r?o(t):e.handleToggleVote(t))}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.liked,n=e.count,r=e.className,o=e.icon,i=e.disabled;return(0,l.BX)(y.ZP,{className:h()("LikeButton",{"is-active":t},r),onClick:this.handleClick,disabled:i,"aria-live":"polite",children:["thank"===(void 0===o?"like":o)?(0,l.tZ)(u.sh,{center:!0}):(0,l.tZ)(d.g,{center:!0})," ",(0,C.Zh)(n).trim()]})}}]),n}(m.Component);(0,a._)(D,"propTypes",{type:_().oneOf(E.eX).isRequired,id:_().oneOfType([_().number,_().string]).isRequired,icon:_().string,liked:_().bool,count:_().number});var L=(0,g.compose)(I.Z,(0,v.connect)(null,{updateEBookVoters:function(e){return function(t,n){var r=n().entities.ebooks[e],o=!(r.relationship||{}).voting;return t({API:{types:R.FOLLOW,method:o?"POST":"DELETE",endpoint:"v3/books/".concat(e,"/voters")},UPDATE:{request:{ebooks:(0,a._)({},e,{relationship:(0,Z._)((0,A._)({},r.relationship),{voting:o}),voteupCount:r.voteupCount+(o?1:-1)})},failure:{ebooks:(0,a._)({},e,r)}}})}},updateLiveLiked:function(e){return function(t,n){var r=n().entities.lives[e],o=!r.isLiked;return t({API:{types:N.UPDATE_LIKED,endpoint:"v3/lives/".concat(e,"/like"),method:o?"POST":"DELETE"},UPDATE:{request:{lives:(0,a._)({},e,{isLiked:o,likedNum:r.likedNum+(o?1:-1)})},failure:{lives:(0,a._)({},e,r)}}})}},updateLiveCourseLiked:function(e){return function(t,n){var r=n().entities.liveCourses[e],o=!r.isLiked;return t({API:{types:N.UPDATE_COURSE_LIKED,endpoint:"v3/lives/course/".concat(e,"/like"),method:o?"POST":"DELETE"},UPDATE:{request:{liveCourses:(0,a._)({},e,{isLiked:o,likedNum:r.likedNum+(o?1:-1)})},failure:{liveCourses:(0,a._)({},e,r)}}})}},updateArticleLike:b.k5,updatePromotionLike:function(e){return function(t,n){var r=n().entities.promotions[e]||{},o=r.voteupCount,i=r.voting,c=i?0:1;return t({API:{types:x.LIKE,endpoint:"v3/promotions/".concat(e,"/voters"),query:{voting:c},method:"POST"},UPDATE:{request:{promotions:(0,a._)({},e,{voteupCount:o+(i?-1:1),voting:c})},success:function(t){return{promotions:(0,a._)({},e,t)}},failure:{promotions:(0,a._)({},e,r)}},NOTIFICATION:{failure:O.XR}})}},updatePinsLike:k.T8}))(D)},31142:function(e,t,n){"use strict";var r=n(22107),o=n(94707),i=n(86325),a=n(55164),c=n(71728),s=n(85626),l=n(85879),u=n(14168),d=n.n(u),p=n(87363),h=n(19076),f=n(38889),_=function(e){(0,i._)(n,e);var t=(0,s._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"render",value:function(){var e=this.props,t=e.a,n=e.to,r=e.activeClassName,o=(0,c._)(e,["a","to","activeClassName"]);return t?(o.component="a",o.href=n):(o.component=h.Link,o.to=n,o.activeClassName=r),(0,l.tZ)(f.ZP,(0,a._)({},o))}}]),n}(p.Component);_.propTypes={a:d().bool,to:d().string},_.defaultProps={a:!1},t.Z=_},86385:function(e,t,n){"use strict";var r=n(85879),o=n(75056),i=n(87641),a=n(43384),c=n(38889),s=n(7181);t.Z=function(){return(0,r.tZ)(a.eV,{block:"MarkdownTips",children:(0,r.BX)(i.Text,{color:"GBL05A",ml:"24px",fontSize:14,children:[(0,r.tZ)(a.Wi,{zaType:"Popup",zaText:"Markdown 识别中"}),"Markdown 语法识别中",(0,r.tZ)(s.Z,{arrowed:!0,toggleEvent:"hover",toggler:(0,r.tZ)(c.ZP,{icon:o.ZP,preset:"plain",css:{marginLeft:5}}),children:(0,r.BX)(i.Box,{height:64,width:253,px:14,py:12,fontSize:14,css:function(e){return{color:e.colors.GBK02A}},children:[(0,r.tZ)(a.Wi,{zaType:"Popup",zaText:"Markdown 识别中 - 气泡"}),"可在「工具栏」-「更多」中关闭此模式，支持语法请参考「帮助文档」"," "]})})]})})}},92868:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(55164),o=n(85879),i=n(67814),a=n.n(i),c=function(e){return(0,o.tZ)("span",(0,r._)({css:function(e){return{fontSize:"14px",color:e.colors.GBL05A,"&.is-error":{color:e.colors.GRD03A}}}},e))};function s(e){var t=e.current,n=e.max,r=e.className,i=e.name,s=n-t;return t>n?(0,o.BX)(c,{className:a()(r,"MaxLength","is-error"),children:[void 0===i?"字数":i,"已超过 ",-s," 个字"]}):(0,o.tZ)(c,{className:a()(r,"MaxLength"),children:s<=10&&"还可以输入 ".concat(s," 个字")})}},71364:function(e,t,n){"use strict";var r=n(85879),o=n(43384),i=n(38889),a=n(51618);t.Z=function(e){var t=e.show,n=e.onCancel,c=e.onSubmit,s=(0,o.Q4)().trackEvent;return(0,r.tZ)(a.Z,{className:"SkipModal",show:t,onCancel:n,hideIcon:!0,maskClosable:!1,children:t&&(0,r.BX)(o.Wi,{zaType:"Block",zaBlock:"expandBlockModal",zaText:"展开阅读全文弹窗",children:[(0,r.tZ)("div",{className:"title",children:"即将打开“知乎App”继续阅读"}),(0,r.BX)("div",{className:"button_container",children:[(0,r.tZ)(i.ZP,{preset:"plain",onClick:function(){s({eventType:"Click",block:"expandModal_cancel",elementLocation:{type:"Button"}}),n()},children:"取消"}),(0,r.tZ)(i.ZP,{preset:"primary",onClick:function(){s({eventType:"Click",action:"OpenUrl",block:"expandModal_open",elementLocation:{type:"Button"}}),c()},children:"打开App"})]})]})})}},51618:function(e,t,n){"use strict";var r=n(55164),o=n(85879),i=n(87363),a=n(67814),c=n.n(a),s=n(82644),l=n(92565);t.Z=function(e){var t=e.show,n=e.setModal,a=e.children,u=e.className,d=e.onCancel,p=e.hideIcon,h=e.maskClosable,f=void 0===h||h,_=function(){n?n(!1):d&&d()},m=(0,i.useRef)();return(0,i.useEffect)(function(){var e=null;return t?(document.body.style.overflow="hidden",e=(0,l.c)(m.current)):document.body.style.overflow="auto",function(){e&&e()}},[t]),t?(0,o.tZ)("div",{className:u,children:(0,o.BX)("div",{ref:m,children:[(0,o.tZ)("div",(0,r._)({className:c()({"ModalExp-background":t})},f&&{onClick:_})),(0,o.BX)("div",{className:c()("ModalExp-content",{"ModalExp-modalShow":t}),onClick:function(e){e.stopPropagation()},children:[!p&&(0,o.tZ)(s.HN,{size:24,fill:"#d3d3d3",className:"ModalExp-closeIcon",onClick:_}),a]})]})}):null}},11584:function(e,t,n){"use strict";var r=n(85879),o=n(38020),i=n(67814),a=n.n(i),c=n(87363),s=n(92565);t.Z=function(e){var t=e.show,n=e.children,i=e.className,l=(0,c.useRef)();return(0,c.useEffect)(function(){var e=null;return t?(document.body.style.overflow="hidden",e=(0,s.c)(l.current)):document.body.style.overflow="auto",function(){e&&e()}},[t]),(0,r.tZ)("div",{className:i,children:(0,r.BX)("div",{ref:l,children:[(0,r.tZ)("div",{className:a()({"ModalLoading-background":t})}),(0,r.BX)("div",{className:a()("ModalLoading-content",{"ModalLoading-modalShow":t}),children:[n,(0,r.tZ)(o.Z,{})]})]})})}},99446:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r=n(85879),o=n(87363),i=n(67516),a=n.n(i),c=n(83697),s=n(55679),l=n(51618),u=[{title:"知乎",imageSrc:"https://pic4.zhimg.com/80/v2-88158afcff1e7f4b8b00a1ba81171b61_720w.png",description:"有问题，就会有回答",button:"打开"},{title:"浏览器",imageSrc:"https://picb.zhimg.com/80/v2-a448b133c0201b59631ccfa93cb650f3_1440w.png",description:"",button:"继续"}],d={uc:{imageSrc:"https://pic4.zhimg.com/80/v2-eb129ee601fe0521fbc05703a615ddd5_1440w.png",title:"UC 浏览器"},qq:{imageSrc:"https://pic1.zhimg.com/80/v2-211dd15e1000c599f5b89ecf4e1eb3b6_1440w.png",title:"QQ 浏览器"},wx:{imageSrc:"https://pic1.zhimg.com/80/v2-05fe05b84411fc88790189e95d7e84aa_1440w.png",title:"微信"},huawei:{imageSrc:"https://pic1.zhimg.com/80/v2-88a3ad0d3764917daaf92f5133a7024d_1440w.jpeg",title:"华为浏览器"},safari:{imageSrc:"https://pic2.zhimg.com/80/v2-da7d9e4b6a7ddba507299bcf5a4d0600_1440w.png",title:"Safari"},chrome:{imageSrc:"https://picb.zhimg.com/80/v2-a448b133c0201b59631ccfa93cb650f3_1440w.png",title:"Chrome"},default:{imageSrc:"https://picb.zhimg.com/80/v2-a448b133c0201b59631ccfa93cb650f3_1440w.png",title:"浏览器"}},p=function(e){var t=e.show,n=e.onCancel,i=e.onSubmit,p=e.id,h=e.type,f=(0,c.n)(),_=f.origin.toLowerCase(),m=f.Android?d.chrome.imageSrc:d.safari.imageSrc,v=a().get("question:firstCheckedTrue");(0,o.useEffect)(function(){v&&t&&!f.Wechat&&(location.href="zhihu://".concat(h,"/").concat(p))},[v,t,h,p,f.Wechat]);var g=function(e){0===e?(a().set("question:firstCheckedTrue","true"),i()):n()},T="";return T=f.UC?"uc":f.Wechat?"wx":f.MQQBrowser?"qq":/huawei|honor/g.test(_)?"huawei":/chrome/g.test(_)||/crios/g.test(_)?"chrome":f.Safari?"safari":"default",u[1].title=d[T].title,u[1].imageSrc="default"===T?m:d[T].imageSrc,(0,r.BX)(l.Z,{className:"ModalWrap",show:t,onCancel:n,hideIcon:!0,maskClosable:!1,children:[t&&(0,r.tZ)(s.dF,{className:"ModalWrap-body"}),(0,r.BX)("div",{className:"ModalWrap-content",children:[(0,r.tZ)("div",{className:"ModalWrap-title",children:"继续浏览内容"}),u.map(function(e,t){return(0,r.BX)("div",{className:"ModalWrap-item",children:[e.imageSrc&&(0,r.tZ)("div",{className:"ModalWrap-itemImg",children:(0,r.tZ)("img",{src:e.imageSrc,alt:""})}),(0,r.BX)("div",{className:"ModalWrap-itemContent",children:[(0,r.tZ)("div",{className:"ModalWrap-itemTitle",children:e.title}),e.description&&(0,r.tZ)("div",{className:"ModalWrap-itemDesc",children:e.description})]}),(0,r.tZ)("div",{className:"ModalWrap-itemBtn",role:"button",tabIndex:0,onClick:function(){return g(t)},children:e.button})]},t)})]})]})}},91770:function(e,t,n){"use strict";n.d(t,{Z:function(){return C}});var r=n(22107),o=n(94707),i=n(87320),a=n(86325),c=n(55164),s=n(57477),l=n(71728),u=n(85626),d=n(85879),p=n(89174),h=n(67814),f=n.n(h),_=n(14168),m=n.n(_),v=n(87363),g=n(30722);function T(e){var t=e.className,n=e.tag,r=e.name,o=e.value,i=e.isFormatted,a=(0,l._)(e,["className","tag","name","value","isFormatted"]),u="div";return n?u=n:a.href?u="a":a.onClick&&(u=p.ZP),(0,d.tZ)(u,(0,s._)((0,c._)({className:f()("NumberBoard-item",t)},a),{children:(0,d.BX)("div",{className:"NumberBoard-itemInner",children:[(0,d.tZ)("div",{className:"NumberBoard-itemName",children:r}),(0,d.tZ)("strong",{className:"NumberBoard-itemValue",title:o,children:void 0!==i&&i?o:(0,g.uf)(o)})]})}))}var E=function(e){(0,a._)(n,e);var t=(0,u._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.divider,r=e.children,o=e.items,i=(0,l._)(e,["className","divider","children","items"]);return(0,d.tZ)("div",(0,s._)((0,c._)({className:f()("NumberBoard",t,{"NumberBoard--divider":n})},i),{children:r||o.map(function(e){return(0,d.tZ)(T,(0,c._)({},e),e.name)})}))}}]),n}(v.Component);(0,i._)(E,"propTypes",{divider:m().bool}),(0,i._)(E,"defaultProps",{divider:!1}),(0,i._)(E,"Item",T);var C=E},41835:function(e,t,n){"use strict";n.d(t,{Z:function(){return Z}});var r=n(55164),o=n(85879),i=n(65733),a=n(19706),c=n(36695),s=n(43384),l=n(3028),u=n(5198),d=n(58909),p=n(7407),h=n(89174),f=function(e){var t=e.onClick;return(0,o.tZ)(h.ZP,{color:"blue",preset:"primary",onClick:t,css:{height:39,fontSize:15,borderRadius:24,pointerEvents:"auto"},children:"App 内打开"})},_=n(94009),m=n(62264),v=n(7835),g=n(67814),T=n.n(g),E=n(87363),C={ease:"easeOut",duration:.3},y=function(){var e,t=document.querySelectorAll(".RichContent-actions");if(t.length>0){var n=Array.from(t).find(function(e){var t=e.classList;return t.contains("Sticky")&&t.contains("is-fixed")&&t.contains("is-bottom")});return(null==n?void 0:n.clientHeight)||0}var r=document.querySelectorAll(".oia-action-bar");return r.length>0&&(null===(e=r[0])||void 0===e?void 0:e.clientHeight)||0},S=function(){var e=(0,_._)((0,E.useState)(12),2),t=e[0],n=e[1];return(0,v.Z)(function(){n(y()+12)}),t},I=function(e){var t=e.children,n=e.className,r=S();return(0,o.tZ)(m.d7.div,{initial:{opacity:0,translateY:8},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:8},transition:C,className:T()("OpenInAppButton is-higher",n),css:{position:"fixed",display:"flex",justifyContent:"center",top:"auto",left:16,bottom:r,width:"calc(100vw - 32px)",zIndex:1,pointerEvents:"none"},children:t})},b=n(258),A=function(e){var t=e.onClick,n=e.href,r=e.className,l=(0,u.Z)(),p=(0,c.useSelector)(d.ib),h=(0,s.Q4)().trackEvent,_=(0,i.Z)(null!=t?t:function(){(0,b.Z)({trackEvent:h,href:n,zaV3Text:"底部打开App按钮",noEnteringSignin:!!p,from:"poplayer"})});return(0,o.tZ)(a.M,{exitBeforeEnter:!0,initial:!1,children:l&&(0,o.tZ)(I,{className:r,children:(0,o.tZ)(f,{onClick:_},"button")})})},Z=(0,l.Z)(null)(function(e){var t=(0,c.useSelector)(p.cM),n=t.oppoSearch,i=t.huaweiSearch;return n?null:(0,o.tZ)(A,(0,r._)({},e,i&&{onClick:function(){return location.href="https://onelink.zhihu.com/onelink?id=711"}}))})},258:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(82452),o=n(57138);function i(e,t){var n=e.trackEvent,i=e.zaV3Text,a=e.href,c=e.from,s=a||(0,o.MN)((0,o.Qu)(location.pathname));null==n||n({eventType:"Click",action:"OpenUrl",block:"OpenInAppButton",elementLocation:{type:"Button",text:i}},{link:{url:s},configMap:{callback_from:c}}),(0,r.rH)(s,t)}},65101:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(85879),o=n(87363),i=n(14168),a=n.n(i),c=n(36695),s=n(93206),l=n(38746),u=n(3028),d=n(79540);function p(e){var t=e.loadBrandContentPlugin,n=e.contentType,i=e.contentToken,a=e.author,c=e.plugin,s=(0,o.useCallback)(function(){t(n,i)},[n,i,t]),u="organization"===a.userType&&!c;return((0,o.useEffect)(function(){u&&s()},[u,s]),c)?(0,r.tZ)("div",{className:"OrgEquityPlugin",children:(0,r.tZ)(l.Z,{data:{contentType:n,contentToken:i,suger:{},author:a,plugin:c,visible:!0}})}):null}p.propTypes={contentType:a().oneOf(["answer","article"]).isRequired,contentToken:a().oneOfType([a().number,a().string]).isRequired,author:a().object.isRequired};var h=(0,s.compose)((0,u.Z)(null),(0,c.connect)(function(e,t){var n=t.contentType,r=t.contentToken;return{plugin:(0,d.PQ)(e,{contentType:n,contentToken:r})}},{loadBrandContentPlugin:d.RD}))(p)},87225:function(e,t,n){"use strict";n.d(t,{Z:function(){return to}});var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(30037),s=n(67814),l=n.n(s),u=n(87363),d=n(36695),p=n(93206),h=n(99830),f=n(2174),_=n(66263),m=n(85576),v=n(92718),g=n(58909),T=n(1606),E=n(30361),C=n(8231),y=function(e){var t=e.content,n=e.name,r=e.hasAuthorBeforeContent;return(0,u.useMemo)(function(){if(!(null==t?void 0:t[0]))return"";var e="";return"text"===t[0].type&&(e=t[0].content,r&&(e=n?"".concat(n,"：").concat(e):e)),e},[t,n,r])};function S(e){var t=[],n=[],r=[],o=[];return e&&Array.isArray(e)&&e.length&&e.forEach(function(e){var i=e.type;"quote"===i&&r.push(e),"video"===i&&n.push(e),"link"===i&&o.push(e),"image"===i&&t.push(e)}),{images:t,videos:n,quotes:r,links:o}}var I=n(77683),b=n(46829);function A(e){var t=e.preset,n=e.author,r=e.showFollowButton;return"special-plain"===t?null:(0,a.tZ)("div",{children:(0,a.BX)("div",{className:"PinItem-author",children:[(0,a.tZ)(I.Z,{author:n,className:"PinItem-authorInfo",preset:"plain"===t?"plain":"default",userLinkV2:!0},"authorInfo"),r&&(0,a.tZ)(b.Z,{className:"PinItem-followButton",preset:"primary",type:n.type,id:n.urlToken,gender:n.gender,isFollowing:n.isFollowing})]})})}var Z=n(20857),w=n(22107),R=n(94707),N=n(87320),k=n(86325),O=n(85626),x=n(66011),P=n(14168),D=n.n(P),L=n(43384),B=n(88423),U=n(81488),M=n(16836),G=n(54674),F=n(99878),z=n(82644),H=n(72137),q=n(17132),V=n.n(q),X={top:10,left:20},W={top:0,left:0};function K(){var e=V()(navigator.userAgent).Mobile?W:X,t=e.top,n=e.left,r=window.innerWidth,o={left:0,top:0,width:r,height:window.innerHeight},i={x:o.left+o.width/2,y:o.top+o.height/2},a=(96+n)*2,c=r,s=0;return r<1e3+a?c=r-a:(c=1e3,s=(r-(1e3+a))/2),{x:i.x,y:i.y,imgContainerWidth:c,imgContainerHeight:o.height-2*t,left:s,top:t}}var j=function(e){(0,k._)(n,e);var t=(0,O._)(n);function n(e){var o;return(0,w._)(this,n),o=t.call(this,e),(0,N._)((0,Z._)(o),"getBoundingClientRect",function(e,t){var n=t.width,r=t.height,o={top:0,left:0,width:0,height:0},i=1;return e.width>e.height?(o.height=r,i=r/e.height,o.width=e.width*i,o.left="-".concat((o.width-n)/2)):e.width<e.height?(o.width=n,i=n/e.width,o.height=e.height*i,o.top="-".concat((o.height-r)/2)):(o.width=n,o.height=r),o}),(0,N._)((0,Z._)(o),"getParentNode",function(){for(var e,t=o.props.img.parentNode;t&&"BODY"!==t.nodeName;){if(t.classList.contains("Image-Wrapper-Preview")){e=t;break}t=t.parentNode}return e}),(0,N._)((0,Z._)(o),"getChildImgNode",function(e){if(e){var t=e.childNodes,n=o.state.index,r=n;return n>=t.length&&(r=t.length-1),{img:(0,t[r]).querySelector(".Image-Preview"),index:r}}}),(0,N._)((0,Z._)(o),"setImageElAttr",function(){var e=o.state,t=e.width,n=e.transition,r=o.props.images,i=o.getParentNode(),a=o.getChildImgNode(i);if(a&&a.img){var c=a.img.getBoundingClientRect(),s=o.getBoundingClientRect(r[a.index],{width:c.width,height:c.height}),l=o.imgEl.getBoundingClientRect(),u=o.containerClientRect,d=u.left,p=u.top,h={x:l.left+l.width/2-d-s.width/2,y:l.top+l.height/2-p-s.height/2},f=t/s.width;if("transition"===n){o.setState({translate:null,scale:null,opacity:-1,transform:"translate(".concat(c.left-d,"px,").concat(c.top-p,"px)")});return}o.setState({transition:""},function(){o.setState({rect:c,transition:"",width:s.width,height:s.height,translate:h,scale:f,transform:"translate(".concat(h.x,"px ,").concat(h.y,"px) scale(").concat(f,")")})}),setTimeout(function(){o.setState({transition:"transition",translate:null,scale:null,transform:"translate(".concat(c.left-d,"px,").concat(c.top-p,"px)"),opacity:-1})},20)}}),(0,N._)((0,Z._)(o),"getImageSize",function(e){var t=o.containerClientRect,n=t.imgContainerWidth,r=t.imgContainerHeight,i=e.width,a=e.height,c=!1,s=1;return(e.width>n||e.height>r)&&(e.width>n&&(s=n/e.width,i=e.width*s,a=s*e.height),a>r&&(s=r/a,a*=s,i*=s),c=!0),o.setState({cursorZoomIn:c}),{width:i,height:a}}),(0,N._)((0,Z._)(o),"handleResizeCallback",function(){o.containerClientRect=K();var e=o.state.index,t=o.props.images;o.setState((0,r._)({transition:"fixed",transform:""},o.getImageSize(t[e])))}),(0,N._)((0,Z._)(o),"handleClick",function(e){var t=o.state.cursorZoomIn,n=e.target;n&&n.classList&&n.classList.contains("ImageGallery-Img")&&t&&o.setState({previewImage:n}),(n.classList.contains("ImageGallery")||n.classList.contains("ImageGallery-Inner"))&&o.setImageElAttr()}),(0,N._)((0,Z._)(o),"handleTransEnd",function(){var e=o.state,t=e.translate,n=e.scale,r=o.props.onClose;t&&n||r()}),(0,N._)((0,Z._)(o),"handlePreviewImageClose",function(){o.setState({previewImage:null},function(){H.Cp()})}),(0,N._)((0,Z._)(o),"handleKeyUpCallback",function(e){39===e.keyCode?o.handleCutImage(1):37===e.keyCode&&o.handleCutImage(-1)}),(0,N._)((0,Z._)(o),"handleCutImage",function(e){var t=o.state.index+e,n=o.props.images;t<n.length&&t>=0&&o.setState((0,r._)({index:t,transition:"fixed",transform:""},o.getImageSize(n[t])))}),o.state={transEnded:!1,translate:null,scale:null,url:null,index:e.index||0,width:0,height:0,rect:null,transition:"transition",previewImage:null,transform:"",cursorZoomIn:!1,opacity:1},o.containerClientRect=K(),o}return(0,R._)(n,[{key:"UNSAFE_componentWillMount",value:function(){var e=this.props,t=e.data,n=e.img.getBoundingClientRect();H.Cp();var r=this.containerClientRect,o=r.left,i=r.top,a=this.getBoundingClientRect(t,{width:n.width,height:n.height}),c={left:n.left-o+Number(a.left),top:n.top-i+Number(a.top)};this.setState({rect:a,width:a.width,height:a.height,transform:"translate(".concat(c.left,"px, ").concat(c.top,"px)")})}},{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.setState((0,r._)({},e.computeTransition(e.props.index)))},20),window.addEventListener("keyup",this.handleKeyUpCallback),window.addEventListener("resize",this.handleResizeCallback)}},{key:"componentWillUnmount",value:function(){H.$Z(),window.removeEventListener("keyup",this.handleKeyUpCallback),window.removeEventListener("resize",this.handleResizeCallback)}},{key:"computeTransition",value:function(e){var t=this.props.images[e],n=this.containerClientRect,r=n.x,o=n.y,i=n.left,a=n.top,c=this.getImageSize(t).width;if(this.imgEl){var s=this.imgEl.getBoundingClientRect(),l=c/s.width,u={x:r-s.width/2-i,y:o-s.height/2-a};return{translate:u,scale:l,transform:"translate(".concat(u.x,"px ,").concat(u.y,"px) scale(").concat(l,")")}}}},{key:"render",value:function(){var e=this,t=this.props.images,n=this.state,r=n.translate,o=n.index,i=n.width,c=n.height,s=n.transition,u=n.previewImage,d=n.transform,p=n.cursorZoomIn,h=n.opacity,f=this.containerClientRect,_=f.left,m=f.top,v=f.imgContainerWidth,g=f.imgContainerHeight,T=(V()(navigator.userAgent).Mobile?W:X).left,E=t[o];return(0,a.tZ)(M.Z,{children:(0,a.BX)("div",{className:l()("ImageGallery",{"is-active":r}),onClick:this.handleClick,children:[(0,a.BX)("div",{className:"ImageGallery-Content",style:{width:"".concat(v+(96+T)*2,"px"),height:"".concat(g,"px"),left:"".concat(_,"px"),top:"".concat(m,"px")},children:[!u&&t.length>1&&(0,a.tZ)("a",{className:l()("ImageGallery-arrow-left",{"ImageGallery-arrow-disabled":0===o}),style:{left:"".concat(T,"px")},onClick:function(){return e.handleCutImage(-1)},children:(0,a.tZ)(G.e,{fill:"#fff",size:42})}),(0,a.tZ)("div",{className:"ImageGallery-Inner",ref:function(t){e.scrollNode=t},children:(0,a.tZ)("img",{ref:function(t){e.imgEl=t},src:(0,B.imgUrl)(E.url,"r"),className:l()("ImageGallery-Img",{"ImageGallery-transition":"transition"===s,"ImageGallery-fixed":"fixed"===s,"ImageGallery-CursorZoomIn":p}),style:{width:i,height:c,transform:d,opacity:h},onTransitionEnd:this.handleTransEnd,alt:"preview","data-rawwidth":E.width,"data-rawheight":E.height,"data-thumbnail":E.thumbnail,"data-original":(0,B.imgUrl)(E.url,"r"),"data-actualsrc":(0,B.imgUrl)(E.url,"b")})}),!u&&t.length>1&&(0,a.tZ)("a",{className:l()("ImageGallery-arrow-right",{"ImageGallery-arrow-disabled":o>=t.length-1}),onClick:function(){return e.handleCutImage(1)},style:{right:"".concat(T,"px")},children:(0,a.tZ)(F.N,{fill:"#fff",size:42})})]}),!u&&(0,a.tZ)("a",{className:"ImageGallery-close",onClick:this.setImageElAttr,children:(0,a.tZ)(z.HN,{fill:"#fff"})}),u&&(0,a.tZ)(U.Z,{img:u,onClose:this.handlePreviewImageClose})]})})}}]),n}(u.Component);(0,N._)(j,"propTypes",{img:D().object.isRequired,data:D().object.isRequired,onClose:D().func.isRequired});var Y=function(e){(0,k._)(n,e);var t=(0,O._)(n);function n(e){var r;return(0,w._)(this,n),r=t.call(this,e),(0,N._)((0,Z._)(r),"setImageAttr",function(){var e=r.state,t=e.width,n=e.height;if(!t||!n){var o=r.divEl.getBoundingClientRect();t=t||o.width,n=n||o.width,r.setState({width:t,height:n})}var i=r.getBoundingClientRect({width:t,height:n});r.setState({imageWidth:i.width,imageHeight:i.height,imageTop:i.top,imageLeft:i.left})}),(0,N._)((0,Z._)(r),"getBoundingClientRect",function(e){var t=e.width,n=e.height,o=r.props.data,i={top:0,let:0,width:0,height:0},a=1;return o.width>o.height?(i.height=n,a=n/o.height,i.width=o.width*a,i.left="-".concat((i.width-t)/2)):(i.width=t,a=t/o.width,i.height=o.height*a,i.top="-".concat((i.height-n)/2)),i}),(0,N._)((0,Z._)(r),"handlePreviewImageOpen",function(e){var t=r.props.onPreviewImageOpen;e.persist(),t&&t(e)||r.setState({previewImage:r.imgWrapper.querySelector("img")})}),(0,N._)((0,Z._)(r),"handlePreviewImageClose",function(){r.setState({previewImage:null})}),r.state={width:e.width||0,height:e.height||0,imageWidth:0,imageHeight:0,imageTop:0,imageLeft:0,previewImage:null},r}return(0,R._)(n,[{key:"componentDidMount",value:function(){this.setImageAttr()}},{key:"render",value:function(){var e=this,t=this.state,n=t.width,r=t.height,o=t.previewImage,i=t.imageWidth,c=t.imageHeight,s=t.imageTop,u=t.imageLeft,d=this.props,p=d.data,h=d.images,f=d.index,_=d.surplus,m=d.previewType,v=d.data.isGif,g=d.vague,T=d.previewTransitionType;return(0,a.BX)(L.Wi,{shouldTrackClick:!o,zaType:"Image",zaModuleId:"IMAGE_TOP_CONTAINER",extra:{configMap:{image_index:String(f+1)}},onClick:this.handlePreviewImageOpen,className:"Thumbnail-Wrapper",ref:function(t){e.divEl=t},style:{width:n?"".concat(n,"px"):"",height:r?"".concat(r,"px"):""},children:[(0,a.tZ)("span",{ref:function(t){e.imgWrapper=t},className:l()({"Image-PreviewVague":g}),children:g?(0,a.tZ)(x.Nm,{className:"Image-Preview",src:v?(0,B.imgUrl)(p.thumbnail,"xl"):(0,B.imgUrl)(p.url,"xl"),width:n,height:r,alt:"cover",thumbnail:v?(0,B.imgUrl)(p.thumbnail,"xl"):(0,B.imgUrl)(p.url,"xl"),"data-rawwidth":p.width,"data-rawheight":p.height,"data-thumbnail":p.thumbnail,"data-original":(0,B.imgUrl)(p.url,"r"),"data-actualsrc":(0,B.imgUrl)(p.url,"b")}):(0,a.tZ)("img",{className:"Image-Preview",src:v?p.thumbnail:(0,B.imgUrl)(p.url,"r"),width:i,height:c,style:{top:"".concat(s,"px"),left:"".concat(u,"px")},alt:"preview","data-rawwidth":p.width,"data-rawheight":p.height,"data-thumbnail":p.thumbnail,"data-original":(0,B.imgUrl)(p.url,"r"),"data-actualsrc":(0,B.imgUrl)(p.url,"b")})}),_>0&&(0,a.tZ)("em",{className:"Thumbnail-Surplus-Sign",children:"+".concat(_)}),v&&(0,a.tZ)("em",{className:"Thumbnail-Gif-Sign",children:"GIF"}),o&&(1===(void 0===m?1:m)?(0,a.tZ)(j,{img:o,data:p,index:f,images:h,onClose:this.handlePreviewImageClose}):(0,a.tZ)(U.Z,{img:o,isOriginalUrl:!g,transitionType:void 0===T?0:T,data:p,onClose:this.handlePreviewImageClose}))]})}}]),n}(u.Component);function Q(e){var t=e.images,n=void 0===t?[]:t;return 0===n.length?null:(0,a.tZ)("div",{className:"Image-Wrapper-Preview",children:n.slice(0,4).map(function(e,t){return(0,a.tZ)(Y,{data:e,vague:!0,index:t,images:n,surplus:3===t&&Math.max(0,n.length-4)},t)})})}(0,N._)(Y,"propTypes",{width:D().number,height:D().number,index:D().number,surplus:D().number,data:D().object,images:D().array,onPreviewImageOpen:D().func});var J=n(93445),$=function(e){var t=e.pinId,n=e.data,r=n.videoId||n.id,o=n.thumbnail;return(0,a.tZ)("div",{css:{paddingTop:"".concat(9/16*100,"%"),position:"relative"},children:(0,a.tZ)(J.Z,{cover:o,videoId:r,contentId:t,contentType:"pin",zaProps:{type:"Pin",token:t}})})};function ee(e){var t=e.id,n=e.videos,r=void 0===n?[]:n;return 0===r.length?null:r.map(function(e,n){return(0,a.tZ)($,{pinId:t,data:e},n)})}function et(e){var t=e.id,n=e.images,r=e.videos;return 0===n.length&&0===r.length?null:(0,a.BX)("div",{className:l()("RichText","ztext","PinItem-remainContentRichText"),children:[(0,a.tZ)(Q,{images:n}),(0,a.tZ)(ee,{id:t,videos:r})]})}var en=n(64099);function er(e){var t=e.data,n=t.url,r=t.card;return(0,a.tZ)(en.Ho,{html:'<a href="'+n+'" data-draft-type="link-card" ></a>',linkCardInfo:(0,N._)({},"".concat(n),r)})}function eo(e){var t=e.links,n=void 0===t?[]:t;return 0===n.length?null:n.map(function(e,t){return(0,a.tZ)(er,{data:e},t)})}function ei(e){var t=e.quotes,n=void 0===t?[]:t;return 0===n.length?null:n.map(function(e,t){return(0,a.tZ)("blockquote",{className:"PinItem-3lineBlockquote",children:e.content},t)})}function ea(e){var t=e.useNewPinStyle,n=e.id,r=e.images,o=e.videos,i=e.quotes,c=e.links;return 0===r.length&&0===o.length&&0===i.length&&0===c.length?null:(0,a.BX)("div",{className:l()("RichText","ztext","PinItem-remainContentRichText"),children:[!t&&(0,a.tZ)(Q,{images:r}),!t&&(0,a.tZ)(ee,{id:n,videos:o}),(0,a.tZ)(ei,{quotes:i}),(0,a.tZ)(eo,{links:c})]})}function ec(e){var t=e.pin,n=e.useNewPinStyle,r=e.noCollapsed,o=t.id,i=t.regulateInfo,c=t.isDeleted,s=t.deletedReason,u=t.content,d=t.author,p=S(u),h=p.images,f=p.videos,_=p.quotes,m=p.links;if(null==i?void 0:i.isRegulating)return(0,a.tZ)("div",{className:l()("PinItem-RichText","PinItem-content-originpin"),children:i.reason});if(c)return(0,a.tZ)("div",{className:l()("PinItem-RichText","PinItem-content-originpin"),children:s});if(u&&u[0]){var v=u.find(function(e){return"text"===e.type});return(0,a.BX)("div",{className:l()("PinItem-RichText","PinItem-content-originpin"),css:{paddingTop:6},children:[n&&(0,a.tZ)(et,{id:o,images:h,videos:f}),(0,a.BX)("div",{css:{marginTop:12},children:[d.name,"："]}),v&&(0,a.tZ)(C.Z,{html:v.content,noCollapsed:r,expanded:r}),(0,a.tZ)(ea,{id:o,useNewPinStyle:n,images:h,videos:f,quotes:_,links:m})]})}return null}var es=n(80608),el=n(87641),eu=n(38003),ed=n(60425),ep=n(25195),eh=n(64011),ef=n(53237),e_=n(42951),em=n(60203),ev=n(64884),eg=n(27834),eT=n(32516),eE=n(30577),eC=n(6788),ey=n(37986),eS=n(31458),eI=n(17924),eb=n(41884),eA=n(31650),eZ={zhicon_icon_24_badge_write_fill:eu.Z,zhicon_icon_24_crab_fill:ed.Z,zhicon_icon_24_blue_book:ep.Z,zhicon_icon_24_exclamation_circle_fill:eh.Z,zhicon_icon_24_hash_bubble_fill:ef.Z,zhicon_icon_24_label_roundtable:e_.Z,zhicon_icon_24_chat_bubble_hash_fill:em.Z,zhicon_icon_24_badge_relevant_fill:ev.Z,zhicon_icon_24_badge_recommendation_fill:eg.Z,zhicon_icon_24_search_circle_fill:eT.Z,zhicon_icon_24_newspaper_fill:eE.ZP,zhicon_icon_24_label_weekly:eC.Z,zhicon_icon_24_label_daily:ey.Z,zhicon_icon_24_badge_pro_fill:eS.Z,zhicon_icon_24_cheese:eI.Z,zhicon_icon_24_stamp:eb.Z,zhicon_icon_24_zhi_zhi_ji_hua:eA.Z},ew=n(65733),eR=function(e){return e},eN=function(e){var t=(0,i._)(e.filter(function(e){return"TEXT"===e.type}),2),n=t[0],r=t[1],o=e.find(function(e){return"IMAGE"===e.type&&!e.selectedImageKey});return{first:n,second:r,icon:o,hasIcon:!!o}},ek=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eR,n=(0,ew.Z)(t);return(0,u.useMemo)(function(){return e.map(function(e,t){return n(eN(e.elements),t)})},[e,n])},eO=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eR,n=(0,ew.Z)(t);return(0,u.useMemo)(function(){return n(eN(e))},[e,n])},ex=function(e){var t=eZ[e.imageKey];return t?(0,a.tZ)(t,{fill:"currentColor",size:18,text:!0,center:!0}):null},eP=function(e){var t=e.data,n=(0,i._)(t,2),o=n[0],c=n[1],s=eO(o.elements),l=s.first,u=s.second,d=s.icon,p=(0,i._)(c.elements,1)[0];return(0,a.tZ)(es.yk,(0,r._)({name:l.content,subText:null==u?void 0:u.content,description:p.content},!!d&&{renderMoreIcon:(0,a.tZ)(ex,{imageKey:d.imageKey}),moreLink:d.actionUrl}))},eD=function(e){var t=e.data,n=ek(t,function(e,n){var r=e.first,o=e.second,i=e.icon,a=e.hasIcon,c=r.fontColor||{};return{type:r.content,color:{color:c.group,textAlpha:c.alpha},icon:a&&eZ[i.imageKey],title:r.content,description:null==o?void 0:o.content,link:t[n].actionUrl}});return(0,a.tZ)(es.zi,{data:n})},eL=(0,u.forwardRef)(function(e,t){var n=e.bg,r=e.data,o=e.subNodes,i=e.url,c=e.type,s=eO(r),l=s.first,u=s.second,d=s.icon,p=s.hasIcon,h=l.fontColor||{};return(0,a.tZ)(es.Lr,{ref:t,color:{bg:n.group,bgAlpha:n.alpha,color:h.group,textAlpha:h.alpha},icon:p&&eZ[d.imageKey],name:l.content,subText:null==u?void 0:u.content,link:i,css:{margin:"0 10px 10px 0",display:"inline-flex"},children:"DESCRIPTION"===c?(0,a.tZ)(eP,{data:o}):(0,a.tZ)(eD,{data:o})})}),eB=(0,u.forwardRef)(function(e,t){var n=e.data,r=e.bg,o=e.url,i=eO(n),c=i.first,s=i.second,l=i.icon,u=i.hasIcon,d=c.fontColor||{};return(0,a.tZ)(es.__,{ref:t,color:{bg:r.group,bgAlpha:r.alpha,color:d.group,textAlpha:d.alpha},icon:u&&eZ[l.imageKey],name:c.content,subText:null==s?void 0:s.content,link:o,css:{margin:"0 10px 10px 0",display:"inline-flex"}})}),eU=function(e){var t,n=e.item;return(null===(t=n.subElements)||void 0===t?void 0:t.length)>0?(0,a.tZ)(eL,{bg:n.backgroundColor,data:n.elements,subNodes:n.subElements,url:n.actionUrl,type:n.subElementsType}):(0,a.tZ)(eB,{bg:n.backgroundColor,data:n.elements,url:n.actionUrl})},eM=function(e){var t=e.qualityLabel,n=null==t?void 0:t[0];return n?n.theme?(0,a.tZ)(el.Box,{marginY:16,children:(0,a.tZ)(es.Gh,{theme:n.theme.toUpperCase(),text:n.text,iconName:null==n?void 0:n.icon,detail:n.detail})}):(0,a.tZ)(el.Box,{marginY:16,children:(0,a.tZ)(eU,{item:n})}):null},eG=n(72111),eF=n(19076);function ez(e){var t=e.pinId,n=e.title,r=e.href,o=e.showHeightLight,i=e.onClick;return(0,a.tZ)(L.eV,{block:"卡片标题跳转",children:(0,a.tZ)("h2",{className:"ContentItem-title",children:(0,a.tZ)(eG._o,{zaAction:"OpenUrl",zaEventType:"Click",zaText:"标题跳转",zaType:"Text",children:(0,a.BX)("div",{itemProp:"zhihu:pin",itemType:"http://schema.org/UserTweets",itemScope:!0,children:[(0,a.tZ)("meta",{itemProp:"url",content:"https://www.zhihu.com/pin/".concat(t)}),(0,a.tZ)("meta",{itemProp:"name",content:n}),(0,a.tZ)(eF.Link,{to:r,target:"_blank",onClick:i,children:o?(0,a.tZ)("span",{dangerouslySetInnerHTML:{__html:n},className:"AnswerItem-highlight"}):n})]})})})})}var eH=n(89174),eq=n(84220),eV=n(60811),eX=n(11018),eW=n(58216),eK=n(1733),ej=n(82926),eY=n(99158),eQ=n(19495),eJ=n(85703),e$=n(63362),e0=n(102),e1=n(24752),e2=n(24794),e3=n(12421),e4=n(7407),e5=n(67927),e6=n(26797),e7=n(71728),e8=n(65939),e9={Neutral:0,UP:1,DOWN:-1},te=(0,m.Z)(function(e){var t=e.pin,n=e.authRequired,o=(0,e7._)(e,["pin","authRequired"]),i=t.reaction||{},c=i.relation,s=i.statistics,l=c||{},u=l.vote,p=l.isAuthor,h=(s||{}).upVoteCount,f=e9[void 0===u?"Neutral":u],m=(0,d.useDispatch)(),v=(0,ew.Z)(n(function(e){var n="neutral"!==e?e:1===f?"up":"down";m((0,e6.uC)(t.id,n))},_.q0.vote));return(0,a.tZ)(e8.Z,(0,r._)({count:h,voting:f,isOwner:void 0!==p&&p,onVote:v,hideDownVote:!0},o))}),tt=function(e){var t=e.action,n=e.moduleId,r=e.onClick,o=e.children;return(0,a.tZ)(L.$U,{zaAction:t,zaType:"Button",zaModuleId:n,as:eK.sN,onClick:r,css:{lineHeight:"40px"},children:o})};function tn(e){var t=e.positionStatus,n=e.href,r=e.stickyFeatureEnabled,o=e.commentsShown,c=e.setCommentsShown,s=e.isDetailPage,l=e.pin,p=e.isSticky,h=e.handleToggleSticky,f=e.showCommentButton,m=e.currentUser,v=e.blockStrategies,g=e.authRequired,T=e.isTopicPage,C=l.id,y=l.author,S=l.commentCount,I=l.adminClosedComment,b=l.reaction,A=v||{},Z=A.isBlockingCollect,w=A.isBlockingShare,R=A.isBlockingComment,N=A.isBlockingVote,k=(0,i._)((0,u.useState)(!1),2),O=k[0],x=k[1],P=(0,i._)((0,u.useState)(!1),2),D=P[0],L=P[1],B=(0,i._)((0,u.useState)(!1),2),U=B[0],M=B[1],G=(0,d.useSelector)(e4.Hu),F=(0,d.useDispatch)(),z=(void 0===b?{}:b).relation||{},H=z.liked,q=z.isAuthor,V=(0,eY.Z)([(0,eY.m)(v)],ej.Z),X=(0,ew.Z)(g(function(){F((0,e6.A0)(C))})),W=V({componentList:[{name:"like",component:(0,a.tZ)(tt,{action:H?"UnLike":"Like",moduleId:"content_card_like_unlike_button",onClick:X,children:H?"取消喜欢":"喜欢"})},{name:"report",component:!q&&(0,a.tZ)(tt,{action:"Report",moduleId:"click_report",onClick:function(){g(function(){return M(!0)},_.q0.report)()},children:"举报"})}]}).filter(Boolean);return(0,a.BX)(a.HY,{children:[(0,a.BX)(E.eX,{css:{marginTop:-10},children:[!(void 0!==T&&T)&&!N&&(0,a.tZ)(te,{pin:l}),!R&&(void 0===f||f)&&(0,a.tZ)(eQ.Z,{onClick:function(){return c(!o)},commentsShown:o,commentClosed:I,count:S,positionStatus:t}),!w&&(0,a.tZ)(e2.Z,{id:C,type:"pin",authorName:y&&y.name,href:n,positionStatus:t}),!Z&&(!m||!m.isOrg)&&(0,a.tZ)(e$.Z,{onClick:function(){g(function(){return x(!0)},_.q0.favlists)()},label:"收藏"}),!G&&r&&q&&(0,e3.U)(m)&&(0,a.tZ)(eH.ZP,{preset:"plain",onClick:h,icon:p?eq.ZP:eV.ZP,label:p?"取消置顶":"置顶"}),q&&(0,a.tZ)(eH.ZP,{preset:"plain",onClick:function(){L(!0)},icon:eX.Z,label:"删除"}),(0,a.tZ)(eK.ZP,{menuContainerClassName:"PinToolbar-menuContainer",toggler:(0,a.tZ)(eH.ZP,{preset:"plain",icon:eW.ZP,"aria-label":"更多"}),children:W})]}),q&&(0,a.tZ)(eJ.Z,{title:"你确定要删除自己的想法吗？",shown:D,onCancel:function(){L(!1)},onSubmit:function(){return g(F((0,e6.q$)(C)).then(function(){s&&(F((0,e5.c0)("想法已删除")),location.href="//www.zhihu.com")}),_.q0.deletePin)}}),(0,a.tZ)(e0.E,{id:C,type:"pin",shown:O,onClose:function(){x(!1)},zaEnabled:!0}),(0,a.tZ)(e1.y,{type:"pin",urlToken:C,shown:U,onClose:function(){return M(!1)},zaEnabled:!0})]})}var tr=function(e){var t=e.pin,n=e.images,r=e.videos,o=e.quotes,i=e.links,c=e.useNewPinStyle,s=e.noCollapsed,l=t.id,u=t.originPin,d=t.created,p=t.updated,h=t.ipInfo,f="//".concat(_.yK,"/pin/").concat(l);return(0,a.BX)("div",{children:[(0,a.tZ)(ea,{useNewPinStyle:c,id:l,quotes:o,links:i,images:n,videos:r}),u&&(0,a.tZ)(ec,{pin:u,noCollapsed:s,useNewPinStyle:c}),(0,a.tZ)(C.O,{href:f,created:d,updated:p,ipInfo:h})]})},to=(0,p.compose)((0,T.Ib)(function(e){return{content:{type:"Pin",id:String(e.pin.id)},moduleId:"universal_single_card"}}),m.Z,(0,c.$_)({dataPath:"pin"}),c.OW,(0,d.connect)(function(e,t){var n=t.pin;return(0,r._)({},"string"==typeof(null==n?void 0:n.author)&&{pin:Object.assign({},n,{author:e.entities.users[n.author]})})}))(function(e){var t=e.pin,n=e.pin,c=n.id,s=n.author,p=n.qualityLabel,m=n.content,T=e.preset,I=e.lastreadTouchable,b=e.isSticky,Z=e.handleToggleSticky,w=e.noCollapsed,R=void 0!==w&&w,N=e.showFollowAuthorButton,k=e.hasAuthorBeforeContent,O=e.onToggleExpand,x=e.commentsPosition,P=e.blockStrategies,D=(void 0===P?{}:P).isBlockingComment,L=e.showCommentButton,B=void 0===L||L,U=e.commentInputPosition,M=e.showHighLight,G=(0,i._)((0,u.useState)(null!=x?x:"bottom"),2),F=G[0],z=G[1],H=(0,d.useSelector)(g.ib),q=(0,i._)((0,u.useState)(!B),2),V=q[0],X=q[1],W=x||(B?"fixed":"bottom"),K="1"===(0,v.Z)("uw_pc_pin_pattern"),j=H&&H.urlToken===s.urlToken,Y="function"==typeof Z,Q="//".concat(_.yK,"/pin/").concat(c),J=y({content:m,name:s.name,hasAuthorBeforeContent:k}),$=(0,u.useMemo)(function(){var e,n,r;return null!==(r=null==t?void 0:null===(e=t.content)||void 0===e?void 0:null===(n=e[0])||void 0===n?void 0:n.title)&&void 0!==r?r:""},[t]),ee=S(m),en=ee.images,er=ee.videos,eo=ee.quotes,ei=ee.links;return(0,a.BX)(E.ZP,(0,o._)((0,r._)({data:t,link:Q,"data-zop":JSON.stringify({itemId:c,type:"pin"}),meta:(0,a.tZ)(A,{preset:T,author:s,showFollowButton:void 0!==N&&N&&!j&&H}),className:l()("PinItem",{"PinItem-withLabel":!!(null==p?void 0:p[0])}),lastreadTouchable:I},$&&{title:(0,a.tZ)(ez,{pinId:c,title:$,href:Q,showHeightLight:void 0!==M&&M})}),{children:[K&&(0,a.tZ)(et,{id:c,images:en,videos:er}),(0,a.tZ)(C.Z,{prefix:Y&&b&&(0,a.tZ)(f.Z,{}),alwaysShowPrefix:!0,data:t,html:J,excerpt:J,noCollapsed:R,before:(0,a.tZ)(eM,{qualityLabel:p}),expanded:R,expandButtonZaType:"Button",onPositionStatusChange:function(e){z(e)},extra:(0,a.tZ)(tr,{pin:t,useNewPinStyle:K,noCollapsed:R,quotes:eo,links:ei,images:en,videos:er}),onToggleExpend:O,children:(0,a.tZ)(tn,(0,r._)({positionStatus:F,href:Q,stickyFeatureEnabled:Y,commentsShown:V,setCommentsShown:X},e))}),!D&&(0,a.tZ)(h.Z,{parent:t,commentPattern:W,commentInputPosition:void 0===U?"bottom":U,shown:V,showPackupButton:B,autoFocus:B,onClose:function(){return X(!1)}})]}))})},12667:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(85879),o=n(67814),i=n.n(o),a={Attention:"NGMMjPlIgmNJSiEet7HX"},c=n(4526),s=n(3426),l=function(e){var t=e.placement,n=void 0===t?c.BOTTOM:t,o=e.children,l=e.target,u=e.container,d=e.isOpen,p=e.isFixed,h=void 0!==p&&p,f=e.repositionKey,_=e.boundary,m=e.className,v=e.isListenNode;return(0,r.tZ)(s.Z,{arrowed:!0,listenResize:!0,placement:n,target:l,container:u,isOpen:d,className:i()("AttentionPopover",a.Attention,m),fixed:h,repositionKey:f||String(h),boundary:_,isListenNode:v,children:o})}},3426:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(15030),l=n(55164),u=n(57477),d=n(71728),p=n(85626),h=n(85879),f=n(67814),_=n.n(f),m=n(14168),v=n.n(m),g=n(87363),T=n(61533),E=n(17002),C=n(90746),y=n(4526),S=n(49978),I=n(58357),b=function(e){(0,c._)(n,e);var t=(0,p._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"listenNodeDisconnect",function(){}),(0,a._)((0,r._)(e),"state",{placement:e.props.placement}),(0,a._)((0,r._)(e),"position",function(){var t=e.props,n=t.target,r=t.container,o=t.placement,i=t.fixed,a=t.boundary;if(e.element&&n){var c=(0,s._)(n,HTMLElement)?n:(0,T.findDOMNode)(n),l=document.body;r&&(l=(0,s._)(r,HTMLElement)?r:(0,T.findDOMNode)(r));var u=(0,I.Z)(c.getBoundingClientRect(),(0,C.Z)(a,l),e.element.getBoundingClientRect(),o);i||(u.targetContainerStyle.left+=window.pageXOffset,u.targetContainerStyle.top+=window.pageYOffset),e.setState(u)}}),(0,a._)((0,r._)(e),"handleRef",function(t){e.element=t,e.props.onRef(t)}),(0,a._)((0,r._)(e),"handleAfterEnter",function(){e.position()}),e}return(0,i._)(n,[{key:"listenNode",value:function(e){if("function"==typeof MutationObserver){var t=new MutationObserver(e);return t.observe(document.body,{attributes:!0,childList:!0,subtree:!0}),{isSuccess:!0,disconnect:t.disconnect}}return{isSuccess:!1}}},{key:"componentDidMount",value:function(){if(this.props.isListenNode){var e=this.listenNode(this.position),t=e.isSuccess,n=e.disconnect;t&&(this.listenNodeDisconnect=n)}this.props.listenResize&&window.addEventListener("resize",this.position)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.target,r=t.repositionKey;(e.target!==n||e.repositionKey!==r)&&requestAnimationFrame(this.position)}},{key:"componentWillUnmount",value:function(){this.props.isListenNode&&this.listenNodeDisconnect(),this.props.listenResize&&window.removeEventListener("resize",this.position)}},{key:"render",value:function(){var e,t=this.props,n=t.isOpen,r=t.arrowed,o=t.fixed,i=t.children,c=t.className,s=(t.placement,t.repositionKey,t.onRef,t.listenResize,t.target,t.container,t.boundary,(0,d._)(t,["isOpen","arrowed","fixed","children","className","placement","repositionKey","onRef","listenResize","target","container","boundary"])),p=this.state,f=p.arrowStyle,m=p.targetContainerStyle,v=p.placement,g=n&&(0,h.BX)("div",(0,u._)((0,l._)({className:_()(c,"Popover-content","Popover-content--".concat(v),S.Z.content,S.Z["content--".concat(v)],(e={"Popover-content--fixed":o,"Popover-content--arrowed":r},(0,a._)(e,S.Z["content--fixed"],o),(0,a._)(e,S.Z["content--arrowed"],r),e)),ref:this.handleRef,style:m},s),{children:[r&&(0,h.tZ)("span",{className:_()("Popover-arrow","Popover-arrow--".concat(v),S.Z.arrow,S.Z["arrow--".concat(v)]),style:f}),i]}));return(0,h.tZ)(E.Z,{onAfterEnter:this.handleAfterEnter,transitionName:S.Z.content,timeout:200,children:g})}}]),n}(g.Component);(0,a._)(b,"propTypes",{isOpen:v().bool,arrowed:v().bool,fixed:v().bool,placement:v().oneOf(Object.keys(y).map(function(e){return y[e]})),repositionKey:v().string,onRef:v().func,listenResize:v().bool,container:v().object,boundary:v().shape({getElement:v().func,padding:v().number,getBoundaryInfo:v().func}),isListenNode:v().bool}),(0,a._)(b,"defaultProps",{isOpen:!1,arrowed:!1,fixed:!1,placement:"bottom",onRef:function(){}}),t.Z=b},90746:function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.getElement,r=e.padding,o=void 0===r?0:r,i=e.getBoundaryInfo;if(i)return i();var a={};n?a=n():t&&(a=t);var c=a.getBoundingClientRect();return{top:c.top+o,right:c.right-o,bottom:c.bottom-o,left:c.left+o}}n.d(t,{Z:function(){return r}})},7181:function(e,t,n){"use strict";n.d(t,{Z:function(){return N}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(49899),d=n(85626),p=n(85879),h=n(67814),f=n.n(h),_=n(95548),m=n.n(_),v=n(14168),g=n.n(v),T=n(87363),E=n(61533),C=n(32210),y=n(65522),S=n(17002),I=n(90746),b=n(4526),A=n(49978),Z=n(58357),w=A.Z.content,R=["appear","enter","enter-active","exit","exit-active","leave","leave-active"].map(function(e){return"".concat(w,"-").concat(e)}),N=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{id:null,opened:!1,arrowStyle:null,targetContainerStyle:null,placement:null}),(0,a._)((0,r._)(e),"handleMouseEnter",function(t){var n=e.props,r=n.delay,o=n.enterDelay,i=n.onMouseEnter;i&&i(t),t.isDefaultPrevented()||(clearTimeout(e.openTask),clearTimeout(e.closeTask),e.openTask=setTimeout(function(){e.openTask=null,e.open()},null!=o?o:r))}),(0,a._)((0,r._)(e),"handleMouseLeave",function(){var t=e.props,n=t.stickHover,r=t.delay,o=t.leaveDelay;!n&&(clearTimeout(e.openTask),clearTimeout(e.closeTask),e.state.opened&&(e.closeTask=setTimeout(function(){e.closeTask=null,e.close()},null!=o?o:r)))}),(0,a._)((0,r._)(e),"handleClick",function(t){var n=e.props.onClick;n&&n(t),t.isDefaultPrevented()||e.open()}),(0,a._)((0,r._)(e),"position",function(){if(!e.toggler||!e.targetContainer)return null;var t=e.props,n=t.placement,r=t.getContainer,o=t.position,i=t.positionStatus,a=t.boundary,c=(0,E.findDOMNode)(e.toggler),s=r(),l=e.targetContainer.getBoundingClientRect(),u=o?o(c,e.targetContainer):(0,Z.Z)(c.getBoundingClientRect(),(0,I.Z)(void 0===a?{}:a,s),l,n);return"fixed"!==i&&u&&u.targetContainerStyle&&(u.targetContainerStyle.top+=window.pageYOffset,u.targetContainerStyle.left+=window.pageXOffset),e.setState(u),u}),(0,a._)((0,r._)(e),"close",function(){if(e.state.opened){var t=e.props.onClose;e.setState({opened:!1},function(){e.removeGlobalListener(),t&&t()})}}),(0,a._)((0,r._)(e),"open",function(){e.state.opened||e.setState({opened:!0})}),(0,a._)((0,r._)(e),"handleAfterEnter",function(){var t=e.props.onOpen,n=e.position();setTimeout(function(){e.addGlobalListener()},0),t&&t(n)}),(0,a._)((0,r._)(e),"handleGlobalClose",function(t){var n=e.props,r=n.preventCloseOnTarget;n.globalClose&&(r?e.toggler&&e.targetContainer&&document.body.contains(t.target)&&t.target.classList&&!e.targetContainer.contains(t.target)&&!(0,E.findDOMNode)(e.toggler).contains(t.target)&&!t.target.classList.contains("preventCloseOnTarget")&&e.close():e.close())}),(0,a._)((0,r._)(e),"handleGlobalKeyDown",function(t){27===t.keyCode&&e.close()}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){this.setState({id:m()("Popover")})}},{key:"getSnapshotBeforeUpdate",value:function(){return this.targetContainer?Array.from(this.targetContainer.classList).filter(function(e){return R.includes(e)}):null}},{key:"componentDidUpdate",value:function(e,t,n){if(n&&n.length>0&&this.targetContainer&&this.targetContainer.classList){var r;(r=this.targetContainer.classList).add.apply(r,(0,u._)(n))}}},{key:"componentWillUnmount",value:function(){clearTimeout(this.openTask),clearTimeout(this.closeTask),this.removeGlobalListener()}},{key:"getEventProps",value:function(){var e=this.props.toggleEvent;return"hover"===e?{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave}:"click"===e?{onClick:this.handleClick}:{}}},{key:"addGlobalListener",value:function(){var e=this;document.addEventListener("click",this.handleGlobalClose),document.addEventListener("keydown",this.handleGlobalKeyDown),this.subscriptions=[(0,C.subscribe)("resize",this.position)],(this.props.scrollOutClear||this.props.hideOnScroll)&&this.subscriptions.push((0,C.subscribe)("scroll",function(){var t;!e.props.hideOnScroll&&(t=e.targetContainer.getBoundingClientRect()).top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)||e.handleGlobalClose()}))}},{key:"removeGlobalListener",value:function(){document.removeEventListener("click",this.handleGlobalClose),document.removeEventListener("keydown",this.globalKeyDown),this.subscriptions&&(this.subscriptions.forEach(function(e){return e.unsubscribe()}),this.subscriptions=null)}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.toggler,o=n.toggleEvent,i=n.arrowed,c=n.children,u=n.className,d=n.targetClassName,h=n.positionStatus,_=n.noLayer,m=n.transitionEnterTimeout,v=n.transitionLeaveTimeout,g=this.state,E=g.id,C=g.opened,I=this.getEventProps(),b=(0,s._)({ref:function(e){t.toggler=e},id:"".concat(E,"-toggle"),"aria-haspopup":!0,"aria-expanded":C},I),Z=this.state,R=Z.arrowStyle,N=Z.targetContainerStyle,k=Z.placement,O=C&&(0,p.BX)("div",(0,l._)((0,s._)({className:f()("Popover-content","Popover-content--".concat(k),A.Z.content,A.Z["content--".concat(k)],d,(e={"Popover-content--fixed":"fixed"===h,"Popover-content--arrowed":i},(0,a._)(e,A.Z["content--fixed"],"fixed"===h),(0,a._)(e,A.Z["content--arrowed"],i),e)),ref:function(e){t.targetContainer=e},style:N,id:"".concat(E,"-content"),"aria-labelledby":"".concat(E,"-toggle")},"hover"===o&&I),{children:[i&&(0,p.tZ)("span",{className:f()("Popover-arrow","Popover-arrow--".concat(k),A.Z.arrow,A.Z["arrow--".concat(k)]),style:R}),c]}));return C&&!_&&(O=(0,p.tZ)(y.Z,{children:O})),(0,p.BX)("div",{className:f()("Popover",A.Z.Popover,u),children:[(0,T.cloneElement)(r,b),(0,p.tZ)(S.Z,{transitionName:w,timeout:{enter:m,exit:v},onAfterEnter:this.handleAfterEnter,children:O})]})}}]),n}(T.Component);N.propTypes={toggler:g().node.isRequired,toggleEvent:g().string,targetClassName:g().string,delay:g().number,enterDelay:g().number,leaveDelay:g().number,onOpen:g().func,onClose:g().func,noLayer:g().bool,getContainer:g().func,placement:g().oneOf(Object.keys(b).map(function(e){return b[e]})),arrowed:g().bool,stickHover:g().bool,position:g().func,positionStatus:g().string,preventCloseOnTarget:g().bool,globalClose:g().bool,scrollOutClear:g().bool,hideOnScroll:g().bool,boundary:g().shape({padding:g().number,getElement:g().func,getBoundaryInfo:g().func})},N.defaultProps={toggleEvent:"click",delay:200,getContainer:function(){return document.body},placement:"bottom",arrowed:!1,preventCloseOnTarget:!1,globalClose:!0,stickHover:!1,noLayer:!1,scrollOutClear:!1,transitionEnterTimeout:200,transitionLeaveTimeout:200}},4526:function(e,t,n){"use strict";n.r(t),n.d(t,{BOTTOM:function(){return a},BOTTOM_LEFT:function(){return c},BOTTOM_RIGHT:function(){return s},LEFT:function(){return r},LEFT_BOTTOM:function(){return p},LEFT_TOP:function(){return d},RIGHT:function(){return o},RIGHT_BOTTOM:function(){return f},RIGHT_TOP:function(){return h},TOP:function(){return i},TOP_LEFT:function(){return l},TOP_RIGHT:function(){return u}});var r="left",o="right",i="top",a="bottom",c="bottom-left",s="bottom-right",l="top-left",u="top-right",d="left-top",p="left-bottom",h="right-top",f="right-bottom"},58357:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(94009),o=n(4526),i=[o.TOP,o.BOTTOM],a=[o.LEFT,o.RIGHT];function c(e,t,n,c){var s=(0,r._)(c.split("-"),2),l=s[0],u=s[1],d=(_=t.top,m=t.bottom,v=t.left,g=t.right,{top:Math.max(_,0),bottom:Math.min(Math.max(m,0),window.innerHeight),left:Math.max(v,0),right:Math.min(Math.max(g,0),window.innerWidth)}),p={},h={},f=l;if(i.includes(l)){var _,m,v,g,T,E,C,y=d.right-n.width,S=d.left;if(u===o.LEFT?(T=e.left,E=S):u===o.RIGHT?(T=e.right-n.width,E=y):(T=e.left+e.width/2-n.width/2,E=S),y>S?T<S?h.left=S:T<y?h.left=T:h.left=y:h.left=E,e.width<=n.width){var I=e.left+e.width/2;p.left=I-h.left}else p.left=n.width/2;l===o.BOTTOM&&e.bottom+n.height>d.bottom&&e.top-n.height>d.top&&(f=o.TOP),l===o.TOP&&e.bottom+n.height<d.bottom&&e.top-n.height<d.top&&(f=o.BOTTOM),C=(0,r._)(f===o.TOP?[n.height,e.top-n.height]:[0,e.bottom],2),p.top=C[0],h.top=C[1]}if(a.includes(l)){var b,A,Z,w=d.bottom-n.height,R=d.top;if(u===o.TOP?(b=e.top,A=R):u===o.BOTTOM?(b=e.bottom-n.height,A=w):(b=e.top+e.height/2-n.height/2,A=R),w>R?b<R?h.top=R:b<w?h.top=b:h.top=w:h.top=A,e.width<=n.width){var N=e.top+e.height/2;p.top=N-h.top}else p.top=n.height/2;l===o.RIGHT&&e.right+n.width>d.right&&e.left-n.width>d.left&&(f=o.LEFT),l===o.LEFT&&e.right+n.width<d.right&&e.left-n.width<d.left&&(f=o.RIGHT),Z=(0,r._)(f===o.LEFT?[n.width,e.left-n.width]:[0,e.right],2),p.left=Z[0],h.left=Z[1]}return{arrowStyle:p,targetContainerStyle:h,placement:f}}},66268:function(e,t,n){"use strict";n.d(t,{rh:function(){return O},Rt:function(){return k},at:function(){return w}});var r=n(55164),o=n(94009),i=n(85879),a=n(87363),c=n.n(a),s=n(91850),l=n(36695),u=n(89965),d=n.n(u),p=n(87641),h=n(43384),f=n(82644),_=n(75334),m=n(67927),v=n(66980),g=Object.assign,T=function(e){return c().createElement(v.Z,g({width:"20",height:"20",fill:"#06F",viewBox:"0 0 20 20"},e),c().createElement("path",{d:"m4.635 4.884-1.133.647 4.944 8.65 1.132-.647-4.943-8.65Z"}),c().createElement("path",{d:"M18.342 3.003 5.524 4.429l5.093 8.991a1.534 1.534 0 0 1 .14 1.153 1.488 1.488 0 0 1-1.25 1.102 1.448 1.448 0 0 1-1.096-.31 1.501 1.501 0 0 1-.377-.45l-4.975-8.79L2 6.76l5.042 8.882c.23.405.558.742.952.98a2.623 2.623 0 0 0 2.612.056 2.69 2.69 0 0 0 .99-.938l7.306-11.792a.622.622 0 0 0-.233-.883.588.588 0 0 0-.327-.062Zm-8.056 4.902a1.175 1.175 0 0 1-.665-.203 1.214 1.214 0 0 1-.442-.546 1.245 1.245 0 0 1 .256-1.331 1.17 1.17 0 0 1 1.301-.267 1.2 1.2 0 0 1 .536.45 1.24 1.24 0 0 1-.146 1.538 1.18 1.18 0 0 1-.84.36Zm3.82-.114a.756.756 0 0 1-.424-.14.781.781 0 0 1-.278-.357.802.802 0 0 1 .181-.853.762.762 0 0 1 .841-.154c.14.063.257.166.34.297a.798.798 0 0 1 .12.44.795.795 0 0 1-.23.556.761.761 0 0 1-.55.222v-.011Z"}))},E=n(3681),C=n(95939),y=n(49274),S=n(31467),I=n(38889),b=n(23354),A=function(e){var t=(null==e?void 0:e.bindTaskDTO)||{},n=t.taskType,r=t.taskId,o=t.taskName;return[b.AQ[n],r,o].join("  ").trim()},Z=function(e){var t=e.visible,n=e.onClose,r=e.onConfirm,c=e.value,s=e.taskList,l=void 0===s?[]:s,u=(0,o._)((0,a.useState)(c),2),d=u[0],h=u[1];return(0,a.useEffect)(function(){var e,n;t&&(null==c?void 0:null===(e=c.bindTaskDTO)||void 0===e?void 0:e.taskId)!==(null==d?void 0:null===(n=d.bindTaskDTO)||void 0===n?void 0:n.taskId)&&h(c)},[t]),(0,i.tZ)(S.Z,{title:"选择芝士任务",size:"large",onClose:n,children:t&&(0,i.BX)(p.Box,{children:[(0,i.tZ)(p.Box,{color:"GBK02A",maxHeight:"50vh",mr:"-24px",pr:"24px",overflowY:"auto",children:(null==l?void 0:l.length)?l.map(function(e){var t;return(0,i.BX)(p.Flex,{flex:1,py:"12px",justifyContent:"space-between",alignItems:"center",css:function(e){var t=e.colors;return{cursor:"pointer",borderBottom:"1px solid ".concat(t.GBK09A)}},as:"label",children:[(0,i.tZ)(p.Text,{fontSize:"14px",children:A(e)}),(0,i.tZ)(C.Z,{checked:(null==d?void 0:null===(t=d.bindTaskDTO)||void 0===t?void 0:t.taskId)===e.bindTaskDTO.taskId,onChange:function(){h(e)}})]},e.bindTaskDTO.taskId)}):(0,i.tZ)(y.H.EI1,{image:"default",content:"没有可绑定的任务"})}),(0,i.BX)(p.Flex,{mt:"32px",justifyContent:"center",children:[(0,i.tZ)(I.ZP,{preset:"outline",color:"grey",css:{width:"168px",marginRight:"16px"},onClick:n,children:"取消"}),(0,i.tZ)(I.ZP,{preset:"primary",color:"blue",css:{width:"168px"},disabled:!d,onClick:function(){r(d)},children:"确认"})]})]})})},w=function(e){return(null==e?void 0:e.bindTaskDTO)?{bind_operate:"BIND",task_id:e.bindTaskDTO.taskId,task_type:e.bindTaskDTO.taskType}:null},R=function(e){var t=e.value,n=e.onChange,c=e.taskList,l=e.disabled,u=void 0!==l&&l,_=e.onOpen,m=void 0===_?function(){return!0}:_,v=(0,o._)((0,s.Z)(!1),2),g=v[0],E=v[1],C=(0,h.Q4)().trackEvent;(0,a.useEffect)(function(){u&&g&&E.off()},[u,g,E]);var y=A(t),S=function(){C({eventType:"Click",elementLocation:{type:"Text",text:y||"选择绑定芝士任务",block:{blockText:"PublishSettingZhiTaskBind"}}}),E.on()};return(0,i.BX)(p.Flex,{flex:1,alignItems:"center",children:[(0,i.BX)(h.Wi,{zaType:"Text",zaText:!0,view:{elementLocation:{block:{blockText:"PublishSettingZhiTaskBind"}}},as:p.Flex,p:"3px 0",alignItems:"center",fontSize:"14px",color:"GBL05A",css:function(e){var n=e.colors;return(0,r._)({cursor:u?"not-allowed":"pointer",opacity:u?.5:1},t?{padding:"3px 14px",background:"rgba(0, 102, 255, .1)",borderRadius:"15px",color:n.GBL01A}:{})},onClick:function(){if(!u){var e=m();d()(null==e?void 0:e.then)?e.then(S):!1!==e&&S()}},children:[(0,i.tZ)(T,{css:function(e){var n=e.colors;return{fill:t?n.GBL01A:n.GBL05A,flexShrink:0}}}),(0,i.tZ)(p.Text,{mx:"4px",title:y||"",css:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:y||"选择绑定芝士任务"}),t&&!u&&(0,i.tZ)(f.HN,{size:"14px",css:{flexShrink:0},onClick:function(e){e.stopPropagation(),null==n||n(null)}})]}),(0,i.tZ)(Z,{visible:g,value:t,taskList:c,onClose:E.off,onConfirm:function(e){null==n||n(e),E.off()}})]})},N=function(e){return(0,i.BX)(p.Flex,{py:"11px",children:[(0,i.tZ)(E.gN,{name:"芝士任务",title:"芝士任务绑定",helper:(0,i.tZ)("p",{children:"如该内容为芝士任务投稿内容，需在此处进行对应任务的绑定操作，请在发布前认真检查绑定关系，内容发布后关系即刻生效。"})}),(0,i.tZ)(R,(0,r._)({},e))]})},k=function(e){var t=e.taskList,n=e.commercialZhitaskBindInfo,r=e.onChange,c=(0,o._)((0,a.useState)(null),2),s=c[0],l=c[1],u=!!n,d=function(e){r(e),l(e)};return(0,a.useEffect)(function(){(null==n?void 0:n.bindStatus)===b.W6.BINDING&&d(n)},[u]),(0,i.tZ)(N,{taskList:t,disabled:(null==s?void 0:s.bindStatus)===b.W6.BINDING,value:s,onChange:function(e){return d(e)}})},O=function(e){var t=e.taskList,n=e.isAnonymous,r=(0,l.useDispatch)(),o=(0,a.useContext)(_.j),c=o.updateFormData,s=(0,o.getFormData)().commercialZhitaskBindInfo,u=(0,a.useCallback)(function(e){c({commercialZhitaskBindInfo:e})},[c]);return(0,a.useEffect)(function(){(null==s?void 0:s.bindStatus)===b.W6.UNBIND&&u(null)},[s,u]),(0,i.tZ)(N,{taskList:t,disabled:(null==s?void 0:s.bindStatus)===b.W6.BINDING,value:s,onChange:u,onOpen:function(){if(n)return r((0,m.c0)("已经启用匿名的内容不能进行芝士任务绑定","red")),!1}})}},23354:function(e,t,n){"use strict";n.d(t,{AQ:function(){return r},PC:function(){return o},W6:function(){return i}});var r={INVITED_TASK:"品牌任务",EVALUATE_TASK:"众测任务"},o={CHEESE:"CHEESE",COMMERCIAL_VIP:"COMMERCIAL_VIP"},i={FE_INIT:"FE_INIT",BINDING:"BINDING",UNBIND:"UNBIND"}},41234:function(e,t,n){"use strict";n.d(t,{M:function(){return p}});var r=n(9338),o=n(94009),i=n(49899),a=n(30971),c=n(85879),s=n(91850);n(87641);var l=n(43384),u=n(38889),d=n(48710),p=function(e){var t,n=e.canSubmit,p=e.handleSubmit,h=e.isReediting,f=e.scheduledPublishAt,_=e.className,m=(0,o._)((0,s.Z)(!1),2),v=m[0],g=m[1],T=(t=(0,r._)(function(){var e,t,n,r=arguments;return(0,a.__generator)(this,function(o){switch(o.label){case 0:for(t=Array(e=r.length),n=0;n<e;n++)t[n]=r[n];g.on(),o.label=1;case 1:return o.trys.push([1,,3,4]),[4,Promise.resolve(p&&p.apply(void 0,(0,i._)(t)))];case 2:return o.sent(),[3,4];case 3:return g.off(),[7];case 4:return[2]}})}),function(){return t.apply(this,arguments)});return(0,c.tZ)(l.$U,{as:u.ZP,zaText:!0,zaType:"Button",zaAction:"Answer",zaModuleId:"published_button",extra:{configMap:{traceId:(0,d.OP)(),type:"Answer",publish_type:h?"oldEdit":"newPublish"}},width:86,height:34,lineHeight:"34px",textAlign:"center",fontSize:14,color:u.rp.Blue,preset:u.EE.Primary,css:{borderRadius:3,cursor:n?"pointer":"not-allowed",opacity:n?1:.3},onClick:T,className:_,disabled:v,children:v?"发布中...":h?"提交修改":f?"定时发送":"发布回答"})}},91309:function(e,t,n){"use strict";n.d(t,{Z:function(){return eq}});var r=n(55164),o=n(94009),i=n(85879),a=n(7835),c=n(87363),s=n(36695),l=n(19076),u=n(87641),d=n(88782),p=n(75334),h=n(8866),f=n(58909),_=n(31021),m=n(62102),v=n(91850),g=n(65733),T=n(20857),E=n(22107),C=n(94707),y=n(87320),S=n(86325),I=n(85626),b=n(14168),A=n.n(b),Z=n(74128),w=n(38889),R=n(80714),N=n(40195),k=function(e){(0,S._)(n,e);var t=(0,I._)(n);function n(){var e;return(0,E._)(this,n),e=t.apply(this,arguments),(0,y._)((0,T._)(e),"handleToggleAnonymousConfirm",function(){var t=e.props,n=t.question.id,r=t.updateQuestionAnonymous;(0,t.onClose)(),r(n)}),e}return(0,C._)(n,[{key:"componentDidMount",value:function(){this.props.fillCurrentUserIfNeeded(["mcn_user_info"])}},{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.question,r=e.shown,o=e.isMCNUser,a=n.relationship.isAnonymous;return(0,i.tZ)(Z.Z,{title:a?"确认取消匿名身份？":"启用匿名后",onClose:t,size:R.Z.isMobileEntry?"small":"default",children:r&&(0,i.BX)("div",{children:[a?(0,i.tZ)("div",{className:"Anonymous-confirm",children:(0,i.tZ)("p",{children:"取消匿名身份后， 提问、回答、赞同和关注将以实名显示。"})}):(0,i.tZ)("div",{className:"Anonymous-confirm",children:(0,i.BX)("ul",{children:[(0,i.tZ)("li",{children:"提问、回答、赞同、关注会显示为匿名"}),(0,i.tZ)("li",{children:"支持匿名邀请别人回答问题"}),(0,i.tZ)("li",{children:"除提问者本人，不能匿名编辑问题"}),(0,i.tZ)("li",{children:"匿名身份不能使用视频功能"}),(0,i.tZ)("li",{children:"不能被视频引用和联合创作"}),(0,i.tZ)("li",{children:"启用匿名将自动取消所有已获得的「专业认可」"}),(0,i.tZ)("li",{children:"匿名身份不能参与芝士任务"}),o&&(0,i.tZ)("li",{children:"不能使用商品信息发布功能"})]})}),(0,i.BX)(Z.w,{direction:"horizontal",children:[(0,i.tZ)(w.ZP,{onClick:t,color:"grey",children:"取消"}),(0,i.tZ)(w.ZP,{preset:"primary",color:"blue",onClick:this.handleToggleAnonymousConfirm,children:"确认"})]})]})})}}]),n}(c.Component);(0,y._)(k,"propTypes",{question:A().object.isRequired});var O=(0,s.connect)(function(e){var t,n=(0,f.ib)(e);return{isMCNUser:(null==n?void 0:null===(t=n.mcnUserInfo)||void 0===t?void 0:t.status)===2}},{updateQuestionAnonymous:N.po,fillCurrentUserIfNeeded:f.sF})(k),x=n(67927),P=n(3681),D="匿名设置",L=function(e){var t=e.question,n=e.isAnonymous,r=e.disabled,a=e.getAnswerFormRef,c=(0,o._)((0,v.Z)(!1),2),l=c[0],d=c[1],p=(0,s.useDispatch)(),h=(0,g.Z)(function(){if(!n){p((0,x.c0)("无法匿名发布，实名发布获得更多曝光","red"));return}var e=a();if(null==e?void 0:e.current){if(e.current.hasVideo()){p((0,x.c0)("匿名不能使用视频功能，如需启用匿名请删除草稿中的视频","red"));return}if(e.current.hasMCNLinkCard()){p((0,x.c0)("不能使用匿名身份推荐商品","red"));return}if(e.current.hasADLinkCard())return e.current.hasFeeConsultCard()?p((0,x.c0)("不能使用匿名身份插入付费咨询卡片","red")):void p((0,x.c0)("不能使用匿名身份插入推荐卡片","red"));d.on()}});return(0,i.BX)(u.Box,{color:"GBL05A",flex:"1",css:{fontSize:"14px"},children:[(0,i.BX)(u.Flex,{height:"38px",children:[(0,i.tZ)(P.KT,{checked:!n,text:"不启用匿名",onChange:h,id:"PublishPanel-Anonymous-0",disabled:r,shouldTrackClick:!0,zaTextPrefix:D}),(0,i.tZ)(P.KT,{checked:n,text:"启用匿名",onChange:h,id:"PublishPanel-Anonymous-1",disabled:r,shouldTrackClick:!0,zaTextPrefix:D})]}),(0,i.tZ)(O,{question:t,shown:l,onClose:d.off})]})},B=function(e){var t=e.isAnonymous,n=(0,(0,c.useContext)(p.j).getFormData)(),a=n.isReport,s=n.commercialZhitaskBindInfo,l=(0,o._)((0,c.useState)(!1),2),d=l[0],h=l[1];return((0,c.useEffect)(function(){h(function(e){return e||t})},[t]),d)?(0,i.BX)(u.Flex,{py:"11px",children:[(0,i.tZ)(P.gN,{name:D}),(0,i.tZ)(L,(0,r._)({disabled:!!a||!!s},e))]}):null},U=n(57477),M=n(43384),G=n(16563),F=n(803),z=function(e){var t=e.updateDraftSettings,n=(0,s.useDispatch)(),r=(0,M.Q4)().trackEvent,o=(0,c.useContext)(p.j),a=o.updateFormData,l=(0,o.getFormData)().commentPermission,u=(0,s.useSelector)(function(e){var t;return null===(t=e.commentPermission.answer)||void 0===t?void 0:t.default})||[];return(0,c.useEffect)(function(){n((0,F.I6)("answer"))},[n]),(0,c.useEffect)(function(){l!==G.sO||(0,G.M1)()||(0,G.UJ)()},[l]),(0,i.tZ)(P.Qr,{onChange:function(e){var n=u.find(function(t){return t.permission===e}).text;r({eventType:"Click",action:"Unknown",elementLocation:{type:"Button",text:"评论权限-".concat(n)}}),e!==l&&(a({commentPermission:e}),requestAnimationFrame(t))},value:l,children:u.map(function(e){var t=e.permission,n=e.text,r=e.disable;return t!==G.sO||l===t||(0,G.M1)()?(0,i.tZ)(P.o3,{value:t,text:n,disabled:r},t):null})})},H=(0,c.forwardRef)(function(e,t){return(0,i.BX)(u.Flex,{py:"11px",children:[(0,i.tZ)(P.gN,{name:"评论权限"}),(0,i.tZ)(u.Box,{flex:"1",children:(0,i.tZ)(z,(0,U._)((0,r._)({},e),{ref:t}))})]})}),q=function(e){var t,n,r,o,i=(null==e?void 0:null===(t=e.disclaimerInfo)||void 0===t?void 0:null===(n=t[0])||void 0===n?void 0:n.status)==="open";return{isDisclaimerChecked:i,disclaimerType:i?null==e?void 0:null===(r=e.disclaimerInfo)||void 0===r?void 0:null===(o=r[0])||void 0===o?void 0:o.type:"none"}},V={type:"none",description:"无声明"},X=function(e){var t=e.reshipmentDisclaimers,n=e.setReshipmentDisclaimers,r=e.disclaimers,o=(0,M.Q4)().trackEvent;return t=t||V,(r=JSON.parse(JSON.stringify(r||[]))).push(V),(0,i.tZ)(P.Qr,{onChange:function(e){var t=r.find(function(t){return t.type===e});o({eventType:"Click",action:"Unknown",elementLocation:{type:"Button",text:"创作声明-".concat(t.description)}}),t&&n(t)},value:t.type,children:r.map(function(e){return(0,i.tZ)(P.o3,{value:e.type,text:e.description},e.type)})})},W=(0,c.forwardRef)(function(e,t){return(0,i.BX)(u.Flex,{py:"11px",children:[(0,i.tZ)(P.gN,{name:"创作声明",helper:(0,i.BX)(i.HY,{children:[(0,i.tZ)("p",{children:"「创作声明」是为自己创作的添加个人声明的工具。当你在创作特定内容（如内容存在虚构或剧透等情节）时，可设置创作声明，该声明将会展示在回答或文章开头。"}),(0,i.tZ)("p",{children:"创作声明表达的是创作者对内容负责的态度。知乎鼓励创作者设置创作声明，以方便知友更好地辨识和理解内容信息。你也可以在编辑内容时，关闭创作声明。"})]})}),(0,i.tZ)(u.Box,{flex:"1",children:(0,i.tZ)(X,(0,U._)((0,r._)({},e),{ref:t}))})]})}),K=function(e){var t=e.question,n=e.updateDraftSettings,r=(0,c.useContext)(p.j),o=r.getFormData,l=r.updateFormData,u=(0,s.useDispatch)(),d=(0,s.useSelector)(function(e){return e.question.disclaimers[t.id]}),h=o().disclaimerType,f=(null==d?void 0:d.find(function(e){return e.type===h}))||V,_=(null==d?void 0:d.length)>0;(0,a.Z)(function(){d||u((0,N.J_)(t.id))});var m=(0,g.Z)(function(e){l({isDisclaimerChecked:"none"!==e.type,disclaimerType:e.type}),requestAnimationFrame(n)});return _?(0,i.tZ)(W,{reshipmentDisclaimers:f,setReshipmentDisclaimers:m,disclaimers:d}):null},j=n(57730),Y="推送给关注者",Q=function(e){var t=e.disabled,n=e.updateDraftSettings,r=(0,c.useContext)(p.j),o=r.updateFormData,a=(0,r.getFormData)().pushActivity,s=function(e){o({pushActivity:e}),requestAnimationFrame(n)};return(0,i.tZ)(u.Box,{color:"GBL05A",flex:"1",css:{fontSize:"14px"},children:(0,i.BX)(u.Flex,{height:"38px",children:[(0,i.tZ)(P.KT,{checked:a,text:"开启推送",onChange:function(){s(!0)},id:"PublishPanel-PushToFollowers-0",disabled:t,shouldTrackClick:!0,zaTextPrefix:Y}),(0,i.tZ)(P.KT,{checked:!a,text:"关闭推送",onChange:function(){j.Z.confirm("设置后，关注你的其他用户将无法在「首页 - 关注」阅读这篇回答",{title:"关闭推送给关注者吗",text:{ok:"关闭推送"}}).then(function(){s(!1)}).catch(function(){})},id:"PublishPanel-PushToFollowers-1",disabled:t,shouldTrackClick:!0,zaTextPrefix:Y})]})})},J=function(e){return(0,i.BX)(u.Flex,{py:"11px",children:[(0,i.tZ)(P.gN,{name:Y}),(0,i.tZ)(Q,(0,r._)({},e))]})},$=n(13905),ee={allowed:"允许规范转载",need_payment:"允许付费转载",disallowed:"禁止转载"},et=function(e){var t=e.currentUser,n=e.updateDraftSettings,r=(0,M.Q4)().trackEvent,o=(0,c.useContext)(p.j),a=o.updateFormData,s=(0,o.getFormData)().reshipmentSettings;return(0,i.tZ)(P.Qr,{onChange:function(e){var o=ee[e];r({eventType:"Click",action:"Unknown",elementLocation:{type:"Button",text:"转载设置-".concat(o)}}),"need_payment"!==e||t.caEnabled||window.open("/copyright/invite"),a({reshipmentSettings:e}),requestAnimationFrame(n)},value:s,children:Object.keys(ee).map(function(e){return"need_payment"===e&&t.isOrg?null:(0,i.tZ)(P.o3,{value:e,text:ee[e]},e)})})},en=(0,c.forwardRef)(function(e,t){return(0,i.BX)(u.Flex,{py:"11px",children:[(0,i.tZ)(P.gN,{name:"转载设置"}),(0,i.tZ)(u.Box,{flex:"1",children:(0,i.tZ)(et,(0,U._)((0,r._)({},e),{ref:t}))})]})}),er=n(96813),eo=n(67814),ei=n.n(eo),ea=n(95377),ec=n(66263),es=function(e){(0,S._)(n,e);var t=(0,I._)(n);function n(e){(0,E._)(this,n),r=t.call(this,e),(0,y._)((0,T._)(r),"onChangeInputType",function(e){r.setState({checked:e.target.checked})}),(0,y._)((0,T._)(r),"onChangeInputValue",function(e){r.setState({text:e.target.value})}),(0,y._)((0,T._)(r),"submit",function(){var e=r.state.text;r.props.submitRewardText(e)});var r,o=e.tagline;return r.state={text:o.replace(/^「/,"").replace(/」$/,"")||ec.Sp,checked:!0},r}return(0,C._)(n,[{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.edit,r=this.state,o=r.text,a=r.checked;return(0,i.BX)(Z.Z,{onClose:t,className:"RewardForm-rewardModal",children:[(0,i.tZ)("p",{className:"RewardForm-rewardTitle",children:n?"编辑赞赏描述":"开启赞赏"}),(0,i.tZ)(ea.Z,{className:"RewardForm-rewardInput",maxLength:"20",type:"text",value:o,onChange:this.onChangeInputValue,disabled:!0}),(0,i.BX)("div",{className:"RewardForm-remark",children:[!n&&(0,i.BX)("label",{className:"RewardForm-protocol",children:[(0,i.tZ)(er.C,{className:"RewardForm-rewardCheckbox",onChange:this.onChangeInputType,checked:a,size:16}),"我已同意",(0,i.tZ)("a",{className:"RewardForm-rewardLink",href:"/terms/tipjar",children:"《知乎赞赏功能使用协议》"})]}),(0,i.tZ)("p",{className:"RewardForm-prompting",children:"暂不支持修改赞赏文案"})]}),(0,i.tZ)(w.ZP,{className:ei()("RewardForm-rewardSubmit",{"RewardForm-rewardSubmit-disabled":!a}),onClick:this.submit,disabled:!a,children:"确定"})]})}}]),n}(c.Component);(0,y._)(es,"propTypes",{onClose:A().func,submitRewardText:A().func,edit:A().bool,tagline:A().string}),(0,y._)(es,"defaultProps",{tagline:ec.Sp});var el=n(67036),eu=n(55344),ed="赞赏设置",ep=function(e){var t;return{rewardTagline:(null==e?void 0:null===(t=e.rewardInfo)||void 0===t?void 0:t.tagline)||""}},eh=function(e){var t=e.question.id,n=e.isAnonymous,r=e.disabled,a=e.updateDraftSettings,l=(0,o._)((0,v.Z)(!1),2),d=l[0],h=l[1],f=(0,c.useContext)(p.j),_=f.getFormData,m=f.updateFormData,T=(0,s.useDispatch)(),E=_().rewardTagline,C=!!E,y=(0,g.Z)(function(e){m({rewardTagline:e}),requestAnimationFrame(a),T((0,el.$j)(t,!0)),h.off()});return(0,i.BX)(u.Box,{color:"GBL05A",flex:"1",css:{fontSize:"14px"},children:[(0,i.BX)(u.Flex,{height:"38px",children:[(0,i.tZ)(P.KT,{checked:C,text:"开启赞赏",onChange:function(){if(n){T((0,x.c0)("匿名回答无法开启赞赏，请先取消匿名","red"));return}h.on()},id:"PublishPanel-RewardSetting-0",disabled:r,shouldTrackClick:!0,zaTextPrefix:ed}),(0,i.tZ)(P.KT,{checked:!C,text:"关闭赞赏",onChange:function(){m({rewardTagline:""}),requestAnimationFrame(a),T((0,el.$j)(t,!1))},id:"PublishPanel-RewardSetting-1",disabled:r,shouldTrackClick:!0,zaTextPrefix:ed})]}),d&&(0,i.tZ)(es,{submitRewardText:y,onClose:h.off,tagline:E,edit:!1})]})},ef=function(e){var t=(0,s.useDispatch)(),n=(0,s.useSelector)(function(e){return e.switches}).isAnswerRewardable;return((0,c.useEffect)(function(){void 0===n&&t((0,eu.X2)(["isAnswerRewardable"]))},[t,n]),n)?(0,i.BX)(u.Flex,{py:"11px",children:[(0,i.tZ)(P.gN,{name:ed}),(0,i.tZ)(eh,(0,r._)({},e))]}):null},e_=n(9539),em=n(23719),ev=n(61514),eg="定时发布",eT=function(e){var t=e.scheduledPublishAt,n=e.initialScheduledPublishAt,r=e.setUseScheduledPublish,o=!!t,a=function(e){r(e)};return(0,i.BX)(u.Box,{color:"GBL05A",flex:"1",css:{fontSize:"14px"},children:[(0,i.BX)(u.Flex,{height:"38px",children:[(0,i.tZ)(P.KT,{checked:!o,text:"不使用定时发布",onChange:function(){return a(!1)},id:"PublishPanel-scheduleLabel-0",shouldTrackClick:!0,zaTextPrefix:eg}),(0,i.tZ)(P.KT,{checked:o,text:"使用定时发布",onChange:function(){a(!0),requestAnimationFrame(function(){(0,em.yZ)(window,{top:50,behavior:"smooth"})})},id:"PublishPanel-scheduleLabel-1",shouldTrackClick:!0,zaTextPrefix:eg})]}),o&&n&&(0,i.tZ)(ev.Z,{value:t,min:n,max:e_.Z(n,7),onChange:function(e){r(!0,e)},css:function(e){return{color:e.colors.GBL05A,fontSize:"14px",marginTop:"5px",".InputButton":{height:"38px"}}}})]})},eE=function(e){return(0,i.BX)(u.Flex,{py:"11px",children:[(0,i.tZ)(P.gN,{name:eg}),(0,i.tZ)(eT,(0,r._)({},e))]})},eC=n(80565),ey=n(48725),eS=n(87038),eI=n(71728),eb=n(31467),eA=n(6438),eZ=n(76741),ew=n(70877),eR=n(42623),eN=n(53910),ek=n(77683),eO=n(92868),ex=function(e){var t=e.onClick,n=e.text,o=(0,eI._)(e,["onClick","text"]);return(0,i.BX)(w.ZP,(0,U._)((0,r._)({preset:"link",onClick:t,css:{fontSize:15}},o),{children:[(0,i.tZ)(ey.E,{text:!0,center:!0})," ",n]}))};ex.defaultProps={text:"修改"};var eP=function(e){(0,S._)(n,e);var t=(0,I._)(n);function n(){var e;return(0,E._)(this,n),e=t.apply(this,arguments),(0,y._)((0,T._)(e),"state",{value:null}),(0,y._)((0,T._)(e),"handleModify",function(){e.setState({modifying:!0})}),(0,y._)((0,T._)(e),"handleChange",function(t){e.setState({value:t.target.value})}),(0,y._)((0,T._)(e),"handleCancel",function(){e.setState({value:null,modifying:!1})}),(0,y._)((0,T._)(e),"handleSubmit",function(t){t.preventDefault(),e.props.onBioChange(e.state.value),e.handleCancel()}),(0,y._)((0,T._)(e),"handleSelect",function(){e.props.onSelect(e.props.value)}),e}return(0,C._)(n,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.bio,r=e.title,o=e.checked,a=e.rich,c=this.state,s=c.modifying,l=c.value;return s?(0,i.BX)("div",{className:"TopicBioItem",children:[(0,i.tZ)("div",{className:"TopicBioItem-title",children:r}),(0,i.BX)("form",{onSubmit:this.handleSubmit,children:[(0,i.tZ)("div",{className:"TopicBioItem-inner",children:(0,i.tZ)(ek.Z,{className:"TopicBioItem-authorInfo",noLink:!0,author:t,children:(0,i.tZ)(ea.Z,{className:"TopicBioItem-input",defaultValue:n,onChange:this.handleChange,placeholder:r,autoFocus:!0})})}),(0,i.BX)("div",{className:"TopicBioItem-inputFooter",children:[(0,i.tZ)(eO.Z,{current:l?l.length:0,max:40}),(0,i.BX)("div",{className:"TopicBioItem-actions",children:[(0,i.tZ)(w.ZP,{preset:"plain",type:"reset",onClick:this.handleCancel,children:"取消"}),(0,i.tZ)(w.ZP,{preset:"primary",color:"blue",type:"submit",children:"保存"})]})]})]})]}):n?(0,i.BX)("div",{className:"TopicBioItem",children:[(0,i.tZ)("div",{className:"TopicBioItem-title",children:r}),(0,i.tZ)(eR.Z,{name:"topic-bio",type:"radio",onChange:this.handleSelect,value:this.props.value,checked:o,children:(0,i.tZ)(ek.Z,{noLink:!0,author:t,className:"TopicBioItem-authorInfo",children:(0,i.BX)("div",{children:[a?(0,i.tZ)(eS.Z,{inline:!0,className:"TopicBioItem-bio",html:n}):(0,i.tZ)("span",{className:"TopicBioItem-bio",children:n}),(0,i.tZ)(ex,{className:"TopicBioItem-modifyButton",onClick:this.handleModify})]})})})]}):(0,i.tZ)("div",{className:"TopicBioItem",children:(0,i.BX)(w.ZP,{className:"TopicBioItem-addButton",size:"spread",preset:"link",onClick:this.handleModify,children:[(0,i.tZ)(eN.nY,{text:!0,center:!0})," 添加",r]})})}}]),n}(c.Component);(0,y._)(eP,"propTypes",{user:A().object.isRequired,title:A().node.isRequired,value:A().object.isRequired,onBioChange:A().func.isRequired,onSelect:A().func.isRequired,checked:A().bool.isRequired});var eD=function(e,t){var n=e.type,r=e.topic,o=(void 0===r?{}:r).id,i=t.type,a=t.topic,c=(void 0===a?{}:a).id;return n===i&&o===c},eL=function(e){(0,S._)(n,e);var t=(0,I._)(n);function n(){var e;return(0,E._)(this,n),e=t.apply(this,arguments),(0,y._)((0,T._)(e),"state",{value:null}),(0,y._)((0,T._)(e),"handleSelect",function(t){return e.setState({value:t})}),(0,y._)((0,T._)(e),"handleChoose",function(){return e.props.onBioChoose(e.state.value)}),e}return(0,C._)(n,[{key:"render",value:function(){var e=this;if(this.props.isFetching)return(0,i.tZ)("div",{className:"TopicBios-loading",children:(0,i.tZ)(ew.Z,{})});var t=this.props,n=t.user,o=t.question.topics,a=t.bios,c=t.currentBio,s=t.onHeadlineUpdate,l=t.onBioUpdate,u=this.state.value||c,d={type:"headline"};return(0,i.BX)("div",{children:[(0,i.BX)("div",{className:"TopicBioItems",children:[(0,i.tZ)(eP,{title:"一句话介绍",user:n,bio:n.headline,value:d,onBioChange:s,onSelect:this.handleSelect,checked:eD(u,d),rich:!0}),o.map(function(t){var o,c={type:"topic",topic:{id:t.id}};return(0,i.tZ)(eP,(0,U._)((0,r._)({title:"在 ".concat(t.name," 话题下的话题经验"),user:n},(o=t.id,a.find(function(e){return e.topic.id===o}))),{value:c,onBioChange:function(e){return l(t.id,e)},onSelect:e.handleSelect,checked:eD(u,c)}),t.id)})]}),(0,i.tZ)(eb.w,{children:(0,i.tZ)(w.ZP,{color:"blue",preset:"primary",onClick:this.handleChoose,children:"完成"})})]})}}]),n}(c.Component);(0,y._)(eL,"propTypes",{onHeadlineUpdate:A().func.isRequired,onBioUpdate:A().func.isRequired,onBioChoose:A().func.isRequired,question:A().object.isRequired,user:A().object.isRequired});var eB=function(e){(0,S._)(n,e);var t=(0,I._)(n);function n(){var e;return(0,E._)(this,n),e=t.apply(this,arguments),(0,y._)((0,T._)(e),"handleUpdateHeadline",function(t){e.props.updateProfile(null,{headline:t})}),(0,y._)((0,T._)(e),"handleUpdateBio",function(t,n){e.props.updateBio(t,n)}),(0,y._)((0,T._)(e),"handleBioChoose",function(t){t&&e.props.chooseBio(e.props.question.id,t),e.props.onClose()}),e}return(0,C._)(n,[{key:"componentDidMount",value:function(){this.props.loadBios(this.props.question.id)}},{key:"render",value:function(){return(0,i.tZ)(eL,(0,r._)({onHeadlineUpdate:this.handleUpdateHeadline,onBioUpdate:this.handleUpdateBio,onBioChoose:this.handleBioChoose},this.props))}}]),n}(c.Component);(0,y._)(eB,"propTypes",{question:A().object.isRequired});var eU=(0,s.connect)(function(e,t){var n=e.currentUser,r=e.question.bio,o=e.entities,i=o.questions,a=o.users,c=e.topic.bios,s=t.question.id,l=i[s],u=(r[s]||{result:{type:"headline"}}).result;return{isFetching:c.isFetching,currentBio:{type:u.type,topic:u.topic},bios:l.topics.map(function(e){return{topic:e,bio:c[e.id]}}),question:l,user:a[n]}},{updateProfile:eA.ck,updateBio:eZ.rl,chooseBio:N.vL,loadBios:N.uF})(eB),eM=function(e){(0,S._)(n,e);var t=(0,I._)(n);function n(){return(0,E._)(this,n),t.apply(this,arguments)}return(0,C._)(n,[{key:"render",value:function(){var e=this.props,t=e.shown,n=e.onClose,o=(0,eI._)(e,["shown","onClose"]);return(0,i.tZ)(eb.Z,{title:"编辑话题经验",subtitle:(0,i.BX)("span",{children:["可以填写你从事的职业、取得的资格或过往经历，",(0,i.tZ)("br",{}),"让你在这个问题下的回答更具说服力。"]}),onClose:n,size:"large",hotKeyClosable:!1,maskClosable:!1,children:t&&(0,i.tZ)(eU,(0,U._)((0,r._)({},o),{onClose:n}))})}}]),n}(c.Component);(0,y._)(eM,"propTypes",(0,r._)({shown:A().bool.isRequired,onClose:A().func.isRequired},eU.propTypes));var eG=function(e){var t=e.children;return"string"!=typeof t||t.trim().length?(0,i.tZ)(u.Text,{maxWidth:"292px",mr:"20px",css:[(0,eC.S)(1)],children:t}):null},eF=function(e){var t=e.questionId,n=e.currentUser,r=(0,s.useSelector)(function(e){return e.question.bio}),o=(0,s.useSelector)(function(e){return e.topic.bios}),a=(r[t]||{result:{type:"headline"}}).result;return("topic"===a.type&&(a.bio=o[a.topic.id]||a.bio),a.bio&&"headline"!==a.type)?(0,i.tZ)(eG,{children:a.bio}):n.headline?(0,i.tZ)(eG,{children:(0,i.tZ)(eS.Z,{inline:!0,html:(a||{}).bio||n.headline})}):null},ez=function(e){var t=e.question,n=e.currentUser,r=(0,o._)((0,v.Z)(!1),2),a=r[0],c=r[1];return(0,i.BX)(u.Box,{color:"GBL05A",flex:"1",css:{fontSize:"14px"},children:[(0,i.BX)(u.Flex,{alignItems:"center",height:"100%",css:{cursor:"pointer"},onClick:c.on,children:[(0,i.tZ)(eF,{questionId:t.id,currentUser:n}),(0,i.BX)(M.$U,{as:u.Flex,zaType:"Button",zaText:"一句话介绍-修改",color:"GBL01A",alignItems:"center",children:["修改",(0,i.tZ)(ey.E,{css:{marginLeft:"2px"},size:16})]})]}),(0,i.tZ)(eM,{shown:a,question:t,onClose:c.off})]})},eH=function(e){return(0,i.BX)(u.Flex,{py:"11px",children:[(0,i.tZ)(P.gN,{name:"一句话介绍"}),(0,i.tZ)(ez,(0,r._)({},e))]})},eq=(0,l.withRouter)(function(e){var t,n=e.question,l=e.answer,v=e.isVideoAnswer,g=e.isReediting,T=e.location,E=e.scheduledPublishAt,C=e.initialScheduledPublishAt,y=e.canScheduledPublish,S=e.setUseScheduledPublish,I=e.className,b=e.updateDraftSettings,A=e.getAnswerFormRef,Z=e.getInitialEnableMarkdown,w=(0,s.useDispatch)(),R=(0,c.useContext)(p.j).updateFormData,N=((null==T?void 0:T.query)||{}).push_activity,k=(0,s.useSelector)(f.ib),O=(0,o._)((0,c.useState)(!1),2),x=O[0],P=O[1];(0,a.Z)(function(){Promise.all([w((0,_.Gl)()),w((0,_.PW)(n.id)),l&&w((0,h.ri)(l.id))].filter(Boolean)).then(function(e){var t,n,i,a,c,s=(0,o._)(e,3),u=s[0],p=s[1],h=s[2];R((0,r._)({},(0,d.Tq)(null===(t=u.payload)||void 0===t?void 0:t.settings),l&&h&&(0,r._)({},(0,d.vi)(h.payload),ep(l),q(h.payload),(0,m.VQ)(h.payload),(0,m.AB)(null==l?void 0:l.settings),(0,d.t8)(l)),(0,d.p4)(null===(n=p.payload)||void 0===n?void 0:n.settings),N&&{pushActivity:!!Number(N)})),Z(null===(c=null===(i=u.payload)||void 0===i?void 0:null===(a=i.commonSettings)||void 0===a?void 0:a.markdownEnabled)||void 0===c||c)}).finally(function(){P(!0)})});var D=null==n?void 0:null===(t=n.relationship)||void 0===t?void 0:t.isAnonymous,L=(n||{}).questionType,U=k&&!k.isOrg;return v&&g||!x?null:(0,i.BX)(u.Box,{pl:"10px",pr:"20px",width:"100%",bg:"GBK99A",css:{position:"relative"},className:I,children:[(0,i.tZ)(u.Box,{sx:{borderTop:"1px solid",borderColor:"GBK09A"},ml:"10px"}),(0,i.tZ)(u.Text,{color:"GBK03A",ml:"10px",pt:"24px",pb:"12px",css:{lineHeight:"24px",fontSize:"17px",fontWeight:"500"},children:"发布设置"}),U&&("normal"===L||D)&&!v&&!g&&(0,i.tZ)(B,{question:n,isAnonymous:D,getAnswerFormRef:A}),!v&&(0,i.tZ)(K,{question:n,updateDraftSettings:b}),(0,i.tZ)($.Z,{type:"answer",questionId:null==n?void 0:n.id,answerId:null==l?void 0:l.id,taskBindProps:{isAnonymous:D,isVideoAnswer:v},reportProps:{isAnonymous:D,updateDraftSettings:b}}),y&&(0,i.tZ)(eE,{scheduledPublishAt:E,initialScheduledPublishAt:C,setUseScheduledPublish:S}),!g&&U&&(0,i.tZ)(eH,{question:n,currentUser:k}),!g&&(0,i.tZ)(en,{currentUser:k,updateDraftSettings:b}),!g&&(0,i.tZ)(H,{updateDraftSettings:b}),!g&&!v&&(0,i.tZ)(J,{updateDraftSettings:b}),(0,i.tZ)(ef,{question:n,isAnonymous:D,updateDraftSettings:b})]})})},13905:function(e,t,n){"use strict";n.d(t,{Z:function(){return k}});var r=n(55164),o=n(94009),i=n(85879),a=n(87363),c=n(36695),s=n(7835),l=function(){if("undefined"==typeof window)return"https://bvip.zhihu.com";var e=window.location.host,t=e.includes(".test")||e.includes(".dev")?"dev":"com",n="https://bvip.zhihu.".concat(t),r=/--box-(\d+)--/g.exec(e);return r&&(n="https://ad-business-vip-web--box-".concat(r[1],"--bvip-zhihu-").concat(t,".zpres.zhihu.").concat(t,"/")),n},u=(0,n(39288).FH)("biz",["OPEN_BIZ_VIP","QUERY_BIZ_VIP_STATUS","GET_COMMERCIAL_REPORT_INFO"]),d=n(66268),p=n(57477),h=n(91850),f=n(65733),_=n(43384),m=n(87641),v=n(71728),g=n(96813),T=n(31467),E=function(e){var t=e.shown,n=e.toggle,o=(0,v._)(e,["shown","toggle"]);return(0,i.tZ)(T.Z,(0,p._)((0,r._)({title:"",subtitle:"",onClose:function(){n()}},o),{children:t&&(0,i.BX)("div",{children:[(0,i.BX)(m.Box,{color:"GBK02A",css:{fontSize:"15px",lineHeight:"22px"},children:[(0,i.tZ)(m.Text,{children:"系统检测到您的账号已开通芝士平台权限。创作者与品牌主的商业合作，需统一通过知乎官方商业合作服务平台「芝士平台」进行。"}),(0,i.tZ)(m.Text,{children:"知享仅针对品牌自营账号开放。如果您是商家，可以在推出芝士平台后，申请开通知享。"}),(0,i.BX)(m.Text,{children:["如仍有疑问，请详询",(0,i.tZ)(m.Link,{href:"https://www.zhihu.com/messages/0cb9df58ed7a3ff685d0ac55d1c1e553",target:"_blank",rel:"noreferrer noopener",color:"primary",children:"@知乎商业小管家\xa0"}),"反馈，我们将积极解决您的问题。"]})]}),(0,i.tZ)("button",{onClick:function(){n()},css:function(e){return[{width:"166px",height:"32px",backgroundColor:e.colors.GBL01A,textAlign:"center",lineHeight:"32px",fontSize:"14px",color:e.colors.GBK99A,borderRadius:"3px",margin:"25px 0 0 93px"}]},children:"知道了"})]})}))},C=n(67927),y=function(e){var t=e.shown,n=e.toggle,s=e.onSuccess,d=e.onFail,f=(0,v._)(e,["shown","toggle","onSuccess","onFail"]),y=(0,c.useDispatch)(),S=(0,o._)((0,a.useState)(!0),2),I=S[0],b=S[1],A=(0,o._)((0,h.Z)(!1),2),Z=A[0],w=A[1],R=(0,_.Q4)().trackEvent;return(0,i.BX)(i.HY,{children:[(0,i.tZ)(T.Z,(0,p._)((0,r._)({title:"商业内容推广",subtitle:"",onClose:function(){R({eventType:"Click",action:"Unknown",elementLocation:{text:"开通商业会员弹窗关闭"}}),n()}},f),{children:t&&(0,i.BX)("div",{children:[(0,i.tZ)(m.Box,{color:"GBK02A",css:{fontSize:"15px",lineHeight:"22px"},children:"报备后，将自动为您开通「知享」试用版，符合商业内容规范的内容可以正常曝光"}),(0,i.BX)(m.Flex,{flexDirection:"inherit",flexWrap:"nowrap",alignItems:"center",style:{marginTop:"10px"},children:[(0,i.tZ)(g.C,{onChange:function(){b(!I)},type:"checkbox",checked:I}),(0,i.BX)(m.Text,{ml:"4px",children:["我已阅读并同意",(0,i.tZ)(m.Link,{href:"https://bvip.zhihu.com/agreement",target:"_blank",rel:"noreferrer noopener",color:"primary",children:"《知享服务使用协议》"})]})]}),(0,i.tZ)("button",{disabled:!I,onClick:function(){y({API:{types:u.OPEN_BIZ_VIP,endpoint:"/commercial/vip",root:"".concat(l(),"/api/v1"),method:"POST"}}).then(function(e){var t,n,r=e.payload;if(r.isSuccess){s(),y((0,C.c0)("开通成功"));return}d(),(null==r?void 0:null===(t=r.err)||void 0===t?void 0:t.code)==="-300"?w.on():y((0,C.c0)((null==r?void 0:null===(n=r.err)||void 0===n?void 0:n.msg)||"开通失败","red"))}).catch(function(e){var t;d(),y((0,C.c0)((null==e?void 0:null===(t=e.err)||void 0===t?void 0:t.msg)||"开通失败","red"))}),n()},css:function(e){return[{width:"166px",height:"32px",backgroundColor:e.colors.GBL01A,textAlign:"center",lineHeight:"32px",fontSize:"14px",color:e.colors.GBK99A,borderRadius:"3px",margin:"25px 0 0 93px"},!I&&{cursor:"not-allowed"}]},children:"确认并开通"})]})})),(0,i.tZ)(E,{shown:Z,toggle:w.toggle})]})},S=n(75334),I=n(3681),b=[{type:!1,description:"非商业推广"},{type:!0,description:"商业推广"}],A=function(e){var t=e.isReport,n=e.commercialPermissionInfo,a=e.setCommercialPermissionInfo,c=e.setIsReport,s=e.validate,l=(0,_.Q4)().trackEvent,u=(0,o._)((0,h.Z)(!1),2),d=u[0],f=u[1];return(0,i.BX)(i.HY,{children:[(0,i.tZ)(I.Qr,{onChange:function(e){if(!s||s()){var t=b.find(function(t){return t.type===e});if(l({eventType:"Click",action:"Unknown",elementLocation:{type:"Button",text:"商业推广-".concat(null==t?void 0:t.description)}}),!0===e&&!(null==n?void 0:n.isCommercialVip)){f.on();return}c(e)}},value:!!t,children:b.map(function(e){return(0,i.tZ)(I.o3,{css:function(e){return{color:e.colors.GBK02A,fontSize:"14px"}},value:e.type,text:e.description},e.type)})}),(0,i.tZ)(y,{shown:d,toggle:f.toggle,onSuccess:function(){c(!0),a(function(e){return(0,p._)((0,r._)({},e),{isCommercialVip:!0})})},onFail:function(){c(!1)}})]})},Z=function(e){return(0,i.BX)(m.Flex,{py:"11px",children:[(0,i.tZ)(I.gN,{name:"商业推广",title:"商业内容推广",helper:(0,i.BX)(i.HY,{children:[(0,i.tZ)("p",{children:"商业内容是指，未经平台允许，用户以推广曝光为目的，发布含有产品售卖信息、牟利性外链等内容，或引导用户至第三方平台进行交易。"}),(0,i.tZ)("p",{children:"知乎提供了报备功能，创作者可以选择主动对包含商业推广的内容进行报备。对于包含商业推广但是未报备的内容，将按社区规范进行处理"}),(0,i.BX)("p",{style:{marginTop:"10px"},children:["关于报备功能更多的信息，",(0,i.tZ)("a",{href:"https://www.zhihu.com/creator/explore/academy/rights/rights",target:"_blank",rel:"noreferrer noopener",children:"点击前往了解"})]})]})}),(0,i.tZ)(m.Box,{flex:"1",children:(0,i.tZ)(A,(0,r._)({},e))})]})},w=(0,a.forwardRef)(function(e,t){var n=e.commercialReportInfo,r=e.initCommercialPermissionInfo,c=(0,o._)((0,a.useState)(r),2),s=c[0],l=c[1],u=(0,o._)((0,a.useState)(!1),2),d=u[0],p=u[1],h=!!n;return(0,a.useEffect)(function(){h&&p(n.isReport)},[h]),(0,a.useImperativeHandle)(t,function(){return{getIsReport:function(){return d}}}),(0,i.tZ)(Z,{isReport:!!d,commercialPermissionInfo:s,setIsReport:p,setCommercialPermissionInfo:l})}),R=function(e){var t=e.isAnonymous,n=e.updateDraftSettings,r=e.initCommercialPermissionInfo,s=(0,c.useDispatch)(),l=(0,o._)((0,a.useState)(r),2),u=l[0],d=l[1],p=(0,a.useContext)(S.j),h=p.updateFormData,_=(0,p.getFormData)().isReport,m=(0,f.Z)(function(e){h({isReport:e}),requestAnimationFrame(n)}),v=(0,f.Z)(function(){return!t||(s((0,C.c0)("已经启用匿名的内容不能进行商业推广声明","red")),!1)});return(0,i.tZ)(Z,{isReport:!!_,commercialPermissionInfo:u,setIsReport:m,setCommercialPermissionInfo:d,validate:v})},N=n(23354),k=function(e){var t=e.type,n=e.questionId,l=e.answerId,p=e.articleId,h=e.reportProps,f=void 0===h?{}:h,_=e.taskBindProps,m=void 0===_?{}:_,v=(0,c.useDispatch)(),g=(0,o._)((0,a.useState)([]),2),T=(0,o._)(g[0],3),E=T[0],C=void 0===E?null:E,y=T[1],S=void 0===y?{}:y,I=T[2],b=void 0===I?"":I,A=g[1],Z="article"===t;return((0,s.Z)(function(){v(Z?{API:{types:u.QUERY_BIZ_VIP_STATUS,endpoint:"/articles/settings",query:{token:p},method:"GET"}}:{API:{types:u.QUERY_BIZ_VIP_STATUS,endpoint:"/questions/".concat(n,"/answer-settings"),query:{token:l},method:"GET"}}).then(function(e){var t,n,r=(null==e?void 0:null===(t=e.payload)||void 0===t?void 0:t.commercialPermissionInfo)||{};if(N.PC.CHEESE===r.businessLine){if(!(null===(n=r.cheeseTaskList)||void 0===n?void 0:n.length))return;A([Z?d.Rt:d.rh,{taskList:r.cheeseTaskList.map(function(e){return{bindStatus:N.W6.FE_INIT,bindTaskDTO:e}})},N.PC.CHEESE])}else N.PC.COMMERCIAL_VIP===r.businessLine&&r.isShowTab&&A([Z?w:R,{initCommercialPermissionInfo:r},N.PC.COMMERCIAL_VIP])})}),N.PC.CHEESE===b&&"answer"===t&&m.isVideoAnswer)?null:C?(0,i.tZ)(C,(0,r._)({},N.PC.CHEESE===b?m:f,S)):null}},3681:function(e,t,n){"use strict";n.d(t,{$_:function(){return N},KT:function(){return x},NZ:function(){return A},Qr:function(){return P},Tw:function(){return O},gN:function(){return Z},o3:function(){return D},vQ:function(){return k}});var r=n(55164),o=n(57477),i=n(71728),a=n(94009),c=n(49899),s=n(85879),l=n(95939),u=n(24405),d=n(91850),p=n(65733),h=n(79107),f=n(75056),_=n(64137),m=n(28753),v=n(88329),g=n.n(v),T=n(87363),E=n(87641),C=n(23719),y=n(43384),S=n(57730),I=n(21060),b=n(45001),A=function(e){return(0,s.tZ)(E.Text,(0,r._)({color:"GBK03A",css:{lineHeight:"61px",fontSize:"17px",fontWeight:"500"}},e))},Z=function(e){var t=e.required,n=e.name,i=e.title,a=e.helper,c=e.props,l=(0,u.F)();return(0,s.BX)(E.Flex,(0,o._)((0,r._)({as:"label",color:"GBK03A",mr:"3px",css:[{lineHeight:"38px",fontSize:"15px",fontWeight:"400",width:"110px"},!t&&{paddingLeft:"10px"}]},c),{children:[t&&(0,s.tZ)(E.Text,{"aria-label":"必填",color:"GRD03A",mt:"2px",mr:"4px",children:"*"}),n,a&&(0,s.tZ)(y.$U,{as:"button",zaType:"Button",zaText:"提示信息-".concat(n),css:function(e){return{color:e.colors.GBL05A}},onClick:function(){S.Z.alert((0,s.BX)("div",{css:{paddingTop:"16px",h2:{paddingBottom:"20px",fontWeight:"bold",fontSize:"24px",textAlign:"center"},p:{textAlign:"left",fontSize:"15px",textIndent:"30px"},a:{textDecoration:"underline",color:l.colors.primary}},children:[(0,s.tZ)("h2",{children:i||n}),a]}),{text:{ok:"我知道了"}}).then(g(),g())},children:(0,s.tZ)(f.rk,{css:{marginLeft:"4px"},center:!0,size:18})})]}))},w=function(e){var t=e.isBottom,n=(0,i._)(e,["isBottom"]);return(0,s.tZ)(y.$U,(0,o._)((0,r._)({as:"button",zaType:"Button",zaText:!0,css:function(e){return{cursor:"pointer",display:"flex",alignItems:"center",color:e.colors.GBL05A}}},n),{children:t?(0,s.BX)(s.HY,{children:[(0,s.tZ)(E.Text,{mr:"4px",fontSize:"14px",children:"回到顶部"}),(0,s.tZ)(_.v,{text:!0,fontSize:"16px"})]}):(0,s.BX)(s.HY,{children:[(0,s.tZ)(E.Text,{mr:"4px",fontSize:"14px",children:"发布设置"}),(0,s.tZ)(m.f,{text:!0,fontSize:"16px"})]})}))},R=function(e){var t=e.className,n=(0,i._)(e,["className"]);return(0,s.tZ)(E.Flex,(0,r._)({className:t,height:"52px",css:function(e){return{justifyContent:"center",borderTop:"1px solid ".concat(e.colors.GBK09A),background:e.colors.GBK99C,WebkitFontSmoothing:"subpixel-antialiased"}}},n))},N=function(e){var t=e.children,n=e.hideScrollButton,r=e.isAnswer,o=(0,a._)((0,d.Z)(!1),2),i=o[0],c=o[1];return(0,T.useEffect)(function(){var e=function(){var e=document.documentElement;e.scrollTop+e.clientHeight>=e.scrollHeight-5?c.on():c.off()};return document.addEventListener("scroll",e),function(){window.removeEventListener("scroll",e)}},[c]),(0,s.BX)(s.HY,{children:[(0,s.tZ)(E.Box,{height:"52px",css:{visibility:"hidden"}}),(0,s.tZ)(R,{css:{position:"fixed",left:0,right:0,bottom:0,zIndex:1},children:(0,s.BX)(E.Flex,{height:"52px",alignItems:"center",mx:"auto",css:{width:r?"654px":"800px"},children:[!n&&(0,s.tZ)(w,{onClick:function(){(0,C.X5)(window,{top:i?0:document.body.scrollHeight,behavior:"smooth"})},isBottom:i}),t]})})]})},k=function(e){var t=e.children,n=e.hideScrollButton,r=e.getContaner;return(0,s.tZ)(I.Z,{bottom:!0,getStyle:function(){return{width:"1000px",bottom:0,maxWidth:"100vw"}},container:r,children:function(e){var o=!e.isFixed;return(0,s.tZ)(R,{children:(0,s.BX)(E.Flex,{width:"100%",height:"52px",alignItems:"center",mx:"auto",px:"20px",children:[!n&&(0,s.tZ)(w,{onClick:function(){if(o){(0,C.X5)(window,{top:0,behavior:"smooth"});return}var e=null==r?void 0:r();if(e){var t=e.getBoundingClientRect().bottom+52;(0,C.yZ)(window,{top:t-document.documentElement.clientHeight,behavior:"smooth"})}},isBottom:o}),t]})})}})},O=function(e){return(0,s.tZ)("button",(0,o._)((0,r._)({css:function(e){return{color:e.colors.GBK08B,marginLeft:"auto",flex:"0 0 auto",height:"100%",padding:"0 10px"}}},e),{children:(0,s.tZ)(h.C,{text:!0})}))};function x(e){var t=e.checked,n=e.onChange,a=e.text,u=e.id,d=e.disabled,h=e.shouldTrackClick,f=e.zaTextPrefix,_=e.zaText,m=(0,i._)(e,["checked","onChange","text","id","disabled","shouldTrackClick","zaTextPrefix","zaText"]),v=(0,y.Q4)().trackEvent;return(0,s.BX)(E.Flex,(0,o._)((0,r._)({flex:1,alignItems:"center",as:"label",htmlFor:u,css:{flex:"0 0 auto",marginRight:"20px",cursor:"pointer"}},m),{children:[(0,s.tZ)(l.Z,{id:u,size:20,checked:t,onChange:(0,p.Z)(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];h&&v({eventType:"Click",action:"Unknown",elementLocation:{type:"Button",text:_||(f?"".concat(f,"-").concat(a):a)}}),n.apply(void 0,(0,c._)(t))}),disabled:d}),(0,s.tZ)(E.Text,{ml:"4px",fontSize:"14px",color:"GBL05A",children:a})]}))}var P=function(e){return(0,s.tZ)(b.Z,(0,r._)({css:{".Select-button":{width:"270px",height:"38px"},".Select-arrow":{marginLeft:"auto"}}},e))},D=function(e){return(0,s.tZ)(b.W,(0,r._)({css:function(e){return{color:e.colors.GBK02A,fontSize:"14px"}}},e))}},25744:function(e,t,n){"use strict";var r=n(94009),o=n(85879),i=n(87363),a=n(7835),c=n(81956),s=n(87641),l=n(31467),u=n(43384),d=n(67516),p=n.n(d),h=n(4757),f={pin:"Pin",article:"Post",answer:"Answer"},_=function(e){var t=e.totalContentCount;return(0,o.BX)(s.Flex,{justifyContent:"center",alignItems:"center",children:["这是你发布的第",(0,o.BX)(s.Text,{fontFamily:"EditorModalFont",fontSize:"15px",children:["\xa0",t,"\xa0"]}),"篇创作"]})},m=function(e){var t=e.type,r=e.toPromoteUrl;return(0,o.BX)(s.Box,{children:[(0,o.tZ)(s.Text,{fontSize:"15px",mt:"24px",mb:"16px",children:"使用超赞包即享海量曝光，轻松助力作品上热门"}),(0,o.tZ)(s.Flex,{flexDirection:"column",justifyContent:"center",alignItems:"center",css:{position:"relative",height:"213px",backgroundImage:"url(".concat(n(63848),")"),backgroundPosition:"center",backgroundSize:"cover"},children:(0,o.tZ)(u.Wi,{zaType:"Button",zaModuleId:"super_coupon_creat_publish_popup_qr_code",extra:{configMap:{super_coupon_create_publish_popup_content_type:"".concat(f[t])}},children:(0,o.tZ)(s.Image,{src:"https://www.zhihu.com/qrcode?url=".concat(encodeURIComponent(r)),width:"120px",height:"120px",mt:"37px"})})}),(0,o.tZ)(s.Text,{fontSize:"12px",color:"GBK06A",children:"打开「知乎 APP」扫描上方二维码"})]})},v=function(e){var t=e.children;return(0,o.tZ)(s.Box,{css:function(e){return{background:"url(".concat(n(56062),") no-repeat center bottom"),backgroundSize:"contain",paddingBottom:"116px",color:e.colors.GBK03A,lineHeight:"24px",width:"352px",marginTop:"24px",textAlign:"center",fontSize:"14px",a:{color:e.colors.GBL01A}}},children:t})};t.Z=function(e){var t=e.author,n=e.type,d=e.contentId,g=e.footerButton,T=e.closeSuccessModal,E=(0,r._)((0,h.Ue)(),3),C=E[0],y=E[1],S=E[2],I=(0,u.Q4)(),b=I.trackEvent,A=I.trackShow,Z=(0,r._)((0,i.useState)(!1),2),w=Z[0],R=Z[1],N=(0,r._)((0,i.useState)({isDmp:!1,isExp:!1,isFirst:!1,totalContentCount:0}),2),k=N[0],O=N[1],x=(0,c.Z)();(0,a.Z)(function(){var e=p().get("showEditorTipModal");if("pin"!==n&&!e){S();return}x("/api/v4/content-promotion/super-coupon/pcpop").then(function(e){var t,r=(null==e?void 0:null===(t=e.payload)||void 0===t?void 0:t.data)||{};(null==r?void 0:r.isDmp)||!(null==r?void 0:r.isDmp)&&"pin"===n?(R(!0),y(),O(r)):S()}).catch(function(){O({isDmp:!1,isExp:!1,isFirst:!1,totalContentCount:0}),S()}).finally(function(){p().set("showEditorTipModal",!1)})}),(0,i.useEffect)(function(){"pin"===n&&A({elementLocation:{type:"Button",moduleId:"super_coupon_creat_publish_check_detail_button"}})},[n]);var P=k.isDmp,D=void 0!==P&&P,L=k.isExp,B=k.isFirst,U=k.totalContentCount,M="https://www.zhihu.com/appview/creator/coupons/promote?contentType=".concat(n,"&contentId=").concat(d,"&utm_source=pcqrcode_publish_suc&zh_hide_nav_bar=true"),G=!D&&"pin"===n,F=function(e){"pin"===e&&(b({action:"OpenUrl",eventType:"Click",elementLocation:{type:"Button",moduleId:"super_coupon_creat_publish_check_detail_button"}}),window.open("https://www.zhihu.com/pin/".concat(d))),R(!1),T&&T()};return C&&w?(0,o.tZ)(l.Z,{size:"default",onClose:F,className:"ModalSucsess",title:"发布成功！",css:{backgroundSize:"contain",paddingBottom:"116px",lineHeight:"24px",width:"400px",margin:"0 auto 15px",textAlign:"center",fontSize:"14px",".Modal-content":{marginTop:"8px",display:"flex",justifyContent:"center"}},children:(0,o.BX)(u.Wi,{as:"div",css:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},zaType:"Popup",zaModuleId:"super_coupon_creat_publish_popup",view:{elementLocation:{type:"Popup",page:{pageId:"60029"}}},extra:{configMap:{super_coupon_create_publish_popup_content_type:"".concat(f[n])}},children:[G?(0,o.BX)(v,{children:["你可以到「",(0,o.tZ)("a",{href:"https://www.zhihu.com/people/".concat(t.urlToken||t.id,"/pins"),target:"_blank",rel:"noopener noreferrer",onClick:T,children:"我的主页"}),"」中查看刚刚发布的内容，也可以打开「知乎 App」查看「想法」。"]}):(0,o.tZ)(s.Text,{fontSize:"13px",color:"GBK06A",children:0===U?"感谢你的创作":(0,o.tZ)(_,{totalContentCount:U})}),D&&void 0!==L&&L&&void 0!==B&&B&&(0,o.tZ)(m,{type:n,toPromoteUrl:M}),(0,o.tZ)(s.Box,{className:"ModalToDetail",css:function(e){return{display:"inlineBlock",border:"1px solid ".concat(e.colors.GBL01A),backgroundColor:"".concat(e.colors.GBL01A),padding:"0 16px",width:"210px",boxSizing:"borderBox",fontSize:"14px",lineHeight:"32px",textAlign:"center",cursor:"pointer",borderRadius:"3px",color:e.colors.GBK99A}},onClick:function(){return F(n)},role:"button",mt:G?"16px":"24px",children:g})]})}):null}},3707:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var r=n(55164),o=n(57477),i=n(79065),a=n(85879),c=n(24405),s=n(80565),l=n(65733),u=n(82806),d=n.n(u),p=n(36695),h=n(87641),f=n(43384);function _(){var e=(0,i._)(["",""]);return _=function(){return e},e}var m=function(e){var t=e.avatars,n=e.isDarkMode;return(0,a.tZ)("ul",{css:{display:"flex",alignItems:"center",marginRight:3},children:t.map(function(e){var t=e||{},r=t.day,o=t.night,i=t.width,c=void 0===i?14:i,s=t.height,l=void 0===s?14:s,u=n?o:r;return u?(0,a.tZ)("li",{css:{display:"flex",alignItems:"center","& + &":{marginLeft:-5}},children:(0,a.tZ)("img",{src:u,alt:"",css:function(e){return{width:c,height:l,borderRadius:"100%",border:"1px solid ".concat(e.colors.GBK99A)}}})},u):null})})};function v(e){var t=e.contentType,n=e.id,i=e.onClickVoterInfo,u=(0,p.useSelector)(function(e){return e["".concat(t,"s")].relationEndorsement[n]})||{},v=u.icon,g=u.text,T=void 0===g?"":g,E=u.textColor,C=void 0===E?"GBK06A":E,y=u.textSize,S=void 0===y?14:y,I=u.isBold,b=void 0!==I&&I,A=u.type,Z=u.avatars,w=u.relationshipEndorseReasonType,R=(0,c.F)().isDarkMode,N="reaction_endorse"===A,k=(0,l.Z)(function(){N&&i()});if(!T)return null;var O=v||{},x=O.day,P=O.night,D=O.width,L=O.height,B=!!(null==Z?void 0:Z.length);return(0,a.tZ)(f.Wi,(0,o._)((0,r._)({zaType:"Text",zaModuleId:"relationship_endorse"},"relationship_endorse"===A?{extra:{configMap:{relationship_endorse_type:String(w)}}}:{zaBlock:"VoterInfo"}),{children:(0,a.BX)(h.Flex,{css:(0,r._)({},N&&{cursor:"pointer",display:"inline-flex"}),onClick:k,alignItems:"center",my:"12px",children:[!B&&v&&(0,a.tZ)(h.Image,{mr:"4px",width:void 0===D?12:D,height:void 0===L?12:L,src:R?void 0===P?"":P:void 0===x?"":x,alt:""}),B&&(0,a.tZ)(m,{avatars:Z,isDarkMode:R}),(0,a.tZ)(h.Text,{css:function(e){return(0,r._)({fontSize:S,fontWeight:b?"bold":"normal",color:e.colors[C]},(0,s.S)(1))},children:d()(_(),T)})]})}))}},82473:function(e,t,n){"use strict";n.d(t,{Z:function(){return I}});var r=n(22107),o=n(94707),i=n(86325),a=n(55164),c=n(85626),s=n(85879),l=n(87363),u=n(36695),d=n(50373),p=n(6438),h=n(87320),f=n(57477),_=n(74135),m=n(39716),v=n(39288),g=n(67927),T=(0,v.FH)("report",["ADD","REPORT_USER_ACTION"]),E=function(e){var t=e.message;return[103006,103007].includes(e.code)?t||m.dC.failure:[103003,103001].includes(e.code)?m.dC.duplicate:m.dC.failure},C=m.dC.success,y=function(){return Promise.all([n.e(584),n.e(1674),n.e(876)]).then(n.bind(n,33802)).then(function(e){return e.default})},S=function(e){(0,i._)(n,e);var t=(0,c._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"render",value:function(){return(0,s.tZ)(d.Z,(0,a._)({getComponent:y},this.props))}}]),n}(l.Component),I=(0,u.connect)(null,function(e,t){return{loadProfile:function(t){e((0,p.hr)(t))},updateUserBlocking:function(t,n){e((0,p.cR)(t,n))},doReport:function(n){var r,o,i,c,s,l,u,d,p,m,v,y,S;return e((r=n.resourceId,o=n.resourceIds,i=n.type,c=n.reasonType,s=n.reasonId,l=n.customReason,u=n.source,d=n.reportedMemberHashId,m=void 0===(p=n.options)?{}:p,v=n.url,y=n.pictures,S=n.reportedResource,{API:{types:T.ADD,endpoint:"reports",method:"POST",body:(0,_.decamelizeKeys)((0,f._)((0,a._)({},r&&{resourceId:r},o&&{resourceIds:o},S&&{reportedResource:S}),{type:i,reasonType:c,reasonId:s,reasonKey:s,customReason:l,source:void 0===u?"web":u,reportedMemberHashId:d,url:v,pictures:y}))},UPDATE:{success:function(e){return(0,h._)({},"".concat(i,"s"),(0,h._)({},r,{isHidden:e.reportInvisibleDisappear}))}},NOTIFICATION:void 0===m.NOTIFICATION?{key:"comment"===i?g.zQ:g.V8,success:C,failure:E}:m.NOTIFICATION})).then(function(e){return e.payload.sarcasmRecommend&&t.showWalle(),e})}}})(S)},57386:function(e,t,n){"use strict";n.d(t,{Z:function(){return O}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(71728),d=n(85626),p=n(85879),h=n(82038),f=n(88329),_=n.n(f),m=n(92769),v=n.n(m),g=n(14168),T=n.n(g),E=n(87363),C=n(69383),y=n(43384),S=n(4534),I=n(38889),b=n(74128),A=n(31142),Z=function(e){var t=e.onClose,n=e.shown;return(0,p.tZ)(b.Z,{wrapperClassName:"WalleModal",className:"WalleModal",title:"举报成功",onClose:t,children:n&&(0,p.BX)("div",{className:"WalleModal-wrapper",children:[(0,p.tZ)("p",{className:"WalleModal-des",children:"你的举报我们已经收到，处理结果会通过系统通知进行告知。"}),(0,p.tZ)("img",{className:"WalleModal-img",src:"https://zhstatic.zhihu.com/heifetz/wall-E.png",alt:"walle"}),(0,p.BX)("div",{className:"WalleModal-open",children:[(0,p.BX)("div",{className:"WalleModal-content",children:[(0,p.tZ)("div",{className:"WalleModal-title",children:"遇到不友善评论了？"}),(0,p.tZ)("div",{className:"WalleModal-intro",children:"开启瓦力保镖评论区保护，瓦力将自动为你识别并处理不友善的评论。"})]}),(0,p.tZ)(A.Z,{className:"WalleModal-btn",preset:"primary",color:"blue",to:"/settings/preference",children:"立即开启"})]})]})})},w=n(66263),R=n(85576),N=n(82473),k=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{shown:!1,walleModalShown:!1}),(0,a._)((0,r._)(e),"handleShow",e.props.authRequired(function(t){var n=e.props.zaReportId;e.setState({shown:!0}),e.props.onModalShown(!0),C.Z.trackEvent(t.target,(0,s._)({action:"Report",element:"Button",is_intent:!0},n&&{id:n}))},w.q0.report)),(0,a._)((0,r._)(e),"handleHide",function(t){e.setState({shown:!1}),e.props.onModalShown(!1,t)}),(0,a._)((0,r._)(e),"handleWalleShow",function(){e.setState({walleModalShown:!0}),e.props.onModalShown(!0)}),(0,a._)((0,r._)(e),"handleWalleClose",function(){e.setState({walleModalShown:!1}),e.props.onModalShown(!1)}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this.state,t=e.shown,n=e.walleModalShown,r=this.props,o=r.id,i=r.resourceType,a=r.type,c=r.modalProps,d=(0,u._)(r,["id","resourceType","type","modalProps"]),f=v()(d,["zaReportId","onModalShown","authRequired","isLogin","currentUser","dispatch"]);return(0,p.BX)(p.HY,{children:[(0,p.BX)(y.$U,(0,l._)((0,s._)({as:I.ZP,zaAction:"Report",zaType:"Button",preset:"plain",onClick:this.handleShow,zaModuleId:"click_report"},f),{children:[(0,p.tZ)(h.Z,{text:!0,center:!0})," 举报"]})),(0,p.tZ)(N.Z,(0,l._)((0,s._)({resourceType:i,type:a,urlToken:o,shown:t,onClose:this.handleHide,showWalle:this.handleWalleShow},c),{zaEnabled:!0})),(0,p.tZ)(Z,{shown:n,onClose:this.handleWalleClose})]})}}]),n}(E.Component);(0,a._)(k,"propTypes",{type:T().oneOf(S.eX).isRequired,id:T().oneOfType([T().number,T().string]).isRequired,zaReportId:T().number,onModalShown:T().func}),(0,a._)(k,"defaultProps",{onModalShown:_()});var O=(0,R.Z)(k)},24752:function(e,t,n){"use strict";n.d(t,{y:function(){return r.Z}});var r=n(82473);n(57386)},45588:function(e,t,n){"use strict";var r=n(85879),o=n(67814),i=n.n(o),a=n(37335);t.Z=function(e){var t=e.className;return(0,r.BX)("div",{className:i()("Reviewing",t),children:[(0,r.BX)("div",{className:"Reviewing-top",children:[(0,r.tZ)(a.P,{size:16}),(0,r.tZ)("span",{className:"Reviewing-tip",children:"内容审核中"})]}),(0,r.tZ)("div",{className:"Reviewing-text",children:"内容将在审核通过后自动发布"})]})}},47163:function(e,t,n){"use strict";n.d(t,{Z:function(){return U}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),l=n(85879),u=n(14168),d=n.n(u),p=n(87363),h=n(36695),f=n(93206),_=n(50373),m=n(67516),v=n.n(m),g=n(85576),T=n(66263),E=n(8866),C=n(67927),y=n(67036),S=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.totalMoney,n=e.showRewarders;return(0,l.tZ)("div",{children:!!t&&(0,l.tZ)("div",{className:"Reward-money",children:(0,l.BX)("span",{onClick:n,role:"button",tabIndex:0,children:["\xa5 ",t.toFixed(2)]})})})}}]),n}(p.Component);(0,a._)(S,"propTypes",{totalMoney:d().number,showRewarders:d().func});var I=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props.activateReward;return(0,l.BX)("div",{className:"Reward",children:[(0,l.tZ)("button",{className:"Reward-activateBtn",onClick:e,children:"开启赞赏"}),(0,l.tZ)("div",{className:"Reward-activateHint",children:"赞赏开启后，读者将可以付费支持你的创作。"})]})}}]),n}(p.Component);(0,a._)(I,"propTypes",{activateReward:d().func});var b=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.tagline,n=e.onClick;return(0,l.BX)("div",{children:[(0,l.tZ)("div",{className:"Reward-tagline",children:t||T.Sp}),(0,l.tZ)("button",{className:"Reward-rewardBtn",onClick:n,children:"赞赏"})]})}}]),n}(p.Component);(0,a._)(b,"propTypes",{onClick:d().func,tagline:d().string});var A=n(19076),Z=n(99447),w=n(30722),R=n(80714),N=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{hoverName:""}),(0,a._)((0,r._)(e),"hoverUser",function(t){e.setState({hoverName:t.target.dataset.name})}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.users,r=t.handleListShown,o=t.rewardMemberCount,i=t.onUserClick,a=this.state.hoverName,c=n.slice(0,5);return(0,l.BX)("div",{className:"Reward-count",children:[(0,l.tZ)("p",{className:"Reward-User-text",onClick:r,children:"".concat((0,w.uf)(o)," 人已赞赏")}),(0,l.BX)("div",{children:[c.map(function(t,n){return R.Z.isMobileEntry&&T.dd?(0,l.tZ)("img",{src:t.avatarUrl,className:"Reward-User-avatar","data-name":t.name,"data-index":n,alt:"赞赏用户"},n):(0,l.tZ)(A.Link,{to:"//".concat(R.Z.wwwHost,"/").concat(t.userType,"/").concat(t.urlToken),className:"Reward-User-img","data-hover-title":a,target:"_blank",onClick:i,children:(0,l.tZ)("img",{src:t.avatarUrl,className:"Reward-User-avatar","data-name":t.name,"data-index":n,onMouseOver:e.hoverUser,alt:"赞赏用户"})},n)}),o>6&&(0,l.BX)("span",{className:"Reward-MoreUser",onClick:r,children:[(0,l.tZ)("i",{}),(0,l.tZ)("i",{}),(0,l.tZ)("i",{})]})]})]})}}]),n}(p.Component);(0,a._)(N,"propTypes",{users:d().array,handleListShown:d().func,rewardMemberCount:d().number,onUserClick:d().func}),(0,a._)(N,"defaultProps",{users:[]});var k=(0,Z.a)({module:"UserList",moduleName:"*** 人已赞赏"})(N),O=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.rewardMemberCount,n=e.handleListShown,r=e.isAuthor,o=e.users,i=e.onUserClick;return t?(0,l.tZ)(k,{users:o,onUserClick:i,handleListShown:n,rewardMemberCount:t}):(0,l.tZ)("div",{className:"Reward-countZero",children:r?null:"还没有人赞赏，快来当第一个赞赏的人吧！"})}}]),n}(p.Component);(0,a._)(O,"propTypes",{rewardMemberCount:d().number,handleListShown:d().func,isAuthor:d().bool,users:d().array,onUserClick:d().func});var x=n(74128),P=n(39503),D=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.modalShown,n=e.onLoad,r=e.items,o=e.voteupCount,i=e.isRewardList,a=e.onClose,c=e.notice;return(0,l.tZ)(x.Z,{size:"fullPage",onClose:a,children:t&&(0,l.tZ)(P.Z,{items:r,text:"赞赏了",isFetching:!1,isDrained:!1,voteupCount:o,onLoad:n,isRewardList:i,notice:c,type:"rewardPeople"})})}}]),n}(p.Component);(0,a._)(D,"propTypes",{onLoad:d().func,modalShown:d().bool});var L=function(){return n.e(5622).then(n.bind(n,35622)).then(function(e){return e.TipjarDialog})},B=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{TipjarRender:!1,modalShown:!1}),(0,a._)((0,r._)(e),"onSubmitReward",function(t){v().set("isRewardable",!0),e.updateReward(t)}),(0,a._)((0,r._)(e),"onPaySuccess",function(){var t=e.props,n=t.reward,r=t.currentUser,o=t.id,i=t.type,a=n[i][o].users,c=[r];Array.isArray(a)&&(a.push(r),c=a),e.props.onRewardSuccess(c,o,i),e.colseTijarDialog(),e.props.showNotification("你已赞赏成功！")}),(0,a._)((0,r._)(e),"onLoad",function(t){"article"===e.props.type?"normal"===t?e.onLoadArticleRewardUser():e.onLoadArticleRewardUserDetails():e.onLoadRewardUser()}),(0,a._)((0,r._)(e),"onLoadArticleRewardUser",function(){var t=e.props.id;e.props.getArticleRewardUser(t)}),(0,a._)((0,r._)(e),"onLoadArticleRewardUserDetails",function(){var t=e.props,n=t.id;t.isAuthor?e.props.getPagingArticleRewardUserDetails(n):e.props.getPagingArticleRewardUser(n)}),(0,a._)((0,r._)(e),"onLoadRewardUser",function(){var t=e.props,n=t.id;t.isAuthor?e.props.getRewardUserDetails(e.props.id):e.props.getRewardUser(n).then(function(t){var n=t.payload.data;if(n.length>0){var r={};n.forEach(function(e){r[e.urlToken]=e}),e.props.updateEntitiesUsers(r)}})}),(0,a._)((0,r._)(e),"handleListShown",function(t){var n=e.props.onRewardUserMoreClick;n&&n(t),e.setState({modalShown:!0})}),(0,a._)((0,r._)(e),"handleListHide",function(){e.setState({modalShown:!1})}),(0,a._)((0,r._)(e),"updateReward",function(t){var n=e.props,r=n.type,o=n.id,i=n.rewardInfo.canOpenReward;"article"===r?e.props.updateArticleReward(o,t,!!i||void 0):e.props.updateAnswerReward(o,t)}),(0,a._)((0,r._)(e),"activateReward",function(){e.onSubmitReward(T.Sp)}),(0,a._)((0,r._)(e),"showRewarders",function(){e.setState({modalShown:!0})}),(0,a._)((0,r._)(e),"addReward",e.props.authRequired(function(t,n){var r=e.props,o=r.id;"article"===r.type?e.props.createArticleTipjar(o,t):e.props.createTipjar(o,t,n)},void 0,C.zQ)),(0,a._)((0,r._)(e),"handleRewardButtonClick",function(t){var n=e.props.onRewardButtonClick;n&&n(t),e.setState({TipjarRender:!0})}),(0,a._)((0,r._)(e),"colseTijarDialog",function(){e.setState({TipjarRender:!1})}),(0,a._)((0,r._)(e),"removeTradeNumber",function(){var t=e.props,n=t.id,r=t.type;e.props.removeTradeNumber(n,r)}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){var e=this.props.rewardInfo;e&&e.isRewardable&&this.onLoad("normal"),this.props.imperativeRef&&(this.props.imperativeRef.current={activateReward:this.activateReward.bind(this)})}},{key:"componentWillUnmount",value:function(){this.props.imperativeRef&&(this.props.imperativeRef.current=null)}},{key:"render",value:function(){var e=this.props,t=e.currentUser,n=e.isAuthor,r=e.isMobile,o=e.id,i=e.reward,a=e.author,c=e.type,s=e.ua,u=e.rewardInfo,d=u.canOpenReward,p=u.isRewardable,h=u.tagline,f=u.rewardTotalMoney,m=u.rewardMemberCount,v=e.onRewardUserClick,g=e.balanceEnable;if(n&&t&&"organization"===t.userType)return null;var T=this.state,E=T.TipjarRender,C=T.modalShown;if(n&&d)return(0,l.tZ)("div",{children:(0,l.tZ)(I,{activateReward:this.activateReward})});if(p){var y=i&&i[c][o]||{},A=y.tradeNumber,Z=y.users,w=y.notice,R=(0,l.tZ)(D,{modalShown:C,items:Z,voteupCount:m,onLoad:this.onLoad,isRewardList:n,notice:w,onClose:this.handleListHide}),N=(0,l.tZ)(O,{rewardMemberCount:m,handleListShown:this.handleListShown,onUserClick:v,users:Z,isAuthor:n});if(!n)return(0,l.BX)("div",{className:"Reward",children:[(0,l.tZ)(b,{tagline:h,onClick:this.handleRewardButtonClick}),N,R,(0,l.tZ)(_.Z,{getComponent:L,author:a,tagline:h,isMobile:r,ua:s,addReward:this.addReward,colseTijarDialog:this.colseTijarDialog,tradeNumber:A,removeTradeNumber:this.removeTradeNumber,onPaySuccess:this.onPaySuccess,TipjarRender:E,type:c,balanceEnable:g})]});var k=(Number(f)||0)/100;return(0,l.BX)("div",{className:"Reward",children:[(0,l.tZ)(S,{tagline:h,totalMoney:k,showRewarders:this.showRewarders}),R,N]})}return null}}]),n}(p.Component);(0,a._)(B,"propTypes",{reward:d().object,isAuthor:d().bool,author:d().object,id:d().number,rewardInfo:d().object,currentUser:d().object,ua:d().object,type:d().string,isMobile:d().bool,balanceEnable:d().bool,onRewardButtonClick:d().func,onRewardUserClick:d().func,onRewardUserMoreClick:d().func}),(0,a._)(B,"defaultProps",{rewardInfo:{},type:"answer",balanceEnable:!0});var U=(0,f.compose)(g.Z,(0,h.connect)(null,{updateAnswerReward:E.fT,updateArticleReward:y.i3,createArticleTipjar:y.pb,getRewardUserDetails:y.Js,getPagingArticleRewardUser:y.Ze,getPagingArticleRewardUserDetails:y.BE,getArticleRewardUser:y.nb,updateEntitiesUsers:y.$U,getRewardUser:y.vu,createTipjar:y.Cf,removeTradeNumber:y.on,onRewardSuccess:y.TN,showNotification:C.c0}))(B)},8231:function(e,t,n){"use strict";n.d(t,{O:function(){return ev},Z:function(){return ey}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(71728),d=n(94009),p=n(85626),h=n(85879),f=n(79852),_=n(75798),m=n(65733),v=n(54231),g=n(28753),T=n(67814),E=n.n(T),C=n(79445),y=n.n(C),S=n(14168),I=n.n(S),b=n(87363),A=n(36695),Z=n(93206),w=n(69383),R=n(43384),N=n(59189),k=n(21060),O=n(36480),x=n(20072),P=n(63020),D=n(38889),L=n(8858),B=n(30361),U=n(62317),M=n(58909),G=n(7768),F=function(e){(0,c._)(n,e);var t=(0,p._)(n);function n(){var e;return(0,o._)(this,n),(e=t.call(this)).state={tipShown:!1,tipContent:"",tipX:0,tipY:0,tipPosition:"bottom"},e.handleMouseDown=e.handleMouseDown.bind((0,r._)(e)),e.handleCopy=e.handleCopy.bind((0,r._)(e)),e.handleTipClose=e.handleTipClose.bind((0,r._)(e)),e.rightClickX=-1,e.rightClickY=-1,e}return(0,i._)(n,[{key:"getRange",value:function(e){if(e&&e.rangeCount>0)return e.getRangeAt(0)}},{key:"getExtraCopyright",value:function(e,t,n){var r=["作者：".concat(t),"链接：".concat(e),"来源：知乎","著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"],o=["",""];return n?r.concat(o):o.concat(r)}},{key:"getCopyText",value:function(e,t,n,r){var o=this.getExtraCopyright(t,n,r).join("\n");return r?o+e:e+o}},{key:"getRangeHtml",value:function(e){var t=document.createElement("div");return t.appendChild(e.cloneContents()),t.outerHTML}},{key:"getCopyHtml",value:function(e,t,n,r){var o=this.getExtraCopyright(t,n,r).join("<br />"),i=r?o+e:e+o;return"<div>".concat(i,"</div>")}},{key:"randomRange",value:function(e,t){return Math.floor(Math.random()*(t-e)+e)}},{key:"addCopyright",value:function(e,t,n){if(window.getSelection){var r=window.getSelection(),o=this.getRange(r),i=o.toString().trim(),a=this.getRangeHtml(o);if(i&&!(i.length<128)){var c=i.length>=512,s=this.getCopyHtml(a,t,n,c),l=this.getCopyText(i,t,n,c),u=e.nativeEvent.clipboardData;if("object"==typeof u&&(u.setData("text/html",'<meta charset="utf-8">'+s),u.setData("text/plain",l),u.getData("text/plain")&&u.getData("text/plain").length>0)){e.preventDefault();return}var d=document.createElement("div");d.innerHTML=s;var p=d.firstChild;p.style.position="fixed",p.style.left="-9999px",document.body.appendChild(p),r.selectAllChildren(p),setTimeout(function(){document.body.removeChild(p),r.removeAllRanges(),r.addRange(o)},200)}}}},{key:"showTip",value:function(e,t){if(window.getSelection){var n,r=window.getSelection(),o=this.getRange(r),i=o.toString().trim(),a=this.randomRange(44,66);if(!(i.length<=a)){e.preventDefault(),e.stopPropagation();var c=o.getBoundingClientRect(),s=window.pageYOffset,l=this.rightClickX,u=this.rightClickY,d="bottom";if(-1!==u)n=u+3;else{var p=this.props.viewPort,h=c.top+s,f=c.bottom+s,_=s+p.top+52,m=s+p.bottom-52;f<_?n=_-52:f<m?n=f:(d="top",n=h>_&&h<m?h:m+52)}var v=-1!==l?l+3:c.left+(c.right-c.left)/2-12;this.setState({tipShown:!0,tipContent:t,tipX:v,tipY:n,tipPosition:d}),this.rightClickX=-1,this.rightClickY=-1}}}},{key:"handleTipClose",value:function(){this.setState({tipShown:!1})}},{key:"handleCopy",value:function(e){var t=this.props,n=t.data,r=n.author,o=n.type,i=n.id,a=n.question,c=n.reshipmentSettings,s=n.relationship,l=void 0===s?{}:s,u=l.isAuthor,d=l.isAuthorized,p=t.isCurrentUser,f="";if("article"===o?f="https://zhuanlan.zhihu.com/p/".concat(i):"answer"===o&&(f="https://www.zhihu.com/question/".concat(a.id,"/answer/").concat(i)),!p&&!u)switch(c){case"disallowed":this.showTip(e,(0,h.tZ)("a",{href:"https://www.zhihu.com/term/zhihu-terms#sec-licence-6",children:"禁止转载"}));break;case"need_payment":if(d)this.showTip(e,"已获授权，复制成功");else{this.showTip(e,(0,h.tZ)("a",{href:"https://www.zhihu.com/copyright/apply?answer=".concat(i),children:"申请转载"}));break}default:this.addCopyright(e,f,r.name)}}},{key:"handleMouseDown",value:function(e){3===e.nativeEvent.which&&(this.rightClickX=e.pageX,this.rightClickY=e.pageY)}},{key:"render",value:function(){var e=this.props,t=e.onRef,n=e.data,r=e.tag,o=e.html,i=e.children,a=e.onClick,c=e.className,s=e.itemProp,l=e.style,u=e.prefix,d=e.ecommerce,p=e.shouldShowCatalog,f=e.shouldCatalogCollapse,_=e.richContentKey,m=e.isCurrentUser,v=e.isNovel,g=e.isExpanded,T=e.entityWords,E=e.isVideoAnswer,C=this.state,y=C.tipShown,S=C.tipContent,I=C.tipX,b=C.tipY,A=C.tipPosition;return(0,h.BX)("div",{ref:t,onClick:a,className:c,style:l,children:[u,(0,h.tZ)(G.Z,{entityWords:T,richContentKey:_,sourceId:n.id,sourceType:n.type,paidInfo:n.paidInfo,itemProp:s,tag:r,html:o,onCopy:this.handleCopy,onMouseDown:this.handleMouseDown,className:"CopyrightRichText-richText",ecommerce:d,shouldShowCatalog:p,useCatalogV2:!0,isAuthor:m,isNovel:v,isExpanded:g,shouldCatalogCollapse:f,isVideoAnswer:E}),i,(0,h.tZ)(U.Z,{shown:y,timeout:1e4,hideOnClick:!0,onClose:this.handleTipClose,x:I,y:b,position:A,content:S,className:"CopyrightRichText-tooltip"})]})}}]),n}(b.Component);F.propTypes={onRef:I().func,viewPort:I().object};var z=(0,Z.compose)((0,A.connect)(function(e,t){return{isCurrentUser:(0,M.pG)(e,t.data.author)}}))(F),H=n(36225),q=n(97727),V=n(80714),X=n(59937),W=n(70538),K=n(85576),j=n(7407),Y=n(35586),Q=function(){var e=(0,R.x3)({action:"ReadFinished",elementLocation:{type:"Text",text:"阅读完成",block:{blockText:"阅读完成"},moduleId:"universal_single_card"}});return(0,h.tZ)("span",{ref:e})},J=n(66011),$=n(6080),ee=n(2930),et=n(77878),en=n(16850),er=n(89774),eo=(0,Z.compose)((0,et.Z)({biz_tag:"ContentItem"}))(function(e){var t=e.url,n=e.hasVideo,r=e.duration,o=e.isVideoAnswer,i=e.onCoverImageLoad,a=e.useImageX,c=(0,u._)(e,["url","hasVideo","duration","isVideoAnswer","onCoverImageLoad","useImageX"]),d=(0,en.Z)(),p=(0,er.Z)(),f="1"===(0,$.c)("contentItem_cover_imagex",{mock:"1"}),_=!d&&a&&(f||p);return(0,h.BX)("div",(0,l._)((0,s._)({className:E()("RichContent-cover",{"RichContent-cover--mobile":V.Z.isMobileEntry})},c),{children:[(0,h.BX)("div",{className:E()("RichContent-cover-inner",{"RichContent-cover--normal":!_}),children:[_?(0,h.tZ)(J.MQ,{src:t,width:"190px",height:"105px",alt:"cover",layout:"fill",onLoad:i,objectFit:"cover"}):(0,h.tZ)(J.Nm,{src:t,width:190,height:105,alt:"cover",onLoad:i}),r&&(0,h.tZ)("div",{className:"RichContent-cover-mask"}),r&&(0,h.tZ)("div",{className:"RichContent-cover-duration",children:r})]}),o&&(0,h.tZ)(J.Nm,{alt:"",width:64,height:18,css:{position:"absolute",left:0,top:0,objectFit:"cover"},src:"https://pic1.zhimg.com/80/v2-c19ceba4b1bea7204cb67e27f469c95b_1440w.png"}),n&&(0,h.tZ)(ee.o,{className:"RichContent-cover-play"})]}))}),ei=n(79065),ea=n(82806),ec=n.n(ea),es=n(19076),el=n(30722),eu=n(44169);function ed(){var e=(0,ei._)(["发布于",""]);return ed=function(){return e},e}function ep(){var e=(0,ei._)(["发布于",""]);return ep=function(){return e},e}function eh(){var e=(0,ei._)(["编辑于",""]);return eh=function(){return e},e}function ef(){var e=(0,ei._)(["发布于",""]);return ef=function(){return e},e}function e_(){var e=(0,ei._)(["・",""]);return e_=function(){return e},e}var em=function(e){(0,c._)(n,e);var t=(0,p._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.href,n=e.created,r=e.updated,o=e.onClick,i=e.videoPlayCount,a=e.ipInfo;return(0,h.BX)("div",{className:"ContentItem-time",children:[(0,h.tZ)(es.Link,{to:t,target:V.Z.isMobileEntry?"":"_blank",onClick:o,children:(0,h.tZ)("span",{"data-tooltip":ec()(ed(),(0,eu.KZ)(n)),"aria-label":ec()(ep(),(0,eu.KZ)(n)),children:r!==n?ec()(eh(),(0,eu.KZ)(r)):ec()(ef(),(0,eu.KZ)(n))})}),!!a&&ec()(e_(),a),!!i&&(0,h.BX)("span",{css:{marginTop:10,marginLeft:5},children:["\xb7 ",(0,el.Zh)(i),"次播放"]})]})}}]),n}(b.Component);(0,a._)(em,"propTypes",{href:I().string,created:I().number,updated:I().number,videoPlayCount:I().number,onClick:I().func,ipInfo:I().string});var ev=em,eg=new Set([106713022,429615779,435773734,426291898,250310031,414291487,409115369,446861209,247003387,73377905,254989758,35134669,36249462,435345603,182387634,140256060,437667891,153624684,47216571,1009993776,1166287748,150785754,573667246,345093461,2051581556,423418617,24921526,427937981,119180585,442812865,175851487,285113967,807213480,415830436,125852644,399866520,269912473,736404714,630788898,217627201,32718846,233425911,1965977070,1703482555,425876259,376921084,477237451,430849009,409175983,395659900,404407636,33593650,29355234,45519587,477365726,407347055,128506044,324992390,391677046,399503822,540487048,514491508,340627548,433773279,125028091,126685323,1073936835,128655569,1782124590,431426144,198577418,449399100,2074550774,342658316,429187404,275411797,121202894,356603699,211168793,1182049284,88545788,435377412,142918293,112180819,107952366,394146559,239506554,243404812,967162682,416311991,108937963,503648342,37744326,338336040,742041726,2142758456,13098904,435935045,181579258,17350640]),eT=/.*?(class="link-box")/,eE=function(e){var t=e.children,n=e.onChange,r=(0,u._)(e,["children","onChange"]),o=(0,d._)((0,_.Z)(r),2),i=o[0],a=o[1],c=(0,m.Z)(n);return(0,b.useEffect)(function(){c(a)},[c,a]),(0,h.tZ)("span",{ref:i,children:t})},eC=function(e){(0,c._)(n,e);var t=(0,p._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",(0,l._)((0,s._)({},e.getInitTruncatedState(e.props)),{shouldSticky:!1,offset:0,prevImgUrls:[]})),(0,a._)((0,r._)(e),"richContentRef",(0,b.createRef)()),(0,a._)((0,r._)(e),"zaRef",(0,b.createRef)()),(0,a._)((0,r._)(e),"truncateContent",function(){var t=e.props,n=t.isMobile,r=t.onToggleExpend,o=e.props.expandedHeight||(n?400:800);(!e.content||e.content.scrollHeight<o)&&(e.setState({isTruncated:!1,isExpanded:!1}),null==r||r(!1,{trackUserAction:!1})),e.content&&e.content.scrollHeight>e.content.offsetHeight&&e.setState({contentCollapsed:!0})}),(0,a._)((0,r._)(e),"updateStateInBrowser",function(){var t=e.props,n=t.excerpt,r=t.allowCollapseWithEmptyExcerpt,o=t.html,i=t.expanded,a=t.cover,c=t.unescapable,s=t.limit,l=t.limitWithImage,u=t.truncateHTMLOptions,d=t.truncateDisabled,p=!0,h=e.state.truncatedContent;if((n||r)&&(eT.test(n)||d))h=n;else if(!c){var f=e.truncate(o,a?l:s,u);p=f.isTruncated,h=f.content}return{isTruncated:p,isExpanded:o&&i,truncatedContent:h,previewImg:null}}),(0,a._)((0,r._)(e),"checkOpenInAppStyle",function(e){if(V.Z.isMobileEntry){var t=document.querySelector(".OpenInApp");t&&(e?t.classList.add("is-higher"):t.classList.remove("is-higher"))}}),(0,a._)((0,r._)(e),"toggle",function(t){e.isCollapsed()?e.handleExpand(t):e.handleCollapse(t)}),(0,a._)((0,r._)(e),"trackExpand",function(t){var n=e.props.expandButtonZaType,r=t?"阅读全文":"收起阅读全文";e.zaRef.current.trackEvent({eventType:"Click",action:t?"Expand":"Collapse",elementLocation:{type:n||"Card",text:r,moduleId:"read_full_text_button"},block:r})}),(0,a._)((0,r._)(e),"handleExpand",function(t){var n,r,o,i,a,c=e.props,s=c.zaIds.expand,l=c.authRequired;if(c.contentNeedTruncated){e.trackExpand(!0),l(function(){})();return}(null==t?void 0:t.target)&&((null==(o=t.target.textContent)?void 0:o.length)>10||t.target.classList.contains("RichContent-inner")||t.target.classList.contains("List-item"))&&(o=null),eg.has(null===(n=e.props)||void 0===n?void 0:null===(r=n.data)||void 0===r?void 0:r.id)&&v.ZP.increment("RichContent.Expand.afterZALog.".concat(o||"default",".").concat(s||"default",".").concat(null===(i=e.props)||void 0===i?void 0:null===(a=i.data)||void 0===a?void 0:a.id,".count"));var u=e.props.onExpand;if(u){u(t);return}var d=e.props,p=d.onToggleExpend,h=d.data,f=h.type,_=h.id;d.currentUser&&(0,X.ZP)("article"===f?"post":f,_,X._x),p&&(p(!0),e.trackExpand(!0)),e.setState({isExpanded:!0},function(){"article"===f&&(0,x.y3)(e.richContentRef.current,function(){w.Z.trackEvent(e.richContentRef.current,{action:"ReadFinish"})})})}),(0,a._)((0,r._)(e),"handleCollapse",function(){var t=e.props.onToggleExpend;w.Z.trackEvent(e.richContentRef.current,{action:"Collapse",element:"Button"}),t&&(t(!1),e.trackExpand(!1)),e.setState({isExpanded:!1},function(){return e.checkOpenInAppStyle(!1)})}),(0,a._)((0,r._)(e),"handlePreview",function(t){var n,r,o=e.props,i=o.ua,a=o.isMobile,c=e.state,s=c.isExpanded,l=c.isTruncated,u=c.prevImgUrls,d=t.target;!(l&&!s)&&"IMG"===d.tagName&&(d.classList.contains("zh-lightbox-thumb")||d.classList.contains("Slideshow-swiperImage"))&&(a&&i.MQQBrowser&&(null===(n=window.browser)||void 0===n?void 0:null===(r=n.app)||void 0===r?void 0:r.openPhotoBrowser)?setTimeout(function(){window.browser.app.openPhotoBrowser(u,y()(u,function(e){return e===d.dataset.original}),0)},0):e.setState({previewImg:d}))}),(0,a._)((0,r._)(e),"handlePositionStatusChange",function(t){var n=e.props.onPositionStatusChange;n&&(n(t),e.checkOpenInAppStyle("fixed"===t))}),(0,a._)((0,r._)(e),"handleBodyInViewChange",function(t){t!==e.state.shouldSticky&&(e.setState({shouldSticky:t}),t||e.checkOpenInAppStyle(!1))}),(0,a._)((0,r._)(e),"handleTrunObserve",function(t){var n=e.props,r=n.data,o=r.type,i=r.id,a=n.updateReadStatus,c=n.html,s=t[0],l=s.intersectionRatio,u=s.isIntersecting;!V.Z.isMobileEntry||"answer"!==o||e.isReadMarked||e.isCollapsed()||((0,x.y3)(e.richContentRef.current,function(){a({type:o,id:i},!0)}),e.isReadMarked=!0),!e.truncateComputed&&(l>0||u||!c)&&(setTimeout(function(){return e.truncateContent()}),e.truncateComputed=!0)}),(0,a._)((0,r._)(e),"isCollapsed",function(){var t=e.props,n=t.after,r=t.before,o=t.unescapable,i=t.contentNeedTruncated,a=e.state,c=a.isExpanded,s=a.isTruncated;return(r||n)&&!o?!c:(i||s)&&!c}),e}return(0,i._)(n,[{key:"abstractProps",get:function(){var e=this.props.data,t=e.id,n=e.type,r=e.author,o=e.question;return{objectId:t,type:n,author:r,title:(void 0===o?{}:o).title,url:e.url,isCopyable:e.isCopyable}}},{key:"componentDidMount",value:function(){var e=this;this.setState((0,l._)((0,s._)({},this.updateStateInBrowser()),{viewPort:{top:148,bottom:window.innerHeight-56}}),function(){var t,n;null===(n=(t=e.props).onToggleExpend)||void 0===n||n.call(t,e.state.isExpanded,{trackUserAction:!1})}),(0,x.y3)(this.richContentRef.current,function(){var t=e.props,n=t.data,r=n.type,o=n.id,i=t.expanded;t.currentUser&&i&&(0,X.ZP)("article"===r?"post":r,o,X._x)}),this.props.imperativeRef&&(this.props.imperativeRef.current={handleExpand:this.handleExpand.bind(this)})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.data.id!==e.data.id&&this.setState(this.getInitTruncatedState(e))}},{key:"UNSAFE_componentWillUpdate",value:function(e,t){var n=e.ua,r=e.html,o=e.isMobile;if(this.state.isExpanded&&!t.isExpanded){var i=this.richContentRef.current.getBoundingClientRect();i.top<this.props.topExcludedHeight&&(this.rect=i,this.scroll=window.pageYOffset)}o&&!this.state.isExpanded&&t.isExpanded&&n.MQQBrowser&&this.setState({prevImgUrls:(0,W.Z)(r)})}},{key:"componentDidUpdate",value:function(e,t){if(t.isExpanded&&!this.state.isExpanded&&this.rect){var n=this.rect,r=n.top,o=n.bottom,i=n.height,a=this.richContentRef.current.offsetHeight,c=window.innerHeight;window.scrollTo(0,this.scroll+(o<c?a-i:r-(c-a))),this.rect=null,this.scroll=null}}},{key:"componentWillUnmount",value:function(){this.props.imperativeRef&&(this.props.imperativeRef.current=null)}},{key:"getInitTruncatedState",value:function(e){var t=e.excerpt,n=e.html,r=e.expanded,o=e.unescapable;return{isTruncated:t.length<=n.length,isExpanded:r,truncatedContent:o?n:t,previewImg:null}}},{key:"truncate",value:function(e,t,n){var r=(0,O.tK)(e,t,n);return{isTruncated:r.isTruncated,content:r.content}}},{key:"renderActions",value:function(){var e=this,t=this.props,n=t.children,r=t.unescapable,o=t.noCollapsed,i=t.expandText,a=t.onClick,c=t.videoData,s=t.needExpandArrow,l=t.forceSticky,u=t.noRenderActions,d=t.contentNeedTruncated,p=this.state,f=p.isExpanded,_=p.isTruncated,m=p.shouldSticky,v=p.offset;if(!f)return[r&&(d||_)&&!c&&(0,h.BX)(D.ZP,{preset:"plain",className:"ContentItem-rightButton ContentItem-expandButton",onClick:a||this.handleExpand,children:[void 0===i?"展开阅读全文":i,(void 0===s||s)&&(0,h.tZ)(g.f,{className:"ContentItem-arrowIcon",center:!0})]},"expand-button"),!u&&n&&(0,h.tZ)(B.eX,{children:n},"actions")];var T=!u&&(n||!o)&&(0,h.BX)(B.eX,{className:"RichContent-actions",children:[n,!o&&(0,h.BX)(D.ZP,{"data-zop-retract-question":!0,preset:"plain",className:"ContentItem-rightButton",onClick:this.handleCollapse,children:[(0,h.tZ)("span",{className:"RichContent-collapsedText",children:"收起"}),(0,h.tZ)(g.f,{className:"ContentItem-arrowIcon is-active",center:!0})]})]});return(l||m)&&T?(0,h.tZ)(k.Z,{offset:v,bottom:!0,container:function(){return e.richContentRef.current.parentNode},onPositionStatusChange:this.handlePositionStatusChange,children:T}):T}},{key:"renderText",value:function(){var e=this,t=this.props,n=t.html,r=t.excerpt,o=t.data,i=t.itemProp,a=t.expandText,c=t.onClick,u=t.prefix,d=t.unescapable,p=t.isSearchContent,_=t.collapsedHeight,m=t.ecommerce,v=t.canAbstract,T=t.richContentKey,C=t.shouldCatalogCollapse,y=t.isNovel,S=t.entityWords,I=t.isVideoAnswer,b=this.state,A=b.truncatedContent,Z=b.previewImg,w=b.viewPort,R=b.contentCollapsed,k=b.isExpanded,O=this.isCollapsed(),x=O?A||r:n,B=p&&V.Z.isMobileEntry?{onClick:c}:{},U=(0,h.BX)(z,(0,l._)((0,s._)({entityWords:S,richContentKey:T&&String([T,O]),itemProp:void 0===i?"text":i,className:E()("RichContent-inner",{"RichContent-inner--collapsed":R}),style:O&&d?{maxHeight:_}:null,tag:"span",onRef:function(t){e.content=t},isExpanded:k,data:o,html:x,viewPort:w,prefix:u},O&&{onClick:c||this.handleExpand},B),{ecommerce:m,shouldCatalogCollapse:C,shouldShowCatalog:(0,L.Z)(o)&&(k||d&&!O),isNovel:y,isVideoAnswer:I,children:[v&&(0,h.tZ)(P.Z,(0,s._)({},this.abstractProps)),!d&&O&&(0,h.BX)(D.ZP,{preset:"plain",className:"ContentItem-more",children:[void 0===a?"阅读全文":a,(0,h.tZ)(g.f,{className:"ContentItem-arrowIcon",center:!0})]}),(0,h.tZ)(f.Z,{img:Z,onClose:function(){return e.setState({previewImg:null})}})]}),O);return d?(0,h.tZ)(N.Z,{rootMargin:"200px 0px 200px 0px",onObserve:this.handleTrunObserve,children:U}):U}},{key:"render",value:function(){var e=this.props,t=e.unescapable,n=e.after,r=e.before,o=e.extra,i=e.cover,a=e.onCoverImageLoad,c=e.hasVideo,s=e.renderCanExpandExtra,l=e.className,u=e.videoData,d=e.handleClickVideoMoreButton,p=e.duration,f=e.isVideoAnswer,_=this.state.isExpanded,m=this.isCollapsed(),v=u?(0,h.BX)(h.HY,{children:[(0,h.tZ)(H.Z,{data:u}),(0,h.tZ)("p",{className:"RichContent-videoMore",onClick:d,children:"点击查看全文"})]}):this.renderText(),g=(0,h.tZ)(eE,{rootMargin:"-".concat(240,"px 0px"),onChange:this.handleBodyInViewChange,children:v});return(0,h.BX)("div",{className:E()("RichContent",l,{"is-collapsed":m,"RichContent--unescapable":t}),ref:this.richContentRef,onClick:this.handlePreview,children:[(0,h.tZ)(R.pS,{ref:this.zaRef}),(0,h.tZ)(q.bY,{input:"o",action:this.toggle}),!m&&r,!t&&m&&i&&(0,h.tZ)(eo,{url:i,onCoverImageLoad:a,hasVideo:c,onClick:this.handleExpand,duration:p,isVideoAnswer:f,useImageX:!0}),g,o||"function"==typeof s&&s(_,this.handleExpand),!m&&(0,h.BX)(h.HY,{children:[n,(0,h.tZ)(Q,{root:this.richContentRef})]}),this.renderActions()]})}}]),n}(b.Component);(0,a._)(eC,"propTypes",{enableConvert:I().bool,unescapable:I().bool,expanded:I().bool,noCollapsed:I().bool,limit:I().number,limitWithImage:I().number,collapsedHeight:I().number,html:I().string,excerpt:I().string,allowCollapseWithEmptyExcerpt:I().bool,truncateDisabled:I().bool,before:I().node,after:I().node,prefix:I().node,extra:I().node,renderCanExpandExtra:I().func,topExcludedHeight:I().number,onPositionStatusChange:I().func,type:I().string,data:I().object,canAbstract:I().bool,cover:I().string,hasVideo:I().bool,truncateHTMLOptions:I().object,expandText:I().string,onToggleExpend:I().func,videoData:I().object,handleClickVideoMoreButton:I().func,zaIds:I().shape({expand:I().number}),forceSticky:I().bool,contentNeedTruncated:I().bool}),(0,a._)(eC,"defaultProps",{limit:160,limitWithImage:100,expanded:!1,unescapable:!1,topExcludedHeight:60,excerpt:"",allowCollapseWithEmptyExcerpt:!1,hasVideo:!1,isVideoAnswer:!1,data:{},collapsedHeight:400,zaIds:{},forceSticky:!1});var ey=(0,Z.compose)(K.Z,(0,A.connect)(function(e){return{ua:(0,j.Uh)(e),isMobile:(0,j.Hu)(e)}},{updateReadStatus:Y.m3}))(eC)},69578:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(49899),a=n(85879),c=n(65733),s=n(87363),l=n(36695),u=n(80714),d=n(66263),p=n(67927),h=n(48825),f=n(37209),_=n(37705),m=[".webp",".jpg",".jpeg",".png",".gif"];t.Z=(0,s.forwardRef)(function(e,t){var n=(0,l.useDispatch)(),v=(0,l.useSelector)(function(e){return e.switches.couldSuperVideoUpload}),g=(0,l.useSelector)(function(e){return e.env.trafficSource}),T=(0,c.Z)(function(t,n){var r;null===(r=e.onUploadError)||void 0===r||r.call(e,t,n)}),E=(0,s.useCallback)(function(t){return n((0,h.Ix)(t,e.uploadType,e.editingContentType,"1"===u.Z.apollo.editor_auto_rotate)).then(function(e){return e.payload}).then(function(e){return{url:e.src,originalSrc:e.originalSrc,watermarkSrc:e.watermarkSrc,privateWatermarkSrc:e.privateWatermarkSrc,watermark:e.watermark,rawWidth:e.dataRawwidth,rawHeight:e.dataRawheight,id:e.hash}}).catch(function(e){throw T(e,"image"),e})},[n,e.editingContentType,e.uploadType,T]),C=(0,s.useCallback)(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return n(f.Ty.apply(void 0,(0,i._)(t))).then(function(e){return e.payload}).catch(function(e){throw T(e,"video"),e})},[n,T]),y=(0,s.useCallback)(function(e){if("object"==typeof e){n((0,p.c0)(e.message,"red"));return}switch(e){case"type":n((0,p.c0)("格式不支持，请上传以下格式的图片：".concat(m.join(", ")),"red"));return;case"size":n((0,p.c0)("请上传不超过 ".concat(d.i3,"M 的图片"),"red"));return;case"dimension":n((0,p.c0)("GIF 图片的长或宽低于 ".concat(120,"px，无法上传"),"red"));return;case"disable-question-answer-image-upload":n((0,p.c0)("图片服务进行升级改造，暂时不能在「问题」「回答」中添加图片","red"));return;case"other":n((0,p.c0)("图片上传未完成，请稍后发布"));return}},[n]),S=(0,s.useCallback)(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return n(f.o2.apply(void 0,(0,i._)(t))).then(function(e){return e.payload})},[n]);return(0,a.tZ)(_.Z,(0,o._)((0,r._)({},e),{ref:t,allowInlineCode:!0,allowImageCaption:!0,allowResizeImage:!0,onImageUpload:E,onVideoUpload:C,uploadImageError:y,loadVideo:S,couldSuperVideoUpload:v,isProduction:"production"===g}))})},36225:function(e,t,n){"use strict";n.d(t,{Z:function(){return x}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(85626),d=n(85879),p=n(87363),h=n(93206),f=n(36695),_=n(2930),m=n(94636),v=n(69383),g=n(68159),T=n(67927),E=n(37209),C=n(99447),y=n(42559),S=n.n(y),I=function(e,t){return .01>Math.abs(e-t)},b={auto:"Auto",ld:"LD",sd:"SD",hd:"HD"},A={auto:"自动",ld:"低清",sd:"标清",hd:"超清"},Z=[1,2,3,5,8,13],w=n(80714),R=n(35502),N=function(e){var t=e.children,n=e.videoId,r=e.iframeRef;return(0,R.Z)({videoId:n,iframeRef:r}),t},k=function(e){var t=new URL(e);return t.searchParams.append("hideWatermark","1"),t.toString()},O=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(e){(0,o._)(this,n),w=t.call(this,e),(0,a._)((0,r._)(w),"handleMessage",function(e,t){var n=w.videoTracker,r=n.handlePlayEvent,o=n.handlePauseEvent,i=n.handleQualityChangeEvent,a=n.handleFragmentLoading,c=n.handleFragmentLoaded;switch(e){case g.FP.DOM.PLAY:r(t);break;case g.FP.DOM.PAUSE:o(t);break;case g.FP.PLAYER.QUALITY_CHANGE:i(t);break;case"fragment-loading":a(t);break;case"fragment-loaded":c(t)}}),(0,a._)((0,r._)(w),"handlePlay",function(){w.props.trackEvent((0,r._)(w),{id:5500,action:"Play",element:"Video"})}),(0,a._)((0,r._)(w),"handlePlayFailed",function(){(0,w.props.showNotification)("视频加载失败，请刷新页面重试","red")}),(0,a._)((0,r._)(w),"handleIframeLoad",function(e){w.setState({iframe:e})});var i,c,l,u,d,p,h,f,_,m,T,E,C,y,w,R=e.data;return w.messageHelper=(0,g.Wn)(R.id,"*",!0),w.videoTracker=(i=function(e,t){v.Z.trackEvent((0,r._)(w),e,{play:t})},l=function(e,t){var n;i(e,(0,s._)({play_event_identifier:_,duration:1e3*f,elapsed:m+((n=T)?Date.now()-n:0),video_quality:b[h]},t))},u=function(){(++y<15?Z.includes(y):y%15==0)&&l({action:"Playing"})},d=function(){y=0,p(),c=setInterval(u,1e3)},h="sd",f=0,_=null,m=0,T=null,E=!1,C=0,y=0,{handlePlayEvent:function(e){var t=e.currentTime;f=e.duration,I(t,0)&&(_=S()(),m=0),T=Date.now(),I(t,0)?l({action:"Play"}):l({action:"ResumePlay"}),d()},handlePauseEvent:function(e){var t=e.currentTime,n=e.duration;T&&(m+=Date.now()-T,T=null),I(t,n)?l({action:"EndPlay"}):l({action:"Pause"}),p()},handleQualityChangeEvent:function(e){var t=e.quality;l({action:"Switch",name:A[t]}),h=t},handleFragmentLoading:function(){E||(C=Date.now())},handleFragmentLoaded:function(){E||(E=!0,l({action:"Load"},{video_load_time:Date.now()-C}))},clearTick:p=function(){clearInterval(c)}}),w.state={iframe:null},w}return(0,i._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=t.isLens,r=t.id,o=t.playerUrl,i=t.flvPlayerUrl,a=e.loadVideo;n||!r||o||i||a(r);var c=this.messageHelper.subscribeMessage;this.messageSubscription=c(this.handleMessage)}},{key:"componentWillUnmount",value:function(){this.messageSubscription.unsubscribe(),this.videoTracker.clearTick()}},{key:"render",value:function(){var e=this.props,t=e.data,n=e.data.error,r=e.onBeforePlay,o=e.hideWatermark&&t.playerUrl?k(t.playerUrl):t.playerUrl;return(0,d.tZ)("div",{className:"RichText-video",children:n?(0,d.tZ)(m.Z,(0,s._)({},t)):(0,d.tZ)(N,{videoId:t.id,iframeRef:{current:this.state.iframe},children:(0,d.tZ)(_.Z,(0,l._)((0,s._)({},t),{playerUrl:o,onIframeRef:this.handleIframeLoad,onPlay:this.handlePlay,onPlayFailed:this.handlePlayFailed,onBeforePlay:r}))})})}}]),n}(p.Component),x=(0,h.compose)((0,f.connect)(function(e,t){var n=t.data,r=n.isLens,o=n.id;return r?{data:(0,l._)((0,s._)({},t.data),{source:"lens",playerUrl:"https://".concat(w.Z.videoHost,"/video/").concat(o)})}:{data:e.video.data[o]||t.data}},{showNotification:T.c0,loadVideo:E.o2}),(0,C.a)(function(e){var t=e.data;return{module:"VideoItem",content:{type:"Video",sub_type:t.isLens?"SelfHosted":"Embedded",video_id:t.id,is_playable:!!t.isPlayable},trackCardShow:!0,view:{id:174}}}))(O)},7768:function(e,t,n){"use strict";n.d(t,{Z:function(){return rh}});var r,o,i=n(55164),a=n(57477),c=n(71728),s=n(94009),l=n(49899),u=n(85879),d=n(58487),p=n(41402),h=n(74246),f=n(87363),_=n.n(f),m=n(93206),v=n(31252),g=n(70400),T=n(80714),E=n(4551),C=n(24405),y=n(17103),S=n(40529),I=n(26257),b=n(64099),A=n(79264),Z=n(60927),w=n(97183),R=n(77711),N=n(25593),k=n(33846),O=n(84632),x=n(55283),P=n(87641),D=n(7835),L=function(e){var t=e.children,n=e.className,r=(0,f.useRef)();return(0,D.Z)(function(){}),(0,u.tZ)("div",{className:n,ref:r,children:t})},B=n(65733),U=n(20857),M=n(22107),G=n(94707),F=n(87320),z=n(86325),H=n(85626),q=n(82586),V=n(58216),X=n(67814),W=n.n(X),K=n(14168),j=n.n(K),Y=n(36695),Q=n(43384),J=n(99447),$=n(1733),ee=n(38889),et=n(74128),en=n(31467),er=n(30722),eo=n(44169),ei=n(7181),ea=n(66263),ec=n(45842),es=n(6438),el=n(1606),eu=n(94382),ed=n(30361),ep=n(46829),eh=n(24794),ef=function(e){(0,z._)(n,e);var t=(0,H._)(n);function n(){var e;return(0,M._)(this,n),e=t.apply(this,arguments),(0,F._)((0,U._)(e),"state",{showQuit:!1}),(0,F._)((0,U._)(e),"onClose",function(){e.setState({showQuit:!1})}),(0,F._)((0,U._)(e),"handleQuitButton",function(){e.setState({showQuit:!0})}),(0,F._)((0,U._)(e),"handleQuitColumn",function(t,n){e.props.fetchQuitColumn(t,n),e.setState({showQuit:!1})}),e}return(0,G._)(n,[{key:"renderStatus",value:function(){var e=this.props,t=e.column,n=t.itemsCount,r=t.voteupCount,o=e.isProfile,i=e.urlToken,a=(e.currentUser||{}).urlToken;return(0,u.BX)(ed.qb,{children:["".concat((0,er.uf)(n)," 篇内容"),"".concat((0,er.uf)(r)," 赞同"),o&&i===a&&this.renderProfileContent()]})}},{key:"renderMeta",value:function(){var e=this.props,t=e.preset,n=e.column.intro;return(0,u.tZ)("div",{className:"ColumnItem-meta",children:T.Z.isMobileEntry?(0,u.tZ)("span",{className:"ColumnItem-meta",children:this.renderStatus()}):(0,u.BX)(u.HY,{children:[n,t===ed.PG.default&&this.renderStatus()]})})}},{key:"renderProfileContent",value:function(){var e=this,t=this.props,n=t.column,r=n.id,o=n.author,i=t.contributions,a=this.state.showQuit,c=o.urlToken===i.urlToken;return(0,u.BX)(u.HY,{children:[(0,u.tZ)(ei.Z,{toggler:(0,u.tZ)(ee.ZP,{preset:"plain",icon:V.AZ}),placement:"top",className:"ColumnItem-more",arrowed:!0,children:c?(0,u.tZ)(ee.ZP,{component:"a",preset:"plain",href:"".concat(ea.i7,"/column/").concat(r),className:"ColumnItem-botton",children:"管理专栏"}):(0,u.tZ)(ee.ZP,{preset:"plain",className:"ColumnItem-botton",onClick:this.handleQuitButton,children:"退出专栏"})}),(0,u.tZ)(et.Z,{onClose:this.onClose,title:"确定退出该专栏吗？",children:a&&(0,u.tZ)("div",{className:"ColumnAuthorsList-modal",children:(0,u.BX)(en.w,{direction:"horizontal",children:[(0,u.tZ)(ee.ZP,{onClick:function(){return e.onClose},children:"取消"}),(0,u.tZ)(ee.ZP,{className:"ColumnPosts-confirmButton",onClick:function(){return e.handleQuitColumn(i.urlToken,r)},color:"blue",preset:"primary",children:"确定"})]})})})]})}},{key:"renderInteractiveContent",value:function(){var e=this,t=this.props,n=t.column,r=n.id,o=n.type,c=n.articlesCount,s=n.followers,l=n.lastArticle,d=n.isFollowing,p=n.author,h=n.title,f=t.zaInfos,_=f.follow,m=f.options,v=t.renderOptions,g={id:r,type:o},E=(l||{}).updated;return(0,u.BX)(u.HY,{children:[!T.Z.isMobileEntry&&(0,u.BX)(ed.n1,{className:"ContentItem-counts",children:[(0,u.BX)("div",{children:[(0,u.tZ)("span",{children:"文章："}),(0,er.uf)(c)]}),(0,u.BX)("div",{children:[(0,u.tZ)("span",{children:"最后更新于："}),(0,eo.rL)(E)||"暂未更新"]}),(0,u.BX)("div",{children:[(0,u.tZ)("span",{children:"关注者："}),s]})]}),(0,u.BX)(ed.eX,{children:[(0,u.tZ)(ep.Z,(0,a._)((0,i._)({},g),{isFollowing:d,zaId:_})),(0,u.tZ)(eh.Z,(0,a._)((0,i._)({},g),{title:h,authorName:p&&p.name,href:"".concat(ea.i7,"/column/").concat(r)})),v&&v(function(){return e.contentItem},m)]})]})}},{key:"render",value:function(){var e=this,t=this.props,n=t.preset,r=t.column,o=t.lastreadTouchable,i=(0,u.tZ)(eu.Z,{column:r,target:"_blank"});return(0,u.tZ)(ed.ZP,{className:"ColumnItem",data:r,link:"".concat(ea.i7,"/column/").concat(r.id),onRef:function(t){return e.contentItem=t},title:i,meta:this.renderMeta(),lastreadTouchable:o,children:n===ed.PG.interactive&&this.renderInteractiveContent()})}}]),n}(f.Component);(0,F._)(ef,"propTypes",{preset:j().oneOf(Object.values(ed.PG)),isProfile:j().bool,zaInfos:j().shape({follow:j().number,options:j().number}),renderOptions:j().func}),(0,F._)(ef,"defaultProps",{preset:ed.PG.default,isProfile:!1,zaInfos:{}});var e_=(0,m.compose)((0,el.Ib)(function(e){return{content:{type:"Column",token:String(e.column.id)}}}),(0,J.a)(function(e){var t=e.column,n=e.trackCardShow;return{module:"ColumnItem",card:{content:{type:"Column",token:t.id,item_num:t.articlesCount,follower_num:t.followers,publish_timestamp:1e3*t.updated,author_member_hash_id:(t.author||{}).id}},trackCardShow:void 0===n||n}}),ec.Z,(0,Y.connect)(null,{fetchQuitColumn:es.eB}))(ef),em=n(69383),ev=function(e,t){em.Z.trackEvent(e,(0,i._)({action:"Click",element_name:"MoreAction"},t&&{id:t}))},eg=n(88423),eT=n(66980),eE=Object.assign,eC=function(e){return _().createElement(eT.Z,eE({viewBox:"0 0 15 15"},e),_().createElement("g",{fill:"#ffab2e",fillRule:"evenodd"},_().createElement("path",{d:"M10.925 14.302c.173.13.408.13.58-.002a.514.514 0 0 0 .175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572a.5.5 0 0 0-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"}),_().createElement("path",{d:"M7.5 1.4a.47.47 0 0 0-.474.354l-1.318 4.29H1.49a.499.499 0 0 0-.467.36.523.523 0 0 0 .185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z"})))},ey=Object.assign,eS=function(e){return _().createElement(eT.Z,ey({width:"15",height:"15",viewBox:"0 0 15 15"},e),_().createElement("g",{fillRule:"evenodd"},_().createElement("path",{fill:"#d7d8d9",d:"M10.925 14.302c.173.13.408.13.58-.002a.514.514 0 0 0 .175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572a.5.5 0 0 0-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"}),_().createElement("path",{fill:"#ffab2e",d:"M7.5 1.4a.47.47 0 0 0-.474.354l-1.318 4.29H1.49a.499.499 0 0 0-.467.36.523.523 0 0 0 .185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z"})))},eI=Object.assign,eb=function(e){return _().createElement(eT.Z,eI({viewBox:"0 0 15 15"},e),_().createElement("g",{fill:"#d7d8d9",fillRule:"evenodd"},_().createElement("path",{d:"M10.925 14.302c.173.13.408.13.58-.002a.514.514 0 0 0 .175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572a.5.5 0 0 0-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"}),_().createElement("path",{d:"M7.5 1.4a.47.47 0 0 0-.474.354l-1.318 4.29H1.49a.499.499 0 0 0-.467.36.523.523 0 0 0 .185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z"})))},eA=function(e){var t=e.score;if(0===t)return null;var n=Math.round(2*t)/2;return(0,u.tZ)("div",{className:"Rating",children:Array.from({length:5}).map(function(e,t){var r=n>=t+1?eC:n>=t+.5?eS:eb;return(0,u.tZ)(r,{size:15},t)})})};function eZ(e){return e?"\xa5".concat(e/100):"免费"}var ew=n(19495),eR=n(99830),eN=n(91157),ek=n(85661),eO=function(e){(0,z._)(n,e);var t=(0,H._)(n);function n(){var e;return(0,M._)(this,n),e=t.apply(this,arguments),(0,F._)((0,U._)(e),"state",{commentsShown:!1,commentsAutoFocus:!0,commentPattern:"fixed"}),(0,F._)((0,U._)(e),"handleCommentsShown",function(t,n){e.setState(n)}),(0,F._)((0,U._)(e),"handleCommentsHide",function(){e.setState({commentsShown:!1})}),e}return(0,G._)(n,[{key:"render",value:function(){var e=this.props,t=e.preset,r=e.ebook,o=e.lastreadTouchable,c=r.id,s=r.type,l=r.url,d=r.title,p=r.cover,h=r.authors,f=r.price,_=r.promotionPrice,m=r.description,v=r.relationship,g=r.voteupCount,E=r.commentCount,C=r.score,y=this.state,S=y.commentsShown,I=y.commentsAutoFocus,b=y.commentPattern;if(t!==ed.PG.interactive)return(0,u.tZ)(ed.ZP,{title:(0,u.tZ)("a",{href:l,target:"_blank",rel:"noopener noreferrer",children:d}),data:r,link:l});var A={id:c,type:s},Z=h.slice(0,2);return(0,u.BX)(ed.ZP,{className:"EBookItem",data:r,link:l,title:!T.Z.isMobileEntry&&(0,u.tZ)("a",{className:"EBookItem-title",href:l,target:"_blank",rel:"noopener noreferrer",children:d}),image:(0,u.tZ)(n.Cover,{url:l,title:d,cover:p}),meta:T.Z.isMobileEntry?(0,u.BX)("div",{className:"EBookItem-meta",children:[(0,u.tZ)("a",{className:"EBookItem-title",href:l,target:"_blank",rel:"noopener noreferrer",children:d}),(0,u.BX)("span",{children:[Z.length&&(0,u.tZ)(ek.Z,{user:Z[0]}),Z.length>1&&"等","的电子书"]}),(0,u.tZ)(eA,{score:C})]}):(0,u.BX)("div",{children:[(0,u.tZ)("div",{className:"EBookItem-description",children:m}),(0,u.BX)(ed.n1,{children:[(0,u.BX)("div",{children:[(0,u.tZ)("span",{children:"作者："}),Z.map(function(e,t){return(0,u.BX)("span",{children:[(0,u.tZ)(ek.Z,{user:e}),t<Z.length-1&&"、"]},t)})]}),(0,u.BX)("div",{children:[(0,u.tZ)("span",{children:"知乎价："}),"number"==typeof _?(0,u.BX)("span",{className:"EBookItem-price",children:[eZ(_),(0,u.tZ)("del",{children:eZ(f)})]}):eZ(f)]})]})]}),lastreadTouchable:o,children:[(0,u.BX)(ed.eX,{className:"EBookItem-actions",children:[(0,u.tZ)(eN.Z,(0,a._)((0,i._)({},A),{liked:!!(void 0===v?{}:v).voting,count:g})),(0,u.tZ)(ew.Z,{onClick:this.handleCommentsShown,commentsShown:S,count:E}),(0,u.tZ)(eh.Z,(0,a._)((0,i._)({},A),{title:d,authorName:h[0]&&h[0].name,href:l}))]}),(0,u.tZ)(eR.Z,{parent:r,commentPattern:b,shown:S,autoFocus:I,onClose:this.handleCommentsHide})]})}}]),n}(f.Component);(0,F._)(eO,"propTypes",{preset:j().oneOf(Object.values(ed.PG))}),(0,F._)(eO,"defaultProps",{preset:ed.PG.default}),(0,F._)(eO,"Cover",function(e){var t=e.url,n=e.cover,r=e.title;return(0,u.tZ)("a",{href:t,target:"_blank",rel:"noopener noreferrer",children:(0,u.tZ)("img",{className:"EBookItem-image",style:{width:T.Z.isMobileEntry?"60px":"78px",height:T.Z.isMobileEntry?"80px":"104px"},src:(0,eg.imgUrl)(n,"100w"),srcSet:"".concat((0,eg.imgUrl)(n,"xld")," 2x"),alt:r})})});var ex=(0,J.a)(function(e){var t=e.trackCardShow;return{module:"EBookItem",trackCardShow:void 0===t||t}})(eO),eP=n(10087),eD=n(86057),eL=n.n(eD),eB=n(8231),eU=n(93547),eM=n(72111),eG=n(77683),eF=n(93445),ez=function(e){var t,n;return(null==e?void 0:null===(t=e.thumbnailExtraInfo)||void 0===t?void 0:t.videoId)||(null==e?void 0:null===(n=e.video)||void 0===n?void 0:n.videoId)},eH=n(7753),eq=n(80565),eV=function(e){var t=e.className,n=e.imgSrc,r=e.href,o=e.title,a=e.children,c=e.imgStyle,s=void 0===c?{}:c,l=e.zaBlockText;return(0,u.tZ)(eM.pl,{href:r,shouldTrackShow:!0,zaType:"Card",zaAction:"OpenUrl",view:{elementLocation:{block:{blockText:void 0===l?"":l}}},extra:{link:{url:r}},target:"_blank",children:(0,u.BX)(P.Flex,{height:"72px",className:t,bg:"GBK10A",p:"0 20px 0 16px",alignItems:"center",justifyContent:"space-between",children:[(0,u.BX)(P.Flex,{children:[n&&(0,u.tZ)(P.Image,{mr:"16px",src:n,css:(0,i._)({width:"64px",height:"40px",borderRadius:"4px",objectFit:"cover"},s)}),(0,u.BX)(P.Box,{children:[(0,u.tZ)(P.Text,{fontWeight:500,fontSize:"15px",lineHeight:"18px",mb:"4px",color:"GBK02A",maxWidth:"400px",css:(0,eq.S)(1),children:o}),(0,u.tZ)(P.Text,{fontSize:"13px",lineHeight:"18px",color:"GBK06A",children:a})]})]}),(0,u.tZ)(eH.ZP,{fill:"#999999"})]})})},eX=function(e){var t=e.eduSection,n=t.routeUrl,r=t.playCount,o=t.courseNum,i=t.courseTitle,a=t.courseImageInfo,c=(void 0===a?{}:a).url;return(0,u.BX)(eV,{imgSrc:void 0===c?"":c,href:n,title:"来自视频课：".concat(i),zaBlockText:"视频课卡片",children:[o?"共 ".concat(o," 集"):""," ",o&&r?"\xb7":""," ",r?"".concat((0,er.Zh)(r),"次学习"):""]})},eW=function(e){var t=e.eduSection,n=void 0===t?{}:t,r=e.author,o=e.expanded,i=n.title,a=n.routeUrl,c=n.id,s=n.attachedInfoBytes,l=ez(n);return(0,u.BX)(ed.ZP,{className:"EduSectionItem",data:n,title:(0,u.tZ)(u.HY,{children:(0,u.tZ)(eM._o,{zaAction:"OpenUrl",zaEventType:"Click",zaText:"标题跳转",zaType:"Text",children:(0,u.tZ)("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:i})})}),link:a,lastreadTouchable:!0,"data-zop":JSON.stringify({authorName:null==r?void 0:r.name,itemId:c,title:i,type:"edu_section"}),children:[(0,u.BX)(P.Box,{my:"16px",children:[(0,u.tZ)("div",{className:"EduSectionItem-video",css:{margin:"0px"},children:(0,u.tZ)(eF.Z,{videoId:l,contentId:c,contentType:"edu_section",zaProps:{type:"EduSection",token:n.id,attachedInfo:s}})}),o&&(0,u.tZ)(eX,{eduSection:n})]}),o&&(0,u.tZ)(eG.Z,{preset:"plain",author:r,userLinkV2:!0},"authorInfo")]})},eK=n(88329),ej=n.n(eK),eY=n(21060),eQ=n(98211),eJ=n(85576),e$=(0,eJ.Z)(function(e){var t=e.hide,n=e.stickyBottom,r=e.stickyContainer,o=e.contentType,i=e.contentId,a=e.zaContentType,c=e.children,s=e.onPositionStatusChange,l=e.authRequired,d=e.useProvider;if(t)return null;var p=void 0===d||d?(0,u.tZ)(eQ.Rj,{loginCheck:l([function(){return!0},function(){return!1}]),contentType:o,contentId:i,zaContentType:a,children:c}):c;return n?(0,u.tZ)(eY.Z,{bottom:!0,container:r,onPositionStatusChange:s,children:p}):p}),e0=n(65939),e1=function(e){var t=e.defaultVoteUpCount,n=e.defaultStatus,r=e.onChange,o=e.disabled,i=(0,eQ.Rv)(t||0,n,r),a=i.voteUpCount,c=i.isVotedUp,s=i.isVotedDown,l=i.voteUp,d=i.voteDown,p=i.cancel,h=(0,B.Z)(function(e){switch(e){case"up":return l();case"down":return d();default:return p()}});return(0,u.tZ)(e0.Z,{count:a,voting:c?1:s?-1:0,onVote:h,isOwner:o})},e2=n(71783),e3=(0,eJ.Z)(function(e){var t=e.isLiked,n=e.onClick,r=e.showIcon,o=e.authRequired,a=(e.currentUser,e.isLogin,(0,c._)(e,["isLiked","onClick","showIcon","authRequired","currentUser","isLogin"])),s=(0,B.Z)(function(){return o(function(){return n(!t)})()});return(0,u.tZ)(ee.ZP,(0,i._)({preset:"plain",onClick:s,icon:void 0===r||r?e2.ZP:null,label:t?"取消喜欢":"喜欢","aria-live":"polite"},a))}),e4=function(e){var t=e.currentIsLiked,n=e.onClick,r=(0,c._)(e,["currentIsLiked","onClick"]),o=(0,eQ.Tq)({currentIsLiked:t}),s=o.isLiked,l=o.like,d=o.unLike;return(0,u.tZ)(e3,(0,a._)((0,i._)({},r),{isLiked:s,onClick:function(e){e?l():d(),null==n||n(e)}}))},e5=n(30037),e6=n(23579),e7=n(82926),e8=n(99158);(r=o||(o={})).Vote="vote",r.Comment="comment",r.Like="like",r.Favlist="favlist",r.Collect="collect",r.Thank="thank",r.Share="share",r.Unknown="unknown";var e9=o,te=function(e){return{componentList:e.componentList.map(function(e,t){var n=e.name,r=e.component;return(0,f.isValidElement)(r)?{name:n,component:(0,f.cloneElement)(r,{key:r.key||n===e9.Unknown?n+t:n})}:{name:n,component:r}})}},tt=function(e){var t=e.className,n=e.renderChildren,r=e.compatibleRenderActionButtons,o=e.middlewares,i=(0,e5.qC)().blockStrategies,a=(0,e8.Z)([(0,e8.m)(i),te].concat((0,l._)(void 0===o?[]:o)),r||e7.Z);return(0,u.tZ)(ed.eX,{className:t,css:function(e){return{display:"flex",alignItems:"center",padding:"10px 16px",margin:"0 -16px -10px",color:e.colors.GBK04A,background:e.colors.GBK99A,clear:"both","&.is-fixed":{margin:0,boxShadow:"0 -1px 3px ".concat((0,e6.a)(e.colors.GBK02A).alpha(.1))},"& > *":{flexShrink:0},"& > .AnnotationTag":{whiteSpace:"nowrap"}}},children:a({componentList:(null==n?void 0:n(e9))||[]})})},tn=n(102),tr=n(63362),to=n(7407),ti=n(58909),ta={"-1":eQ.Ad.VOTED_DOWN,0:eQ.Ad.NEUTRAL,1:eQ.Ad.VOTED_UP,2:eQ.Ad.VOTED_DOWN},tc=n(20765),ts=function(e){var t=e.commentsShown,n=void 0!==t&&t,r=e.onCommentButtonClick,o=void 0===r?ej():r,i=e.eduSection,a=e.author,c=e.renderOptions,l=i.commentCount,d=i.isLiked,p=i.id,h=i.voting,_=i.voteCount,m=i.title,v=i.type,g=i.routeUrl,T=(0,ti.xw)(a),E=(0,to.dD)(),C=(0,s._)((0,f.useState)(!1),2),y=C[0],S=C[1],I=(0,f.useCallback)(function(){S(!0)},[]),b=(0,f.useCallback)(function(){S(!1)},[]),A=(0,Y.useDispatch)(),Z=(0,B.Z)(function(e){A((0,tc.jY)(p,e))}),w=(0,B.Z)(function(e,t){A((0,tc.Qm)(p,e,t))});return(0,u.BX)(u.HY,{children:[(0,u.tZ)(tt,{renderChildren:function(e){return[{name:e.Vote,component:(0,u.tZ)(e1,{defaultStatus:ta[h]||eQ.Ad.NEUTRAL,defaultVoteUpCount:_,onChange:w})},{name:e.Comment,component:(0,u.tZ)(ew.Z,{onClick:o,commentsShown:n,count:l,positionStatus:"normal"})},{name:e.Share,component:(0,u.tZ)(eh.Z,{id:p,type:v,url:g,title:m,authorName:a.name,css:{marginLeft:"24px"}})},{name:e.Favlist,component:(0,u.tZ)(tr.Z,{onClick:I,label:"收藏",showIcon:!E},"favlist")},{name:e.Like,component:(0,u.tZ)(e4,{currentIsLiked:!!d,css:{marginLeft:"24px"},onClick:Z})},{name:e.Unknown,component:T?null:c()}]}}),(0,u.tZ)(tn.E,{id:p,type:"edu_section",shown:y,onClose:b,zaEnabled:!0})]})};ts.defaultProps={renderOptions:function(){return null}};var tl=function(e){var t=e.eduSection,n=e.renderContent,r=e.renderActions,o=t.id;return(0,u.BX)(e5.xM,{data:t,children:[null==n?void 0:n(),(0,u.tZ)(e$,{contentId:o,contentType:"edu_section",children:null==r?void 0:r(tt)})]})};function tu(e){var t=e.eduSection,n=e.eduSection,r=n.id,o=n.description,c=void 0===o?"":o,l=n.author,d=e.onToggleExpand,p=e.renderOptions,h=e.truncateDisabled,_=e.limit,m=(0,Y.useSelector)(function(e){return eL()(l)?e.entities.users[l]:l}),v=(0,s._)((0,f.useState)(!1),2),g=v[0],T=v[1],E=(0,s._)((0,f.useState)({commentsShown:!1,commentsAutoFocus:!0,commentPattern:"fixed"}),2),C=E[0],y=E[1],S=function(e){T(e),d&&d(e)};return(0,u.BX)("div",{children:[(0,u.tZ)(tl,{eduSection:t,renderContent:function(){return(0,u.tZ)(eP.eb,{data:(null==t?void 0:t.thumbnailExtraInfo)||(null==t?void 0:t.video),children:(0,u.tZ)(eW,{eduSection:t,author:m,expanded:g})})},renderActions:function(){return(0,u.tZ)(eB.Z,(0,a._)((0,i._)({excerpt:(0,eU.NJ)(c,200),html:c,cover:null,hasVideo:!1},_?{limit:_}:{}),{truncateDisabled:h,allowCollapseWithEmptyExcerpt:!0,expanded:g,onToggleExpend:S,data:(0,a._)((0,i._)({},t),{id:r}),children:(0,u.tZ)(ts,{className:"EduSectionItem-toolbar",eduSection:t,author:m,commentsShown:C.commentsShown,onCommentButtonClick:function(e,t){return y(t)},renderOptions:p})}))}}),(0,u.tZ)(eR.Z,{className:"EduSectionItem-comment",containerClassName:"EduSectionItem-commentContainer",parent:t,shown:C.commentsShown,commentPattern:C.commentPattern,autoFocus:C.autoFocus,onClose:function(){return y((0,a._)((0,i._)({},C),{commentsShown:!1}))},commentInputPosition:"bottom",showPackupButton:!0})]})}tu.defaultProps={renderOptions:function(){return[null]},truncateDisabled:!0};var td=(0,m.compose)((0,el.Ib)(function(e){var t=e.eduSection;return{content:{type:"EduSection",id:String(t.id)},extra:{mediaInfo:{videoInfo:{videoId:ez(t)}}}}}))(tu),tp=n(37335),th=function(e){(0,z._)(n,e);var t=(0,H._)(n);function n(){var e;return(0,M._)(this,n),e=t.apply(this,arguments),(0,F._)((0,U._)(e),"state",{commentPattern:"fixed",commentsShown:!1,commentsAutoFocus:!0}),(0,F._)((0,U._)(e),"handleCommentsShown",function(t,n){e.setState(n)}),(0,F._)((0,U._)(e),"handleCommentsHide",function(){e.setState({commentsShown:!1})}),e}return(0,G._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.preset,r=t.favlist,o=t.favlist,c=o.id,s=o.type,l=o.title,d=o.updatedTime,p=o.answerCount,h=o.followerCount,f=o.isFollowing,_=o.isPublic,m=o.creator,v=void 0===m?{}:m,g=o.commentCount,E=t.status,C=t.action,y=t.lastreadTouchable,S=t.zaInfos,I=S.follow,b=S.options,A=t.renderOptions,Z=this.state,w=Z.commentsShown,R=Z.commentsAutoFocus,N=Z.commentPattern,k="/collection/".concat(c),O=(0,u.tZ)("a",{href:k,target:"_blank",rel:"noopener noreferrer",children:l});if(n===ed.PG.plain)return(0,u.tZ)(ed.ZP,{data:r,link:k,title:O});var x={id:c,type:s};return n===ed.PG.default?(0,u.tZ)(ed.ZP,{data:r,link:k,title:(0,u.BX)(P.Flex,{alignItems:"center",children:[O,!_&&(0,u.tZ)(P.Text,{color:"GBL05A",ml:".3em",children:(0,u.tZ)(tp.P,{center:!0,size:18})})]}),meta:E||(0,u.BX)(ed.qb,{children:["".concat((0,eo.tC)(d)," 更新"),"".concat((0,er.uf)(p)," 条内容"),"".concat((0,er.uf)(h)," 人关注")]}),extra:C}):(0,u.BX)(ed.ZP,{data:r,link:k,onRef:function(t){e.contentItem=t},title:O,lastreadTouchable:y,children:[T.Z.isMobileEntry?(0,u.BX)("div",{className:"FavlistItem-cells",children:[(0,u.tZ)("span",{children:!!h&&"".concat((0,er.uf)(h)," 关注")}),(0,u.BX)("span",{children:[(0,eo.tC)(d),"更新"]})]}):(0,u.BX)(ed.n1,{children:[(0,u.BX)("div",{children:[(0,u.tZ)("span",{children:"关注数："}),(0,er.uf)(h)]}),(0,u.BX)("div",{children:[(0,u.tZ)("span",{children:"最后更新于："}),(0,eo.tC)(d)]}),(0,u.BX)("div",{children:[(0,u.tZ)("span",{children:"作者："}),(0,u.tZ)(ek.Z,{user:v})]})]},"favlist-item-cells"),(0,u.BX)(ed.eX,{children:[(0,u.tZ)(ep.Z,(0,a._)((0,i._)({},x),{isFollowing:f,zaId:I})),(0,u.tZ)(ew.Z,{onClick:this.handleCommentsShown,commentsShown:w,count:g}),(0,u.tZ)(eh.Z,(0,a._)((0,i._)({},x),{title:l,authorName:v&&v.name})),A&&A(function(){return e.contentItem},b)]},"favlist-item-actions"),(0,u.tZ)(eR.Z,{parent:r,commentPattern:N,shown:w,autoFocus:R,onClose:this.handleCommentsHide})]})}}]),n}(f.Component);(0,F._)(th,"propTypes",{preset:j().oneOf(Object.values(ed.PG)),zaInfos:j().shape({follow:j().number,options:j().number}),renderOptions:j().func}),(0,F._)(th,"defaultProps",{preset:ed.PG.default,zaInfos:{}});var tf=(0,J.a)(function(e){var t=e.favlist,n=e.trackCardShow;return{module:"CollectionItem",card:{content:{type:"Collection",token:String(t.id),item_num:t.answerCount,follower_num:t.followerCount,publish_timestamp:1e3*t.updateTime,author_member_hash_id:(t.creator||{}).id}},trackCardShow:void 0===n||n}})(th),t_=function(e){(0,z._)(n,e);var t=(0,H._)(n);function n(){return(0,M._)(this,n),t.apply(this,arguments)}return(0,G._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.preset,r=t.liveCourse,o=t.liveCourse,c=o.id,s=o.type,l=o.subject,d=o.courseMemberCount,p=o.liveCount,h=o.price,f=o.promotionPrice,_=o.headImageMobile,m=o.likedNum,v=o.isLiked,g=o.description,E=o.speakers,C=void 0===E?[]:E,y=t.lastreadTouchable,S=t.renderOptions,I=t.zaIds.options,b="/lives/courses/".concat(c);if(n!==ed.PG.interactive)return(0,u.tZ)(ed.ZP,{data:r,link:b,title:(0,u.tZ)("a",{href:b,target:"_blank",rel:"noopener noreferrer",children:l})});var A=!!C.length&&"".concat(C[0].member.name).concat(C.length>1?"等":"","的私家课 \xb7 ").concat(p," 节课"),Z={id:c,type:s};return(0,u.BX)("div",{className:"LiveCourseItem",children:[_&&(0,u.tZ)("a",{className:"LiveCourseItem-cover",href:b,target:"_blank",rel:"noopener noreferrer",children:(0,u.tZ)("img",{src:(0,eg.imgUrl)(_,"640w"),srcSet:"".concat((0,eg.imgUrl)(_,"r")," 2x"),alt:l})}),(0,u.tZ)(ed.ZP,{data:r,link:b,title:(0,u.tZ)("a",{href:b,target:"_blank",rel:"noopener noreferrer",children:l}),lastreadTouchable:y,children:(0,u.BX)(eB.Z,{excerpt:"",limit:60,limitWithImage:60,html:T.Z.isMobileEntry?A:g||"",data:r,extra:!T.Z.isMobileEntry&&(0,u.BX)(ed.n1,{children:[(0,u.BX)("div",{children:[(0,u.tZ)("span",{children:"参与人数："}),(0,er.uf)(d)]}),(0,u.BX)("div",{children:[(0,u.tZ)("span",{children:"课程节数："}),(0,er.uf)(p)]}),(0,u.BX)("div",{children:[(0,u.tZ)("span",{children:"特价："}),"number"==typeof f?(0,u.BX)("span",{className:"LiveItem-price",children:[eZ(f),(0,u.tZ)("del",{children:eZ(h)})]}):eZ(h)]})]}),children:[(0,u.tZ)(eN.Z,(0,a._)((0,i._)({},Z),{liked:v,count:m,icon:"thank"})),(0,u.tZ)(eh.Z,(0,a._)((0,i._)({},Z),{url:b,title:l})),S&&S(function(){return e.contentItem},I)]})})]})}}]),n}(f.Component);(0,F._)(t_,"propTypes",{preset:j().oneOf(Object.values(ed.PG)),renderOptions:j().func,zaIds:j().object}),(0,F._)(t_,"defaultProps",{zaIds:{}});var tm=(0,J.a)(function(e){var t=e.liveCourse,n=e.trackCardShow;return{module:"LiveCourseItem",card:{content:{type:"LiveCourse",id:t.id}},trackCardShow:void 0===n||n}})(t_),tv=n(84220),tg=n(60811),tT=n(55698),tE=function(e){var t=e.className,n=e.children;return(0,u.tZ)("div",{className:W()(t,"LiveAvatar-column"),children:n})},tC=function(e){var t=e.className,n=e.speakers,r=e.size,o=e.alt;if(!n||!n.length)return null;var s=n.map(function(e){return e.avatarUrl}).slice(0,4),l=function(e){var t=e.className,n=e.src,r=(0,c._)(e,["className","src"]);return(0,u.tZ)(tT.qE,(0,a._)((0,i._)({url:n},r),{className:W()("LiveAvatar-img",t)}))},d=function(e){var t=e.className,n=(0,c._)(e,["className"]);return(0,u.tZ)(tE,{children:(0,u.tZ)(l,(0,a._)((0,i._)({},n),{className:W()(t,"alignCenter"),size:r}))})},h=function(e){return(0,u.tZ)(l,(0,a._)((0,i._)({},e),{size:r/2-1}))},f=function(e){var t=e.imageUrls,n=(0,c._)(e,["imageUrls"]);return(0,u.tZ)(tE,{children:t.map(function(e,t){return(0,p.az)(h,(0,a._)((0,i._)({},n),{key:t,src:e}))})})},_=[];switch(s.length){case 1:_=(0,u.tZ)(function(e){return(0,u.tZ)(l,(0,a._)((0,i._)({},e),{size:r}))},{src:s[0],alt:o});break;case 2:_=s.map(function(e,t){return(0,u.tZ)(d,{src:e,alt:o},t)});break;case 3:_=[(0,u.tZ)(d,{src:s[0],alt:o},"1"),(0,u.tZ)(f,{imageUrls:s.slice(1,3),alt:o},"2")];break;default:_=[s.slice(0,2),s.slice(2)].map(function(e,t){return(0,u.tZ)(f,{imageUrls:e,alt:o},t)})}return(0,u.tZ)("div",{className:W()(t,"LiveAvatar-wrapper"),style:{width:r,height:r},children:_})},ty=n(2174),tS=n(12421),tI=function(e){(0,z._)(n,e);var t=(0,H._)(n);function n(){return(0,M._)(this,n),t.apply(this,arguments)}return(0,G._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.preset,r=t.live,o=t.live,c=o.id,s=o.type,l=o.subject,d=o.speaker.member,p=o.startsAt,h=o.price,f=o.promotionPrice,_=o.description,m=void 0===_?"":_,v=o.image,g=o.isLiked,E=o.likedNum,C=o.seats,y=t.lastreadTouchable,S=t.zaIds.options,I=t.renderOptions,b=t.isSticky,A=t.handleToggleSticky,Z=t.currentUser,w=Z&&Z.urlToken===d.urlToken,R="function"==typeof A,N=(C||{}).taken,k="/lives/".concat(c);if(n!==ed.PG.interactive)return(0,u.tZ)(ed.ZP,{data:r,link:k,title:(0,u.BX)(u.HY,{children:[R&&b&&(0,u.tZ)(ty.Z,{}),(0,u.tZ)("a",{href:k,target:"_blank",rel:"noopener noreferrer",children:l})]}),children:!T.Z.isMobileEntry&&R&&w&&(0,tS.U)(Z)&&(0,u.tZ)(ee.ZP,{preset:"plain",onClick:A,icon:b?tv.TX:tg.rh,label:b?"取消置顶":"置顶"})});var O=(0,u.tZ)(tC,{className:"LiveItem-avatar",speakers:[d],size:60}),x={id:c,type:s};return(0,u.BX)("div",{className:"LiveItem",children:[!T.Z.isMobileEntry&&v&&(0,u.tZ)("a",{className:"LiveItem-cover",href:k,target:"_blank",rel:"noopener noreferrer",children:(0,u.tZ)("img",{src:(0,eg.imgUrl)(v,"640w"),srcSet:"".concat((0,eg.imgUrl)(v,"r")," 2x"),alt:l})}),(0,u.tZ)(ed.ZP,{image:T.Z.isMobileEntry&&O,data:r,link:k,onRef:function(t){e.contentItem=t},title:(0,u.BX)("span",{children:[d.name,"：",(0,u.tZ)("a",{href:k,target:"_blank",rel:"noopener noreferrer",children:l})]}),meta:T.Z.isMobileEntry&&(0,u.BX)("span",{children:[(0,er.uf)(N)," 参与"]}),lastreadTouchable:y,children:T.Z.isMobileEntry?(0,u.tZ)(eN.Z,(0,a._)((0,i._)({},x),{liked:g,count:E,icon:"thank"})):(0,u.BX)(eB.Z,{className:"LiveItem-description",excerpt:(0,eU.$G)(m,60),limit:60,limitWithImage:60,html:m,data:r,extra:(0,u.BX)(ed.n1,{children:[!!N&&(0,u.BX)("div",{children:[(0,u.tZ)("span",{children:"参与人数："}),N]}),(0,u.BX)("div",{children:[(0,u.tZ)("span",{children:"时间："}),(0,eo.P5)(p)]}),(0,u.BX)("div",{children:[(0,u.tZ)("span",{children:"特价："}),"number"==typeof f?(0,u.BX)("span",{className:"LiveItem-price",children:[eZ(f),(0,u.tZ)("del",{children:eZ(h)})]}):eZ(h)]})]}),children:[(0,u.tZ)(eN.Z,(0,a._)((0,i._)({},x),{liked:g,count:E,icon:"thank"})),(0,u.tZ)(eh.Z,(0,a._)((0,i._)({},x),{title:l,authorName:d&&d.name,url:k})),I&&I(function(){return e.contentItem},S)]})})]})}}]),n}(f.Component);(0,F._)(tI,"propTypes",{preset:j().oneOf(Object.values(ed.PG)),renderOptions:j().func,zaIds:j().object}),(0,F._)(tI,"defaultProps",{zaIds:{}});var tb=(0,m.compose)(ec.Z,(0,J.a)(function(e){var t=e.live,n=e.trackCardShow,r=e.zaInfos,o=(void 0===r?{}:r).cardShow;return(0,a._)((0,i._)({module:"LiveItem",card:{content:{type:"Live",id:t.id,author_member_hash_id:t.speaker.member.id}}},o&&{view:{id:o}}),{trackCardShow:void 0===n||n})}))(tI),tA=n(87225),tZ=n(93155),tw=n(75606),tR=n(17435),tN=n(4059),tk=n(31142),tO={placeholders:{img:" [图片] "}},tx=function(e){(0,z._)(n,e);var t=(0,H._)(n);function n(){var e;return(0,M._)(this,n),e=t.apply(this,arguments),(0,F._)((0,U._)(e),"state",{collapsed:!0,commentPattern:"fixed",commentsShown:!1,commentsAutoFocus:!0}),(0,F._)((0,U._)(e),"handleOpenComment",function(t){var n=t.target.parentNode.className.includes("is-fixed")?"fixed":"bottom",r=e.state.modalShown;e.setState({modalShown:!("bottom"===n&&r),commentPattern:n})}),(0,F._)((0,U._)(e),"handleCommentsShown",function(t,n){e.setState(n)}),(0,F._)((0,U._)(e),"handleCommentsHide",function(){e.setState({commentsShown:!1})}),(0,F._)((0,U._)(e),"handlePackupButton",function(){e.setState({modalShown:!1}),e.CommentsButtonEl.scrollIntoView({block:"start",behavior:"smooth"}),window.scrollTo(0,window.pageYOffset-window.screen.height/2)}),(0,F._)((0,U._)(e),"handleContentToggleExpand",function(t){e.setState({collapsed:!t})}),e}return(0,G._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.preset,r=t.question,o=t.question,c=o.id,s=o.title,l=o.type,d=o.created,p=o.answerCount,h=o.followerCount,f=o.isMuted,_=o.questionType,m=o.detail,v=o.commentCount,g=o.adminClosedComment,E=o.relationship,C=void 0===E?{}:E,y=o.annotationDetail,S=t.action,I=t.isConcise,b=t.isAnonymousFollowing,A=t.lastreadTouchable,Z=t.zaInfos,w=Z.title,R=Z.expand,N=Z.follow,k=Z.options,O=t.renderOptions,x=t.blockStrategies,P=void 0===x?{}:x,D=P.isBlockingFollowQuestion,L=P.isBlockingComment,B=P.isBlockingShare,U=this.state,M=U.commentsShown,G=U.commentsAutoFocus,F=U.commentPattern,z=U.collapsed,H={id:c,type:l},q="/question/".concat(c);return(0,u.BX)(ed.ZP,{data:r,link:q,lastreadTouchable:A,onRef:function(t){e.contentItem=t},title:(0,u.BX)("div",{className:"QuestionItem-title",children:[(0,u.tZ)(eM._o,{zaAction:"OpenUrl",zaEventType:"Click",zaText:"标题跳转",zaType:"Text",children:(0,u.tZ)("a",(0,a._)((0,i._)({href:q,target:"_blank",rel:"noopener noreferrer","data-za-detail-view-name":"Title"},w&&{"data-za-detail-view-id":w}),{children:s}))}),b&&(0,u.tZ)(tZ._,{className:"QuestionItem-icon"}),"commercial"===_&&f&&(0,u.tZ)("span",{className:"QuestionItem-muteStatus",children:"待推广"})]}),children:[!z&&y&&(0,u.tZ)(tR.Z,{annotationDetail:y}),n===ed.PG.default&&(0,u.BX)(ed.qb,{children:[(0,eo.KZ)(d),"".concat((0,er.uf)(p)," 个回答"),"".concat((0,er.uf)(h)," 个关注")]}),n===ed.PG.interactive&&(0,u.BX)(eB.Z,{data:r,html:m||"",excerpt:r.excerpt,limit:60,limitWithImage:60,truncateHTMLOptions:tO,onToggleExpend:this.handleContentToggleExpand,zaIds:{expand:R},children:[!D&&(S||(0,u.tZ)(ep.Z,(0,a._)((0,i._)({},H),{isFollowing:(C&&({}).hasOwnProperty.call(C,"isFollowing")?C:r).isFollowing,zaId:N}))),T.Z.isMobileEntry&&I?(0,u.BX)("div",{className:"QuestionItem-concise",children:[!!p&&(0,u.BX)("span",{children:[(0,er.uf)(p)," 个回答"]}),!!(p&&h)&&(0,u.tZ)("span",{className:"QuestionItem-mobileDot"}),!!h&&(0,u.BX)("span",{children:[(0,er.uf)(h)," 关注"]})]}):[!L&&(0,u.tZ)(ew.Z,{onClick:this.handleCommentsShown,commentsShown:M,commentClosed:g,count:v},"comment"),!B&&(0,u.tZ)(eh.Z,(0,a._)((0,i._)({},H),{title:s,href:q}),"share"),!!p&&(0,u.BX)(tk.Z,{preset:"plain",to:q,target:"_blank",children:[(0,u.tZ)(tw.C,{style:{marginRight:"4px"},center:!0,text:!0}),(0,er.uf)(p)," 个回答"]},"linkbutton"),O&&O(function(){return e.contentItem},k),z&&y&&(0,u.tZ)(tN.Z,{annotationDetail:y})]]}),(0,u.tZ)(eR.Z,{parent:r,commentPattern:F,shown:M,autoFocus:G,onClose:this.handleCommentsHide})]})}}]),n}(f.Component);(0,F._)(tx,"propTypes",{preset:j().oneOf(Object.keys(ed.PG)).isRequired,isAnonymousFollowing:j().bool,contentShown:j().bool,zaInfos:j().shape({title:j().number,expand:j().number,follow:j().number,options:j().number}),renderOptions:j().func}),(0,F._)(tx,"defaultProps",{preset:ed.PG.default,zaInfos:{}});var tP=(0,m.compose)((0,el.Ib)(function(e){return{content:{type:"Question",token:String(e.question.id)}}}),(0,J.a)(function(e){var t=e.question,n=e.trackCardShow;return{module:"QuestionItem",card:{content:{type:"Question",token:String(t.id),item_num:t.answerCount,comment_num:t.commentCount,follower_num:t.followerCount,publish_timestamp:1e3*t.created}},trackCardShow:void 0===n||n}}),(0,e5.$_)({dataPath:"question"}),e5.OW)(tx),tD=n(33773),tL=n(77236),tB=n(81809),tU=n(19076),tM=n(91770),tG=n(87964),tF=function(e){var t=e.userKey,n=e.isLast,r=(0,c._)(e,["userKey","isLast"]),o=(0,Y.useSelector)(function(e){return e.entities.users[t]});if(!o)return null;var s=o.urlToken,l=o.name,d=o.isOrg;return(0,u.BX)(tU.Link,(0,a._)((0,i._)({to:"/".concat(d?"org":"people","/").concat(s)},r),{children:[l,!n&&"、"]}))},tz=function(e){(0,z._)(n,e);var t=(0,H._)(n);function n(){var e;return(0,M._)(this,n),e=t.apply(this,arguments),(0,F._)((0,U._)(e),"load",function(){var t=e.props,n=t.dispatch,r=t.id;n((0,tG.AO)(r))}),(0,F._)((0,U._)(e),"track",function(){var t=e.props.roundtable;e.hoverCardElement&&t&&(em.Z.setModule(e.hoverCardElement,{module:"RoundtableItem"},{card:{content:{type:"Roundtable",token:t.id,item_num:t.questionsCount,follower_num:t.followers,publish_timestamp:1e3*t.stopTime}}}),em.Z.trackCardShow(e.hoverCardElement))}),(0,F._)((0,U._)(e),"handleOpen",function(){e.load(),e.track()}),e}return(0,G._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.toggler,r=t.roundtable,o=t.id,s=t.isLoading,l=t.onRef,d=(0,c._)(t,["toggler","roundtable","id","isLoading","onRef"]),p=r||{},h=p.name,f=p.type,_=p.description,m=p.guests,v=void 0===m?[]:m,g=p.activitiesCount,T=p.questionsCount,E=p.followers,C=p.logo,y=p.stopTime,S=p.isFollowing,I=v.length,b="/roundtable/".concat(o);return(0,u.BX)(tL.Z,(0,a._)((0,i._)({toggler:n,preventCloseOnTarget:!0,isLoading:s,onOpen:this.handleOpen,size:"large"},d),{ref:function(t){l&&"function"==typeof l&&l(t),e.hoverCardElement=t},children:[(0,u.tZ)(tL.O,{title:(0,u.tZ)("a",{target:"_blank",href:"/roundtable/".concat(o),rel:"noopener noreferrer",children:h}),avatarUrl:C,attrInfo:(0,u.BX)("div",{children:[(0,u.tZ)(tD.x8,{text:!0,center:!0})," ",(0,eo.rL)(y)]})}),_&&(0,u.tZ)("div",{children:(0,u.tZ)("div",{className:"HoverCard-description",children:_})}),(0,u.BX)("div",{children:[(0,u.tZ)(tB.H,{text:!0,center:!0})," 组织机构",(0,u.tZ)("span",{className:"HoverCard-separate",children:" | "}),(0,u.tZ)("a",{href:"/topic/19793502",children:"圆桌"})]}),I>0&&(0,u.BX)("div",{children:["嘉宾",(0,u.tZ)("span",{className:"HoverCard-separate",children:" | "}),v.map(function(e,t){var n=e.member;return(0,u.tZ)(tF,{userKey:n,isLast:t===I-1},t)})]}),(0,u.BX)("div",{children:[(0,u.BX)(tM.Z,{children:[(0,u.tZ)(tM.Z.Item,{tag:tk.Z,preset:"plain",a:!0,to:b,name:"动态",value:g}),(0,u.tZ)(tM.Z.Item,{tag:tk.Z,preset:"plain",a:!0,to:"".concat(b,"/question"),name:"问题",value:T}),(0,u.tZ)(tM.Z.Item,{tag:tk.Z,preset:"plain",a:!0,to:"".concat(b,"/followers"),name:"关注者",value:E})]}),(0,u.tZ)("div",{className:"HoverCard-buttons",children:(0,u.tZ)(ep.Z,{id:o,type:f,isFollowing:S,preset:"primary"})})]})]}))}}]),n}(f.Component),tH=(0,Y.connect)(function(e,t){var n=t.id,r=e.entities.roundtables,o=e.loading.local;return{roundtable:r[n],isLoading:!!o["roundtable/".concat(n)]}})(tz),tq=function(e){(0,z._)(n,e);var t=(0,H._)(n);function n(){return(0,M._)(this,n),t.apply(this,arguments)}return(0,G._)(n,[{key:"render",value:function(){var e=this.props,t=e.roundtable,n=t.name,r=t.id,o=e.noHoverCard,s=e.style,l=e.className,d=e.children,p=(0,c._)(e,["roundtable","noHoverCard","style","className","children"]),h=d||n;return o||(h=(0,u.tZ)(tH,{toggler:h,id:r})),(0,u.tZ)("a",(0,a._)((0,i._)({style:s,className:W()("RoundTableLink",l),href:"/roundtable/".concat(r)},p),{children:h}))}}]),n}(f.Component);tq.propTypes={roundtable:j().object.isRequired,noHoverCard:j().bool,style:j().object,className:j().string,children:j().node},tq.defaultProps={noHoverCard:!1};var tV=function(e){(0,z._)(n,e);var t=(0,H._)(n);function n(){var e;return(0,M._)(this,n),e=t.apply(this,arguments),(0,F._)((0,U._)(e),"state",{commentsShown:!1,commentsAutoFocus:!0,commentPattern:"fixed"}),(0,F._)((0,U._)(e),"handleCommentsShown",function(t,n){e.setState(n)}),(0,F._)((0,U._)(e),"handleCommentsHide",function(){e.setState({commentsShown:!1})}),e}return(0,G._)(n,[{key:"render",value:function(){var e,t=this,n=this.props,r=n.preset,o=n.roundtable,c=n.lastreadTouchable,s=n.zaInfos.follow,l=o||{},d=l.id,p=l.logo,h=l.type,f=l.guests,_=void 0===f?[]:f,m=l.stopTime,v=l.startTime,g=l.followers,E=l.commentCount,C=l.isFollowing,y=this.state,S=y.commentsShown,I=y.commentsAutoFocus,b=y.commentPattern,A=(0,u.tZ)(tq,{roundtable:o,target:"_blank"}),Z="/roundtable/".concat(d);if(r!==ed.PG.interactive)return(0,u.tZ)(ed.ZP,{data:o,link:Z,title:A});var w={id:d,type:h};return(0,u.BX)(ed.ZP,{data:o,link:Z,onRef:function(e){t.contentItem=e},title:(0,u.BX)("div",{className:"RoundtableItem-title",children:[A,(0,u.BX)("div",{className:"RoundtableItem-badge",children:[(0,u.tZ)(tD.x8,{text:!0,center:!0})," ",(e=Date.now()/1e3)>m?"已结束":e<v?"".concat((0,eo.rL)(v)," 开始"):"".concat((0,eo.rL)(m)," 结束")]})]}),image:(0,u.tZ)(tT.qE,{url:p,size:60}),meta:(0,u.BX)("div",{className:"RoundtableItem-meta",children:[(0,er.uf)(g)," 人关注",!T.Z.isMobileEntry&&"了该圆桌"]}),lastreadTouchable:c,children:[!T.Z.isMobileEntry&&_.length>0&&(0,u.tZ)(ed.n1,{children:(0,u.BX)("div",{children:[(0,u.tZ)("span",{children:"嘉宾："}),_.map(function(e,t){return(0,u.BX)("span",{children:[(0,u.tZ)(ek.Z,{user:e}),t<_.length-1&&"、"]},t)})]})}),(0,u.BX)(ed.eX,{children:[(0,u.tZ)(ep.Z,(0,a._)((0,i._)({},w),{isFollowing:C,zaId:s})),(0,u.tZ)(ew.Z,{onClick:this.handleCommentsShown,commentsShown:S,count:E}),(0,u.tZ)(eh.Z,(0,a._)((0,i._)({},w),{title:o.name}))]}),(0,u.tZ)(eR.Z,{parent:o,commentPattern:b,shown:S,autoFocus:I,onClose:this.handleCommentsHide})]})}}]),n}(f.Component);(0,F._)(tV,"propTypes",{preset:j().oneOf(Object.values(ed.PG)),zaInfos:j().shape({follow:j().number,options:j().number}),renderOptions:j().func}),(0,F._)(tV,"defaultProps",{preset:ed.PG.default,zaInfos:{}});var tX=n(379),tW=n(81168),tK=n(66223),tj=n(45588),tY=n(6716);function tQ(e){var t=e.target,n=e.target,r=n.id,o=n.attachment.url,c=n.description,l=n.title,d=n.author,p=n.thumbnailExtraInfo,h=n.isReviewing,_=n.isUpdateReviewing,m=e.lastreadTouchable,v=e.preset,g=e.onToggleExpand,T=e.renderOptions,E=e.renderActionButtons,C=e.adHint,y=p||{},S=y.videoId,I=y.url,b=(0,Y.useSelector)(function(e){return eL()(d)?e.entities.users[d]:d}),A=(0,ti.xw)(b),Z=(0,s._)((0,f.useState)(!1),2),w=Z[0],R=Z[1],N=(0,s._)((0,f.useState)({commentsShown:!1,commentsAutoFocus:!0,commentPattern:"fixed"}),2),k=N[0],O=N[1],x=(0,s._)((0,tY.Z)(void 0===v?"primary":v,w,b),1)[0];return(0,u.tZ)(e5.xM,{data:t,children:(0,u.BX)(ed.ZP,{className:"ZVideoItem",data:t,title:(0,u.tZ)("a",{href:o,target:"_blank",rel:"noopener noreferrer",children:l}),link:o,meta:x,lastreadTouchable:m,"data-zop":JSON.stringify({authorName:null==b?void 0:b.name,itemId:r,title:l,type:"zvideo"}),children:[A&&(h||_)&&(0,u.tZ)(tj.Z,{}),w&&S&&(0,u.tZ)("div",{className:"ZVideoItem-video",children:(0,u.tZ)(eP.eb,{data:p,children:(0,u.tZ)(eF.Z,{videoId:S,contentId:r,contentType:"zvideo",zaProps:{token:r}})})}),w&&(0,u.tZ)(tW.Z,{}),(0,u.BX)(eB.Z,{excerpt:(0,eU.NJ)(c),html:c,cover:I,hasVideo:!0,truncateDisabled:!0,allowCollapseWithEmptyExcerpt:!0,expanded:w,onToggleExpend:function(e){R(e),g&&g(e)},children:[(0,u.tZ)(tX.Z,{className:"ZVideoItem-toolbar",zvideo:t,author:b,commentsShown:k.commentsShown,onCommentButtonClick:function(e,t){return O(t)},renderOptions:T,renderActionButtons:E}),C&&(0,u.tZ)(tK.Z,{tag:C})]}),(0,u.tZ)(eR.Z,{className:"ZVideoItem-comment",containerClassName:"ZVideoItem-commentContainer",parent:t,shown:k.commentsShown,commentPattern:k.commentPattern,autoFocus:k.autoFocus,onClose:function(){return O((0,a._)((0,i._)({},k),{commentsShown:!1}))},commentInputPosition:"bottom",showPackupButton:!0})]})})}tQ.defaultProps={renderOptions:function(){return[null]}};var tJ=(0,m.compose)((0,el.Ib)(function(e){var t,n=e.target;return{content:{type:"Answer",token:String(n.id)},extra:{mediaInfo:{videoInfo:{videoId:null===(t=n.thumbnailExtraInfo)||void 0===t?void 0:t.videoId}}}}}))(tQ),t$=n(55342),t0=n(25834),t1=n(61317),t2={expand:2765,title:2812,voteUp:2756,voteDown:2761,toggleComment:2757,share:2758,favlists:2759,thank:2767,options:2760,report:2796,follow:2797,getCommentAction:function(e){return e?"Expand":"Collapse"}};ea.BR;var t3=function(e){(0,z._)(n,e);var t=(0,H._)(n);function n(){return(0,M._)(this,n),t.apply(this,arguments)}return(0,G._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.eventcard,r=n.linkTitle,o=n.linkUrl,i=n.title,a=n.eventUrl,c=n.extraInfo,s=n.content,l=n.bannerUrl,d=t.eventcard,p=t.lastreadTouchable,h=t.renderOptions,f=t.zaIds.options;return(0,u.BX)("div",{className:"EventcardItem",children:[l&&(0,u.tZ)("a",{className:"EventcardItem-cover",href:a,target:"_blank",rel:"noopener noreferrer",children:(0,u.tZ)("img",{src:l,srcSet:"".concat(l," 2x"),alt:i})}),(0,u.BX)(ed.ZP,{data:d,link:a,onRef:function(t){e.contentItem=t},title:(0,u.tZ)("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:i}),lastreadTouchable:p,children:[(0,u.tZ)("div",{className:"EventcardItem-content",children:s}),(0,u.BX)(ed.eX,{children:[!!r&&(0,u.tZ)(tk.Z,{a:!0,color:"blue",to:o,children:r}),(0,u.tZ)("span",{children:c}),h&&h(function(){return e.contentItem},f)]})]})]})}}]),n}(f.Component);(0,F._)(t3,"propTypes",{preset:j().oneOf(Object.values(ed.PG)),zaIds:j().object,renderOptions:j().func});var t4=(0,J.a)(function(e){var t=e.trackCardShow;return{module:"EventItem",trackCardShow:void 0===t||t}})(t3),t5=n(97345),t6=function(e){var t=e.className;return(0,u.tZ)("span",{className:W()("Bull",t),children:" \xb7 "})},t7=n(51397),t8=Object.assign,t9=function(e){return _().createElement(eT.Z,t8({width:"40",height:"40",viewBox:"0 0 40 40"},e),_().createElement("path",{d:"M20 12c6.904 0 12.5 5.596 12.5 12.5S26.904 37 20 37c-6.903 0-12.5-5.596-12.5-12.5S13.097 12 20 12zm0 16.826 3.222 2.061c.76.486 1.218.165 1.016-.72l-.886-3.892 2.867-2.572c.677-.608.494-1.165-.413-1.241l-3.734-.314-1.467-3.693c-.334-.841-.876-.841-1.21 0l-1.467 3.693-3.734.314c-.917.077-1.092.631-.413 1.24l2.867 2.573-.886 3.891c-.202.886.253 1.209 1.016.721L20 28.826zM29.525 3a1 1 0 0 1 .79 1.612l-4.336 5.6a1 1 0 0 1-.79.388h-.446a1 1 0 0 1-.853-.479l-3.792-6.208A.6.6 0 0 1 20.61 3h8.915zm-8.692 6.043a1 1 0 0 1-.83 1.557h-5.468a1 1 0 0 1-.81-.413l-4.06-5.6A1 1 0 0 1 10.476 3h5.772a1 1 0 0 1 .83.443l3.756 5.6z"}))},ne=["MEMBER_ANSWER_QUESTION","MEMBER_PUBLISH_EBOOK","MEMBER_CREATE_ARTICLE","MEMBER_ASK_QUESTION","MEMBER_CREATE_PIN","MEMBER_PUBLISH_LIVE_COURSE"],nt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=t.author.name;return n?"".concat(n,"：").concat(e):e},nn=n(57177),nr=/({})/,no={people:{Component:ek.Z,type:"user"},topic:{Component:nn.Z},column:{Component:eu.Z},roundtable:{Component:tq}},ni=function(e){var t=e.actors,n=e.template,r=t.slice(0,5);return(0,u.tZ)(t5.CJKSpace,{children:n.split(nr).map(function(e){return"{}"===e?r.map(function(e,t){if(!no[e.type])return(0,u.BX)("span",{children:[e.title,t<r.length-1&&"、"]},e.id);var n=no[e.type],o=n.Component,c=n.type,s=void 0===c?e.type:c,l=(0,i._)((0,F._)({},s,e),"people"===e.type&&{noBadge:!0});return(0,u.BX)("span",{children:[(0,u.tZ)(o,(0,a._)((0,i._)({},l),{children:e.name||e.title})),t<r.length-1&&"、"]},e.id)}):e})})},na=/{}/,nc=["pin","answer","article"],ns=["FEED_MEMBER_RECOGNIZED_PROFESSIONAL_ANSWER"],nl=(0,ec.Z)(function(e){var t=e.feed,n=e.currentUser,r=t.actionTextTpl,o=void 0===r?"":r,c=t.createdTime,s=t.actors,l=void 0===s?[]:s,d=t.verb,p=void 0===d?"":d,h=p.includes("MEMBER"),_=(0,f.useMemo)(function(){return h&&1e3*c<=Date.now()&&(0,eo.rL)(c)},[h,c]);if(ne.includes(t.verb)){var m=l[0],v=o.replace(na,"");return(0,u.tZ)("div",{className:"FeedSource",children:(0,u.BX)("div",{className:"FeedSource-firstline",children:[(0,u.BX)(t5.CJKSpace,{children:[(0,u.tZ)(ek.Z,{user:m,noHoverCard:T.Z.isMobileEntry,badgeProps:{css:{margin:"0 .3em"}},children:m.name}),v]}),_&&[(0,u.tZ)(t6,{},"bull"),_]]})})}return(0,u.BX)("div",{className:"FeedSource",children:[(0,u.BX)("div",{className:"FeedSource-firstline",children:[(0,u.tZ)(ni,{actors:l,template:o}),ns.includes(p)&&(0,u.tZ)(t7.Z,(0,a._)((0,i._)({},"FEED_MEMBER_RECOGNIZED_PROFESSIONAL_ANSWER"===p?{labelInfo:{foregroundColor:{alpha:1,group:"GYL02A"},backgroundColor:{alpha:.08,group:"GYL02A"},text:"专业",type:"recognition"},extra:{customIcon:t9,customIconClassName:"FeedSource-recognizeIcon"}}:null),{className:"FeedSource-labelIcon"})),_&&[(0,u.tZ)(t6,{},"bull"),_]]}),t.target&&nc.includes(t.target.type)&&(0,u.tZ)(eG.Z,{className:"FeedSource-byline",author:t.target.author,preset:"plain",extra:T.Z.isMobileEntry&&!n})]})}),nu=n(28753),nd=function(e){(0,z._)(n,e);var t=(0,H._)(n);function n(){var e;return(0,M._)(this,n),e=t.apply(this,arguments),(0,F._)((0,U._)(e),"handleUninterest",function(){var t=e.props,n=t.item,r=n.id,o=n.type,i=n.ad,a=t.uninterest,c=t.type;return"feed_advert"===o&&(0,t0.WY)(i.closeTrack),a(r,c)}),e}return(0,G._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.ua,r=t.isVip,o=!T.Z.isMobileEntry&&(0,u.tZ)(Q.$U,{as:$.sN,zaAction:"Ignore",zaType:"Button",className:this.props.itemClassName,onClick:this.handleUninterest,onRef:function(t){e.el=t},children:"不感兴趣"}),i=!T.Z.isMobileEntry&&(0,u.tZ)($.sN,{className:"TopstoryItem-menuItem",onClick:this.props.authRequired(function(){}),children:(0,u.tZ)(q.Z,{extra:{ua:n,isVip:r}})});return"feed_advert"===this.props.item.type?(0,u.BX)($.ZP,{className:"TopstoryItem-rightButton",toggler:(0,u.BX)(ee.ZP,{onRef:function(t){e.el=t},className:"TopstoryItem-advertButton",preset:"plain",children:["广告",(0,u.tZ)(nu.f,{center:!0})]}),children:[(0,u.tZ)($.sN,{className:"TopstoryItem-menuItem",onClick:this.handleUninterest,children:"不感兴趣"}),(0,u.tZ)($.sN,{className:"TopstoryItem-menuItem",tag:"a",target:"_blank",href:"/promotion-intro",children:"知乎广告介绍"}),i]}):(0,u.BX)(f.Fragment,{children:[o,i]})}}]),n}(f.Component),np=(0,Y.connect)(null,{uninterest:t1.Tl})(nd),nh=n(35597),nf=n(51695),n_=(0,m.compose)((0,el.Ib)(function(e){return{content:{type:"Question",token:String(e.question.id)},block:"写回答卡片"}}))(function(e){var t=e.question,n=e.lastreadTouchable,r=e.renderOptions,o=e.zaInfos,c=t.id,l=t.title,d=t.content,p=t.excerpt,h=t.viewCount,_=t.answerCount,m=t.recReason,v=o.options,g=o.title,T=o.expand,E=(0,s._)((0,f.useState)(!0),2),C=E[0],y=E[1],S=(0,s._)((0,f.useState)(null),2),I=S[0],b=S[1];return(0,u.BX)("div",{className:"TopstoryQuestionAskItem",children:[(0,u.BX)("div",{className:"TopstoryQuestionAskItem-hint",children:[(0,u.tZ)(nh.Z,{center:!0}),m]}),(0,u.tZ)(ed.ZP,{data:t,title:(0,u.tZ)("a",(0,a._)((0,i._)({href:"/question/".concat(c),target:"_blank",rel:"noopener noreferrer"},g&&{"data-za-detail-view-id":g}),{children:l})),lastreadTouchable:n,onRef:b,children:(0,u.BX)(eB.Z,{html:d,excerpt:p,limit:60,limitWithImage:60,zaIds:{expand:T},onToggleExpend:function(){return y(!C)},children:[(0,u.BX)(tk.Z,{className:"TopstoryQuestionAskItem-writeAnswerButton",preset:"outline",color:"blue",to:"/question/".concat(c,"?write"),target:"_blank","data-za-detail-view-id":5121,"data-za-detail-view-action":"Answer",children:[(0,u.tZ)(nf.yc,{}),"写回答"]}),(0,u.BX)("div",{className:"TopstoryQuestionAskItem-questionInfo",children:[(0,er.uf)(h)," 次浏览"]}),(0,u.BX)("div",{className:"TopstoryQuestionAskItem-questionInfo",children:[(0,er.uf)(_)," 个回答"]}),r&&r(function(){return I},v)]})})]})}),nm=n(11264),nv=n(6360),ng=n(65033),nT=n(49048),nE=n(98731),nC=n(18837),ny=n.n(nC)()(function(e){return e.findIndex(function(e){return"annotation"===e.name})},function(e){return e.map(function(e){return e.name}).join("-")}),nS=(0,u.tZ)(tN.Z,{annotationDetail:{showOuter:!0,reasonDescription:"品牌提问"}},"BrandQuestion"),nI=[function(e,t){var n=e.componentList,r=t.item.target,o=t.tabType;if(!(!T.Z.isMobileEntry&&"recommend"===o&&r.question&&"commercial"===r.question.questionType))return e;var c=ny(n);if(n[c].component){var s=(0,l._)(n);return s[c]={name:"annotation",component:nS},(0,a._)((0,i._)({},e),{componentList:s})}return e}],nb=n(18133),nA=n(20072);n(57045);var nZ=n(6148),nw=function(e){return null==e?void 0:e.forEach(function(e){return new Promise(function(t,n){var r=new Image;r.addEventListener("load",t),r.addEventListener("error",n),r.src=e})})};function nR(e){var t=e.promotionExtra,n=e.children,r=(0,f.useRef)(null),o=(0,f.useMemo)(function(){return(0,nZ.dj)(t)},[t]);(0,f.useEffect)(function(){o&&(nw(o.impression_tracks),(0,nA.y3)(r.current,function(){return nw(o.view_tracks)}))},[o]);var i=(0,f.useCallback)(function(){o&&nw(o.click_tracks)},[o]);return(0,u.BX)("div",{ref:r,children:[(0,u.tZ)(g.SV,{children:(0,u.tZ)(nb.Z,{data:o,node:r.current})}),"function"==typeof n?n(i):n]})}nR.propTypes={promotionExtra:j().string.isRequired,children:j().oneOfType([j().func,j().any]).isRequired};var nN=function(e){var t;if((null===(t=e.attachment)||void 0===t?void 0:t.type)==="video"){var n,r=e.attachment,o=r.parentTitle,c=r.isComplete,s=r.parentContentToken,l=r.parentPlayCount,u=r.parentVoteupCount,d=r.splitStart,p=e.thumbnailExtraInfo;if(!p)return"undefined"!=typeof window&&(null===(n=window.Raven)||void 0===n||n.captureMessage("Empty thumbnailExtraInfo",{extra:{target:e}})),e;var h={videoId:p.videoId,zvideoId:s,title:o,playCount:l,voteupCount:u,isComplete:c,startTime:d};return(0,a._)((0,i._)({},e),{videoAnswerData:h})}return e};function nk(e){var t,n=e.item,r=e.tabType,o=e.isFollowTab,c=e.preset,s=e.hasAuthorBeforeContent,l=e.handleExpand,d=e.renderIgnoreButton,p=e.adHint,h=e.index,_=n.actionTextTpl,m=n.actors,v=n.target,g=n.promotionExtra,T=n.offset,E=(0,f.useMemo)(function(){return nN(v)},[v]),C="recommend"===r,y=(0,f.useMemo)(function(){return null==m?void 0:m.find(function(e){return"people"===e.type})},[m]),S=(0,B.Z)(function(e){g&&(0,nT.w)("answer",e,g)}),I=(0,u.tZ)(nv.Z,(0,a._)((0,i._)({answer:E},s&&{formatContent:nt}),{action:o&&"{}赞同了回答"===_&&"voted",actor:y,preset:c,lessExcerpt:!0,trackCardShow:!1,lastreadTouchable:!0,renderExtraOptions:d,onToggleExpand:l,zaInfos:(0,a._)((0,i._)({},t2),{index:T}),renderActionButtons:(t={tabType:r,item:n},function(e){var n=nI.reduce(function(e,n){return n(e,t)},e);return(0,nE.W9)(n)}),hideCommercialInviteLabel:!0,shouldAlwaysShowPlayer:C,isRecommend:C,shouldTrackReadDuration:C,adHint:p,shouldHidePaidIntroWhenCollapsed:!0,index:h}));return g?(0,u.BX)(ng.ZP,{extra:g,children:[(0,u.tZ)(nm.Z,{type:"answer",id:E.id,index:h}),(0,u.tZ)(nR,{promotionExtra:g,children:function(e){return(0,f.cloneElement)(I,{trackPromotionClick:e,onClickTitle:S})}})]}):I}nk.propTypes={item:j().object.isRequired,tabType:j().oneOf(["recommend","follow"]),isFollowTab:j().bool,preset:j().string,hasAuthorBeforeContent:j().bool,handleExpand:j().func,renderIgnoreButton:j().func};var nO=n(86112);function nx(e){var t=e.item,n=e.isFollowTab,r=e.preset,o=e.hasAuthorBeforeContent,c=e.handleExpand,s=e.renderOptions,l=e.tabType,d=e.adHint,p=e.index,h=t.actionTextTpl,_=t.actors,m=t.target,v=t.promotionExtra,g=t.offset,T=(0,f.useMemo)(function(){return null==_?void 0:_.find(function(e){return"people"===e.type})},[_]),E=(0,B.Z)(function(e){v&&(0,nT.w)("article",e,v)}),C=(0,u.tZ)(nO.Z,(0,a._)((0,i._)({article:m},o&&{formatContent:nt}),{action:n&&("{}赞了文章"===h||"{}赞同了文章"===h)&&"voted",actor:T,preset:r,lessExcerpt:!0,trackCardShow:!1,lastreadTouchable:!0,zaInfos:(0,a._)((0,i._)({},t2),{index:g}),shouldTrackReadDuration:"recommend"===l,onToggleExpand:c,renderOptions:s,adHint:d,index:p}));return v?(0,u.BX)(ng.ZP,{extra:v,children:[(0,u.tZ)(nm.Z,{type:"article",id:m.id,index:p}),(0,u.tZ)(nR,{promotionExtra:v,children:function(e){return(0,f.cloneElement)(C,{trackPromotionClick:e,onClickTitle:E})}})]}):C}nx.propTypes={item:j().object.isRequired,isFollowTab:j().bool,preset:j().string,hasAuthorBeforeContent:j().bool,handleExpand:j().func,renderOptions:j().func};var nP={question:"question",answer:"answer",question_ask:"question_ask",article:"article",column:"column",collection:"collection",roundtable:"roundtable",live_course:"live_course",live:"live",ebook:"ebook",pin:"pin",eventcard:"eventcard",zvideo:"zvideo",edu_section:"edu_section"},nD=function(e){(0,z._)(n,e);var t=(0,H._)(n);function n(){var e;return(0,M._)(this,n),e=t.apply(this,arguments),(0,F._)((0,U._)(e),"state",{preset:"special-plain",hasAuthorBeforeContent:"recommend"===e.props.type,limitProps:{}}),(0,F._)((0,U._)(e),"handleExpand",function(t){var n=e.props.type;e.setState({preset:"recommend"===n&&t?"plain":"special-plain",hasAuthorBeforeContent:"recommend"===n&&!t})}),(0,F._)((0,U._)(e),"handleUninterest",function(){var t=e.props,n=t.item.id;return(0,t.uninterest)(n,t.type)}),(0,F._)((0,U._)(e),"renderZVideoOptions",function(t,n){return[(0,u.BX)($.ZP,{toggler:(0,u.tZ)(ee.ZP,{preset:"plain",className:"OptionsButton",icon:V.AZ,"aria-label":"更多"}),children:[(0,u.tZ)(Q.$U,{zaType:"Button",zaAction:"Ignore",as:$.sN,className:"ZVideoToolbar-menuItem",onClick:e.handleUninterest,children:"不感兴趣"}),(0,u.tZ)($.sN,{className:"TopstoryItem-menuItem",onClick:e.props.authRequired(function(){}),children:(0,u.tZ)(q.Z,{extra:{ua:t,isVip:n}})})]},"options")]}),(0,F._)((0,U._)(e),"renderItem",function(t,n,r){var o,c=e.props,s=c.ua,l=c.currentUser,d=((null==l?void 0:l.vipInfo)||{}).isVip,h=t.target,f=t.actor,_=t.adHint,m=e.state,v=m.preset,g=m.hasAuthorBeforeContent,T="follow"===n,E="recommend"===n,C=E?function(r){return(0,u.tZ)(np,(0,i._)({type:n,item:t,ua:s,isVip:d,authRequired:e.props.authRequired},r))}:void 0,y=C?l&&C?function(e,t){var n=h.relationship,r=(void 0===n?{}:n).isAuthor,o={toggler:(0,u.tZ)(ee.ZP,{preset:"plain",className:"OptionsButton",icon:V.AZ,"aria-label":"更多"}),reversed:!0,onOpen:function(){return ev(e(),t)},menuClassName:"ItemOptions-selfMenu",itemClassName:"ItemOptions-selfMenuItem"};if(!r)return(0,p.az)($.ZP,(0,a._)((0,i._)({},o),{key:"options"}),C({itemClassName:"ItemOptions-selfMenuItem",getContainer:e}))}:null:void 0;switch(h.type){case nP.question:return(0,u.tZ)(tP,{preset:ed.PG.interactive,question:h,trackCardShow:!1,lastreadTouchable:!0,zaInfos:t2,renderOptions:y});case nP.question_ask:return(0,u.tZ)(n_,{question:h,lastreadTouchable:!0,zaInfos:t2,renderOptions:y});case nP.answer:return(0,u.tZ)(nk,{item:t,tabType:n,isFollowTab:T,preset:v,hasAuthorBeforeContent:g,handleExpand:e.handleExpand,renderIgnoreButton:C,adHint:_,index:r});case nP.article:return(0,u.tZ)(nx,{item:t,tabType:n,isFollowTab:T,preset:v,hasAuthorBeforeContent:g,handleExpand:e.handleExpand,renderOptions:y,adHint:_,index:r});case nP.column:return(0,u.tZ)(e_,{preset:ed.PG.interactive,column:h,trackCardShow:!1,lastreadTouchable:!0,zaInfos:t2,renderOptions:y});case nP.collection:return(0,u.tZ)(tf,{preset:ed.PG.interactive,favlist:h,trackCardShow:!1,lastreadTouchable:!0,zaInfos:t2,renderOptions:y});case nP.roundtable:return(0,u.tZ)(tV,{preset:ed.PG.interactive,roundtable:h,trackCardShow:!1,lastreadTouchable:!0,zaInfos:t2});case nP.live_course:return(0,u.tZ)(tm,{liveCourse:h,preset:ed.PG.interactive,trackCardShow:!1,lastreadTouchable:!0,renderOptions:y,zaIds:t2});case nP.live:return(0,u.tZ)(tb,{live:h,preset:ed.PG.interactive,trackCardShow:!1,lastreadTouchable:!0,renderOptions:y,zaIds:t2});case nP.ebook:return(0,u.tZ)(ex,{ebook:h,preset:ed.PG.interactive,trackCardShow:!1,lastreadTouchable:!0});case nP.pin:return(0,u.tZ)(tA.Z,{action:!0,isFollowTab:T,actor:f,pin:h,preset:v,hasAuthorBeforeContent:g,onToggleExpand:e.handleExpand,commentsPosition:"bottom",trackCardShow:!1,shouldTrackReadDuration:E,lastreadTouchable:!0});case nP.zvideo:return(null===(o=h.attachment)||void 0===o?void 0:o.type)===1?(0,u.tZ)(tJ,{target:h,preset:v,adHint:_,onToggleExpand:e.handleExpand,renderOptions:function(){return e.renderZVideoOptions(s,d)},lastreadTouchable:!0}):(0,u.tZ)(t$.Z,{zvideo:h,preset:v,onToggleExpand:e.handleExpand,renderOptions:function(){return e.renderZVideoOptions(s,d)},lastreadTouchable:!0,shouldAlwaysShowPlayer:E,showMetaAfterPlayer:E,adHint:_});case nP.eventcard:return(0,u.tZ)(t4,{trackCardShow:!1,eventcard:h,lastreadTouchable:!0,renderOptions:y,zaIds:t2});case nP.edu_section:return(0,u.tZ)(td,{eduSection:h,onToggleExpand:e.handleExpand,renderOptions:function(){return e.renderZVideoOptions(s,d)},lastreadTouchable:!0});default:return null}}),e}return(0,G._)(n,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.type,r=e.className,o=e.index;return t.target.isDelete?null:(0,u.tZ)("div",{className:W()("Feed",r),children:(0,u.BX)(Q.eV,{moduleId:"universal_single_card",extra:{attachedInfoBytes:t.attachedInfo},children:["follow"===n&&(0,u.tZ)(nl,{feed:t}),this.renderItem(t,n,o)]})})}}]),n}(f.PureComponent);(0,F._)(nD,"propTypes",{item:j().object.isRequired,type:j().oneOf(["recommend","follow"]),className:j().string}),(0,m.compose)(eJ.Z,(0,Y.connect)(function(e){return{ua:e.env.userAgent}},{uninterest:t1.Tl}),(0,J.a)(function(e){var t=e.item,n=t.id,r=t.attachedInfo,o=t.target,c=t.target,s=c.id,l=c.type,u=t.dataZaIndex;return{module:"FeedItem",index:String(void 0===u?0:u),isAd:!1,attachedInfoBytes:r,card:{card_type:"Feed",feed_id:n,has_image:!!(o.thumbnailExtraInfo&&"image"===o.thumbnailExtraInfo.type),has_video:!!(o.thumbnailExtraInfo&&"video"===o.thumbnailExtraInfo.type),content:(0,a._)((0,i._)({type:ea.LA[l]},(0,t0.A$)(l,s)),{video_id:o.thumbnailExtraInfo&&o.thumbnailExtraInfo.videoId})},view:{id:2743},trackCardShow:!0}}))(nD);var nL=n(35502),nB=function(e){var t=e.root,n=e.parentType,r=e.parentId,o=(0,c._)(e,["root","parentType","parentId"]),l=(0,s._)((0,f.useState)(),2),d=l[0],p=l[1];(0,nL.Z)({videoId:null==d?void 0:d.videoId,iframeRef:null==d?void 0:d.videoIframeRef});var h=(0,B.Z)(function(e){var t="";return[nP.zvideo,nP.answer].includes(n)&&(t="?".concat(new URLSearchParams([["itemId",r],["itemType",n]]).toString())),"https://".concat(T.Z.videoHost,"/video/").concat(e).concat(t)}),_=(0,B.Z)(function(e){var t=e.videoId,n=e.videoIframeRef;t&&(null==n?void 0:n.current)&&p({videoId:t,videoIframeRef:n})});return(0,u.tZ)(u.HY,{children:(0,u.tZ)(O.SM,(0,a._)((0,i._)({onLinkCardPlayerLoaded:_,getVideoUrl:h,useZVideoLinkCard:!1},o),{root:t}))})},nU=function(e){var t=this;return e.length?function(n,r){for(var o=e.length-1,i=n;o>=0;)i=e[o].call(t,i,r),o--;return i}:ej()},nM=/<img\b[^>]*data-rawwidth="([^>"]*)"[^>]*?>/g,nG=function(e){return e?e.replace(nM,function(e,t){if(!(t=parseInt(t)))return e;var n=t>=343?"normal":"small";return e.replace(/data-size="[^">]*"/g,'data-size="'.concat(n,'"'))}):e},nF=function(e){var t=e.onRef,n=e.htmlProcessors,r=e.linkCardInfo,o=e.zvideoLinkCardProps,d=e.adLinkCardProps,p=e.mcnLinkCardProps,h=e.eduCardProps,_=e.mkSkuLinkCardProps,m=e.html,v=e.sourceId,g=e.shouldShowCatalog,T=e.shouldCatalogCollapse,D=e.shouldFoldCatalog,B=e.referenceLinkProps,U=e.useCatalogV2,M=e.isAuthor,G=e.maskGradientColor,F=e.isVideoAnswer,z=(0,c._)(e,["onRef","htmlProcessors","linkCardInfo","zvideoLinkCardProps","adLinkCardProps","mcnLinkCardProps","eduCardProps","mkSkuLinkCardProps","html","sourceId","shouldShowCatalog","shouldCatalogCollapse","shouldFoldCatalog","referenceLinkProps","useCatalogV2","isAuthor","maskGradientColor","isVideoAnswer"]),H=d||{},q=H.parentType,V=H.parentId,X=(0,s._)((0,f.useState)(null),2),W=X[0],K=X[1],j=(0,s._)((0,f.useState)(null),2),Y=j[0],Q=j[1],J=(0,C.F)(),$=nU((0,l._)(void 0===n?[]:n).concat([(0,k.Pq)(),A.g,Z.Tw,(0,I.PD)(U),nG]));(0,O.af)(W,o,r),(0,k.AV)(W,B),(0,I.cy)(W);var ee=(0,f.useMemo)(function(){return(0,I.f1)(m,v)},[m,v]).catalog,et=(0,f.useMemo)(function(){if(!W)return{};var e=W.getBoundingClientRect().left-20;return{shouldFold:T||(0,I.b6)(e),width:(0,I.XD)(e)}},[W,T]),en=et.shouldFold,er=et.width;return(0,u.BX)(L,{css:{position:"relative",display:"inline"},children:[(0,Z.fv)(W),g&&D&&(0,u.tZ)(I.$n,{root:W}),(0,u.tZ)(S.H,(0,a._)((0,i._)({},d),{root:W})),(0,u.tZ)(N._,(0,a._)((0,i._)({},_),{root:W})),(0,u.tZ)(nB,(0,a._)((0,i._)({parentId:V,parentType:q,isVideoAnswer:void 0!==F&&F},o),{root:W})),(0,R.H)({root:W,mcnLinkCardProps:p,contentType:q,token:V,isAuthor:M}),(0,x.cD)({root:W,createLinkCardPortal:b.EN,eduCardProps:h,Popover:E.Z}),g&&U&&(null==ee?void 0:ee.length)>0&&(0,u.BX)(u.HY,{children:[(0,u.tZ)(P.Box,{ref:Q,css:(0,i._)({position:"absolute",left:en?-20:-er-I.PO-20,top:en?60:0,width:er},en&&{pointerEvents:"none"})}),(0,u.tZ)(I.fo,{catalog:ee,inEditor:!1,scrollOffset:52,stickyOffset:en?132:72,contentRoot:W,container:Y,shouldShowFoldIcon:en,shouldCollapse:T,maskGradientColor:G})]}),(0,u.tZ)(b.Ho,(0,i._)({ref:(0,y.Z)(t,K),css:function(e){return(0,a._)((0,i._)({},(0,A.b)(e),w.e),{"img.content_image, img.origin_image":{'&[data-size="normal"]':{width:"100%",maxWidth:"100%"},'&[data-size="small"]':{width:"320px",maxWidth:"100%"}}})},html:$(m,{sourceId:v,theme:J,shouldShowCatalog:g,shouldFoldCatalog:D,linkCardInfo:r})},z))]})},nz=n(54231),nH={},nq=function(e,t){var n=t.split("/").reverse()[0],r=(0,s._)(n.split("."),2),o=r[0],i=r[1],a=(0,s._)(o.split("_"),2)[1],c=(0,nz.HP)({appName:"heifetz"})("".concat("webp"===i||"gif"===i?i:"image",".").concat(a,".unknown.RichText"));switch(e){case"loadstart":nH[n]=Date.now();break;case"load":if(nH[n]){var l="".concat(c,".success");nz.ZP.increment({raw:"".concat(l,".count")}),nz.ZP.timing(l,Date.now()-nH[n]),delete nH[n]}break;case"timeout":nH[n]&&(nz.ZP.increment({raw:"".concat(c,".timeout.count")}),delete nH[n]);break;case"error":nH[n]&&(nz.ZP.increment({raw:"".concat(c,".failure.count")}),delete nH[n])}},nV=function(e){return(0,u.tZ)(b.BU,(0,a._)((0,i._)({onLoadStateChange:nq},e),{useMp4:!0}))},nX=function(e){var t=e.node,n=e.index,r=t.dataset.thumbnail,o="uncomfortable"in t.dataset,i=function(){return r?"load-gif":"load-image"},a=(0,s._)((0,f.useState)(o?"uncomfortable":i()),2),c=a[0],l=a[1];return"load-image"===c?(0,u.tZ)(b.RP,{node:t,onLoadStateChange:nq,index:n}):"load-gif"===c?(0,u.tZ)(b.pE,{node:t,Component:nV}):"uncomfortable"===c?(0,u.BX)(u.HY,{children:[(0,u.tZ)(b.rI,{node:t,style:{display:"none"}}),(0,u.tZ)(w.i,{node:t,onClick:function(){delete t.dataset.uncomfortable,l(i())}})]}):null},nW=n(69920),nK=n(39658),nj=new nW.Z,nY=function(e){return nj("",e)},nQ=function(e){var t=e.paidInfo,n=e.targetSelector,r=(0,f.useMemo)(function(){var e=function(e){if(!e)return"";var t=e.font;return t&&t.base64?{normalFontFaceCss:"\n        @font-face {\n            font-family: 'DynamicFonts".concat(t.fontType,"';\n            font-display: 'swap';\n            font-weight: normal;\n            src: url(").concat(t.base64,");\n        }\n    "),boldFontFaceCss:t.boldBase64?"\n        @font-face {\n            font-family: 'DynamicFonts".concat(t.fontType,"';\n            font-display: 'swap';\n            font-weight: bold;\n            src: url(").concat(t.boldBase64,");\n        }\n    "):"",fontFamilyCss:"\n        font-family: 'DynamicFonts".concat(t.fontType,"', -apple-system, BlinkMacSystemFont,\n        'Helvetica Neue', 'PingFang SC', 'Microsoft YaHei',\n        'Source Han Sans SC', 'Noto Sans CJK SC', 'WenQuanYi Micro Hei',\n        sans-serif;\n    ")}:{}}(t),r=e.normalFontFaceCss,o=e.boldFontFaceCss,i=e.fontFamilyCss;return[r,o,i?"".concat(n,"{").concat(i,"}"):""].filter(Boolean).map(nY)},[t,n]);return(0,u.tZ)(nK.ql,{children:r.map(function(e,t){return(0,u.tZ)("style",{type:"text/css",children:e},t)})})},nJ=n(81897),n$=n.n(nJ),n0=n(29229),n1=n(82267),n2=function(){var e=(0,s._)((0,f.useState)(null),2),t=e[0],n=e[1];return[t,(0,B.Z)(function(e){n(e.currentTarget.dataset.mcnId)}),(0,B.Z)(function(){return n(null)})]},n3=function(e){var t=e.goodsCardId,r=e.handleClose,o=(0,Y.useSelector)(function(e){return e.currentUser}),i=(0,n0.Z)(function(){return n.e(430).then(n.bind(n,23717))}),a=(0,n1._)(),c=(0,B.Z)(function(e){a({id:e.id,source:e.sourceId,url:e.url,appSchemaIos:e.app_schema_ios,appSchemaAndroid:e.app_schema_android})});return t?(0,u.tZ)(i,{showModal:!!t,id:t,userId:o,clientId:n$().get("_zap"),onClose:r,onSelectCard:c}):null},n4=n(2122),n5=function(e){var t=e.className,n=e.html,r=e.lazyLoadImageProps,o=(0,s._)((0,f.useState)(null),2),i=o[0],a=o[1];return(0,b.RK)(i,r),(0,u.tZ)("div",{ref:a,children:(0,u.tZ)(n4.Z,{className:t,content:n})})},n6=n(36892),n7=n(61533),n8=function(e){var t=e.getAttribute("data-hash"),n=e.textContent.replace(/^@/,""),r=document.createElement("span");return e.parentNode.replaceChild(r,e),{target:r,data:{id:t,name:n}}},n9=function(e){var t=(0,s._)((0,f.useState)(null),2),n=t[0],r=t[1];return(0,f.useEffect)(function(){if(e){var t=Array.from(e.querySelectorAll(".member_mention"));t.length&&r(t.map(n8).map(function(e,t){var n=e.data,r=e.target;return(0,n7.createPortal)((0,u.BX)(ek.Z,{user:n,children:["@",n.name]},t),r)}))}},[e]),n},re=n(83697),rt=n(59590),rn=function(e,t){var n=t.root;if(!e.defaultPrevented){var r=e.target;if(!("img"!==r.tagName.toLowerCase()||!r.src.includes("zhimg")&&r.src.includes("equation")||r.classList.contains("ztext-gif")&&!r.parentNode.classList.contains("isPlaying"))){var o=Array.from(n.querySelectorAll(["img"])).filter(function(e){return e.src.includes("zhimg")&&!e.src.includes("equation")}),a=o.indexOf(r);if(-1!==a){e.preventDefault();var c=o.map(function(e){return e.dataset.thumbnail&&e.src.replace(/\.jpg|\.webp/,".gif")||e.dataset.src||e.src||""}).map(function(e){return(0,eg.imgUrl)(e,(0,i._)({quality:""},e.endsWith("webp")&&{extension:"jpg"}))});(0,rt.Z)("base/openImage").dispatch({images:c,index:a})}}}},rr=function(e){var t=(0,re.n)(),n=(0,f.useCallback)(function(n){t.ZhihuHybrid&&rn(n,{root:e})},[e,t.ZhihuHybrid]);(0,f.useEffect)(function(){if(e)return e.addEventListener("click",n),function(){e.removeEventListener("click",n)}},[e,n])},ro=n(24340),ri=function(e){var t=e.getAttribute("data-poster"),n={title:e.getAttribute("data-name"),thumbnail:"data:,"===t?"":t,url:e.getAttribute("href"),src:e.getAttribute("data-src")};n=e.getAttribute("data-lens-id")?(0,a._)((0,i._)({},n),{isLens:!0,id:e.getAttribute("data-lens-id"),isPlayable:!0}):(0,a._)((0,i._)({},n),{isLens:!1,id:e.getAttribute("data-video-id"),isPlayable:"true"===e.getAttribute("data-video-playable")}),e.hasAttribute("data-lens-status")&&(n=(0,a._)((0,i._)({},n),{error:{status:e.getAttribute("data-lens-status"),message:e.getAttribute("data-description")}}));var r=document.createElement("div");return e.parentNode.replaceChild(r,e),{target:r,data:n}},ra=function(e){return e.getAttribute("data-lens-id")||e.getAttribute("data-video-id")},rc=function(e,t){var n=t.hideWatermark,r=t.contentType,o=t.contentId,i=(0,s._)((0,f.useState)(null),2),a=i[0],c=i[1];return(0,f.useEffect)(function(){if(e){var t=Array.from(e.querySelectorAll(".video-box, .video-link, .unprocessable_video"));t.length&&c(t.filter(ra).map(ri).map(function(e,t){var i=e.data,a=e.target;return(0,n7.createPortal)((0,u.tZ)(ro.Z,{ratio:16/9,children:(0,u.tZ)(eF.Z,{zaProps:{type:r,token:o},videoId:i.id,contentId:o,contentType:r,hideWatermark:n},t)}),a)}))}},[e,n,r,o]),a},rs=function(e){var t=e.root,r=e.ecommerce,o=e.sourceType,i=e.sourceId,a=e.entityWords,c=e.hideWatermark;return(0,u.BX)(u.HY,{children:[rc(t,{hideWatermark:c,contentType:o,contentId:i}),n9(t),(0,u.tZ)(g.SV,{target:"ecommercePortal",replacement:null,children:(0,v.su)(t,{ecommerce:r,getComponent:function(){return Promise.all([n.e(154),n.e(8400)]).then(n.bind(n,4669))}})}),(0,d.K)(t,{type:o,sourceId:i,entityWords:a})]})},rl=function(e){var t,n,r,o,p,h,_,v,g=e.className,T=e.ecommerce,E=e.html,C=e.shouldShowCatalog,y=e.sourceId,S=e.sourceType,I=e.isExpanded,b=e.entityWords,A=e.isVideoAnswer,Z=e.hideWatermark,w=(0,c._)(e,["className","ecommerce","html","shouldShowCatalog","sourceId","sourceType","isExpanded","entityWords","isVideoAnswer","hideWatermark"]),R=(0,s._)((0,f.useState)(null),2),N=R[0],k=R[1],O=(0,f.useMemo)(function(){return E?m.compose.apply(void 0,(0,l._)([(0,d.z)(b)].filter(Boolean)))(E):""},[E,b]);rr(N),n=(t=(0,s._)((0,f.useState)(!1),2))[0],r=t[1],o=(0,Q.Q4)().trackEvent,p=(0,B.Z)((0,n6.Z)(function(){document.getSelection().toString()&&o({eventType:"Click",elementLocation:{moduleId:"text_select",type:"Text"}})},1e3)),h=(0,B.Z)(function(){document.addEventListener("selectionchange",p)}),_=(0,B.Z)(function(){document.getSelection().toString()&&(o({eventType:"Click",elementLocation:{moduleId:"text_copy",type:"Text",text:n?"快捷键复制":"右键复制"}}),r(!1))}),v=(0,B.Z)(function(e){("c"===e.key||67===e.keyCode)&&(e.ctrlKey||e.metaKey)&&r(!0)}),(0,f.useEffect)(function(){if(N)return N.addEventListener("selectstart",h),N.addEventListener("copy",_),document.addEventListener("keydown",v),function(){N.removeEventListener("selectstart",h),N.removeEventListener("copy",_),document.removeEventListener("keydown",v),document.removeEventListener("selectionchange",p)}},[N,_,v,p,h]);var x=(0,s._)(n2(),3),P=x[0],D=x[1],L=x[2];return(0,u.BX)(u.HY,{children:[(0,u.tZ)(nF,(0,a._)((0,i._)({},w),{className:g,html:void 0===I||I?O:E,onRef:k,ConditionalImage:nX,adLinkCardProps:{parentId:y,parentType:S},mcnLinkCardProps:{onClick:D},mkSkuLinkCardProps:{cardSize:"large",enableBackdrop:!1,sourceConvert:!1,tagPreset:"plain",enableMetaTag:!1,enableButton:!0,buttonPreset:"plain",buttonColor:"orange",enableHint:!1},eduCardProps:{token:y,contentType:S},zvideoLinkCardProps:{enableInlinePlay:!0},shouldShowCatalog:C,sourceId:y,useCatalogV2:!0,isVideoAnswer:A})),(0,u.tZ)(rs,{root:N,ecommerce:T,sourceId:y,sourceType:S,entityWords:b,hideWatermark:Z}),(0,u.tZ)(n3,{goodsCardId:P,handleClose:L})]})},ru=function(e){var t=e.paidInfo,n=(0,c._)(e,["paidInfo"]);return(0,u.tZ)(rl,(0,i._)({css:(0,p.iv)((0,h.Z)(t))},n))},rd=function(e){var t;return(null==e?void 0:null===(t=e.font)||void 0===t?void 0:t.fontType)||""},rp=function(e){var t=e.paidInfo,n=(0,c._)(e,["paidInfo"]),r=rd(t);return(0,u.BX)(u.HY,{children:[(0,u.tZ)(nQ,{paidInfo:t,targetSelector:'.RichText[data-font-id="'.concat(r,'"]')}),(0,u.tZ)(rl,(0,i._)({"data-font-id":r},n))]})},rh=function(e){var t=e.isNovel,n=e.paidInfo,r=(0,c._)(e,["isNovel","paidInfo"]);if(t){var o=r.className,a=r.html;return(0,u.tZ)(n5,{className:o,html:a,lazyLoadImageProps:{onLoadStateChange:nq,useWebP:!1}})}return n?"1"===T.Z.apollo.dynamic_font_schema?(0,u.tZ)(rp,(0,i._)({paidInfo:n},r)):(0,u.tZ)(ru,(0,i._)({paidInfo:n},r)):(0,u.tZ)(rl,(0,i._)({},r))}},83821:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626);n(85879);var l=n(14168),u=n.n(l),d=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{visible:e.props.disabled}),(0,a._)((0,r._)(e),"onShow",function(){e.setState({visible:!0})}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){this.state.visible||(this.props.timeout>0?this.timeout=setTimeout(this.onShow,this.props.timeout):this.onShow())}},{key:"componentWillUnmount",value:function(){this.timeout&&clearTimeout(this.timeout)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.placeholder;return this.state.visible?t:n}}]),n}(n(87363).Component);(0,a._)(d,"propTypes",{disabled:u().bool,placeholder:u().node,timeout:u().number}),(0,a._)(d,"defaultProps",{disabled:!1,placeholder:null,timeout:-1})},28209:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(87363);function o(){return(0,r.useEffect)(function(){window.scrollTo(0,0)},[]),null}},45001:function(e,t,n){"use strict";n.d(t,{W:function(){return O},Z:function(){return P}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(71728),d=n(85626),p=n(85879),h=n(83921),f=n(67814),_=n.n(f),m=n(7656),v=n.n(m),g=n(92769),T=n.n(g),E=n(95548),C=n.n(E),y=n(14168),S=n.n(y),I=n(87363),b=n(77617),A=n.n(b),Z=n(98125),w=n(13844),R=n(7181),N={button:"HrHisPElmD_XxB9LKi6j",plainButton:"h39gnJsHf0NWeCTuygxV",arrow:"RXYxRcvJ7zVIfNZSOcHa",list:"wzIYYDapUzV6NOo6FjeV",option:"A1LO1m96faGxseE9tNf3",popoverTarget:"U4KXos1rwjW8g8If_xHY"},k=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleMouseEnter",function(){e.node.focus()}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.value,r=t.text,o=t.className,i=t.onClick,a=t.children,c=(0,u._)(t,["value","text","className","onClick","children"]);return(0,p.tZ)("button",(0,l._)((0,s._)({ref:function(t){e.node=t},className:_()("Select-option",N.option,o),onClick:i,onMouseEnter:this.handleMouseEnter,tabIndex:-1,role:"option"},c),{children:a||r||n}))}}]),n}(I.Component);(0,a._)(k,"propTypes",{value:S().oneOfType([S().string,S().number,S().bool]).isRequired,text:S().string,onClick:S().func,children:S().node});var O=k,x=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.call(this),(0,a._)((0,r._)(e),"state",{open:!1}),(0,a._)((0,r._)(e),"handleOpen",function(){e.timeout=setTimeout(function(){if(e.list){var t=e.getSelectedIndex(),n=e.isRepositioned?0:t,r=e.list.querySelector(".Select-option:nth-child(".concat(n+1,")"));r&&r.focus()}},100),e.setState({open:!0})}),(0,a._)((0,r._)(e),"handleClose",function(){clearTimeout(e.timeout),e.isRepositioned=!1,e.setState({open:!1})}),(0,a._)((0,r._)(e),"handleItemClick",function(t){var n=e.props,r=n.onChange,o=n.children,i=I.Children.toArray(o)[t];r&&r(i.props.value,t)}),(0,a._)((0,r._)(e),"position",function(t){if(!t)return null;var n=e.props,r=n.plain,o=n.margin,i=n.needsReposition,a=n.topExcludedHeight,c=n.fixFirstItem,s=t.getBoundingClientRect(),l=s.top,u=s.left,d=getComputedStyle(t);e.listRect||(e.listRect=e.list.getBoundingClientRect());var p=e.listRect.width,h=e.list.clientHeight,f=e.list.scrollHeight,_=e.getSelectedIndex(),m=e.list.querySelector(".Select-option:nth-child(".concat((c?0:_)+1,")"));if(!m)return null;var g=m.offsetTop,T=m.offsetHeight,E=v()(Math.round(g-(h-T)/2),0,f-h),C=l+-(g-E+1)+o;i&&C<a&&(C=l-9+o,e.isRepositioned=!0);var y=u;return r&&(y-=20),y=Math.min(window.innerWidth-p,y),e.list.scrollTop=E,{targetContainerStyle:{top:C=Math.max(14,C),left:y=Math.max(14,y),fontSize:d.fontSize}}}),e.id=C()("Select"),e.isRepositioned=!1,e}return(0,i._)(n,[{key:"getSelectedIndex",value:function(){var e=this.props,t=e.value,n=e.children,r=I.Children.toArray(n).findIndex(function(e){return e.props.value===t});return -1!==r?r:0}},{key:"renderToggler",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.text,r=t.value,o=this.props,i=o.buttonClassName,c=o.plain,s=o.large,l=o.width,u=o.disabled;return(0,p.BX)(w.Z,{large:s,preset:c?"plain":null,className:_()("Select-button",N.button,i,(0,a._)({"Select-plainButton":c},N.plainButton,c)),style:{width:l},role:"combobox","aria-expanded":!1,disabled:u,children:["function"==typeof e?e(n,r):e||n||r,(0,p.tZ)(h.ZP,{text:!0,className:_()("Select-arrow",N.arrow)})]})}},{key:"render",value:function(){var e=this,t=T()(this.props,["buttonClassName"]),n=t.text,r=t.children,o=t.listClassName,i=t.menuToggler,c=t.width,d=t.useDefaultPosition,h=(0,u._)(t,["text","children","listClassName","menuToggler","width","useDefaultPosition"]),f=I.Children.toArray(r),m=f[this.getSelectedIndex()],v=i||this.renderToggler(n,m&&m.props),g=_()((0,a._)({"Select-list":!0},o,o),N.list);return(0,p.tZ)(R.Z,(0,l._)((0,s._)({toggler:v,fade:!0,delay:0,arrowed:!1,targetClassName:_()("Select-popoverTarget",N.popoverTarget),position:d?null:this.position,onOpen:this.handleOpen,onClose:this.handleClose},h),{children:(0,p.tZ)(Z.Z,{selector:".Select-option",children:(0,p.tZ)("div",{className:g,role:"listbox",style:{width:c},ref:function(t){e.list=t},children:f.map(function(t,n){return(0,I.cloneElement)(t,{id:"".concat(e.id,"-").concat(n),onClick:function(r){t.props.onClick&&t.props.onClick(r),e.handleItemClick(n)},key:n})})})})}))}}]),n}(I.Component);(0,a._)(x,"propTypes",{className:S().string,listClassName:S().string,buttonClassName:S().string,plain:S().bool,large:S().bool,width:S().number,value:S().oneOfType([S().string,S().number,S().bool]),text:S().oneOfType([S().node,S().func]),margin:S().number,needsReposition:S().bool,topExcludedHeight:S().number,onChange:S().func,children:S().node,disabled:S().bool,useDefaultPosition:S().bool}),(0,a._)(x,"defaultProps",{plain:!1,large:!1,margin:0,needsReposition:!1,topExcludedHeight:60,disabled:!1,fixFirstItem:!1});var P=A()(x,{value:"onChange"})},82311:function(e,t,n){"use strict";var r=n(85879),o=n(37335);t.Z=function(){return(0,r.BX)("div",{className:"SelfVisibleLable-wrap",children:[(0,r.tZ)(o.P,{className:"SelfVisibleLable-lockIcon",width:16,center:!0}),"仅自己可见"]})}},24794:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(85626),d=n(85879),p=n(7629),h=n(78603),f=n(45913),_=n(83931),m=n(67814),v=n.n(m),g=n(11362),T=n.n(g),E=n(88329),C=n.n(E),y=n(14168),S=n.n(y),I=n(87363),b=n(36695),A=n(69383),Z=n(43384),w=n(4534),R=n(1733),N=n(54422),k=n(38889),O=n(97727),x=n(80714),P=n(66263),D=n(67927),L=n(40861),B=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,n=null;return{start:function(){n||(n=setTimeout(function(){e(),n=null},t))},stop:function(){n&&(clearTimeout(n),n=null)}}};function U(e){return e&&e.startsWith("//")?"".concat(x.Z.protocol).concat(e):e}var M=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{qrCodeUrl:""}),(0,a._)((0,r._)(e),"togglerRef",(0,I.createRef)()),(0,a._)((0,r._)(e),"shouldShowMenu",function(){var t=e.props,n=t.onTogglerClick,r=t.disabled;return!1!==n()&&!r}),(0,a._)((0,r._)(e),"handleTogglerClick",function(t){if(!e.shouldShowMenu()){t.preventDefault();return}e.loadQrcodeImage(),e.handleShare(t)}),(0,a._)((0,r._)(e),"handleMouseEnter",function(t){if(!e.shouldShowMenu()){t.preventDefault();return}e.loadQrcodeImage(),e.handleShare(t)}),(0,a._)((0,r._)(e),"open",function(t){e.shouldShowMenu()&&(e.loadQrcodeImage(),e.menu.popover.open(),e.handleShare(t))}),(0,a._)((0,r._)(e),"handleShare",function(){var t=e.props,n=t.id,r=t.type,o=t.getShareText,i=t.zaShareId,a=t.onShare;["live","edu_course","edu_section"].includes(r)||o(n,r),A.Z.trackEvent(e.togglerRef.current,(0,s._)({action:"Share",element:"Button",is_intent:!0,element_name:P.ur[r]},i&&{id:i})),null==a||a()}),(0,a._)((0,r._)(e),"copyLink",function(){var t=e.props,n=t.type,r=t.title,o=t.authorName,i=t.href,a=t.showNotification,c=w.iB[n]||"",s=o&&"匿名用户"!==o&&c?"".concat(o,"的").concat(c," - "):"",l=i?(0,N.BY)(i):e.url();T()("".concat(r?"".concat(r," - "):"").concat(s,"知乎\n").concat(U(l)),{format:"text/plain"}),a("链接复制成功！")}),(0,a._)((0,r._)(e),"url",function(){var t=e.props,n=t.id,r=t.type,o=t.shouldUseHrefFirst,i=t.href;return o?(0,N.BY)(i):U((0,N.BY)(e.props.url))||"".concat(location.origin,"/").concat(r,"/").concat(n)}),(0,a._)((0,r._)(e),"loadQrcodeImage",function(){var t=e.state.qrCodeUrl,n=e.props,r=n.shouldUseHrefFirst,o=n.href;if(!t){var i=r?o:"".concat(e.url(),"#showWechatShareTip");t="".concat(x.Z.protocol,"//").concat(x.Z.wwwHost,"/qrcode?url=").concat(encodeURIComponent(i)),e.setState({qrCodeUrl:t}),new Image().src=t}}),(0,a._)((0,r._)(e),"preloaderRef",(0,I.createRef)()),(0,a._)((0,r._)(e),"tryPreloadImage",function(){e.props.willPositivePreload&&(e.preloaderRef.current||(e.preloaderRef.current=B(function(){return e.loadQrcodeImage()})),e.preloaderRef.current.start())}),(0,a._)((0,r._)(e),"stopPreloadImage",function(){var t;null===(t=e.preloaderRef.current)||void 0===t||t.stop()}),(0,a._)((0,r._)(e),"shareToWeibo",function(){var t={appKey:"3063806388"},n=e.props.shareText;n&&(t.title=n);var r="http://service.weibo.com/share/share.php?".concat(Object.keys(t).map(function(e){return"".concat(e,"=").concat(encodeURIComponent(t[e]))}).join("&"));window.open(r,"_blank","width=615,height=505")||(location.href=r)}),e}return(0,i._)(n,[{key:"componentDidUpdate",value:function(e){this.props.positionStatus!==e.positionStatus&&this.menu.popover.close()}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.togglerClassName,o=t.positionStatus,i=t.toggler,a=t.type,c=t.disabled,u=t.placement,_=t.toggleEvent,m=t.stickHover,g=t.children,T=this.state.qrCodeUrl,E=(0,d.tZ)("div",{className:v()("ShareMenu-toggler",r),children:(0,I.cloneElement)(i,{onMouseEnter:this.tryPreloadImage,onMouseLeave:this.stopPreloadImage,disabled:c,ref:this.togglerRef})}),C="hover"===_?{onMouseEnter:this.handleMouseEnter}:{onClick:this.handleTogglerClick};return(0,d.BX)(d.HY,{children:[(0,d.tZ)(O.bY,{input:"s",action:this.open}),(0,d.BX)(Z.$U,(0,l._)((0,s._)({as:R.ZP,zaText:!0,zaType:"Button",zaAction:"Share",zaModuleId:"more_panel_share",className:v()("ShareMenu",n),positionStatus:o,ref:function(t){e.menu=t},toggler:E,placement:u,toggleEvent:_,stickHover:m},C),{children:[(0,d.BX)(Z.$U,{as:R.sN,zaType:"Button",zaAction:"Share",zaText:!0,className:"ShareMenu-button",onClick:this.copyLink,children:[(0,d.tZ)(p.n,{size:17,className:"ShareMenu-Icon--normal",color:"#9FADC7"}),"复制链接"]}),"live"===a||(0,d.BX)(Z.$U,{as:R.sN,zaType:"Button",zaAction:"Share",zaText:!0,className:"ShareMenu-button",onClick:this.shareToWeibo,children:[(0,d.tZ)(h.kH,{size:17,className:"ShareMenu-Icon--small"}),"新浪微博"]}),(0,d.BX)(R.sN,{tag:"div",className:"ShareMenu-wechat",noActive:!0,children:[(0,d.BX)(k.ZP,{className:"ShareMenu-button",preset:"plain",children:[(0,d.tZ)(f.F3,{size:17,className:"ShareMenu-Icon--small",color:"#60C84D"}),"微信扫一扫"]}),(0,d.tZ)("img",{className:"ShareMenu-qrCode",src:T,alt:"微信二维码"})]}),g]}))]})}}]),n}(I.Component);(0,a._)(M,"propTypes",{toggler:S().node,onTogglerClick:S().func,zaShareId:S().number,willPositivePreload:S().bool}),(0,a._)(M,"defaultProps",{toggler:(0,d.tZ)(k.ZP,{preset:"plain",icon:_.xP,label:"分享"}),onTogglerClick:C(),willPositivePreload:!1}),t.Z=x.Z.isMobileEntry?function(){return null}:(0,b.connect)(function(e,t){var n=t.id,r=t.type,o=e.shareTexts;return{shareText:(null==o?void 0:o["".concat(r).concat(n)])||t.shareText}},{showNotification:D.c0,getShareText:L.kB})(M)},4416:function(e,t,n){"use strict";n.d(t,{n:function(){return s},y:function(){return l}});var r=n(87363),o=n(51070),i=n.n(o),a=n(65733),c=n(4817),s=function(e,t){var n=(0,c.Z)(),o=(0,a.Z)(t);(0,r.useEffect)(function(){if(n){var t=new(i());return t.bind(e,o),function(){t.reset()}}},[o,n,e])},l=function(e){return s(e.input,e.action),null}},97727:function(e,t,n){"use strict";n.d(t,{yW:function(){return r.y},bY:function(){return _},wi:function(){return m}});var r=n(4416),o=n(85879);n(67814);var i=n(87363),a=n.n(i),c=n(94009),s=n(49899),l=n(51070),u=n.n(l),d=n(65733),p=n(4817),h=a().createContext(null),f=function(e,t){var n=(0,p.Z)(),r=(0,i.useContext)(h),o=(0,d.Z)(t);(0,i.useEffect)(function(){if(n&&r)return r.bind(e,o),function(){r.unbind(e)}},[n,r,e,o])},_=function(e){var t=e.input,n=e.action;return f(t,function(e){for(var t,r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];t=e.target,/^(input|textarea|select)$/i.test(t.tagName)||t.isContentEditable||n.apply(void 0,[e].concat((0,s._)(o)))}),null},m=function(e){var t=e.children,n=e.root,r=(0,c._)((0,i.useState)(null),2),a=r[0],s=r[1];return(0,i.useEffect)(function(){if(n){var e=new(u())(n);return s(e),function(){e.reset()}}},[n]),(0,o.tZ)(h.Provider,{value:a,children:t})}},4817:function(e,t,n){"use strict";var r=n(36695);t.Z=function(){return(0,r.useSelector)(function(e){return e.env.enableShortcut})}},49906:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),l=n(85879),u=n(82452),d=n(14168),p=n.n(d),h=n(87363),f=n(31011),_=n(99447),m=n(31467),v=n(17132),g=n.n(v),T=n(16850),E={zhihu:"注册或登录",wechat:"使用微信快速登录",weibo:"使用微博快速登录",qq:"使用 QQ 快速登录"},C={qq:"qqconn",weibo:"sina",wechat:"wechat_mp"},y=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"jumpToOAuthUrl",function(t){var n=e.props.redirectUrl,r=void 0===n?location.href:n,o=(0,u.tL)(r),i=o.utm_source,a=o.utm_medium,c=g()(navigator.userAgent).isZhihu;if("zhihu"===t){location.href=c?"zhihu://signin?next=".concat(r):"https://www.zhihu.com/signin?next=".concat(encodeURIComponent(r)).concat(i?"?utm_source=".concat(i):"");return}location.href="https://www.zhihu.com/oauth/redirect/login/".concat(C[t],"?next=/oauth/account_callback&from=").concat(encodeURIComponent(r),"&utm_source=").concat(i,"&ref_source=").concat(a)}),(0,a._)((0,r._)(e),"renderSignButtons",function(){var t=e.props.buttons;return"string"==typeof t?e.renderSingleSignButton({name:t}):t.map(function(t){return"string"==typeof t?e.renderSingleSignButton({name:t}):"object"==typeof t?e.renderSingleSignButton(t):null})}),(0,a._)((0,r._)(e),"renderSingleSignButton",function(t){var n=t.name,r=t.text,o=t.fill,i=t.color,a="#fff"===o||"#ffffff"===o;return Object.keys(E).includes(n)?(0,l.tZ)("button",{className:"SignInModal-button-".concat(n),style:{backgroundColor:o,borderColor:a?"#0f88eb":o,color:a?"#0f88eb":i},onClick:function(){e.jumpToOAuthUrl(n)},children:r||E[n]},n):null}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.urlScheme,r=e.isMobile,o=this.props.title||"".concat(n?"打开 App 或":"","登录后继续操作"),i=r?f.Z:m.Z;return(0,l.tZ)(i,{size:"small",className:"SignInModal",title:o,onClose:t,children:(0,l.tZ)(_.r,{module:"SignForm",moduleName:o,trackCardShow:!0,children:(0,l.BX)("div",{className:"SignInModal-content",children:[n&&(0,l.tZ)(u.yv,{className:"SignInModal-openInAppButton",href:n,children:"立即打开 App"}),this.renderSignButtons()]})})})}}]),n}(h.Component);(0,a._)(y,"propTypes",{onClose:p().func.isRequired,urlScheme:p().string,redirectUrl:p().string,buttons:p().oneOfType([p().array,p().string])}),(0,a._)(y,"defaultProps",{buttons:["zhihu"]}),t.Z=(0,T.$)()(y)},2174:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(85879),o=n(67814),i=n.n(o);function a(e){var t=e.className;return(0,r.tZ)("span",{className:i()("ActivityItem-StickyMark",t),children:"置顶"})}},14982:function(e,t,n){"use strict";var r=n(85879),o=n(87363),i=n(15103),a=(0,o.forwardRef)(function(e,t){var n=e.fixSections,o=e.onCommand,a=e.queryCommandState,c=e.queryCommandEnable,s=e.editorState;return(0,r.tZ)("div",{className:"fixArea",ref:t,css:{display:"flex"},children:n.map(function(e){return e.items.length>0&&(0,r.tZ)(i.Z,{items:e.items,onCommand:o,queryCommandState:a,queryCommandEnable:c,editorState:s,showDivider:!1,showRightSpace:!1},e.sectionName)})})});t.Z=a},9710:function(e,t,n){"use strict";var r=n(85879),o=n(87363),i=n(15103),a=(0,o.forwardRef)(function(e,t){var n=e.mainSections,o=e.setButtonRectInfo,a=e.onCommand,c=e.queryCommandState,s=e.queryCommandEnable,l=e.editorState;return(0,r.tZ)("div",{className:"mainArea",ref:t,css:{display:"flex",flexShrink:1},children:n.map(function(e,t,n){return e&&n?e.items.length>0&&(0,r.tZ)(i.Z,{sectionIndex:t,onButtonRectInfoGet:o,items:e.items,onCommand:a,queryCommandState:c,queryCommandEnable:s,editorState:l,showDivider:!0,showRightSpace:!0},e.sectionName):null})})});t.Z=a},54713:function(e,t,n){"use strict";var r=n(85879),o=n(87363),i=n(15103),a=(0,o.forwardRef)(function(e,t){var n=e.moreSections,o=e.onCommand,a=e.queryCommandState,c=e.queryCommandEnable,s=e.editorState;return(0,r.tZ)("div",{className:"moreArea",ref:t,css:{display:"flex"},children:n.map(function(e){return e?e.items.length>0&&(0,r.tZ)(i.Z,{items:e.items,onCommand:o,queryCommandState:a,queryCommandEnable:c,editorState:s,showDivider:!1,showRightSpace:!1,replaceIconByOnlyChild:!1,shouldHide:function(e){return e.every(function(e){var t;return(null==e?void 0:null===(t=e.children)||void 0===t?void 0:t.length)===0})}},e.sectionName):null})})});t.Z=a},15103:function(e,t,n){"use strict";n.d(t,{Z:function(){return Z}});var r=n(55164),o=n(57477),i=n(85879),a=n(14168),c=n.n(a),s=n(17103),l=n(32894),u=n(67814),d=n.n(u),p=n(87363),h=n(43384),f=n(38889),_={hover:function(e){return{background:e.colors.GBK10A,borderRadius:"4px"}},isCommandActive:function(e){return{svg:{path:{fill:e.colors.GBL01A}},".togglerIcon":{borderLeftColor:e.colors.GBL01A},color:e.colors.GBL01A}}},m=(0,p.forwardRef)(function(e,t){var n=e.showTogglerIcon,a=e.isMenuOpen,c=e.icon,u=e.isActive,m=e.disabled,v=e.onClick,g=e.className,T=e.text,E=e.label,C=e.sectionIndex,y=e.buttonIndex,S=e.onButtonRectInfoGet,I=(0,p.useRef)(null);(0,p.useEffect)(function(){var e,t=(null===(e=I.current)||void 0===e?void 0:e.getBoundingClientRect()).right;t&&(null==S||S({label:E,sectionIndex:C,buttonIndex:y,right:t}))},[C,y]);var b=n&&(0,i.tZ)("div",{className:"togglerIcon",css:{transform:"".concat(a?"rotate(180deg)":"rotate(0deg)"),fontSize:0,marginBottom:"2px"},children:(0,i.tZ)(l.r,{})});return(0,i.BX)(h.$U,{as:f.ZP,zaType:"Button",zaText:E,ref:(0,s.Z)(t,I),preset:f.EE.Plain,className:d()("ToolbarButton",g),disabled:m,css:function(e){return{"&.Button.Button--plain":(0,o._)((0,r._)({marginRight:"20px",padding:"2px 4px",paddingRight:n?"1px":"4px",fontSize:"11px",color:e.colors.GBK03A,textAlign:"center",alignItems:"flex-end",display:"flex",whiteSpace:"nowrap"},u&&_.isCommandActive(e)),{"&:hover":_.hover(e)})}},"aria-label":E,onClick:v,children:[(0,i.BX)("div",{css:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,i.tZ)(c,{center:!0}),(0,i.tZ)("span",{css:{width:"100%"},children:null!=T?T:E})]}),b]})});m.propTypes={icon:c().elementType.isRequired,label:c().string.isRequired,isActive:c().bool,disabled:c().bool,showTogglerIcon:c().bool,isMenuOpen:c().bool,className:c().string,text:c().string,shortcut:c().string,onClick:c().func,sectionIndex:c().number,buttonIndex:c().number,onButtonRectInfoGet:c().func},m.defaultProps={isActive:!1,disabled:!1,isMenuOpen:!1,showTogglerIcon:!1,onClick:function(){}};var v=n(94009),g=n(1733),T=n(4526),E={hover:function(e){return{background:e.colors.GBK10A,".togglerIcon":{borderLeftColor:e.colors.GBL01A}}},isCommandActive:function(e){return{svg:{path:{fill:e.colors.GBL01A}},".togglerIcon":{borderLeftColor:e.colors.GBL01A},color:e.colors.GBL01A}}},C=(0,p.forwardRef)(function(e,t){var n=e.isActive,o=e.disabled,a=e.onClick,c=e.icon,s=e.text,l=e.label,u=e.onMouseEnter,d=e.onMouseLeave,p=e.component;return p?(0,i.tZ)(p,(0,r._)({},e)):(0,i.BX)(h.$U,{as:f.ZP,zaType:"Button",zaText:l,preset:f.EE.Plain,"aria-label":l,disabled:o,css:function(e){return{"&.Button.Button--plain":(0,r._)({padding:"12px 20px",display:"flex",alignItems:"center",color:e.colors.GBK03A,width:"100%",boxSizing:"border-box",whiteSpace:"nowrap",borderRadius:"4px","&:hover":E.hover(e),"&:active":E.isCommandActive(e)},n&&E.isCommandActive(e))}},onClick:a,onMouseEnter:u,onMouseLeave:d,ref:t,children:[(0,i.tZ)(c,{center:!0,css:{marginRight:"4px"}}),null!=s?s:l]})});function y(e,t,n){return!!n&&((null==e?void 0:e.children)?e.children.find(function(e){return y(e,t,n)}):e.commandName?t(e.commandName,n)&&e:void 0)}function S(e,t,n){return!!n&&((null==e?void 0:e.children)?e.children.some(function(e){return S(e,t,n)}):t(e.commandName,n))}function I(e){var t=e.items,n=e.onCommand,r=e.queryCommandState,o=e.queryCommandEnable,a=e.editorState;return t.map(function(e){if(!0===e.hide)return null;var t,c,s,l=y(e,r,a),u=!S(e,o,a);return(null==e?void 0:null===(t=e.children)||void 0===t?void 0:t.length)?(0,i.tZ)(g.ZP,{toggleEvent:"hover",placement:T.RIGHT,enterDelay:300,leaveDelay:300,toggler:(0,i.tZ)(C,{icon:null!==(c=null==l?void 0:l.icon)&&void 0!==c?c:e.icon,onClick:function(t){var r;null===(r=e.onClick)||void 0===r||r.call(e,t),e.commandName&&n(e.commandName)},label:e.label,isActive:!!l,disabled:u}),className:"ToolbarV3SubmenuButton",children:(0,i.tZ)(I,{items:e.children,onCommand:n,queryCommandState:r,queryCommandEnable:o,editorState:a})},e.label):(0,i.tZ)(C,{icon:null!==(s=null==l?void 0:l.icon)&&void 0!==s?s:e.icon,onClick:function(t){var r;null===(r=e.onClick)||void 0===r||r.call(e,t),e.commandName&&n(e.commandName),e.hideMenuOnClick&&document.body.click()},label:e.label,isActive:!!l,disabled:u,component:e.Component},e.label)})}function b(e){var t=e.subMenu,n=e.onCommand,r=e.queryCommandState,o=e.queryCommandEnable,a=e.editorState,c=e.isActive,s=e.label,l=e.shortcut,u=e.disabled,d=e.onClick,h=e.icon,f=e.sectionIndex,_=e.buttonIndex,T=e.onButtonRectInfoGet,E=(0,v._)((0,p.useState)(!1),2),C=E[0],y=E[1],S=(0,i.tZ)(m,{isMenuToggler:!0,isMenuOpen:C,showTogglerIcon:!0,icon:h,isActive:c,disabled:u,shortcut:l,onClick:d,label:s,sectionIndex:f,buttonIndex:_,onButtonRectInfoGet:T});return(0,i.tZ)(g.ZP,{toggler:S,onOpen:function(){return y(!0)},onClose:function(){return y(!1)},arrowed:!1,menuContainerClassName:"ToolbarV3Menu-container",preventCloseOnTarget:!0,children:(0,i.tZ)(I,{items:t,onCommand:n,queryCommandState:r,queryCommandEnable:o,editorState:a})})}function A(){return(0,i.tZ)("span",{className:"ToolbarDivider",css:function(e){return{height:"20px",borderRight:"1px solid",borderColor:e.colors.GBK09A,marginLeft:"-4px"}}})}function Z(e){var t=e.items,n=e.onCommand,a=e.queryCommandState,c=e.queryCommandEnable,s=e.editorState,l=e.showDivider,u=e.showRightSpace,d=e.replaceIconByOnlyChild,p=void 0===d||d,h=e.shouldHide,f=e.sectionIndex,_=e.onButtonRectInfoGet;return(null==h?void 0:h(t))?null:(0,i.BX)("div",{className:"toolbar-section",css:(0,r._)({display:"flex",alignItems:"center"},u&&{marginRight:"16px"}),children:[t.filter(function(e){return!!e}).map(function(e,t){var l,u=e.Component,d=e.label,h=e.text,v=e.children,g=e.shortcut,T=e.commandName,E=e.onClick;if(!0===e.hide)return null;var C=y(e,a,s),I=!S(e,c,s),A=e.icon,Z={label:d,icon:A,disabled:I,shortcut:g,isActive:!!C,text:h,sectionIndex:f,buttonIndex:t,onButtonRectInfoGet:_,onClick:function(e){null==E||E(e),T&&n(T)}};if((null==v?void 0:v.length)>1||!p&&(null==v?void 0:v.length)>0)A=(null==C?void 0:C.icon)||A,l=b,Z=(0,o._)((0,r._)({},Z),{icon:A,onCommand:n,queryCommandState:a,queryCommandEnable:c,editorState:s,subMenu:v});else if((null==v?void 0:v.length)===1&&p){l=m;var w=v[0],R=w.icon,N=w.label,k=w.text,O=w.shortcut,x=w.commandName;Z=(0,o._)((0,r._)({},Z),{icon:R,label:N,text:k,shortcut:O,onClick:function(e){null==E||E(e),x&&n(x)}})}else l=m;return u?(0,i.tZ)(u,(0,r._)({toolbarButton:l},Z),e.label):(0,i.tZ)(l,(0,r._)({},Z),e.label)}),l&&(0,i.tZ)(A,{})]})}C.propTypes={icon:c().elementType.isRequired,label:c().string.isRequired,isActive:c().bool,disabled:c().bool,className:c().string,text:c().string,shortcut:c().string,onClick:c().func,onMouseEnter:c().func,onMouseLeave:c().func},C.defaultTypes={isActive:!1,disabled:!1,onClick:function(){},onMouseEnter:function(){},onMouseLeave:function(){}},I.propTypes={items:c().arrayOf(c().oneOfType([c().object,c().bool])).isRequired,onCommand:c().func.isRequired,queryCommandState:c().func.isRequired,queryCommandEnable:c().func.isRequired,editorState:c().object.isRequired},b.propTypes={icon:c().elementType.isRequired,subMenu:c().arrayOf(c().oneOfType([c().object,c().bool])).isRequired,label:c().string.isRequired,onCommand:c().func.isRequired,queryCommandEnable:c().func.isRequired,queryCommandState:c().func.isRequired,editorState:c().object.isRequired,shortcut:c().string,disabled:c().bool,isActive:c().bool,onClick:c().func,sectionIndex:c().number,buttonIndex:c().number,onButtonRectInfoGet:c().func},b.defaultTypes={disabled:!1,isActive:!1,onClick:function(){}},Z.propTypes={items:c().arrayOf(c().oneOfType([c().object,c().bool])).isRequired,onCommand:c().func.isRequired,queryCommandState:c().func.isRequired,queryCommandEnable:c().func.isRequired,shouldHide:c().func,editorState:c().object.isRequired,showDivider:c().bool.isRequired,showRightSpace:c().bool.isRequired,isMoreSection:c().bool,sectionIndex:c().number,replaceIconByOnlyChild:c().bool,onButtonRectInfoGet:c().func}},92061:function(e,t,n){"use strict";var r=n(85879),o=n(87363),i=n(67814),a=n.n(i),c=n(43384),s=(0,o.forwardRef)(function(e,t){var n=e.children,o=e.className;return(0,r.tZ)(c.eV,{block:"EditorToolbar",children:(0,r.tZ)("div",{ref:t,css:{width:"100%",display:"flex",justifyContent:"center"},children:(0,r.tZ)("div",{className:a()("toolbarV3",o),css:{display:"flex",overflowX:"auto",padding:"10px 0 10px 20px",boxShadow:"0px -0.5px 0px 0px rgba(235, 235, 235, 1) inset"},onMouseDown:function(e){return e.preventDefault()},children:n})})})});t.Z=s},18341:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(85879),o=n(92061),i=n(9710),a=n(54713),c=n(14982),s=n(94009),l=n(95951),u=n(65733),d=n(7835),p=n(86105),h=n(87363);function f(e){var t,n,f,_,m,v,g,T,E,C,y,S,I,b,A,Z,w,R,N,k,O=e.onCommand,x=e.queryCommandState,P=e.queryCommandEnable,D=e.editorState,L=e.toolbarMainAreaData,B=e.toolbarMoreAreaData,U=e.toolbarFixtureAreaData,M=e.className,G=(n=(t={toolbarMainAreaData:L,toolbarMoreAreaData:B}).toolbarMainAreaData,f=t.toolbarMoreAreaData,m=(_=(0,s._)((0,h.useState)(function(){return[(0,p.fromJS)(n),(0,p.fromJS)(f)]}),2))[0],v=_[1],T=(g=(0,s._)((0,h.useState)(!1),2))[0],E=g[1],y=(C=(0,s._)((0,l.Z)(),2))[0],S=C[1],I=(0,h.useRef)(null),b=(0,h.useRef)(null),A=(0,h.useRef)(null),Z=(0,h.useRef)(0),w=(0,u.Z)(function(e){e&&(I.current=e,Z.current=e.offsetLeft)}),R=(0,h.useRef)([]),N=(0,u.Z)(function(e){var t=e.label,n=e.sectionIndex,r=e.buttonIndex,o=e.right;R.current.push({label:t,right:o,sectionIndex:n,buttonIndex:r}),R.current=R.current.sort(function(e,t){var n=e.sectionIndex,r=e.buttonIndex,o=t.sectionIndex,i=t.buttonIndex;return n>o?-1:n<o?1:r>i?-1:r<i?1:0})}),k=(0,u.Z)(function(){var e=null==S?void 0:S.width,t=null==I?void 0:null===(o=I.current)||void 0===o?void 0:o.getBoundingClientRect().width,n=(null==b?void 0:null===(i=b.current)||void 0===i?void 0:i.getBoundingClientRect().width)||0,r=null==A?void 0:null===(a=A.current)||void 0===a?void 0:a.getBoundingClientRect().width;if(e&&t&&void 0!==n&&r){var o,i,a,c,l=e-n-r,u=null===(c=R.current)||void 0===c?void 0:c.find(function(e){return l>e.right-Z.current});if(u){var d=u.sectionIndex,p=u.buttonIndex,h=d,f=p;d<3&&(h=3),(d<3||p<1)&&(f=1);var _=(0,s._)(m,2),g=_[0],T=_[1],C=g.getIn([h,"items"]),y=T.getIn([0,"items",0,"children"]),w=C.concat(y),N=w.slice(0,f+1),k=w.slice(f+1);v([g.setIn([h,"items"],N),T.setIn([0,"items",0,"children"],k)])}}E(!1)}),(0,h.useEffect)(function(){v([(0,p.fromJS)(n),(0,p.fromJS)(f)]),E(!0)},[n]),(0,h.useEffect)(function(){T&&k()},[T]),(0,h.useEffect)(function(){E(!0)},[S]),(0,d.Z)(function(){E(!0)}),{mainSections:m[0].toJS(),moreSections:m[1].toJS(),setToolbarRef:y,setMainAreaRef:w,moreAreaRef:b,fixAreaRef:A,setButtonRectInfo:N}),F=G.mainSections,z=G.moreSections,H=G.setToolbarRef,q=G.setMainAreaRef,V=G.moreAreaRef,X=G.fixAreaRef,W=G.setButtonRectInfo;return(0,r.BX)(o.Z,{ref:H,className:M,children:[(0,r.tZ)(i.Z,{ref:q,mainSections:F,setButtonRectInfo:W,onCommand:O,queryCommandState:x,queryCommandEnable:P,editorState:D}),(0,r.tZ)(c.Z,{ref:X,fixSections:U,queryCommandEnable:P,queryCommandState:x,onCommand:O,editorState:D}),(0,r.tZ)(a.Z,{ref:V,queryCommandState:x,queryCommandEnable:P,editorState:D,onCommand:O,moreSections:z})]})}},62317:function(e,t,n){"use strict";n.d(t,{Z:function(){return C}});var r=n(20857),o=n(22107),i=n(94707),a=n(86325),c=n(85626),s=n(85879),l=n(67814),u=n.n(l),d=n(14168),p=n.n(d),h=n(87363),f=n(17002),_=n(87320),m=n(55164),v=n(57477),g=n(71728),T=function(e){(0,a._)(n,e);var t=(0,c._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.position,n=e.preset,r=e.restricted,o=e.className,i=e.childrenClassName,a=e.children,c=(0,g._)(e,["position","preset","restricted","className","childrenClassName","children"]);return(0,s.tZ)("div",{className:"TooltipContent-wrapper",children:(0,s.BX)("div",(0,v._)((0,m._)({className:u()("TooltipContent","TooltipContent--".concat(t),"TooltipContent--".concat(n),o)},c),{children:[(0,s.tZ)("div",{className:"TooltipContent-arrow"}),(0,s.tZ)("div",{className:u()("TooltipContent-children",i,{"TooltipContent-children--restricted":r}),children:a})]}))})}}]),n}(h.Component);(0,_._)(T,"propTypes",{position:p().oneOf(["top","bottom","left","right"]),preset:p().oneOf(["black","white"]),restricted:p().bool,className:p().string,childrenClassName:p().string,children:p().node}),(0,_._)(T,"defaultProps",{position:"top",preset:"black",restricted:!0});var E=function(e){(0,a._)(n,e);var t=(0,c._)(n);function n(){var e;return(0,o._)(this,n),(e=t.call(this)).handleBodyClick=e.handleBodyClick.bind((0,r._)(e)),e.hideOnNextClick=!1,e}return(0,i._)(n,[{key:"componentDidMount",value:function(){this.props.hideOnClick&&document.body.addEventListener("click",this.handleBodyClick)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.timeout,r=t.hideOnClick,o=t.onClose;!this.props.shown&&e.shown&&(r&&(this.hideOnNextClick=!0),-1!==n&&(this.timeoutId=setTimeout(function(){o&&o()},n))),this.props.shown&&!e.shown&&this.reset()}},{key:"componentWillUnmount",value:function(){this.reset(),this.props.hideOnClick&&document.body.removeEventListener("click",this.handleBodyClick)}},{key:"handleBodyClick",value:function(){this.hideOnNextClick&&(this.reset(),this.props.onClose&&this.props.onClose())}},{key:"reset",value:function(){this.hideOnNextClick=!1,clearTimeout(this.timeoutId)}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.contentClassName,r=e.contentChildrenClassName,o=e.preset,i=e.restricted,a=e.shown,c=e.x,l=e.y,d=e.position,p=e.content,h=e.children;return(0,s.tZ)(f.Z,{transitionName:"Tooltip",timeout:300,children:a&&(0,s.tZ)("div",{style:{left:c,top:l},className:u()("Tooltip",t),children:(0,s.tZ)(T,{className:n,childrenClassName:r,position:d,preset:o,restricted:i,children:p||h})},JSON.stringify({x:c,y:l}))})}}]),n}(h.Component);E.propTypes={position:T.propTypes.position,preset:T.propTypes.preset,restricted:T.propTypes.restricted,className:p().string,contentClassName:p().string,contentChildrenClassName:p().string,shown:p().bool,timeout:p().number,hideOnClick:p().bool,onClose:p().func,content:p().node,x:p().number,y:p().number},E.defaultProps={position:T.defaultProps.position,preset:T.defaultProps.preset,restricted:T.defaultProps.restricted,shown:!0,timeout:-1,hideOnClick:!1};var C=E},57177:function(e,t,n){"use strict";n.d(t,{Z:function(){return L}});var r=n(22107),o=n(94707),i=n(87320),a=n(86325),c=n(55164),s=n(57477),l=n(71728),u=n(85626),d=n(85879),p=n(55698),h=n(72111),f=n(67814),_=n.n(f),m=n(14168),v=n.n(m),g=n(87363),T=n(36695),E=n(93206),C=n(7407),y=n(20857),S=n(77236),I=n(69383),b=n(87038),A=n(30722),Z=n(38889),w=n(91770),R=n(66263),N=n(85576),k=n(76741),O=n(31142),x=function(e){(0,a._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,r._)(this,n),e=t.apply(this,arguments),(0,i._)((0,y._)(e),"load",function(){var t=e.props,n=t.dispatch,r=t.id;n((0,k.hX)(r))}),(0,i._)((0,y._)(e),"track",function(){var t=e.props.topic;e.hoverCardElement&&t&&(I.Z.setModule(e.hoverCardElement,{module:"TopicItem"},{card:{content:{type:"Topic",token:t.id,item_num:t.questionsCount,follower_num:t.followersCount}}}),I.Z.trackCardShow(e.hoverCardElement))}),(0,i._)((0,y._)(e),"handleFollow",e.props.authRequired(function(){var t=!e.props.topic.isFollowing;I.Z.trackEvent(e.hoverCardElement,{action:t?"Follow":"UnFollow",element:"Button"});var n=e.props,r=n.dispatch,o=n.id;r((0,k.KS)(o))},R.q0.follow)),(0,i._)((0,y._)(e),"handleOpen",function(){e.load(),e.track()}),e}return(0,o._)(n,[{key:"isTopicReady",value:function(){var e=this.props.topic||{},t=e.questionsCount,n=e.followersCount,r=e.bestAnswersCount;return!(void 0===t&&void 0===n&&void 0===r)}},{key:"render",value:function(){var e=this,t=this.props,n=t.toggler,r=t.topic,o=t.id,i=t.isLoading,a=t.onRef,u=(0,l._)(t,["toggler","topic","id","isLoading","onRef"]),p=r||{},h=p.name,f=p.introduction,_=p.totalPv,m=p.discussCount,v=p.bestAnswersCount,g=p.avatarUrl,T=p.isFollowing,E=p.headerCard,C="//www.zhihu.com/topic/".concat(o),y=E&&E.avatarUrl||g;return(0,d.BX)(S.Z,(0,s._)((0,c._)({toggler:n,preventCloseOnTarget:!0,isLoading:i,onOpen:this.handleOpen,size:"large"},u),{ref:function(t){a&&"function"==typeof a&&a(t),e.hoverCardElement=t},children:[(0,d.tZ)(S.O,{title:(0,d.tZ)("a",{target:"_blank",rel:"noopener noreferrer",href:C,children:h}),avatarUrl:y,avatarFit:"cover"}),f&&(0,d.tZ)("div",{children:(0,d.tZ)(b.Z,{className:"HoverCard-description",html:f})}),(0,d.BX)("div",{children:[this.isTopicReady()&&(0,d.BX)(w.Z,{children:[(0,d.tZ)(w.Z.Item,{tag:O.Z,preset:"plain",a:!0,to:"".concat(C,"/questions"),name:"浏览量",value:(0,A.Zh)(Number(_)),isFormatted:!0,target:"_blank"}),(0,d.tZ)(w.Z.Item,{tag:O.Z,preset:"plain",a:!0,to:"".concat(C,"/top-answers"),name:"精华",value:v,target:"_blank"}),(0,d.tZ)(w.Z.Item,{tag:O.Z,preset:"plain",a:!0,to:"".concat(C,"/followers"),name:"讨论量",target:"_blank",value:(0,A.Zh)(Number(m)),isFormatted:!0})]}),(0,d.tZ)("div",{className:"HoverCard-buttons",children:r&&(0,d.tZ)(Z.ZP,{preset:"primary",color:T?"grey":"blue",onClick:this.handleFollow,children:T?"已关注":"关注话题"})})]})]}))}}]),n}(g.Component),P=(0,E.compose)(N.Z,(0,T.connect)(function(e,t){var n=t.id,r=e.entities.topics,o=e.loading.local;return{topic:r[n],isLoading:!!o["topic/".concat(n)]}}))(x),D=function(e){(0,a._)(n,e);var t=(0,u._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"render",value:function(){var e,t=this.props,n=t.isMobile,r=t.topic,o=r.name,i=r.avatarUrl,a=r.id,u=r.headerCard,f=t.avatar,m=t.avatarProps,v=t.noHoverCard,g=t.noLink,T=t.style,E=t.className,C=t.children,y=(t.dispatch,t.trackEvent,(0,l._)(t,["isMobile","topic","avatar","avatarProps","noHoverCard","noLink","style","className","children","dispatch","trackEvent"])),S=u&&u.avatarUrl||i;e=f?(0,d.tZ)(p.qE,(0,c._)({className:"TopicLink-avatar",url:S,alt:o},m)):C||o,g||(void 0===v?n:v)||(e=(0,d.tZ)(P,{toggler:e,id:a}));var I=g?"span":h.pl;return(0,d.tZ)(I,(0,s._)((0,c._)({style:T,className:_()("TopicLink",E),href:"//www.zhihu.com/topic/".concat(a),target:"_blank",as:g?"":"a",zaBlock:"TopicLink"},y),{children:e}))}}]),n}(g.Component);(0,i._)(D,"propTypes",{topic:v().object.isRequired,user:v().object,avatar:v().bool,avatarProps:v().object,noHoverCard:v().bool,noLink:v().bool,style:v().object,className:v().string,children:v().node}),(0,i._)(D,"defaultProps",{avatar:!1,noLink:!1});var L=(0,E.compose)((0,T.connect)(function(e){return{isMobile:(0,C.Hu)(e,{includeTablet:!0})}}))(D)},48710:function(e,t,n){"use strict";n.d(t,{OP:function(){return p},SS:function(){return h}});var r=n(55164),o=n(94009),i=n(85879),a=n(84871),c=n.n(a),s=n(87363),l=n(42559),u=n.n(l),d=(0,s.createContext)(null),p=function(){return(0,s.useContext)(d)},h=function(e){return c()(function(t){var n=p();return(0,i.tZ)(e,(0,r._)({traceId:n},t))},e)};t.ZP=function(e){var t=e.children,n=(0,o._)((0,s.useState)(function(){return u()()}),1)[0];return(0,i.tZ)(d.Provider,{value:n,children:t})}},73596:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(87363),s=n(14168),l=n.n(s),u=n(87038),d=n(60414),p=n(27258);function h(e){var t,n=e.user,s=e.noHeadline,l=(0,i._)(e,["user","noHeadline"]),h=n.headline,f=n.isOrg,_=n.subTitle,m=(0,c.useMemo)(function(){return(0,d.TE)(n.badgeV2||n.badge)},[n]),v=m.identity,g=m.bestAnswerer,T=m.baike,E=m.title;return _||E?(0,a.tZ)(u.Z,(0,r._)({html:_||E},l)):!f&&(null==g?void 0:null===(t=g.topics)||void 0===t?void 0:t.length)?(0,a.BX)("div",(0,o._)((0,r._)({},l),{children:[(0,a.tZ)(p.Z,{topics:g.topics,user:n}),"的优秀答主"]})):v?(0,a.tZ)("div",(0,o._)((0,r._)({},l),{children:v[0].description})):T?(0,a.tZ)("div",(0,o._)((0,r._)({},l),{children:T.description})):h&&!s?(0,a.tZ)(u.Z,(0,r._)({html:h},l)):null}h.propTypes={user:l().object.isRequired,noHeadline:l().bool},t.Z=(0,c.memo)(h)},73831:function(e,t,n){"use strict";n.d(t,{Z:function(){return E}});var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(36695),s=n(29229),l=n(7407),u=n(72111),d=n(65733),p=n(88329),h=n.n(p),f=n(87363),_=n(19076),m=n(69383),v=n(59590),g=(0,f.forwardRef)(function(e,t){var n=e.isPinProfile,c=e.user,s=e.isPinDaily,l=e.onClick,p=void 0===l?h():l,f=e.children,g=(0,i._)(e,["isPinProfile","user","isPinDaily","onClick","children"]),T=c.id,E=c.urlToken,C=c.isOrg,y=c.url,S=c.maskLevel,I="//www.zhihu.com/".concat(C?"org":"people","/").concat(E||T),b="zhihu://pin".concat(y,"/moments"),A=(0,d.Z)(function(e){s&&"A"===e.target.nodeName&&m.Z.trackEvent(e.target,{id:2065}),n&&(e.preventDefault(),(0,v.Z)("base/openURL").dispatch({url:b})),S&&e.preventDefault(),p(e)});return(0,a.tZ)(u._o,{zaText:!0,zaBlock:"User",zaModuleId:"author_portrait_text_button",children:(0,a.tZ)(_.Link,(0,o._)((0,r._)({ref:t,to:I,href:I,target:"_blank",onClick:A,className:"UserLink-link","data-za-detail-view-element_name":"User"},g),{children:f}))})}),T=n(80445),E=function(e){var t=e.user,u=e.noHoverCard,d=e.noLink,p=e.children,h=(0,i._)(e,["user","noHoverCard","noLink","children"]),f=t.id,_=t.urlToken,m=(0,T.e)(t),v=(0,c.useSelector)(function(e){return(0,l.Hu)(e,{includeTablet:!0})}),E=null!=u?u:v,C=(0,s.Z)(function(){return Promise.all([n.e(584),n.e(4667),n.e(9597)]).then(n.bind(n,93285))},!E);if(!m||d)return p||null;var y=(0,a.tZ)(g,(0,o._)((0,r._)({},h),{user:t,children:p}));return E||!C?y:(0,a.tZ)(C,{toggler:y,id:f,urlToken:_,user:t})}},50494:function(e,t,n){"use strict";var r=n(22107),o=n(94707),i=n(87320),a=n(86325),c=n(85626),s=n(85879),l=n(14168),u=n.n(l),d=n(87363),p=n(36695),h=n(20072),f=n(69383),_=function(e){(0,a._)(n,e);var t=(0,c._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"componentDidMount",value:function(){var e=this.props.zaViewName;(0,h.y3)(this.node,function(){f.Z.trackCardShow(null,{id:3613,name:e})})}},{key:"render",value:function(){var e=this,t=this.props,n=t.theme,r=t.zaViewName,o=t.vipIcon,i=o.nightModeUrl,a=o.url;return(0,s.tZ)("a",{className:"UserLink-vipIcon",href:"https://www.zhihu.com/vip",target:"_blank",rel:"noopener noreferrer",ref:function(t){return e.node=t},"data-za-detail-view-id":3612,"data-za-detail-view-name":r,children:(0,s.tZ)("img",{src:"light"===n?a:i,alt:"zhihu vip"})})}}]),n}(d.Component);(0,i._)(_,"propTypes",{vipIcon:u().shape({nightModeUrl:u().string,url:u().string}).isRequired,zaViewName:u().string}),t.Z=(0,p.connect)(function(e){return{theme:e.env.theme}})(_)},85661:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(55698),s=n(60414),l=n(29229),u=n(67814),d=n.n(u),p=n(92769),h=n.n(p),f=n(14168),_=n.n(f),m=n(36695),v=n(19076),g=n(69383),T=n(59590),E=n(7407),C=n(50494),y=n(80445),S=function(e){var t,u,p=e.isPinProfile,f=e.onClick,_=e.isPinDaily,S=e.user,I=e.avatar,b=e.avatarProps,A=e.showVipIcon,Z=e.vipIconZaViewName,w=e.badgeProps,R=e.noBadge,N=e.noLink,k=e.noHoverCard,O=e.style,x=e.className,P=e.children,D=(0,i._)(e,["isPinProfile","onClick","isPinDaily","user","avatar","avatarProps","showVipIcon","vipIconZaViewName","badgeProps","noBadge","noLink","noHoverCard","style","className","children"]),L=(0,m.useSelector)(function(e){return(0,E.Hu)(e,{includeTablet:!0})}),B=S.id,U=S.name,M=S.avatarUrl,G=S.urlToken,F=S.isOrg,z=S.vipInfo,H=S.url,q=S.maskLevel,V=void 0===k?L:k,X=(0,l.Z)(function(){return Promise.all([n.e(584),n.e(4667),n.e(9597)]).then(n.bind(n,93285))},!V&&!L);u=I?(0,a.tZ)(c.qE,(0,r._)({className:"UserLink-avatar",url:M,alt:U},b)):P||U;var W=!!(0,y.e)(S),K="//www.zhihu.com/".concat(F?"org":"people","/").concat(G||B);return W&&!N&&(u=(0,a.tZ)(v.Link,(0,o._)((0,r._)({className:"UserLink-link","data-za-detail-view-element_name":"User",to:K,target:"_blank",onClick:(t="zhihu://pin".concat(H,"/moments"),function(e){_&&"A"===e.target.nodeName&&g.Z.trackEvent(e.target,{id:2065}),p&&(e.preventDefault(),(0,T.Z)("base/openURL").dispatch({url:t})),q&&e.preventDefault(),f&&"function"==typeof f&&f(e)})},h()(D,["isPinProfile","trackEvent","onClick","dispatch","isPinDaily"])),{children:u})),!V&&X&&(u=(0,a.tZ)(X,{toggler:u,id:B,urlToken:G,user:S}))),(0,a.BX)("span",{style:O,className:d()("UserLink",x),children:[u,W&&!R&&!I&&(0,a.tZ)(s.Vh,(0,r._)({css:{marginLeft:".3em"},isOrg:F,badge:S.badgeV2||S.badge,linkify:!0,enableTooltip:!0,useNew:!0},w)),W&&A&&!I&&z&&z.vipIcon&&(0,a.tZ)(C.Z,{vipIcon:z.vipIcon,zaViewName:Z})]})};S.propTypes={user:_().object.isRequired,avatar:_().bool,avatarProps:_().object,noBadge:_().bool,noHoverCard:_().bool,showVipIcon:_().bool,style:_().object,className:_().string,children:_().node,isPinProfile:_().bool,isPinDaily:_().bool},S.defaultProps={avatar:!1,noBadge:!1,showVipIcon:!1},t.Z=S},80445:function(e,t,n){"use strict";function r(e){var t=e.id,n=e.urlToken;return"0"===t?null:!!(n||t)}n.d(t,{e:function(){return r}})},94226:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(55698),s=n(67814),l=n.n(s),u=n(73831);function d(e){var t=e.className,n=e.user,s=void 0===n?{}:n,d=e.avatarProps,p=void 0===d?{}:d,h=(0,i._)(e,["className","user","avatarProps"]),f=s.name,_=s.avatarUrl;return(0,a.tZ)("span",{className:l()("UserLink",t),children:(0,a.tZ)(u.Z,(0,o._)((0,r._)({},h),{user:s,children:(0,a.tZ)(c.qE,(0,r._)({className:"UserLink-avatar",url:_,alt:f},p))}))})}},94785:function(e,t,n){"use strict";n.d(t,{Z:function(){return C}});var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(60414),s=n(67814),l=n.n(s);n(22107),n(94707),n(86325),n(85626);var u=n(87363);u.Component;var d=n(24405),p=n(64386),h=n(14583),f=n(43384),_=n(16850),m=function(e){var t=e.vipIcon,n=e.imageToken,r=e.nightModeToken,o=(0,d.F)().isDarkMode,i=t||{},a=i.url,c=i.nightModeUrl;return o?r?"https://picx.zhimg.com/".concat(r):c:n?"https://picx.zhimg.com/".concat(n):a},v=(0,u.memo)(function(e){var t=e.vipInfo,n=(0,i._)(e,["vipInfo"]),c=m(t),s=(0,_.Z)();return(0,a.BX)(f.$U,(0,o._)((0,r._)({as:"span",rel:"noopener noreferrer",zaBlock:"VipBadge",zaType:"Button",zaEventType:"Click",onClick:function(){s?window.location.href=" https://www.zhihu.com/xen/market/vip-privileges":p.Z.show()},css:{cursor:"pointer",display:"inline-flex",alignItems:"center"}},n),{children:["​",c?(0,a.tZ)("img",{src:c,alt:"",css:{width:"1em",height:"1em"}}):(0,a.tZ)(h.Z,{css:{height:"1em",width:"1em"}})]}))}),g=n(73831),T=n(50494),E=n(80445);function C(e){var t,n,s=e.className,u=e.showVipIcon,d=e.vipIconZaViewName,p=e.user,h=void 0===p?{}:p,f=e.noBadge,_=e.noVipBadge,m=e.children,C=e.badgeProps,y=void 0===C?{}:C,S=(0,i._)(e,["className","showVipIcon","vipIconZaViewName","user","noBadge","noVipBadge","children","badgeProps"]),I=(0,E.e)(h),b=(null===(t=h.vipInfo)||void 0===t?void 0:t.isVip)&&!(void 0!==_&&_),A=I&&u&&(null===(n=h.vipInfo)||void 0===n?void 0:n.vipIcon);return(0,a.BX)("span",{className:l()("UserLink",s),children:[(0,a.tZ)(g.Z,(0,o._)((0,r._)({},S),{user:h,children:m||h.name})),I&&!f&&(0,a.tZ)(c.Vh,(0,r._)({css:{marginLeft:".3em"},isOrg:h.isOrg,badge:h.badgeV2||h.badge,linkify:!0,enableTooltip:!0,useNew:!0},y)),b&&(0,a.tZ)(v,{vipInfo:h.vipInfo,css:{marginLeft:".3em"}}),A&&(0,a.tZ)(T.Z,{vipIcon:h.vipInfo.vipIcon,zaViewName:d})]})}},93445:function(e,t,n){"use strict";n.d(t,{Z:function(){return W}});var r=n(94009),o=n(85879),i=n(10087),a=n(75798),c=n(65733),s=n(58338),l=n(6080),u=n(68159),d=n(87363),p=n.n(d),h=n(9338),f=n(30971),_=n(95951),m=n(80714),v=n(81956),g=n(29229),T=n(43384),E={width:null},C=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"px";if(E.width)return t?"".concat(E.width/1920*e).concat(t," "):E.width/1920*e},y=function(e){var t=e.src;return(0,o.tZ)("div",{css:{margin:"auto 0",width:C(240),height:C(240),borderRadius:C(240),position:"absolute",left:"50%",transform:"translate(-50%,0)",backgroundColor:"#eee",fontSize:0},children:t&&(0,o.tZ)("img",{width:"100%",css:{borderRadius:C(240)},src:t,alt:"头像"})})},S=n(55164),I=n(71728),b=n(87641),A=n(4667),Z=n.n(A)()(function(){return new Promise(function(e){return requestAnimationFrame(function(){return setTimeout(e)})})}),w=function(){var e=(0,r._)((0,d.useState)(!1),2),t=e[0],n=e[1];return(0,d.useEffect)(function(){Z().then(function(){return n(!0)})},[]),t},R=(0,d.forwardRef)(function(e,t){var r=e.renderer,i=void 0===r?"svg":r,a=e.loop,c=void 0===a||a,s=e.autoplay,l=void 0===s||s,u=e.data,p=e.src,h=(0,I._)(e,["renderer","loop","autoplay","data","src"]),f=(0,d.useRef)(),_=(0,g.Z)(function(){return n.e(6018).then(n.t.bind(n,83476,23))},w());return(0,d.useImperativeHandle)(t,function(){return{get lottie(){return _}}}),(0,d.useEffect)(function(){_&&_.loadAnimation({container:f.current,renderer:i,loop:c,autoplay:l,animationData:u,path:p})},[_]),(0,o.tZ)(b.Box,(0,S._)({ref:f},h))}),N=function(e){var t=e.showKanShan,n=e.src;return(0,o.tZ)("div",{css:{position:"absolute",top:C(-120),left:C(100),backgroundColor:"#000",width:C(300),height:C(250),overflow:"hidden"},children:n&&(0,o.tZ)(R,{loop:!1,autoPlay:!0,src:n,css:{position:"absolute",top:C(-80),left:C(-250),opacity:t?1:0,width:C(600),height:C(600)}})})},k=n(66980),O=Object.assign,x=function(e){return p().createElement(k.Z,O({width:"318",height:"28",fill:"none",viewBox:"0 0 318 28"},e),p().createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M290.976 20.112a.862.862 0 0 0 .61.253l9.471-.043a26.203 26.203 0 0 1-9.802 3.972 1.172 1.172 0 0 0-.536.62c-.098.264-.097.555.004.82a1.337 1.337 0 0 0 1.612.417 25.695 25.695 0 0 0 10.435-5.268v5.599a1.077 1.077 0 0 0 1.079 1.079 1.079 1.079 0 0 0 1.08-1.08v-5.757a24.248 24.248 0 0 0 10.434 5.268 1.21 1.21 0 0 0 1.512-.432c.144-.72-.044-1.223-.547-1.439a27.624 27.624 0 0 1-9.687-3.756h9.471a.976.976 0 0 0 .979-.864c0-.576-.331-.864-.979-.864h-11.183v-1.611a1.078 1.078 0 0 0-1.08-1.08 1.079 1.079 0 0 0-1.079 1.08v1.611h-11.184a.863.863 0 0 0-.61 1.475Zm.144-10.414a.891.891 0 0 0 .567.217l5.901.044c-.193.238-.384.436-.574.634-.234.244-.468.487-.707.805-.432.576-.331.993.317 1.281l5.268 1.295a54.534 54.534 0 0 1-9.572 1.44.78.78 0 0 0-.701.71c-.01.121.008.242.054.355a1.062 1.062 0 0 0 1.18.762 54.98 54.98 0 0 0 12.104-2.475c4.011 1.142 6.847 1.967 8.507 2.475a1.222 1.222 0 0 0 1.439-.546.936.936 0 0 0 .08-.576.916.916 0 0 0-.613-.706c-1.007-.215-2.691-.618-5.066-1.194-.849-.216-1.497-.389-1.929-.533a10.786 10.786 0 0 0 3.656-3.77h4.851c.561-.072.964-.173.964-.749 0-.576-.331-.863-.964-.863h-14.293c.192-.27.409-.52.648-.749.288-.36.504-.619.648-.763a.74.74 0 0 0 .117-.712.741.741 0 0 0-.549-.468 1.44 1.44 0 0 0-1.612.432c-.278.466-.606.9-.979 1.295-.36.432-.604.749-.748.965h-7.427a.937.937 0 0 0-.863.863.888.888 0 0 0 .296.53Zm22.257-2.575c.058.504.418.864 1.065.864.705 0 1.037-.288 1.022-.749V4.763a1.194 1.194 0 0 0-1.194-1.18h-8.924a12 12 0 0 0-.763-2.375c-.187-.504-.647-.648-1.439-.648a1.05 1.05 0 0 0-.864 1.18 2.564 2.564 0 0 0 .216.648c.174.387.318.786.432 1.195h-9.514c-.863 0-1.295.388-1.295 1.18v2.36c.067.5.427.787 1.079.864a.963.963 0 0 0 .965-.864V5.684a.46.46 0 0 1 .532-.533h18.25c.288 0 .432.173.432.533v1.44Zm-11.327 5.268-2.878-.748h.057c-.36-.072-.59-.173-.245-.533a20.893 20.893 0 0 0 1.065-1.195h8.463a8.272 8.272 0 0 1-3.871 3.124l-2.591-.648ZM136.762 5.913c.178.16.41.247.649.246l12.061-.043a.92.92 0 0 0 .849-.864.965.965 0 0 0-.849-.964h-4.635v-.23a.558.558 0 0 0 .059-.11 1.08 1.08 0 0 0 .041-.123.797.797 0 0 0 .016-.084 9.725 9.725 0 0 1-.432-1.828 3.386 3.386 0 0 0-.216-.648 1.124 1.124 0 0 0-1.295-.647.88.88 0 0 0-.759.711.879.879 0 0 0 .01.368c.023.07.049.154.079.252.049.164.107.368.176.612l.062.216c.077.487.187.968.331 1.439v.115h-5.498a1.004 1.004 0 0 0-.964.964.96.96 0 0 0 .315.618Zm.132 17.768c.084.095.187.17.301.224h-.014a.944.944 0 0 0 1.079-.125.947.947 0 0 0 .23-.306 35.592 35.592 0 0 0 2.145-4.635c.144-.432-.029-.82-.533-1.18-.647-.072-1.036.144-1.18.648-.144.33-.36.791-.648 1.439a62.54 62.54 0 0 1-1.511 2.878.947.947 0 0 0-.097.57.931.931 0 0 0 .228.488Zm1.725-7.975c.221.224.521.352.836.355l3.137-.043v7.096c0 1.08-.504 1.511-1.439 1.511h-1.439c-.576 0-.864.317-.864.964a1.183 1.183 0 0 0 1.108 1.008 7.872 7.872 0 0 0 1.713-.101c2.015 0 2.951-1.036 2.807-3.123V16.06h3.008a1.195 1.195 0 0 0 1.18-1.194V9.815a1.186 1.186 0 0 0-.729-1.09 1.177 1.177 0 0 0-.451-.09h-8.031a1.238 1.238 0 0 0-1.181 1.28v4.952c0 .314.124.616.345.84Zm1.598-1.933v-2.879h-.014a.482.482 0 0 1 .133-.414.472.472 0 0 1 .414-.133h5.484a.488.488 0 0 1 .28.048l.028.015a.498.498 0 0 1 .241.39.48.48 0 0 1-.002.095v2.878a.49.49 0 0 1-.304.5l-.015.006-.012.004a.49.49 0 0 1-.216.022h-5.484a.473.473 0 0 1-.511-.318.474.474 0 0 1-.022-.214Zm8.234 7.959a.877.877 0 0 0 .258-.086h-.014a1.036 1.036 0 0 0 .446-1.137c-.144-.331-.389-.792-.748-1.44l-.864-1.295a1.021 1.021 0 0 0-1.295-.317.808.808 0 0 0-.44.45.813.813 0 0 0 .008.63c.288.49.863 1.396 1.727 2.677a.856.856 0 0 0 .735.527.831.831 0 0 0 .187-.01Zm1.371-11.808a.98.98 0 0 0 .614.323l2.274.014c-.076 6.237-1.727 11.15-4.951 14.738a1.207 1.207 0 0 0 .202 1.44 1.193 1.193 0 0 0 1.439-.216c3.234-3.877 4.994-9.221 5.282-16.034h.864a.858.858 0 0 0-.064.146l-.006.02-.016.054a.943.943 0 0 0-.029.212v12.694c0 1.986.906 2.879 2.691 2.879h.979c1.857.1 2.907-.864 3.109-2.879a6.564 6.564 0 0 1 .115-.964c.121-.859.193-1.724.216-2.59a1.034 1.034 0 0 0-.749-1.181.675.675 0 0 0-.863.648c-.015.433-.053.866-.115 1.295a20.009 20.009 0 0 1-.216 2.044c-.087 1.209-.59 1.713-1.44 1.713h-.547c-.791.13-1.18-.375-1.18-1.44V10.463l-.1-.216h4.087a.978.978 0 0 0 0-1.943h-6.678c0-.72.029-1.857.115-3.44V1.625a1.083 1.083 0 0 0-1.08-.964 1.022 1.022 0 0 0-.978.964c0 1.285-.028 2.51-.054 3.674-.024 1.053-.047 2.055-.047 3.005h-2.26a.98.98 0 0 0-.614 1.62Zm7.293-5.391c1.065.935 1.755 1.554 2.043 1.842h-.014c.576.36 1.022.417 1.454.029.431-.389.46-.864.1-1.44a16.122 16.122 0 0 1-1.281-1.065c-.647-.503-1.079-.834-1.295-.978-.619-.36-1.094-.36-1.439 0a.748.748 0 0 0-.246.237.739.739 0 0 0 .131.943 3.539 3.539 0 0 0 .547.432ZM1.629 5.295c0 .648.288.965.85.965l6.462.043a38.14 38.14 0 0 1-7.643 8.938 1.353 1.353 0 0 0-.216 1.612.95.95 0 0 0 .66.482l.018.003a.948.948 0 0 0 .834-.27 33.572 33.572 0 0 0 3.555-3.44v12.48a1.151 1.151 0 0 0 1.18 1.079 1.108 1.108 0 0 0 1.08-1.08V20.94h13.226v1.828c.072 1.296-.561 1.9-1.929 1.828h-3.022c-.49 0-.749.288-.749.864.077.652.51 1.012 1.296 1.08h3.152c2.447 0 3.584-1.109 3.454-3.34V10.722a1.295 1.295 0 0 0-1.295-1.296H9.588a118.968 118.968 0 0 0 1.943-3.123h14.623a.965.965 0 0 0 0-1.929H12.597c.445-.673.807-1.398 1.079-2.159a1.137 1.137 0 0 0-.648-1.439 1.252 1.252 0 0 0-1.612.964l-1.295 2.591H2.478c-.561 0-.849.317-.849.964Zm6.78 8.924v-2.476a.475.475 0 0 1 .532-.532h12.162a.474.474 0 0 1 .331.08l.01.006.007.006.01.008a.496.496 0 0 1 .039.035.475.475 0 0 1 .135.397v2.476H8.408Zm0 4.85v-3.008h13.226v3.008H8.408Zm32.966 7.851c.201.201.471.317.755.324a1.109 1.109 0 0 0 1.08-1.08V7.34a.951.951 0 0 0-1.08-1.08 1.109 1.109 0 0 0-1.079 1.08v18.826c.007.284.123.554.324.755Zm4.992-20.744c.148-.047.284-.127.398-.233h-.029a.993.993 0 0 0 .058-1.511 37.095 37.095 0 0 0-2.792-2.879 1.166 1.166 0 0 0-1.613-.216.993.993 0 0 0-.114 1.44c.523.434 1.004.916 1.439 1.439.508.476.989.98 1.439 1.511a1.05 1.05 0 0 0 1.214.45Zm1.83 13.43.075.005.025.001a1.174 1.174 0 0 0 .18-.01l8.334.072a1.324 1.324 0 0 0 1.44-1.281v-8.046a1.224 1.224 0 0 0-1.44-1.44h-8.333c-.85 0-1.281.505-1.281 1.44v7.974a1.135 1.135 0 0 0 1 1.284Zm7.73 6.583c.236.197.533.306.84.307h.044c1.828 0 3.08-.043 3.757-.086 2.648-.072 3.914-1.396 3.77-3.973V3.928a1.44 1.44 0 0 0-1.439-1.44H49.341a1.022 1.022 0 0 0-.964.98 1.05 1.05 0 0 0 .964 1.065h12.162c.432 0 .648.187.648.546v16.898c.072 1.64-.72 2.36-2.36 2.36h-3.455c-.72.067-1.007.427-.863 1.08.056.302.217.575.453.772Zm.193-9.063c0 .36-.216.547-.647.547h-5.758c-.431 0-.647-.187-.647-.547v-5.584a.763.763 0 0 1 .648-.648h5.757a.763.763 0 0 1 .647.648v5.584Zm22.755-1.713a.892.892 0 0 1-.748-.863c.072-.576.317-.864.748-.864h10.766c.504 0 .749.288.749.864a.892.892 0 0 1-.749.863h-3.555v2.879h3.224c.504 0 .763.288.763.85 0 .56-.26.69-.763.762h-3.224v3.656a11.3 11.3 0 0 0 4.088.647c4.02.144 8.338.144 12.953 0 .777 0 1.18.317 1.18.965a.992.992 0 0 1-.217.586 1.022 1.022 0 0 1-.963.378h-5.383c-3.526.072-6.102.072-7.757 0-4.443-.144-7.322-1.468-8.636-3.972a16.162 16.162 0 0 1-1.44 3.972.874.874 0 0 1-.936.472.879.879 0 0 1-.344-.14.979.979 0 0 1-.331-1.296 15.544 15.544 0 0 0 1.727-7.643.936.936 0 0 1 .863-.863c.648 0 .965.287.965.863a9.196 9.196 0 0 1-.115 1.08c.017.362-.017.726-.101 1.08a9.267 9.267 0 0 0 2.519 3.022v-7.312l-5.283.014Zm2.26-3.871c-.864 0-1.295-.403-1.295-1.195V3.251c0-.791.431-1.194 1.295-1.194h6.678a1.236 1.236 0 0 1 1.281 1.194v7.096c0 .792-.417 1.195-1.28 1.195h-6.679Zm.533-7.326v1.828h5.498V4.216c0-.36-.144-.533-.432-.533h-4.419c-.432 0-.647.173-.647.533Zm5.066 5.757c.288 0 .432-.187.432-.547V7.497h-5.498v1.929c0 .36.215.547.647.547h4.419Zm5.052 13.241a.99.99 0 0 1-1.428-.335.994.994 0 0 1 .463-1.392 7.34 7.34 0 0 0 5.268-8.175v-2.59c0-.576.331-.864.979-.864.648 0 .921.36.864.863v2.591a19.18 19.18 0 0 1-.332 3.757l2.879 2.26c1.079.863 1.871 1.438 2.375 1.827a.89.89 0 0 1 .348 1.105.9.9 0 0 1-.247.334c-.36.432-.821.461-1.44.101-.356-.207-.693-.543-1.121-.969-.315-.314-.68-.677-1.138-1.075-1.08-.935-1.871-1.568-2.375-1.928a10.306 10.306 0 0 1-5.095 4.548v-.058Zm-.502-19.369a.763.763 0 0 1-.678-.867.935.935 0 0 1 .863-.864h11.629a.878.878 0 0 1 0 1.728h-5.282l-.431 3.108h4.044a1.167 1.167 0 0 1 .251.02l.024.005a1.156 1.156 0 0 1 .861.779c.05.159.065.327.044.492v8.635c0 .576-.317.864-.964.864a.765.765 0 0 1-.864-.864V9.138a.46.46 0 0 0-.532-.532h-6.146c-.432 0-.633.172-.633.532v7.815a.863.863 0 1 1-1.727 0V8.246c0-.792.431-1.195 1.295-1.195h2.26l.532-3.109-4.36-.1a.762.762 0 0 1-.186.003Zm85.487 8.459a1.226 1.226 0 0 1-.678.022 1.24 1.24 0 0 1-.772-.583c-.287-.56-.1-1.108.547-1.612a29.074 29.074 0 0 0 10.651-8.074 2.69 2.69 0 0 1 1.612-.964 2.117 2.117 0 0 1 1.612.964 24.714 24.714 0 0 0 10.55 7.758 1.048 1.048 0 0 1 .46.218 1.034 1.034 0 0 1 .188 1.394 1.339 1.339 0 0 1-1.728.431A30.56 30.56 0 0 1 188.462 3.9c-.216-.216-.403-.216-.547 0a34.166 34.166 0 0 1-10.866 8.276 1.264 1.264 0 0 1-.278.129Zm-.039 5.628a1.078 1.078 0 0 1-.979-1.08 1.021 1.021 0 0 1 .979-.963h22.697a1.064 1.064 0 0 1 1.08.964 1.11 1.11 0 0 1-1.08 1.08h-12.162a71.474 71.474 0 0 1-5.397 5.612.292.292 0 0 0-.086.202s0 .1.216.1c3.655-.143 7.527-.32 11.615-.532a30.668 30.668 0 0 0-2.26-2.26 1.065 1.065 0 0 1 0-1.439 1.268 1.268 0 0 1 1.626.1l1.713 1.728c1.25 1.198 2.199 2.17 2.884 2.872.261.268.484.496.671.683a.957.957 0 0 1 .206.344.994.994 0 0 1-.307 1.096 1.122 1.122 0 0 1-1.626-.101 6.447 6.447 0 0 1-.532-.648l-.648-.648c-.648 0-1.684 0-3.123.216-5.095.216-8.996.389-11.731.547-.935 0-1.54-.187-1.827-.763a1.811 1.811 0 0 1 .647-1.928 34.96 34.96 0 0 0 5.052-5.283l-7.628.101Zm5.052-5.599a1.051 1.051 0 0 1-.965-1.065 1.022 1.022 0 0 1 .965-.978h12.594a1.024 1.024 0 0 1 .964.978 1.054 1.054 0 0 1-.964 1.065h-12.594Zm32.499-7.038c0 .648.288.965.849.965l6.549.043a37.813 37.813 0 0 1-7.643 8.938 1.353 1.353 0 0 0-.216 1.612.955.955 0 0 0 1.08.415.95.95 0 0 0 .36-.2 33.584 33.584 0 0 0 3.555-3.44v12.48a1.15 1.15 0 0 0 1.18 1.079 1.107 1.107 0 0 0 1.079-1.08V20.94h13.242v1.828c.057 1.296-.504 1.9-1.943 1.828h-3.009c-.503 0-.762.288-.762.864.067.652.499 1.012 1.295 1.08h3.224c2.447 0 3.584-1.109 3.454-3.34V10.722a1.294 1.294 0 0 0-1.295-1.296h-13.097a118.765 118.765 0 0 0 1.942-3.123h14.696a.962.962 0 0 0 .964-.964.964.964 0 0 0-.964-.965H225.25a10.08 10.08 0 0 0 1.08-2.159 1.138 1.138 0 0 0-.648-1.439 1.252 1.252 0 0 0-1.612.964l-1.295 2.591h-7.643c-.561 0-.849.317-.849.964Zm6.779 8.924v-2.476h-.058a.484.484 0 0 1 .151-.425.481.481 0 0 1 .206-.11l.016-.003a.51.51 0 0 1 .132-.008.46.46 0 0 1 .085.014h12.162a.489.489 0 0 1 .547.532v2.476h-13.241Zm0 4.85v-3.008h13.241v3.008h-13.241Zm32.599-2.26c-.863.145-1.439 0-1.626-.532a1.22 1.22 0 0 1 .763-1.44 26.994 26.994 0 0 0 10.651-6.03 1.175 1.175 0 0 1 .316-.216 2.166 2.166 0 0 1 1.627-.748c.489 0 1.108.288 1.827 1.065a24.738 24.738 0 0 0 10.335 5.498 1.146 1.146 0 0 1 .682.662 1.157 1.157 0 0 1-.049.95c-.144.504-.677.69-1.612.532a35.98 35.98 0 0 1-10.867-6.232.518.518 0 0 0-.748 0 35.353 35.353 0 0 1-5.464 3.838.868.868 0 0 1 .254-.038h10.866a.864.864 0 0 1 0 1.727H259.75a.865.865 0 0 1-.574-1.509 35.332 35.332 0 0 1-5.515 2.474Zm-1.079-7.642a1.037 1.037 0 0 1 0-1.511 18.427 18.427 0 0 0 4.519-6.347 1.183 1.183 0 0 1 1.512-.533c.561.144.748.533.532 1.18a8.214 8.214 0 0 1-.748 1.44h6.664a.961.961 0 0 1 .863.964.94.94 0 0 1-.863.863h-7.744a20.168 20.168 0 0 1-3.238 3.872 1.44 1.44 0 0 1-1.526.072h.029Zm5.383 16.681c-.864 0-1.339-.46-1.439-1.439v-4.85a1.302 1.302 0 0 1 .376-1.063 1.309 1.309 0 0 1 1.063-.377h14.637a1.342 1.342 0 0 1 1.215.91c.058.17.08.35.066.53v4.85a1.316 1.316 0 0 1-.566 1.205 1.327 1.327 0 0 1-.715.234h-14.637Zm3.224-16.364a1.037 1.037 0 0 1-1.439-.216 10.083 10.083 0 0 1-1.44-1.929c-.359-.504-.331-.892.101-1.18a1.108 1.108 0 0 1 1.439.1c.395.453.756.934 1.08 1.44.094.152.2.296.316.432a1.126 1.126 0 0 1-.057 1.353Zm10.075 14.536a.5.5 0 0 0 .343-.086.48.48 0 0 0 .204-.446v-2.879a.497.497 0 0 0-.14-.407.486.486 0 0 0-.407-.14h-11.831c-.432 0-.648.188-.648.547v2.879c0 .345.216.532.648.532h11.831Zm-5.167-16.364a1.092 1.092 0 0 1-.115-1.44 15.455 15.455 0 0 0 3.022-4.85 1.14 1.14 0 0 1 1.439-.648.936.936 0 0 1 .533 1.296 7.425 7.425 0 0 1-.748 1.44h7.326a1.009 1.009 0 0 1 .964.963.981.981 0 0 1-.964.864h-8.291c-.1.184-.211.361-.331.533l-1.18 1.51a1.28 1.28 0 0 1-1.612.332h-.043Zm7.743 1.943a1.02 1.02 0 0 1-1.439-.331 81.324 81.324 0 0 1-.222-.284l-.006-.007c-.282-.36-.741-.95-1.384-1.753a.905.905 0 0 1 .216-1.18 1.121 1.121 0 0 1 1.439.115l.439.54c.619.761 1.032 1.268 1.173 1.504a1.05 1.05 0 0 1-.173 1.396h-.043Z",clipRule:"evenodd"}))},P=function(e){var t=e.showSlogn;return(0,o.tZ)(x,{css:{position:"absolute",left:"50%",bottom:"8%",transform:"translate(-50%,0%)",opacity:t?1:0,transition:"opacity 0.3s linear",width:"30%"}})},D=Object.assign,L=function(e){return p().createElement(k.Z,D({fill:"none",viewBox:"0 0 40 40"},e),p().createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M18.194 28.016a9.844 9.844 0 1 1 0-19.688 9.844 9.844 0 0 1 0 19.688Zm10.362-1.813a13.069 13.069 0 1 0-2.317 2.331l6.045 6.045a1.684 1.684 0 0 0 2.317-2.331l-6.045-6.045Z",clipRule:"evenodd"}))},B=Object.assign,U=function(e){return p().createElement(k.Z,B({fill:"none",viewBox:"0 0 124 64"},e),p().createElement("path",{fill:"#fff",d:"M0 6a6 6 0 0 1 6-6h117v64H6a6 6 0 0 1-6-6V6Z"}),p().createElement("path",{fill:"#0767FB",fillRule:"evenodd",d:"M35.274 31.36h5.729A1.642 1.642 0 0 1 42.629 33v1.813h-7.657a37.718 37.718 0 0 1-1.44 6.794 19.258 19.258 0 0 1-4.159 7.412 7.082 7.082 0 0 1-6.966 1.238 41.498 41.498 0 0 0 4.016-3.872 21.589 21.589 0 0 0 3.872-6.836 23.184 23.184 0 0 0 1.021-4.736h-8.39a3.44 3.44 0 0 1 3.44-3.44h5.281c.058-.623.087-1.256.087-1.9v-7.196h-2.98c-.115.144-.115.274-.115.389a5.413 5.413 0 0 1-2.62 3.756 7.542 7.542 0 0 1-3.266.778s1.51-3.052 2.13-4.779l.059-.172c.378-1.106.968-2.831 1.61-4.635a4.174 4.174 0 0 1 1.77-2.519 5.455 5.455 0 0 1 3.11-.92s-1.094 3.252-1.44 4.317l-.033.073a.628.628 0 0 0-.082.258h10.19a1.77 1.77 0 0 1 1.77 1.756v1.684h-6.563v9.096Zm8.694-12.48H59.8l.043 27.707h-6.189l-5.282 3.368-.518-3.368h-3.886V18.88Zm6.045 26.224 3.094-1.957h3.109V22.321h-8.708v20.826h2.202l.303 1.957ZM88.6 32.712V20.58l12.133-.633h1.094c.679-1.193.99-2.56.892-3.93l-.001-.002c-.101-.317-.274-.86-.819-.732a41.76 41.76 0 0 1-5.498.936c-3.364.407-4.925.52-9.248.832l-.827.06c-8.636.634-16.336.936-16.336.936a3.282 3.282 0 0 0 3.44 3.296c2.878-.115 7.196-.317 11.514-.533v11.903H68.579a3.44 3.44 0 0 0 3.44 3.44h12.954v9.197c0 1.152-.59 1.54-1.57 1.569h-5.037a5.412 5.412 0 0 0 2.879 3.397c1.12.374 2.31.497 3.483.36 1.756-.087 3.814-1.08 3.814-4.635v-9.888h14.508a1.638 1.638 0 0 0 1.52-1.023c.082-.2.123-.415.121-.632v-1.785H88.6Zm-12.207-9.054c.333.206.622.475.85.793l3.7 5.181-2.879 2.087-5.47-7.585.49-.36a2.979 2.979 0 0 1 3.31-.116Zm19.792.548-4.016 5.31 2.879 2.16 5.757-7.7-.49-.36a2.941 2.941 0 0 0-2.203-.575 2.95 2.95 0 0 0-1.956 1.165h.029ZM33.92 40.398l3.023-1.929 3.972 5.93c.45.863.577 1.858.36 2.807a9.04 9.04 0 0 1-.863 2.878l-6.492-9.686Z",clipRule:"evenodd"}))},M=Object.assign,G=function(e){return p().createElement(k.Z,M({width:"31",height:"17",fill:"none",viewBox:"0 0 31 17"},e),p().createElement("path",{fill:"#fff",d:"M2.928 14.638 0 0h31L5.962 15.933a2 2 0 0 1-3.034-1.295Z"}))},F=function(e){var t=e.currentUser;return(0,o.BX)("div",{css:{display:"flex",alignItems:"center",border:"".concat(C(3)," solid #fff"),backgroundColor:"#fff",position:"relative",height:C(70),boxSizing:"border-box",borderRadius:C(3),width:C(400)},children:[(0,o.tZ)(G,{css:{position:"absolute",bottom:parseInt(C(-18)),right:C(30),width:C(31),height:C(17.5)}}),(0,o.tZ)(U,{css:{width:C(123),height:"100%"}}),(0,o.BX)("div",{css:{backgroundColor:"#000",display:"inline-flex",alignItems:"center",position:"relative",height:"100%",paddingRight:C(10),paddingLeft:C(20),borderTopRightRadius:C(3),borderBottomRightRadius:C(3),flex:1},children:[(0,o.tZ)("span",{css:{fontSize:C(34),color:"#fff",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:C(180),WebkitLineClamp:1},children:t.name}),(0,o.tZ)(L,{css:{position:"absolute",right:C(10),width:C(40),height:C(40)}})]})]})},z=function(e){var t=e.setShowEndVideo,i=e.handleOpacityChange,a=e.subscribeEvent,s=e.hasEndVideo,l=e.currentUser,p=e.itemType,h=e.itemId,f=(0,r._)((0,d.useState)(!1),2),_=f[0],m=f[1],v=(0,r._)((0,d.useState)(!1),2),E=v[0],S=v[1],I=(0,r._)((0,d.useState)(!1),2),b=I[0],A=I[1],Z=(0,r._)((0,d.useState)(!1),2),w=Z[0],R=Z[1],k=(0,d.useRef)(!1),O=(0,d.useRef)(!1),x=(0,d.useRef)([]),D=(0,d.useRef)(new Audio),L=(0,g.Z)(function(){return n.e(6018).then(n.t.bind(n,83476,23))}),B=(0,c.Z)(function(e){if(e){var t=x.current.findIndex(function(t){return t[e]});x.current[t]&&clearTimeout(x.current[t][e]),x.current.splice(t,1)}else x.current.forEach(function(e){"object"==typeof e?clearTimeout(Object.values(e)[0]):clearTimeout(e)}),x.current=[]}),U=(0,c.Z)(function(){t(!1),S(!1),R(!1),A(!1)}),M=(0,c.Z)(function(){S(!0),x.current.push({author:setTimeout(function(){R(!0),x.current.push({content:setTimeout(function(){m(!0),A(!0),D.current.play()},200)})})}),x.current.push({exit:setTimeout(function(){i({value:0}),x.current.push({destroy:setTimeout(function(){U(),B()},500)})},2300)})});(0,d.useEffect)(function(){O.current&&!k.current&&s&&(B("timeout"),M()),s&&O.current&&!k.current&&(B("timeout"),M());var e=function(){if(t(!0),i({value:1,time:0}),O.current=!0,!1===s){U();return}k.current?U():s?M():x.current.push({timeout:setTimeout(function(){k.current=!0,S(!1),t(!1)},3e3)})};if(a){var n=a(u.FP.ENDED,e).unsubscribe;return function(){n(e),B()}}},[s,a]);var G={type:p?p.charAt(0).toUpperCase()+p.slice(1):""};return"answer"===p?G.token=h:G.id=h,(0,d.useEffect)(function(){D.current.src="https://zhstatic.zhihu.com/heifetz_static/1632738186715.wav"},[]),E&&L&&(0,o.tZ)(T.eV,{content:G,children:(0,o.BX)(T.Wi,{zaType:"Video",zaBlock:"EndVideo",children:[(0,o.BX)("div",{css:{position:"absolute",left:"50%",top:C(250),transform:"translate(-50%,0)",textAlign:"center",opacity:w?1:0,transition:"opacity 0.2s linear"},children:[(0,o.BX)("div",{css:{position:"relative",height:C(250),width:C(300),margin:"0 auto ".concat(C(53))},children:[_&&(0,o.tZ)(N,{src:"https://zhstatic.zhihu.com/heifetz_static/kanshan.json",showKanShan:_}),(0,o.tZ)(y,{src:l.avatarUrl})]}),(0,o.tZ)(F,{currentUser:l})]}),(0,o.tZ)(P,{showSlogn:b})]})})},H=function(e){var t=e.id,n=e.itemId,i=e.itemType,a=(0,d.useRef)((0,u.Wn)(t,"*",!0)).current.subscribeMessage,s=(0,r._)((0,d.useState)(!1),2),l=s[0],p=s[1],g=(0,r._)((0,d.useState)({value:1,time:.5}),2),T=g[0],y=g[1],S=(0,r._)((0,d.useState)(null),2),I=S[0],b=S[1],A=(0,r._)((0,d.useState)({}),2),Z=A[0],w=A[1],R=(0,d.useRef)(!0),N=(0,r._)((0,d.useState)(!1),2),k=N[0],O=N[1],x=(0,v.Z)(),P=(0,d.useRef)(),D=(0,r._)((0,_.Z)(0),2),L=D[0],B=D[1],U=(0,c.Z)(function(e){var t=e.value,n=e.time;y({value:t,time:void 0===n?.5:n})}),M=(0,c.Z)(function(){var e;x("".concat(m.Z.fetchRoot.www,"/api/v4/video/tail?object_id=").concat(n,"&object_type=").concat(i),{headers:{"X-Referer":document.referrer,"Content-Type":"application/json","X-App-Za.OS":"webplayer"},credentials:"include"}).then((e=(0,h._)(function(e){var t;return(0,f.__generator)(this,function(n){switch(n.label){case 0:if(!(t=e.payload).displayAnimation)return[3,5];n.label=1;case 1:var r;return n.trys.push([1,3,,4]),[4,(r=t.author.avatarUrl,new Promise(function(e,t){var n=new Image;n.onload=e,n.onerror=t,n.src=r}))];case 2:return n.sent(),b(!0),w({name:t.author.name,avatarUrl:t.author.avatarUrl}),[3,4];case 3:return n.sent(),b(!1),[3,4];case 4:return[3,6];case 5:b(!1),n.label=6;case 6:return[2]}})}),function(t){return e.apply(this,arguments)})).catch(function(){b(!1)})}),G=(0,c.Z)(function(){R.current&&(O(!0),R.current=!1)});return(0,d.useEffect)(function(){if(n&&i&&k&&x&&M(),a){var e=a(u.FP.PLAY,G).unsubscribe;return function(){e(G)}}},[M,k,x,a]),(0,d.useEffect)(function(){if(P.current&&(E.width=P.current.clientWidth,L(P.current)),a){var e=function(){setTimeout(function(){E.width=P.current.clientWidth})},t=[a(u.FP.ENTER_FULLSCREEN,e).unsubscribe,a(u.FP.EXIT_FULLSCREEN,e).unsubscribe,a(u.FP.ENTER_PAGE_FULLSCREEN,e).unsubscribe,a(u.FP.EXIT_PAGE_FULLSCREEN,e).unsubscribe];return function(){t.forEach(function(e){return e()})}}},[P.current,a]),(0,d.useEffect)(function(){B&&(E.width=B&&B.width)},[B]),(0,o.tZ)("div",{ref:P,children:(0,o.tZ)("div",{css:{position:"absolute",height:"100%",width:C(1920),left:0,top:0,backgroundColor:"black",visibility:l?"visible":"hidden"},children:(0,o.tZ)("div",{css:{position:"absolute",top:"50%",left:0,transform:"translateY(-50%)",opacity:T.value,transition:"opacity ".concat(T.time,"s linear"),backgroundColor:"black",height:9*C(1920,null)/16,width:"100%"},children:P.current&&(0,o.tZ)(z,{itemId:n,itemType:i,currentUser:Z,hasEndVideo:I,handleOpacityChange:U,subscribeEvent:a,setShowEndVideo:p})})})})},q=n(76976),V=n(89774),X=n(83821),W=(0,d.memo)(function(e){var t=e.videoId,n=e.contentId,p=e.contentType,h=e.zaProps,f=e.cover,_=e.muted,m=e.standalone,v=e.useSingle,g=void 0!==v&&v,T=e.hideWatermark,E=(0,V.Z)(),C="1"===(0,l.c)("use_hevc")||E,y="1"===(0,l.c)("use_backdrop_blur")||E,S="1"===(0,l.c)("play_station")||E,I=(0,d.useRef)({isPlaying:!1,isPip:!1}).current,b=(0,d.useRef)((0,u.Wn)(t,"*",!0)).current,A=(0,r._)((0,a.Z)({threshold:.5},g),2),Z=A[0],w=A[1],R="1"===(0,l.c)("use_new_player")?"ks":"zhihu",N=(0,q.Hg)(),k=(0,c.Z)(function(){w||!I.isPlaying||I.isPip||b.dispatchMessage(window,u.aO.PAUSE,{dontApplyOnFullScreen:!0})}),O=(0,c.Z)(function(){I.isPlaying=!0,b.dispatchMessage(window,u.aO.EXIT_PIP)}),x=(0,c.Z)(function(){I.isPlaying=!1}),P=(0,c.Z)(function(){I.isPip=!0}),D=(0,c.Z)(function(){I.isPip=!1}),L=(0,s.Z)((0,c.Z)(function(){k()}),200);return(0,d.useEffect)(function(){if(g){var e=[b.subscribeMessage(u.FP.PLAY,O).unsubscribe,b.subscribeMessage(u.FP.PAUSE,x).unsubscribe,b.subscribeMessage(u.FP.ENTER_PIP,P).unsubscribe,b.subscribeMessage(u.FP.EXIT_PIP,D).unsubscribe];return window.addEventListener("scroll",L),function(){window.removeEventListener("scroll",L),e.forEach(function(e){return e()})}}},[g,x,O,L,b,P,D]),(0,o.tZ)("div",{ref:Z,css:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},children:(0,o.tZ)(X.Z,{children:(0,o.tZ)(i.ZP,{hideWatermark:void 0!==T&&T,identify:R,id:t,zaProps:h,pageName:p,muted:void 0!==_&&_,useHEVC:C,standalone:void 0!==m&&m,shouldShowPageFullScreenButton:!0,cover:f,backdropBlur:y,usePlayStation:S,scene:N,contentId:"".concat(n),contentType:p,children:n&&p&&(0,o.tZ)(H,{id:t,itemId:n,itemType:p})})})})})},65939:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(94009),u=n(85626),d=n(85879),p=n(76280),h=n(10421),f=n(67814),_=n.n(f),m=n(14168),v=n.n(m),g=n(87363),T=n(93206),E=n(69383),C=n(43384),y=n(30722),S=n(38889),I=n(97727),b=n(80714),A=n(66263),Z=n(85576),w=n(16850),R=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"voteUpButtonRef",(0,g.createRef)()),(0,a._)((0,r._)(e),"voteDownButtonRef",(0,g.createRef)()),(0,a._)((0,r._)(e),"onVote",e.props.authRequired(function(t){e.props.onVote(t)},A.q0.vote)),(0,a._)((0,r._)(e),"voteUp",function(t){var n=e.props.voting,r=(0,l._)(1===n?["UnUpvote","neutral"]:["Upvote","up"],2),o=r[0],i=r[1];e.vote(t,o,i),e.voteUpButtonRef.current.focus()}),(0,a._)((0,r._)(e),"voteDown",function(t){var n=e.props.voting,r=(0,l._)(-1===n?["UnDownvote","neutral"]:["Downvote","down"],2),o=r[0],i=r[1];e.vote(t,o,i),e.voteDownButtonRef.current.focus()}),(0,a._)((0,r._)(e),"vote",function(t,n,r){var o=e.props,i=o.disableAuth,a=o.handleToggleGuide,c=o.onClick,l=o.type,u=o.zaIds,d=u.voteUp,p=u.voteDown,h=n.includes("Upvote")?d:p;if("article"===l&&"down"===r&&E.Z.trackEvent(e.voteDownButtonRef.current,{action:"Click",id:2315,name:"反对"}),E.Z.trackEvent(n.includes("Upvote")?e.voteUpButtonRef.current:e.voteDownButtonRef.current,(0,s._)({action:n,element:"Button"},h&&{id:h})),c){c(t,r);return}if(i){a(t,r);return}e.onVote(r)}),(0,a._)((0,r._)(e),"handleTogglerClick",function(t){e.shouldShowMenu()||t.preventDefault(),e.voteDown(t)}),(0,a._)((0,r._)(e),"renderVoteUpButton",function(){var t=e.props,n=t.isOwner,r=t.count,o=t.voting,i=t.disabled,a=t.hideDesc,c=1===o,s=c?"已赞同":"赞同",l=[s,(0,y.Zh)(r)].join(" "),u=[!a&&s,0!==r&&(0,y.Zh)(r).trim()].filter(Boolean).join(" ");return(0,d.BX)(C.$U,{as:S.ZP,zaText:c?"取消赞同":"赞同",zaType:"Button",zaModuleId:"upvote_btn",zaAction:c?"UnUpvote":"Upvote",className:_()("VoteButton VoteButton--up",{"is-active":1===o}),disabled:n||i,onClick:e.voteUp,"aria-label":l,"aria-live":"polite",onRef:e.voteUpButtonRef,children:[(0,d.tZ)(p.Ex,{center:!0,size:10,className:"VoteButton-TriangleUp"}),u]})}),(0,a._)((0,r._)(e),"renderVoteDownButton",function(){var t=e.props,n=t.voting,r=t.disabled,o=t.isMobile,i=-1===n;return(0,d.tZ)(C.$U,{as:S.ZP,zaText:i?"取消反对":"反对",zaType:"Button",zaModuleId:"downvote_btn",zaAction:i?"UnDownvote":"Downvote",className:_()("VoteButton VoteButton--down",{"is-active":-1===n},{"VoteButton--mobileDown":b.Z.isMobileEntry||o}),disabled:r,onClick:e.voteDown,"aria-label":i?"已反对":"反对","aria-live":"polite",onRef:e.voteDownButtonRef,children:(0,d.tZ)(h.y,{center:!0,size:10})})}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.isOwner,n=e.hideDownVote;return(0,d.BX)("span",{ref:this.voteButtonRef,children:[(0,d.tZ)(I.bY,{input:"v",action:this.voteUp}),(0,d.tZ)(I.bY,{input:"d",action:this.voteDown}),this.renderVoteUpButton(),!t&&!n&&this.renderVoteDownButton()]})}}]),n}(g.Component);(0,a._)(R,"propTypes",{voting:v().oneOf([-1,0,1]).isRequired,disabled:v().bool,type:v().string,hideDesc:v().bool,zaIds:v().shape({voteUp:v().number,voteDown:v().number}),hideDownVote:v().bool}),(0,a._)(R,"defaultProps",{voting:0,disabled:!1,type:"",hideDesc:!1,zaIds:{},hideDownVote:!1}),t.Z=(0,T.compose)((0,w.$)(),Z.Z)(R)},97285:function(e,t,n){"use strict";n.d(t,{Z:function(){return I}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(85626),u=n(85879),d=n(87363),p=n(36695),h=n(8866),f=n(89250),_=n(10886),m=n(62618),v=n(24405),g=n(14168),T=n.n(g),E=n(39503),C=function(e){var t=e.voteupCount,n=e.type,r=e.isFetching,o=e.isDrained,i=e.items,a=e.onLoad,c=e.handleListHide,s=e.modalShown,l=(0,v.F)().colors;return t<=0?null:(0,u.tZ)("span",{css:{color:l.GBL05A},children:(0,u.tZ)(m.Z,{size:"fullPage",onClose:c,styles:{root:{height:520}},children:s&&(0,u.tZ)(E.Z,{isFetching:r,isDrained:o,text:"column"===n?"关注了":"赞同了",items:i,voteupCount:t,onLoad:a})})})};C.propTypes={openable:T().bool,id:T().oneOfType([T().number,T().string]),type:T().oneOf(["pin","answer","article","column"]).isRequired,modalShown:T().bool,handleListHide:T().func},C.defaultProps={openable:!0};var y={answer:"answers",article:"articles",pin:"pins",column:"columns"},S=function(e){(0,c._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleLoad",function(){var t=e.props,n=t.type,r=t.id,o=t.loadAnswerVoters,i=t.loadArticleVoters,a=t.loadColumnsFollowers;switch(n){case"answer":return o(r);case"article":return i(r);case"column":return a(r);default:return null}}),e}return(0,i._)(n,[{key:"render",value:function(){return(0,u.tZ)(C,(0,s._)({onLoad:this.handleLoad},this.props))}}]),n}(d.Component);(0,a._)(S,"propsTypes",(0,s._)({},C.propsTypes)),(0,a._)(S,"defaultProps",(0,s._)({},C.defaultProps));var I=(0,p.connect)(function(e,t){var n=t.id,r=t.type,o=e.entities.users,i=(e[y[r]]||{}).upvoters,a=(void 0===i?{}:i)[n]||{isFetching:!1,isDrained:!1,order:"normal",ids:[]};return{isFetching:a.isFetching,isDrained:a.isDrained,order:a.order,items:a.ids.map(function(e){return o[e]})}},{loadAnswerVoters:h.Yu,loadArticleVoters:f.Id,loadColumnsFollowers:_.bK})(S)},39503:function(e,t,n){"use strict";n.d(t,{Z:function(){return O}});var r=n(22107),o=n(94707),i=n(87320),a=n(86325),c=n(55164),s=n(57477),l=n(85626),u=n(85879),d=n(99178),p=n(14168),h=n.n(p),f=n(87363),_=n(22715),m=n(30722),v=n(80714),g=n(67814),T=n.n(g);function E(e){var t=e.header,n=e.options,r=e.className,o=e.onRef,i=e.showOptions;return(0,u.BX)("div",{className:T()("Topbar",r,v.Z.isMobileEntry&&"Topbar--mobile"),ref:o,children:[(0,u.tZ)("div",{className:"Topbar-title",children:t}),(void 0===i||i)&&(0,u.tZ)("div",{className:"Topbar-options",children:n})]})}var C=n(69383),y=n(44169),S=n(30361),I=n(46829),b=n(74914),A=n(73596),Z=n(85661),w=n(94785),R=n(94226),N=function(e){(0,a._)(n,e);var t=(0,l._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"componentDidMount",value:function(){var e=this.props.user;C.Z.setModule(this,{module:"UserItem"},{card:{content:{type:"User",member_hash_id:e.id,follower_num:e.followerCount}}})}},{key:"renderRewardDetails",value:function(){var e=this.props.user,t=e.amount,n=e.rewardCreated;return(0,u.BX)("div",{className:"ContentItem-rewardDetails",children:[(0,u.tZ)("p",{className:"ContentItem-rewardAmount",children:t&&"赞赏了 \xa5".concat(t/100)}),(0,u.tZ)("p",{className:"ContentItem-rewardTime",children:(0,y.rL)(n)})]})}},{key:"render",value:function(){var e=this.props,t=e.user,n=t.urlToken,r=t.isFollowed,o=t.isFollowing,i=t.answerCount,a=t.articlesCount,c=t.followerCount,s=t.id,l=t.isOrg,d=e.user,p=e.type,h=e.isRewardList,f=e.action,_=e.meta,g=e.status,T=e.noTrackCardShow,E=e.onClick,C=e.currentUser,y=!n,N=C&&C.id===s,k=void 0!==f?f:!N&&!y&&(0,u.tZ)(I.Z,{id:d.urlToken,type:p||d.type,preset:I.Z.PRESETS.primary,gender:d.gender,isFollowing:o,onClick:E}),O=void 0!==_?_:y||(0,u.tZ)(A.Z,{user:d}),x=void 0!==g?(0,u.tZ)(S.qb,{children:g}):!y&&(0,u.BX)(S.qb,{children:[!!i&&"".concat((0,m.uf)(i)," 回答"),!!a&&"".concat((0,m.uf)(a)," 文章"),!!c&&"".concat((0,m.uf)(c)," 关注者")]}),P="//www.zhihu.com/".concat(l?"org":"people","/").concat(n||s),D=this.props.userLinkV2;return(0,u.tZ)(S.ZP,{data:d,link:P,image:D?(0,u.tZ)(R.Z,{className:"UserItem-avatar",avatarProps:{size:v.Z.isMobileEntry?46:60},user:d,target:"_blank"}):(0,u.tZ)(Z.Z,{className:"UserItem-avatar",avatar:!0,avatarProps:{size:v.Z.isMobileEntry?46:60},user:d,target:"_blank"}),title:(0,u.BX)("div",{className:"UserItem-title",children:[D?(0,u.tZ)(w.Z,{user:d,target:"_blank"}):(0,u.tZ)(Z.Z,{user:d,target:"_blank"}),(0,u.tZ)(b.Z,{isFollowing:o,isFollowed:r})]}),meta:(0,u.BX)("div",{children:[O,x]}),noTrackCardShow:T,extra:h?this.renderRewardDetails():k})}}]),n}(f.Component);(0,i._)(N,"propTypes",{action:h().node,status:h().node,meta:h().node,type:h().string,isRewardList:h().bool,onClick:h().func,currentUser:h().object});var k=function(e){(0,a._)(n,e);var t=(0,l._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"render",value:function(){var e=this.props,t=e.isFetching,n=e.isDrained,r=e.items,o=e.voteupCount,i=e.onLoad,a=e.text,l=e.isRewardList,p=e.notice,h=e.type,f=e.currentUser,g=v.Z.isMobileEntry?{}:{getContainer:function(e){return e}};return(0,u.BX)("div",{className:"VoterList",children:[(0,u.tZ)(E,{header:"".concat((0,m.uf)(o)," 人").concat(a||"赞同了")}),l&&p&&(0,u.tZ)("div",{className:"VoterList-description",children:(0,u.tZ)("p",{children:p})}),(0,u.tZ)(d.ZP,(0,s._)((0,c._)({className:"VoterList-content",isLoading:t,isDrained:n,onLoad:i,placeholder:(0,u.tZ)(d.i,{className:"List-item",withAvatar:!0})},g),{children:r&&r.map(function(e,t){return(0,u.tZ)(_.HC,{children:(0,u.tZ)(N,{currentUser:f,user:e,isRewardList:l,meta:null,type:h,userLinkV2:!0})},"".concat(t,".").concat(e.urlToken))})}))]})}}]),n}(f.Component);(0,i._)(k,"propTypes",{isFetching:h().bool.isRequired,isDrained:h().bool.isRequired,items:h().array.isRequired,voteupCount:h().number.isRequired,text:h().string.isRequired,onLoad:h().func.isRequired,isRewardList:h().bool,type:h().string,currentUser:h().object});var O=k},55342:function(e,t,n){"use strict";n.d(t,{Z:function(){return x}});var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(72111),s=n(30037),l=n(10087),u=n(26115),d=n(86057),p=n.n(d),h=n(87363),f=n(36695),_=n(87641),m=n(93206),v=n(379),g=n(66223),T=n(61255),E=n(99830),C=n(30361),y=n(45588),S=n(8231),I=n(93445),b=n(80714),A=n(60736),Z=n(93547),w=n(58909),R=n(1606),N=function(e){var t=e.expanded,n=e.isVideoCoverFullSize;return e.renderFlag?(0,a.tZ)(T.xJ,{mb:t?"8px":n?"8px":"4px"}):null},k=n(6716);function O(e){var t,n,d=e.zvideo,m=e.zvideo,A=m.id,R=m.type,O=m.description,x=void 0===O?"":O,P=m.title,D=m.author,L=m.isVisible,B=m.creationRelationship,U=m.attachedInfoBytes,M=e.lastreadTouchable,G=e.preset,F=void 0===G?"primary":G,z=e.onToggleExpand,H=e.renderOptions,q=e.couldShowHiddenSign,V=e.renderActionButtons,X=e.shouldAlwaysShowPlayer,W=e.truncateDisabled,K=e.limit,j=e.showMetaAfterPlayer,Y=e.adHint;d.thumbnailExtraInfo&&(t=d.thumbnailExtraInfo.videoId,n=d.thumbnailExtraInfo.url),d.video&&(t=d.video.videoId,n=d.video.thumbnail);var Q=(0,f.useSelector)(function(e){return p()(D)?e.entities.users[D]:D}),J=(0,w.xw)(Q),$=(0,i._)((0,h.useState)(!1),2),ee=$[0],et=$[1],en=(0,i._)((0,h.useState)({commentsShown:!1,commentsAutoFocus:!0,commentPattern:"fixed"}),2),er=en[0],eo=en[1],ei=(0,i._)((0,k.Z)(F,ee,Q,B),1)[0],ea="https://".concat(b.Z.wwwHost,"/zvideo/").concat(A),ec=t&&(X||ee),es=(0,T.HE)(B),el=N({expanded:ee,isVideoCoverFullSize:X&&j,renderFlag:es});return(0,a.tZ)(s.xM,{data:d,children:(0,a.BX)(C.ZP,{className:"ZVideoItem",data:d,title:(0,a.BX)(a.HY,{children:[J&&!L&&q&&(0,a.BX)("span",{className:"ZVideoItem-hiddenSign",children:[(0,a.tZ)(u.Z,{}),"隐藏"]}),(0,a.tZ)(c._o,{zaAction:"OpenUrl",zaEventType:"Click",zaText:"标题跳转",zaType:"Text",zaModuleId:"card_title_text",children:(0,a.tZ)("a",{href:ea,target:"_blank",rel:"noopener noreferrer",children:P})})]}),link:ea,meta:j?null:ei,lastreadTouchable:M,"data-zop":JSON.stringify({authorName:null==Q?void 0:Q.name,itemId:A,title:P,type:"zvideo"}),children:[J&&(d.isReviewing||d.isUpdateReviewing)&&(0,a.tZ)(y.Z,{}),ec&&(0,a.BX)(_.Box,{my:"16px",children:[(0,a.tZ)("div",{className:"ZVideoItem-video",css:{margin:"0px"},children:(0,a.tZ)(l.eb,{data:d.thumbnailExtraInfo||d.video,children:(0,a.tZ)(I.Z,{videoId:t,contentId:A,contentType:R,zaProps:{type:"Zvideo",token:d.id,attachedInfo:U}})})}),ee&&(0,a.tZ)(T._N,{id:A,creationRelationship:B})]}),j&&ei,(0,a.BX)(S.Z,(0,o._)((0,r._)({excerpt:(0,Z.NJ)(x,es?140:200),html:x,cover:X?null:n,hasVideo:!X},K?{limit:K}:{}),{truncateDisabled:W,allowCollapseWithEmptyExcerpt:!0,expanded:ee,onToggleExpend:function(e){et(e),z&&z(e)},data:(0,o._)((0,r._)({},d),{id:A}),prefix:el,children:[(0,a.tZ)(v.Z,{className:"ZVideoItem-toolbar",zvideo:d,author:Q,commentsShown:er.commentsShown,onCommentButtonClick:function(e,t){return eo(t)},renderOptions:H,renderActionButtons:V}),Y&&(0,a.tZ)(g.Z,{tag:Y})]})),(0,a.tZ)(E.Z,{className:"ZVideoItem-comment",containerClassName:"ZVideoItem-commentContainer",parent:d,shown:er.commentsShown,commentPattern:er.commentPattern,autoFocus:er.autoFocus,onClose:function(){return eo((0,o._)((0,r._)({},er),{commentsShown:!1}))},commentInputPosition:"bottom",showPackupButton:!0})]})})}O.defaultProps={renderOptions:function(){return[null]},truncateDisabled:!0};var x=(0,m.compose)((0,R.Ib)(function(e){var t=e.zvideo;return{content:{type:"Zvideo",token:String(t.id),id:String(t.id)},extra:{mediaInfo:{videoInfo:{videoId:t.id}}}}}),(0,f.connect)(function(e,t){return(0,o._)((0,r._)({},t),{zvideo:(0,o._)((0,r._)({},t.zvideo),{creationRelationship:(0,A.ze)(t.zvideo)})})}))(O)},6716:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(87363),s=n(77683),l=n(61255),u=function(e){return"plain"===e||"special-plain"===e},d=function(e){return"special-plain"===e};t.Z=function(e,t,n){var p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,h=(0,i._)((0,c.useMemo)(function(){var t;if((0,l.HE)(p)){var i=!d(e);t=(0,l.SF)(e,n,p,i)}else t=!d(e)&&(0,a.tZ)(s.Z,(0,o._)((0,r._)({},u(e)&&{preset:"plain"}),{author:n,userLinkV2:!0}),"authorInfo");return u(e)?[t,null]:[[t,null],null]},[p,e,n]),2);return[h[0],h[1]]}},77100:function(e,t,n){"use strict";n.d(t,{Z:function(){return I}});var r=n(55164),o=n(94009),i=n(49899),a=n(85879),c=n(65733),s=n(36695),l=n(87641),u=n(43384),d=n(53910),p=n(57730),h=n(88329),f=n.n(h),_=n(4773),m=n(25076),v=n(87320),g=n(57477),T=n(80565),E=n(79107),C=n(7181),y=function(e){var t=e.className,n=e.index,o=e.selected,i=e.onClick,c=e.onDelete,s=e.item,d=e.item,p=d.status,h=d.target,f=(void 0===h?{}:h).parentObject.title,_=0===p,m="ContributionItem-deleteButton",y=(0,a.BX)(u.$U,(0,g._)((0,r._)({zaType:"Card",zaText:f,view:{elementLocation:{card:{index:void 0===n?0:n}}},as:l.Flex,role:"button",className:t,width:"168px",height:"52px",color:"GBK03A",px:"8px",alignItems:"center",lineHeight:"normal"},_&&{onClick:i}),{css:function(e){var t;return{border:"1px solid ".concat(o?"transparent":_?e.colorMod(e.colors.GBL01A).alpha(.08):e.colors.GBK09A),boxShadow:o?"inset 0 0 0 2px ".concat(e.colors.GBL01A):"none",borderRadius:"3px",backgroundColor:e.colors.GBK99C,":hover":(t={background:_?e.colorMod(e.colors.GBL01A).alpha(.08):e.colors.GBK10A},(0,v._)(t,".".concat(m),{visibility:"visible"}),(0,v._)(t,"cursor",_?"pointer":"not-allowed"),t),position:"relative"}},children:[(0,a.tZ)(l.Flex,(0,g._)((0,r._)({},_&&{color:"GBL01A"}),{fontSize:"11px",fontWeight:"600",alignItems:"center",justifyContent:"space-between",children:(0,a.tZ)(u.$U,{zaBlock:"Delete",zaText:"删除投稿",zaType:"Button",as:l.Box,role:"button",className:m,onClick:function(e){e.stopPropagation(),null==c||c(s)},css:{cursor:"pointer",visibility:"hidden",position:"absolute",right:"-8px",top:"-8px"},children:(0,a.tZ)(E.Z,{size:12,css:function(e){return{color:e.colors.GRD03A,backgroundColor:e.colors.GBK99A,borderRadius:"50%",border:"2px solid ".concat(e.colors.GBK99A)}}})})})),(0,a.tZ)(l.Box,{fontSize:"14px",css:[(0,T.S)(2),{wordBreak:"break-all"}],children:f})]}));return(0,a.tZ)(u.eV,{block:"VideoAnswerItem",children:_?y:(0,a.tZ)(C.Z,{toggler:y,placement:"top",arrowed:!0,toggleEvent:"hover",children:(0,a.tZ)(l.Box,{fontSize:"12px",p:"8px",children:"已投稿问题仅支持在回答详情页编辑"})})})},S=function(e){var t=e.className,n=e.onClick,i=e.totalCount,c=e.currentCount,s=(0,o._)((0,m.Z)("zvideo_contribution_form:should_hide_new_tag"),2),p=s[0],h=s[1];return(0,a.BX)(u.$U,{zaType:"Button",zaAction:"",zaBlock:"AddVideoAnswer",zaText:"添加问题",as:l.Flex,className:t,role:"button",width:"168px",height:"52px",color:"GBL01A",alignItems:"center",justifyContent:"center",onClick:function(e){p||h(!0),null==n||n(e)},css:function(e){return(0,r._)({position:"relative",cursor:"pointer",borderRadius:"3px",border:"1px solid ".concat(e.colorMod(e.colors.GBL01A).alpha(.08)),":hover":{background:e.colorMod(e.colors.GBL01A).alpha(.08)},overflow:"hidden"},!p&&{"::after":{content:'"NEW"',position:"absolute",top:"0",right:"0",color:e.colors.GRD03A,fontSize:"8px",fontWeight:"bold",textAlign:"center",background:e.colorMod(e.colors.GRD03A).alpha(.08),borderBottomLeftRadius:"3px",padding:"4px"}})},children:[(0,a.tZ)(d.nY,{size:12}),(0,a.tZ)(l.Box,{fontSize:"14px",fontWeight:"500",mt:"1px",ml:"5px",children:c&&i?"继续添加 (".concat(c,"/").concat(i,")"):"添加问题"})]})},I=function(e){var t=e.zvideoId,n=e.showCreateButton,r=e.showSelect,o=void 0!==r&&r,u=e.onAdd,d=e.onSelect,h=e.isProduce,m=(0,s.useDispatch)(),v=(0,_.oL)(),g=(0,_.fh)(t);if(h)g.reverse();else{var T=g.filter(function(e){return 2===e.status}),E=g.filter(function(e){return 2!==e.status});E.reverse(),g=(0,i._)(E).concat((0,i._)(T))}var C=(0,_.cF)(t).answer,I=void 0===C?{}:C,b=I.canContribute,A=I.totalCount,Z=void 0===A?0:A,w=g.length,R=(0,c.Z)(function(e){m((0,_.O)(e.id)),m((0,_.ry)(e.id)),null==d||d(e)}),N=(0,c.Z)(function(e){p.Z.confirm((0,a.tZ)(l.Box,{textAlign:"center",children:"已编辑的投稿内容不会被保存"}),{title:(0,a.tZ)(l.Box,{ml:"23px",children:"确定删除该视频投稿？"}),text:{ok:"确认删除",cancel:"继续编辑"}}).then(function(){if(e.status&&0!==e.status){var n=e.target.object.id;n&&m((0,_.EB)(t,e.id,n))}else m((0,_.KQ)(t,e.id));m((0,_.O)(null))},f())});return(0,a.tZ)(l.Flex,{flexWrap:"wrap",ml:"-8px",children:(0,a.BX)(a.HY,{children:[g.map(function(e){return(0,a.tZ)(y,{selected:o&&(null==v?void 0:v.id)===e.id,onClick:function(){return R(e)},onDelete:function(){return N(e)},item:e,css:{marginLeft:"8px"}},e.id)}),void 0!==b&&b&&w<Z&&void 0!==n&&n&&(0,a.tZ)(S,{onClick:u,currentCount:w,totalCount:Z,css:{marginLeft:"8px"}})]})})}},18362:function(e,t,n){"use strict";var r=n(85879),o=n(65733),i=n(88329),a=n.n(i),c=n(87641),s=n(43384),l=n(57730),u=n(38889),d=n(95377),p=n(38876);t.Z=function(e){var t=e.isEditing,n=e.onSubmit,i=e.onCancel,h=e.selectedQuestion,f=e.value,_=e.onChange,m=(0,o.Z)(function(){n()}),v=(0,o.Z)(function(){f?l.Z.confirm((0,r.tZ)(c.Box,{textAlign:"center",children:t?"已编辑的投稿内容不会被保存":"当前输入的投稿内容不会被保存"}),{title:(0,r.tZ)(c.Box,{ml:"23px",children:t?"确定取消当前修改":"确定返回选择其他问题？"}),text:{ok:t?"取消修改":"确定返回",cancel:t?"继续编辑":"继续投稿"}}).then(i,a()):i()});return(0,r.BX)(s.eV,{block:"AnswerEditor",children:[(0,r.tZ)(p.Z,{selected:!0,item:h,css:{padding:"0 20px",marginTop:"24px"}}),(0,r.tZ)(s.$U,{zaType:"Input",zaAction:"Answer",as:c.Box,px:"20px",mt:"17px",flex:"1",children:(0,r.tZ)(d.Z,{autoFocus:!0,maxLength:"150000",value:f,onChange:function(e){_(e.target.value)},css:{width:"100%",height:"100%!important",textarea:{height:"100%"}},multiline:!0,placeholder:"针对问题介绍下视频（选填）"})}),(0,r.BX)(c.Flex,{height:"82px",justifyContent:"space-between",alignItems:"center",px:"20px",css:{button:{width:"236px"}},children:[(0,r.tZ)(s.$U,{zaType:"Button",zaAction:"Close",zaText:!0,as:u.ZP,onClick:v,children:t?"取消修改":"返回选择"}),(0,r.tZ)(s.$U,{zaType:"Button",zaAction:"Save",zaText:!0,as:u.ZP,onClick:m,preset:"primary",color:"blue",children:t?"提交修改":"添加投稿"})]})]})}},38876:function(e,t,n){"use strict";var r=n(85879),o=n(87363),i=n(43384),a=n(30722),c=n(38889),s=n(87641),l=s.Box,u=s.Flex;t.Z=function(e){var t=e.className,n=e.index,s=e.onSelect,d=e.selected,p=e.item,h=p.title,f=p.followCount,_=p.commentCount,m=p.visitCount,v=p.highlight,g=(0,o.useMemo)(function(){return[f,_,m].every(function(e){return"number"==typeof e})?["".concat((0,a.ok)(f)," 关注"),"".concat((0,a.ok)(_)," 评论"),"".concat((0,a.ok)(m)," 浏览")].join(" \xb7 "):null},[f,_,m]);return(0,r.BX)(i.$U,{zaBlock:"QuestionItem",zaType:"Card",zaText:g,view:{elementLocation:{card:{index:void 0===n?0:n}}},as:u,py:"12px",alignItems:"start",className:t,children:[(0,r.BX)(l,{flex:"1",children:[(0,r.tZ)(l,{fontSize:"15px",fontWeight:"500",dangerouslySetInnerHTML:{__html:(null==v?void 0:v.title)||h},css:function(e){return{wordBreak:"break-all",em:{fontStyle:"inherit",color:e.colors.GYL01A}}}}),g&&(0,r.tZ)(l,{mt:"3px",color:"GBL05A",fontSize:"14px",children:g})]}),void 0!==d&&d?(0,r.tZ)(c.ZP,{preset:"secondary",color:"blue",css:{cursor:"unset"},children:"已选择"}):(0,r.tZ)(c.ZP,{onClick:s,color:"blue",css:{padding:"0 9px",marginLeft:"20px"},children:"选择问题"})]})}},70938:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(99178),s=n(36892),l=n(65733),u=n(49274),d=n(82644),p=n(44066),h=n(88329),f=n.n(h),_=n(73411),m=n.n(_),v=n(87363),g=n(36695),T=n(87641),E=n(43384),C=n(5941),y=n(81956),S=n(4773),I=n(38876),b=m()(1);t.Z=function(e){var t=e.title,n=e.description,h=e.zvideoId,_=e.onSelect,m=(0,y.Z)(),A=(0,g.useDispatch)(),Z=(0,v.useRef)(),w=(0,i._)((0,v.useState)(!1),2),R=w[0],N=w[1],k=(0,i._)((0,v.useState)(""),2),O=k[0],x=k[1],P=(0,i._)((0,v.useState)([]),2),D=P[0],L=P[1],B=(0,g.useSelector)(function(e){return e.zvideos.contribution[R?"questionSearchResults":"recommendQuestions"]}),U=B.isLoading,M=B.paging.isEnd,G=B.data,F=(0,E.Q4)(),z=(0,s.Z)(function(e){return b(function(){return m("/api/v4/search/suggest",{query:{q:e},headers:{"X-API-Version":"3.0.91","X-App-Za":"OS=Web"}})}).then(function(e){L(e.payload.suggest.map(function(e,t){return(0,o._)((0,r._)({},e),{name:e.query,index:t})}))},f())},500),H=(0,v.useCallback)(function(){Z.current&&(Z.current.scrollTop=0)},[]),q=(0,l.Z)(function(e){e!==O&&(x(e),e?z(e):(H(),N(!1),L([])))}),V=(0,l.Z)(function(e,t){var n=t.index;F.trackEvent({eventType:"Click",action:"Question",block:"SuggestItem",elementLocation:{type:"Text",text:e,card:{index:n}}}),H(),x(e),N(!0),A((0,S.nL)(e,!0))}),X=(0,l.Z)(function(){O&&(H(),N(!0),A((0,S.nL)(O,!0)))}),W=(0,l.Z)(function(){G.length&&(O?A((0,S.nL)()):A((0,S.GC)()))});return(0,v.useEffect)(function(){A((0,S.GC)({zvideoId:h,title:t,description:n},!0))},[h,t,n,A]),(0,a.BX)(a.HY,{children:[(0,a.tZ)(T.Box,{px:"20px",my:"24px",fontSize:"24px",fontWeight:"500",children:"选择投稿问题"}),(0,a.tZ)(C.Z,{autoSelect:!1,value:O,onChange:q,onSelect:V,onEnterInput:X,items:D,css:{".Popover":{width:"100%",padding:"0 20px",boxSizing:"border-box"},".Input-wrapper":{width:"100%"}},inputProps:{grey:!0,placeholder:"搜索相关问题…",after:O?(0,a.tZ)(d.HN,{size:16,css:function(e){return{cursor:"pointer",color:e.colors.GBK07A}},onClick:function(){return q("")}}):(0,a.tZ)(p.J7,{size:20,css:function(e){return{color:e.colors.GBL05A}}})},menuProps:{style:{width:"470px"}}}),M&&!G.length?(0,a.tZ)(u.H.EI1,{image:"default",content:"暂无相关问题"}):(0,a.tZ)(c.ZP,{onRef:Z,css:{flex:"1",padding:"0 20px",overflowY:"auto"},isLoading:U,isDrained:M,onLoad:W,getContainer:function(e){return e},children:G.map(function(e,t){return(0,a.tZ)(I.Z,{onSelect:function(){_(e)},index:t,item:e,css:function(e){return{"& + &":{borderTop:"1px solid ".concat(e.colors.GBK09A)}}}},e.id)})})]})}},25229:function(e,t){"use strict";t.Z=function(e){return e?e.replace(/\n/g,"<br>"):e}},5934:function(e,t,n){"use strict";n.d(t,{Z:function(){return x}});var r=n(55164),o=n(94009),i=n(85879),a=n(65733),c=n(43897),s=n(87363),l=n(36695),u=n(87641),d=n(69383),p=n(31467),h=n(38889),f=function(e){var t=e.dataTransfer;return t.items?Array.from(t.items).filter(function(e){return"file"===e.kind}).map(function(e){return e.getAsFile()}):Array.from(t.files)},_=n(78110),m=n.n(_),v=n(66263),g=n(67927),T=n(41492),E=n(67814),C=n.n(E),y=n(43384),S=function(e){var t=e.className,n=e.text,r=e.onFiles,o=e.zaClickId,a=e.zaBlockText,c=e.multiple,l=e.disabled,p=e.preset,f=e.size,_=e.icon,m=e.handleMouseEnter,g=e.handleMouseLeave,T=(0,s.useRef)(null);return(0,i.BX)(i.HY,{children:[(0,i.tZ)(y.$U,{zaText:!0,zaType:"Button",as:u.Box,zaBlock:a,zaAction:"Upload",css:{display:"spread"===f?"block":"inline-block"},onMouseEnter:m,onMouseLeave:g,children:(0,i.tZ)(h.ZP,{className:C()("VideoUploadButton",t),preset:p||"primary",size:f||"spread",color:"blue",disabled:l,icon:_,onClick:function(e){o&&d.Z.trackEvent(e.target,{id:o,action:"Upload"}),T.current.click()},children:n})}),(0,i.tZ)("input",{type:"file",className:"VideoUploadButton-fileInput",ref:T,onChange:function(){r(T.current.files,"Add"),T.current.value=null},accept:v.CZ.VIDEO.join(","),multiple:void 0===c||c})]})},I=n(24405),b=(0,s.memo)(function(e){var t=e.className,n=e.showRuleDesc,r=(0,I.F)().colors;return(0,i.BX)(u.Box,{className:t,css:{fontSize:14,lineHeight:"22px",color:r.GBL05A,textAlign:"center",a:{textDecoration:"underline"}},children:[void 0!==n&&n&&(0,i.BX)(u.Flex,{marginTop:34,fontSize:10,width:688,justifyContent:"center",children:[(0,i.BX)(u.Box,{css:{width:"134px"},children:[(0,i.tZ)(u.Text,{css:{color:r.GBK04A,fontWeight:500,marginBottom:6},fontSize:13,children:"视频大小"}),(0,i.tZ)(u.Text,{fontSize:12,lineHeight:1.4,css:{color:r.GBK06A},children:"时长和大小均不限"}),(0,i.tZ)(u.Text,{fontSize:12,lineHeight:1.4,css:{color:r.GBK06A},children:"推荐上传大小为 5G 以内"})]}),(0,i.BX)(u.Box,{css:{width:"340px",position:"relative",margin:"0 40px","&::after,&::before":{content:'""',position:"absolute",width:1,height:20,verticalAlign:"middle",top:"50%",transform:"translate(0,-50%)",backgroundColor:r.GBK09A},"&::after":{left:0},"&::before":{right:0}},children:[(0,i.tZ)(u.Text,{css:{color:r.GBK04A,fontWeight:500,marginBottom:6},fontSize:13,children:"视频分辨率"}),(0,i.tZ)(u.Text,{fontSize:12,lineHeight:1.4,css:{color:r.GBK06A},children:"最大支持 1080P"}),(0,i.tZ)(u.Text,{fontSize:12,lineHeight:1.4,css:{color:r.GBK06A},children:"分辨率超过 1920 *1080，会被压缩为 1920 *1080"})]}),(0,i.BX)(u.Box,{css:{width:"134px"},children:[(0,i.tZ)(u.Text,{css:{color:r.GBK04A,fontWeight:500,marginBottom:6},fontSize:13,children:"视频格式"}),(0,i.tZ)(u.Text,{fontSize:12,lineHeight:1.4,css:{color:r.GBK06A},children:"支持常用视频格式"}),(0,i.tZ)(u.Text,{fontSize:12,lineHeight:1.4,css:{color:r.GBK06A},children:"推荐使用 mp4"})]})]}),(0,i.BX)(u.Text,{marginTop:35,color:r.GBL05A,fontSize:12,children:["上传视频，即代表您已同意"," ",(0,i.tZ)("a",{href:"https://www.zhihu.com/question/20118966",target:"_blank",rel:"noopener noreferrer",css:{color:r.GBL07A},children:"知乎视频使用规范"})," ","与"," ",(0,i.tZ)("a",{href:"https://www.zhihu.com/term/video",target:"_blank",rel:"noopener noreferrer",css:{color:r.GBL07A},children:"《知乎视频用户协议》"})]})]})}),A=n(99178),Z=n(70400),w=n(96813),R=n(80565),N=n(44169);function k(e){var t=e.item,n=e.onCheck,r=(0,o._)((0,s.useState)(!1),2),a=r[0],c=r[1],l=t.id,d=t.title,p=t.description,h=t.imageUrl,f=t.publishedAt,_=t.video,v=null==_?void 0:_.duration;return(0,i.BX)(u.Flex,{p:"20px 24px",justifyContent:"space-between",alignItems:"center",children:[(0,i.BX)(u.Flex,{flex:1,children:[(0,i.BX)(u.Box,{width:112,height:70,flexShrink:0,marginRight:"16px",css:{position:"relative",borderRadius:3,overflow:"hidden"},children:[(0,i.tZ)(u.Image,{width:"100%",height:"100%",src:h,alt:"",css:{objectFit:"cover"}}),(0,i.tZ)(u.Text,{fontSize:12,lineHeight:"14px",color:"GBK99A",css:{position:"absolute",bottom:4,right:7,textShadow:"0 0 5px rgba(0,0,0,0.5)"},children:"number"!=typeof v?null:"".concat(String(Math.floor(v/60)),":").concat(m()(String(Math.floor(v%60)),2,"0"))})]}),(0,i.BX)(u.Flex,{flexDirection:"column",justifyContent:"center",flex:1,children:[(0,i.tZ)(u.Text,{fontSize:14,fontWeight:500,lineHeight:"20px",color:"GBK03A",css:[(0,R.S)(1)],children:d}),(0,i.tZ)(u.Text,{mt:"6px",fontSize:14,lineHeight:"20px",color:"GBK04A",css:[(0,R.S)(1)],children:p}),(0,i.tZ)(u.Text,{mt:"8px",fontSize:13,lineHeight:"16px",color:"GBK06A",children:(0,N.rL)(f)})]})]}),(0,i.tZ)(w.C,{css:{marginLeft:16,flexShrink:0},checked:a,onChange:function(e){c(e.currentTarget.checked),n(l)}})]})}function O(e){var t,n=e.onClose,r=e.onSubmit,a=(0,o._)((0,s.useState)([]),2),c=a[0],d=a[1],p=(0,l.useSelector)(function(e){return e.zvideos.insertable})||{},f=p.isLoading,_=p.data,m=p.paging,v=(0,l.useDispatch)(),g=(0,s.useCallback)(function(){v((0,T.Fn)())},[v]),E=(0,s.useCallback)(function(e){c.includes(e)?d(c.filter(function(t){return t!==e})):d(c.concat([e]))},[c]);return(0,i.BX)(u.Box,{height:688,children:[(0,i.tZ)(u.Box,{m:"40px auto",fontSize:24,fontWeight:500,lineHeight:"30px",color:"GBK02A",textAlign:"center",children:"选择已发布的视频"}),(0,i.tZ)(A.ZP,{css:{marginBottom:100},onLoad:g,isLoading:null!=f&&f,isDrained:null!==(t=null==m?void 0:m.isEnd)&&void 0!==t&&t,getContainer:function(e){return e.parentElement.parentElement.parentElement},children:_.map(function(e,t){return(0,i.tZ)(Z.SV,{children:(0,i.tZ)(k,{item:e,onCheck:E})},t)})}),(0,i.BX)(u.Flex,{bg:"GBK99A",p:"32px 25px",width:"100%",height:100,justifyContent:"center",css:{position:"absolute",left:0,right:0,bottom:0},children:[(0,i.tZ)(h.ZP,{css:{flex:1},onClick:n,children:"返回"}),(0,i.tZ)(h.ZP,{disabled:0===c.length,css:{flex:1,marginLeft:18},preset:"primary",color:"blue",onClick:function(){r(c),n()},children:"添加"})]})]})}var x=function(e){var t=e.show,n=e.onZVideoSubmit,_=e.onVideoSubmit,m=e.onClose,E=((0,l.useSelector)(function(e){return e.zvideos.insertable})||{}).data,C=(0,o._)((0,s.useState)(!1),2),y=C[0],I=C[1],A=(0,o._)((0,s.useState)(!1),2),Z=A[0],w=A[1],R=(0,l.useDispatch)(),N=function(){if((null==E?void 0:E.length)>0){w(!0);return}R((0,T.Fn)()).then(function(e){e.payload.data.length?w(!0):R((0,g.c0)("还没有发布过视频"))})},k=(0,a.Z)(function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.multiple,r=void 0!==n&&n,o=t.numLimit,i=void 0===o?v.lM:o,a=t.uploadPartiallyWhenExceedsLimit,c=Array.from(e).filter(function(e){return v.CZ.VIDEO.some(function(t){return e.name.toLowerCase().endsWith(t)})});if(0===c.length)return{message:"视频格式不支持",abortUpload:!0};var s=c.filter(function(e){return e.size>102400});return 0===s.length?{message:"视频必须大于 100KB，请重新选择上传",abortUpload:!0}:!r&&s.length>1?{message:"一次仅能上传一个视频，请分开上传",abortUpload:!1,validFiles:[s[0]]}:r&&s.length>i?0===i?{message:"上传个数已达上限",abortUpload:!0}:void 0===a||a?{message:"最多可上传 ".concat(i," 个视频，已默认选择").concat(i>1?"前":"第"," ").concat(i," 个视频"),abortUpload:!1,validFiles:s.slice(0,i)}:{message:"一次最多上传 ".concat(i," 个视频, 请重新选择上传"),abortUpload:!0}:{message:null,abortUpload:!1,validFiles:s}}(e),n=t.message,r=t.abortUpload,o=t.validFiles;n&&(R((0,g.c0)(n,r?"red":"white")),r)||_({value:o[0]})});return t?(0,i.BX)(p.Z,{css:{width:688},onClose:m,children:[Z&&(0,i.tZ)(O,{onSubmit:n,onClose:function(){w(!1)}}),!Z&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(u.Text,{fontSize:"24px",color:"GBK02A",lineHeight:"34px",fontWeight:500,m:"40px 0 30px",textAlign:"center",children:"导入视频"}),(0,i.BX)(u.Flex,{flexDirection:"column",alignItems:"center",width:"440px",height:"300px",margin:"0 auto 45px",css:function(e){return(0,r._)({border:"2px dashed ".concat(e.colors.GBK09A),borderRadius:4},y&&{borderColor:e.colors.GBL05A,"*":{pointerEvents:"none"}})},onDragOver:function(e){return e.preventDefault()},onDragEnter:function(){return I(!0)},onDragLeave:function(){return I(!1)},onDrop:function(e){e.preventDefault(),k(f(e))},children:[(0,i.tZ)(c.z,{size:90,css:function(e){return{color:y?e.colors.GBL05A:e.colors.GBK09A,marginTop:66}}}),(0,i.tZ)(u.Text,{color:"GBK03A",fontSize:"20px",lineHeight:"28px",fontWeight:"500",mt:"16px",children:"拖放要导入的视频文件"}),(0,i.BX)(u.Box,{mt:"20px",children:[(0,i.tZ)(S,{text:"导入视频",multiple:!1,css:{width:142},zaBlockText:"UploadVideoFile",onFiles:k}),(0,i.tZ)(h.ZP,{preset:"secondary",color:"blue",css:{width:142,marginLeft:12,padding:"0 14px",whiteSpace:"nowrap"},onClick:function(e){d.Z.trackEvent(e.target,{id:8622,action:"Click"},{button:{text:"选择已发布的视频"}}),N()},children:"选择已发布的视频"})]})]}),(0,i.tZ)(b,{})]})]}):null}},57508:function(e,t,n){"use strict";n.d(t,{o:function(){return u},Z:function(){return d}});var r=n(15030),o=n(55164),i=n(94009),a=n(85879),c=n(65733),s=n(87363),l=n(81956),u=(0,s.createContext)({}),d=function(e){var t=e.children,n=e.zvideo_id,d=e.defaultVideo,p=(0,i._)((0,s.useState)(null),2),h=p[0],f=p[1],_=(0,l.Z)(),m=(0,c.Z)(function(e){_&&n&&_("/api/v4/zvideos/".concat(n,"/publish/permissions?full_duration_millis=").concat(e)).then(function(e){if(e.ok){var t=e.payload,n=(null!=t?t:{}).chapters;n&&f((0,o._)({},n,{minInterval:"number"==typeof n.minInterval?parseInt("".concat(n.minInterval/1e3)):5}))}})}),v=(0,s.useRef)();return(0,s.useEffect)(function(){if(n&&void 0===v.current){var e,t;d.file&&(0,r._)(d.file,File)?(e=d.file,new Promise(function(t,n){try{var r=document.createElement("video");r.preload="metadata",r.onloadedmetadata=function(){URL.revokeObjectURL(r.src),t(Math.floor(1e3*r.duration))},r.onerror=n,r.src=URL.createObjectURL(e)}catch(e){n(e)}})).then(function(e){v.current=e,m(e)}):(null===(t=d.video)||void 0===t?void 0:t.duration)&&m(1e3*d.video.duration)}},[d,n,_,m]),(0,a.tZ)(u.Provider,{value:h,children:h&&t})}},32854:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(9219),s=n(27723),l=n(19076),u=n(87641),d=n(1733),p=n(97476),h=n(38889);function f(e){var t=e.children,n=(0,i._)(e,["children"]);return(0,a.tZ)(d.sN,(0,o._)((0,r._)({css:function(e){return{height:36,display:"flex",alignItems:"center",color:e.colors.GBL05A,fontSize:"14px"}}},n),{children:t}))}t.Z=(0,l.withRouter)(function(e){var t=e.location,n=(0,a.tZ)(h.ZP,{component:u.Flex,preset:"plain",color:"gray",alignItems:"center",mr:"20px",children:"切换模式"});return(0,a.BX)(d.ZP,{positionStatus:"fixed",toggler:n,boundary:{padding:16},children:[(0,a.BX)(f,{onClick:p.Gb,children:[(0,a.tZ)(c.Z,{css:{marginRight:6}}),"无障碍"]}),(0,a.BX)(f,{tag:"a",href:(0,p.cg)((null==t?void 0:t.pathname)||""),children:[(0,a.tZ)(s.Z,{css:{marginRight:6}}),"关怀版"]})]})})},97476:function(e,t,n){"use strict";n.d(t,{cg:function(){return c},Gb:function(){return a}}),n(81897);var r=n(23483),o=n(80714);n(85879);var i=new r.xQ;function a(){var e;null===(e=window.aria)||void 0===e||e.start()}function c(e){return"https://".concat(o.Z.wwwHost,"/aria").concat(e)}"undefined"!=typeof window&&(window.RQ_HALW_QDPH=function(){i.next("off")},window.RQ_VWDUW_QDPH=function(){i.next("on")})},31318:function(e,t,n){"use strict";n.d(t,{Z:function(){return ei}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),l=n(85879),u=n(87977),d=n(83921),p=n(67814),h=n.n(p),f=n(35695),_=n(78160),m=n(14168),v=n.n(m),g=n(87363),T=n(13844),E=n(7181),C=n(49899),y=n(98690),S=n(54674),I=n(99878),b=n(87123),A=n(24943),Z=n(64101),w=n(45088),R=n(44250),N=n(82764),k=n(94115),O=n(99495),x=n(69306),P=n(152),D=n(25626),L=n(9539),B=n(28872),U=n(22083),M=n(74296),G=n(46148),F=n(98813),z=n(70362),H=n(98029),q=n(48641),V=n(35273),X=n(79846),W=n(64956),K=n(78110),j=n.n(K),Y=n(55164),Q=n(57477),J=n(94009),$=n(87641),ee=[{key:"hour",title:"时",length:24},{key:"minutes",title:"分",length:60},{key:"second",title:"秒",length:60}],et={hour:"00",minutes:"00",second:"00"},en=function(e){var t=e.value,n=void 0===t?et:t,r=e.onChange,o=(0,J._)((0,g.useState)(n),2),i=o[0],c=o[1],s=(0,g.useCallback)(function(e,t){return function(){var n=(0,Q._)((0,Y._)({},i),(0,a._)({},e,t));c(n),null==r||r(n)}},[i,r]);return(0,g.useEffect)(function(){c(n)},[n]),(0,l.tZ)($.Flex,{mt:"10px",height:"170px",flex:"0 0 100%",children:ee.map(function(e){var t=e.key,n=e.title,r=e.length;return(0,l.BX)($.Box,{px:"8px",css:function(e){return{borderLeft:"1px solid ".concat(e.colorMod(e.colors.GBL01A).alpha(.1)),textAlign:"center"}},children:[(0,l.tZ)($.Text,{fontSize:"12px",lineHeight:"24px",color:"GBL05A",children:n}),(0,l.tZ)($.Box,{css:{height:"140px",overflowY:"scroll",cursor:"pointer","&::-webkit-scrollbar":{display:"none"}},children:Array(r).fill().map(function(e,n){var r=j()(String(n),2,"0"),o=r===i[t];return(0,l.tZ)($.Text,{fontSize:"14px",height:"24px",lineHeight:"24px",css:function(e){return(0,Y._)({borderRadius:"4px"},o?{background:e.colors.GBL01A,color:e.colors.GBK99A}:{"&:hover":{background:e.colorMod(e.colors.GBL01A).alpha(.1)}})},onClick:s(t,r),children:r},"".concat(t,"_").concat(r))})})]},t)})})},er=["日","一","二","三","四","五","六"],eo=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{calendarDate:e.props.defaultCalendarDate||(Array.isArray(e.props.value)?e.props.value[0]:e.props.value),hoveringDate:null,now:new Date}),(0,a._)((0,r._)(e),"handlePrevYearClick",function(){var t=(0,A.Z)(e.state.calendarDate,-1);e.setState({calendarDate:t}),e.props.onCalendarDateChange(t)}),(0,a._)((0,r._)(e),"handlePrevMonthClick",function(){var t=(0,Z.Z)(e.state.calendarDate,-1);e.setState({calendarDate:t}),e.props.onCalendarDateChange(t)}),(0,a._)((0,r._)(e),"handleNextMonthClick",function(){var t=(0,Z.Z)(e.state.calendarDate,1);e.setState({calendarDate:t}),e.props.onCalendarDateChange(t)}),(0,a._)((0,r._)(e),"handleNextYearClick",function(){var t=(0,A.Z)(e.state.calendarDate,1);e.setState({calendarDate:t}),e.props.onCalendarDateChange(t)}),(0,a._)((0,r._)(e),"handleDayClick",function(t){e.setState({calendarDate:t}),e.props.onCalendarDateChange(t),e.props.onChange(t)}),(0,a._)((0,r._)(e),"onTimeChange",function(t){var n=t.hour,r=t.minutes,o=t.second,i=(0,w.Z)((0,R.Z)((0,N.Z)(e.state.calendarDate,Number(n)),Number(r)),Number(o));e.handleDayClick(i)}),(0,a._)((0,r._)(e),"handleDayHover",function(t){e.setState({hoveringDate:t}),e.props.onHover(t)}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.weekStartsOn,o=t.value,i=t.disabledDate,a=t.showToday,c=t.showPrevMonth,s=t.showPrevYear,u=t.showNextMonth,d=t.showNextYear,p=t.showTime,f=t.isFirst,m=this.state,v=m.calendarDate,g=m.hoveringDate,T=m.now,E=(0,k.Z)((0,O.Z)(v),{weekStartsOn:r}),A=(0,x.Z)((0,P.Z)(v),{weekStartsOn:r}),Z=(0,C._)(Array((0,D.Z)(A,E)+1)).map(function(e,t){return(0,L.Z)(E,t)}).reduce(function(e,t){var n=(0,B.Z)(t,E,{weekStartsOn:r});return e[n]=e[n]?(0,C._)(e[n]).concat([t]):[t],e},[]),w=Z[0].map(U.Z),R=Array.isArray(o);return(0,l.BX)("div",{className:h()("Calendar",n,{"Calendar--hasBottomTool":a,"Calendar--showtime":p}),children:[(0,l.BX)("div",{className:"Calendar-topTool",children:[s&&(0,l.tZ)("button",{className:"Calendar-topToolButton Calendar-topToolButton--prevYear",onClick:this.handlePrevYearClick,children:(0,l.tZ)(y.t,{size:20,center:!0})}),c&&(0,l.tZ)("button",{className:"Calendar-topToolButton Calendar-topToolButton--prevMonth",onClick:this.handlePrevMonthClick,children:(0,l.tZ)(S.e,{size:20,center:!0})}),(0,l.tZ)("div",{className:"Calendar-topToolDate",children:(0,_.Z)(v,"yyyy 年 M 月")}),u&&(0,l.tZ)("button",{className:"Calendar-topToolButton Calendar-topToolButton--nextMonth",onClick:this.handleNextMonthClick,children:(0,l.tZ)(I.N,{size:20,center:!0})}),d&&(0,l.tZ)("button",{className:"Calendar-topToolButton Calendar-topToolButton--nextYear",onClick:this.handleNextYearClick,children:(0,l.tZ)(b.r,{size:20,center:!0})})]}),(0,l.BX)("div",{className:"Calendar-date",children:[(0,l.BX)("table",{className:"Calendar-table",cellSpacing:0,children:[(0,l.tZ)("thead",{className:"Calendar-thead",children:(0,l.tZ)("tr",{children:w.map(function(e){return(0,l.tZ)("th",{className:"Calendar-weekName",children:er[e]},e)})})}),(0,l.tZ)("tbody",{children:Z.map(function(t,n){return(0,l.tZ)("tr",{children:t.map(function(t,n){var r=i(t),a=R?(0,q.Z)(t,o[0])||(0,q.Z)(t,o[1]):(0,q.Z)(t,o),c=!1;if(R){var s=(0,z.Z)(o),u=(0,H.Z)(o);c=(0,V.Z)(t,s)>0&&(0,V.Z)(u,t)>0}return(0,l.tZ)("td",{className:h()("Calendar-day",{"is-hovered":(0,q.Z)(t,g),"is-today":(0,q.Z)(t,T),"is-disabled":r,"is-not-this-month":!(0,X.Z)(t,v),"is-input-date":a,"is-in-range":c}),onClick:function(){r||e.handleDayClick(t)},onMouseEnter:function(){r||e.handleDayHover(t)},onMouseLeave:function(){r||e.handleDayHover(null)},children:(0,W.Z)(t)},n)})},n)})})]}),p&&(0,l.tZ)(en,{value:function(){var e=function(e){return{hour:j()(String((0,M.Z)(e)),2,"0"),minutes:j()(String((0,G.Z)(e)),2,"0"),second:j()(String((0,F.Z)(e)),2,"0")}};if(R){var t=(0,z.Z)(o),n=(0,H.Z)(o);return e(f?t:n)}return e(o)}(),onChange:this.onTimeChange})]}),a&&(0,l.tZ)("div",{className:"Calendar-bottomTool",children:a&&(0,l.tZ)("button",{className:"Calendar-todayButton",onClick:function(){return e.handleDayClick(T)},disabled:i(T),children:"今天"})})]})}}]),n}(g.Component);(0,a._)(eo,"defaultProps",{weekStartsOn:0,disabledDate:function(){return!1},onChange:function(){return!1},onCalendarDateChange:function(){return!1},onHover:function(){return!1},showToday:!0,showPrevMonth:!0,showPrevYear:!0,showNextMonth:!0,showNextYear:!0,showTime:!1}),eo.propTypes={defaultCalendarDate:v().instanceOf(Date),value:v().oneOfType([v().instanceOf(Date),v().arrayOf(v().instanceOf(Date))]),weekStartsOn:v().number,disabledDate:v().func,onChange:v().func,onHover:v().func,showToday:v().bool,showPrevMonth:v().bool,showPrevYear:v().bool,showNextMonth:v().bool,showNextYear:v().bool};var ei=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{isFocused:!1}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.large,o=t.value,i=t.onChange,a=t.isButtonActive,c=t.toggler,s=t.disabledDate,p=t.getContainer,m=t.placeholder,v=t.showIcon,g=this.state.isFocused;return(0,l.tZ)(E.Z,{className:h()("DatePicker",n),toggler:c||(0,l.BX)(T.Z,{large:r,className:h()("DatePicker-Button",{"is-active":g||a}),children:[void 0!==v&&v&&(0,l.tZ)(u.i,{center:!0,size:20}),o?_.Z(o,"yyyy/MM/dd"):m,(0,l.tZ)(d.ji,{css:{marginLeft:8}})]}),onOpen:function(){e.setState({isFocused:!0})},onClose:function(){e.setState({isFocused:!1})},ref:function(t){e.popover=t},placement:"bottom",arrowed:!0,preventCloseOnTarget:!0,getContainer:p,children:(0,l.tZ)(eo,{value:o||f.Z(),onChange:function(t){e.popover.close(),i(t)},disabledDate:s})})}}]),n}(g.Component);(0,a._)(ei,"propTypes",{toggler:v().element,disabledDate:v().func})},61514:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),l=n(85879),u=n(67814),d=n.n(u),p=n(45088),h=n(72280),f=n(66345),_=n(48127),m=n(32293),v=n(74382),g=n(22926),T=n(21619),E=n(71905),C=n(78160),y=n(82764),S=n(74296),I=n(44250),b=n(46148),A=n(33960),Z=n.n(A),w=n(78110),R=n.n(w),N=n(67633),k=n.n(N),O=n(87363),x=n(45001),P=n(31318),D=k()(0,24).map(function(e){return R()(e,2,"0")}),L=k()(0,60).map(function(e){return R()(e,2,"0")}),B=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{value:p.Z(e.props.value,0)}),e}return(0,i._)(n,[{key:"handleChange",value:function(e,t){var n=this.props,r=n.onChange,o=n.min,i=n.max,a=e;o&&h.Z(e,o)&&(a=o),i&&f.Z(e,i)&&(a=i),this.setState({value:a}),r(a,t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.large,o=t.min,i=t.max,a=t.onRef,c=t.showIcon,s=this.state.value,u=o&&_.Z(m.Z(s),m.Z(o)),p=u&&_.Z(v.Z(s),v.Z(o)),A=i&&_.Z(m.Z(s),m.Z(i)),w=A&&_.Z(v.Z(s),v.Z(i));return(0,l.BX)("div",{className:d()("DateTimePicker",n),ref:a,children:[(0,l.tZ)(P.Z,{showIcon:void 0!==c&&c,large:r,value:s,disabledDate:function(e){return!!(o&&h.Z(e,m.Z(o))||i&&f.Z(e,m.Z(i)))},onChange:function(t){e.handleChange(Z()(function(e){return g.Z(e,t.getFullYear())},function(e){return T.Z(e,t.getMonth())},function(e){return E.Z(e,t.getDate())})(s),{date:t})}}),(0,l.tZ)(x.Z,{listClassName:"DateTimePicker-selectList",large:r,value:C.Z(s,"HH"),onChange:function(t){return e.handleChange(y.Z(s,t),{hours:t})},children:D.map(function(e){var t=u&&e<S.Z(o)||A&&e>S.Z(i);return(0,l.tZ)(x.W,{value:e,disabled:t,css:function(e){return{color:t?e.colors.GBK07B:e.colors.GBK02A}}},e)})}),(0,l.tZ)("span",{className:"DateTimePicker-label",children:"时"}),(0,l.tZ)(x.Z,{listClassName:"DateTimePicker-selectList",large:r,value:C.Z(s,"mm"),onChange:function(t){return e.handleChange(I.Z(s,t),{minutes:t})},children:L.map(function(e){var t=p&&e<b.Z(o)||w&&e>b.Z(i);return(0,l.tZ)(x.W,{value:e,disabled:t,css:function(e){return{color:t?e.colors.GBK07B:e.colors.GBK02A}}},e)})}),(0,l.tZ)("span",{className:"DateTimePicker-label",children:"分"})]})}}]),n}(O.Component);t.Z=B},66654:function(e,t,n){"use strict";n.r(t);var r=JSON.parse(document.getElementById("js-clientConfig").textContent);t.default=r},80714:function(e,t,n){"use strict";var r=n(66654);t.Z=r.default},66263:function(e,t,n){"use strict";n.d(t,{AW:function(){return G},An:function(){return S},BR:function(){return p},Bg:function(){return er},CZ:function(){return X},Dm:function(){return N},G5:function(){return Q},If:function(){return T},K9:function(){return k},K_:function(){return s},LA:function(){return U},M:function(){return Z},M5:function(){return C},Pw:function(){return f},R8:function(){return P},Sp:function(){return M},T$:function(){return g},TY:function(){return R},Uw:function(){return w},W0:function(){return O},Wy:function(){return E},Xq:function(){return H},aK:function(){return W},dN:function(){return ee},dd:function(){return Y},fH:function(){return b},hY:function(){return A},i3:function(){return F},i7:function(){return l},iG:function(){return y},jB:function(){return x},lH:function(){return J},lM:function(){return z},o$:function(){return K},o7:function(){return I},oP:function(){return D},of:function(){return V},ov:function(){return $},pL:function(){return j},q0:function(){return v},rX:function(){return u},t6:function(){return en},ur:function(){return B},vg:function(){return d},xR:function(){return q},yK:function(){return h},zg:function(){return _},zs:function(){return L}});var r=n(87320),o=n(55164),i=n(57477),a=n(88423),c=n(80714),s={"-1":"他",0:"她",1:"他"},l="//www.zhihu.com",u="column"!==c.Z.currentEntry?"":l,d="//zhuanlan.zhihu.com",p=52,h="www.zhihu.com",f={hang:"hang",lock:"lock",ban:"ban",isForceRenamed:"isForceRenamed",isGuest:"isGuest",destroy:"destroy",suicide:"suicide",notBindPhone:"notBindPhone"},_=Object.keys(f).map(function(e){return f[e]}),m={follow:[f.ban,f.isForceRenamed,f.notBindPhone,f.isGuest],report:[f.ban,f.notBindPhone],share:[f.ban,f.isForceRenamed],editProfile:[f.ban,f.isForceRenamed,f.notBindPhone],thank:[f.notBindPhone],deblock:[f.lock],vote:[f.notBindPhone],favlists:[f.notBindPhone],like:[f.notBindPhone],message:[f.notBindPhone],serviceAccountMessage:[f.notBindPhone,f.ban],deletePin:[f.notBindPhone],invite:[f.notBindPhone],getCoupon:[f.notBindPhone],gift:[f.notBindPhone],blockUser:[f.notBindPhone],buy:[f.notBindPhone]},v=Object.keys(m).reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t,_.filter(function(e){return!m[t].includes(e)})))},{}),g={blocking:"因为你已将此人屏蔽，暂时无法进行该操作。您可以进入他的个人主页解除屏蔽。",commentBlocked:"根据对方设置，暂时无法进行评论操作。",blocked:"根据对方设置，暂时无法进行该操作。"},T=2400,E=1e4,C={sina:"3063806388",qqconn:"100490701",wechat:"wx268fcfe924dcb171",mobileWechat:"wx21dd00cd1ccac236"},y="bindPhoneLastAlertTime",S=4039,I=100007,b=1e5,A=100010,Z=100016,w=100017,R=100018,N=100028,k=40312,O=110600,x={add:"annotation",cancel:"annotation_cancel",view:"show_annotation_detail"},P=0,D=1,L=2,B={topic:"Topic",people:"User",column:"Column",collection:"Collection",live:"Live",ebook:"EBook",publication:"EBook",pin:"Pin",article:"Post",answer:"Answer",question:"Question",question_ask:"QuestionAsk",promotion:"Promotion",roundtable:"RoundtableItem",live_course:"LiveCourse",remix_album:"RemixAlbum",search_course:"LiveCourse",search_special:"LiveAlbum",out_link:"ExternalAd",ad:"Ad",album:"RemixAlbum",rewardPeople:"User",zvideo:"Video"},U={question:"Question",answer:"Answer",comment:"Comment",message:"Message",pin:"Pin",live:"Live",live_message:"LiveMessage",book_review:"BookReview",promotion:"Promotion",column:"Column",theater:"Theater",drama:"Drama",zvideo:"Zvideo",zvideo_collection:"ZvideoCollection",topic:"Topic",collection:"Collection",question_ask:"QuestionAsk",roundtable:"Roundtable",ebook:"EBook",remix_album:"RemixAlbum",live_course:"LiveCourse",ad:"Ad",article:"Post",favlist:"Collection",people:"User",member:"User",publication:"EBook",album:"RemixAlbum",search_course:"LiveCourse",search_special:"LiveAlbum",out_link:"ExternalAd",paid_consultation_question:"Conversation",paid_consultation_answer:"Conversation",activity:"Unknown",live_feedback:"Unknown",live_feedback_reply:"Unknown",infinity:"Unknown",zhihu_daily:"Unknown",market_comment:"Unknown",topic_log:"Unknown",book_note:"Unknown",discussion_review:"Unknown",drama_bullet:"Unknown",drama_statement:"Unknown",bullet:"Unknown",vip_comment:"Unknown",search_suggested_word:"Unknown",zpoll:"Unknown"},M="真诚赞赏，手留余香",G={abuseip:40350,imfrozen:40351,unhuman:40352},F=10,z=20,H="global::enableShortcut",q={alertTimeSpan:3600,canWrite:!1,tip:"应国家法规对于账号实名的要求，进行下一步操作前，需要先完成手机绑定。"},V={NO_AUTH:-1,ENTER_RECRUIT:0,NO_SETTING:1,PASS:2},X={IMAGE:[".png",".jpeg",".gif",".jpg"],VIDEO:[".3gp",".asf",".avi",".dat",".f4v",".flv",".m4v",".mkv",".mov",".mp4",".mp4v",".mpe",".mpeg",".mpg",".ra",".ram",".rm",".rmvb",".vob",".webm",".wm",".wmv"]},W={id:null,urlToken:null,name:"匿名用户",gender:-1,avatarUrl:(0,a.imgUrl)("https://pic1.zhimg.com/v2-d41c2ceaed8f51999522f903672a521f.jpeg","is"),headline:null,badge:null,isOrg:!1,isFollowing:!1,isFollowed:!1,isBlocking:!1,isBlocked:!1};(0,i._)((0,o._)({},W),{name:" 知乎用户",avatarUrl:(0,a.imgUrl)("https://pic1.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff.jpeg","is")});var K={answer:["1396303730","1394715943","1309692335","571602599","1405988657","1551858840","528969715","1126833448","1551974986"],question:["329062584","298155229","335633281","344276433","418460881","424224869","423070517"]},j="https://www.zhihu.com/xen/market/vip-privileges",Y=!0,Q="zhihumobilesvip",J=["四川","地震"],$={collect_answer:"收藏",up:"赞同",down:"反对",neutral:"取消赞同/反对"},ee={auto_notif:"auto_notif",header:"header",question_header_card:"question_header_card",force_launch_notif:"force_launch_notif",agree:"agree",disagree:"disagree",comment:"comment",star:"star",comment_list:"comment_list",comment_more:"comment_more",more_answers:"more_answers",bottom:"bottom",capsule:"capsule",follow:"follow",write_answer:"write_answer"},et="auto_notif",en={expand_answer:"force_launch_notif",expand_answer1:et,expand_answer2:et,up:"agree",down:"disagree",comment_answer:"comment",collect_answer:"star"},er=6},4627:function(e,t,n){"use strict";n.d(t,{Z:function(){return L}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),l=n(85879),u=n(53910),d=n(67814),p=n.n(d),h=n(14168),f=n.n(h),_=n(87363),m=n(69383),v=n(38889),g=n(49899),T=n(68014),E=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleAdd",function(t){var n=e.props,r=n.value,o=n.onChange,i=n.onAdd;i&&i(t),o&&o((0,g._)(r).concat([t]))}),(0,a._)((0,r._)(e),"handleRemove",function(t){var n=e.props,r=n.value,o=n.onChange,i=n.onRemove;i&&i(r[t],t),o&&o((0,g._)(r.slice(0,t)).concat((0,g._)(r.slice(t+1))))}),(0,a._)((0,r._)(e),"handleIfBackspace",function(t){var n=e.props.value;8===t.keyCode&&!e.state.value&&n.length&&e.handleRemove(n.length-1)}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.value,o=t.renderTagInner,i=t.renderInput;return(0,l.BX)("div",{className:p()("TagInputAlias",n),children:[r&&r.map(function(t,n){return(0,l.tZ)(T.Z,{removable:!0,onRemove:function(){return e.handleRemove(n)},children:o(t)},n)}),i({onAdd:this.handleAdd,onIfBackspace:this.handleIfBackspace})]})}}]),n}(_.Component);(0,a._)(E,"propTypes",{renderTagInner:f().func.isRequired,renderInput:f().func,value:f().array.isRequired,onAdd:f().func,onRemove:f().func,onChange:f().func});var C=n(55164),y=n(57477),S=n(85456),I=n.n(S),b=n(36695),A=n(93206),Z=n(5941),w=n(90656),R=n(58909),N=n(76741),k=function(e){return e.name.startsWith("创建 ")&&e.name.endsWith(" 话题")},O=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{value:"",items:[]}),(0,a._)((0,r._)(e),"mounted",!1),(0,a._)((0,r._)(e),"fetchTopic",function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return w.F.apply(void 0,(0,g._)(n).concat([[],{topic_filter:1}])).then(function(t){t=t.filter(function(e){return!k(e)});var r=e.props.currentUser,o=n[0];return!r||!r.canEditTopic||t.find(function(e){return e.name===o})||/\s/.test(o)||/(?:[+=$￥^><~`|!-#%-*,-/:;?@[-\]_{}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F])/.test(o)?t:(0,g._)(t).concat([{urlToken:"topic",token:o,name:"创建 ".concat(o," 话题")}])})}),(0,a._)((0,r._)(e),"createTopic",function(t){return e.props.createTopic(t).then(function(e){return e.payload})}),(0,a._)((0,r._)(e),"handleSelect",function(t,n){var r=e.props.onSelect;Promise.resolve(k(n)?e.createTopic(n.token||n.name):n).then(function(t){r&&r(t),e.mounted&&e.setState({value:""})}).catch(function(){e.setState({value:""})})}),(0,a._)((0,r._)(e),"handleChange",I()(function(t){e.setState({value:t}),e.fetchTopic(t).then(function(t){return e.mounted&&e.setState({items:t})})},200)),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){this.mounted=!0,(0,this.props.fillCurrentUserIfNeeded)(["canEditTopic"])}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=this.state,t=e.value,n=e.items,r=this.props.filter;return(0,l.tZ)(Z.Z,(0,y._)((0,C._)({},this.props),{autoFocus:!0,value:t,items:r&&n?n.filter(r):n,onChange:this.handleChange,onSelect:this.handleSelect}))}}]),n}(_.Component),x=(0,A.compose)((0,b.connect)(function(e){return{currentUser:(0,R.ib)(e)}},{createTopic:N.HV,fillCurrentUserIfNeeded:R.sF}))(O),P=function(e,t){if(!e||!t)return!1;var n=e.urlToken||e.id,r=t.urlToken||t.id;return n&&n===r},D=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleClick",function(t){var n=e.props.onToggleActived;n&&n(),m.Z.trackEvent(t.target,{id:2465,action:"Click"})}),(0,a._)((0,r._)(e),"handleBlur",function(t){var n=e.props.onBlur;n&&n(t);var r=e.props.onToggleActived;r&&r()}),(0,a._)((0,r._)(e),"handleChange",function(t){var n=e.props,r=n.max,o=n.onChange;r>0&&o(t.slice(0,r))}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.max,o=t.value,i=t.inputProps,a=t.onAdd,c=t.onRemove,s=t.actived,d=t.onRef,h=t.placeholderNote,f="绑定话题".concat(o.length>0?"（".concat(o.length,"/").concat(r,"）"):h||"（至少添加一个）");return(0,l.tZ)(E,{className:p()("TopicInputAlias-tagInput",n),value:o,renderInput:function(t){var n=t.onAdd,a=t.onIfBackspace;return(!o||o.length<r)&&(s?(0,l.tZ)(x,{className:"TopicInputAlias-autocomplete",inputProps:{className:p()("TopicInputAlias-input",null==i?void 0:i.className)},menuProps:{menuClassName:"TopicInputAlias-suggestionContainer"},filter:o&&function(e){return!o.find(function(t){return P(t,e)})},onRef:d,onKeyDown:a,onSelect:n,onBlur:e.handleBlur,placeholder:f}):(0,l.tZ)(v.ZP,{className:"TopicInputAlias-placeholderButton",label:f,icon:u.nY,onClick:e.handleClick,preset:"plain",color:"blue"}))},renderTagInner:function(e){return(0,l.tZ)("a",{target:"_blank",rel:"noopener noreferrer",href:"//www.zhihu.com/topic/".concat(e.id||e.urlToken),children:e.name})},onAdd:a,onRemove:c,onChange:this.handleChange})}}]),n}(_.Component);(0,a._)(D,"propTypes",{max:f().number}),(0,a._)(D,"defaultProps",{max:5});var L=D},5469:function(e,t,n){"use strict";n.d(t,{rt:function(){return E}});var r=n(94009),o=n(79065),i=n(85879),a=n(91850),c=n(41402),s=n(7562),l=n(87363),u=n(36695),d=n(1733),p=n(16563),h=n(65744),f=n(803),_=n(71981);function m(){var e=(0,o._)(["\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n"]);return m=function(){return e},e}var v=(0,c.F4)(m()),g=function(e){var t=e.className,n=e.isLoading;return(0,i.BX)(d.sN,{className:t,css:function(e){return{display:"inline-flex",alignItems:"center",color:e.colors.GBK06A}},children:[(0,i.tZ)("span",{css:{display:"inline-flex",alignItems:"center",width:24,marginLeft:-24},children:(0,i.tZ)(s.Z,{css:n?{animation:"".concat(v," 1s linear 600ms infinite")}:{}})}),n?"加载中...":"加载失败，点击「设置」重试"]})},T=function(e){var t=e.className,n=e.current,r=e.permissionItem,o=e.onClick,a=r.permission,c=r.text,s=r.disable,l=r.disableAlert;return a!==p.sO||n===a||(0,p.M1)()?(0,i.tZ)(_.Z,{className:t,onClick:function(){s?(0,h.t)(l,{theme:"red-ghost"}):o(a,c)},checked:n===a,children:c}):null};function E(e){var t=e.current,n=e.target,o=e.type,c=e.onChange,s=e.className,d=(0,r._)((0,a.Z)(!1),2),_=d[0],m=d[1],v=(0,r._)((0,a.Z)(!0),2),E=v[0],C=v[1],y=(0,u.useDispatch)(),S=n.type,I=n.id,b=o||S,A=(0,u.useSelector)(function(e){var t,n;return null===(t=e.commentPermission)||void 0===t?void 0:null===(n=t[b])||void 0===n?void 0:n[I]})||[];(0,l.useEffect)(function(){_||y((0,f.n5)(b,I)).finally(function(){C.off(),m.on()})},[y,b,I,_,m,C]),(0,l.useEffect)(function(){t!==p.sO||(0,p.M1)()||(0,p.UJ)()},[t]);var Z=function(e,r){if(e!==t){if(!n){c(e);return}var o=n.id;n.adminClosedComment?(0,h.t)("此内容无法更改评论权限",{theme:"red-ghost"}):e===p.Kz||t===p.Kz?(0,h.y)("你确定要更改评论权限吗？",{content:e===p.Kz?"更改后，已有评论不变，新评论需要经过筛选才会公开显示":"更改后，所有待筛选评论都会被公开显示出来"}).then(function(){return c(o,e,r)}).catch(function(){return null}):c(o,e,r)}};return E?(0,i.tZ)(g,{className:s,isLoading:!0}):E||!_||A.length?(0,i.tZ)(i.HY,{children:A.map(function(e){return(0,i.tZ)(T,{className:s,permissionItem:e,onClick:Z,current:t},e.permission)})}):(0,i.tZ)(g,{className:s})}var C=n(22107),y=n(94707),S=n(86325),I=n(85626),b=n(31467),A=n.p+"assets/deleteComment.d2efe0dc.gif",Z=n(99447),w=function(e){(0,S._)(n,e);var t=(0,I._)(n);function n(){return(0,C._)(this,n),t.apply(this,arguments)}return(0,y._)(n,[{key:"render",value:function(){return(0,i.tZ)("img",{src:A,style:{maxWidth:"200px",marginTop:"30px"},alt:"delete-comment-success"})}}]),n}(l.Component);w.showModal=function(e){b.Z.open(function(t){var n=(e||{}).reportText;return setTimeout(t,2e3),(0,i.tZ)(b.Z,{title:"举报成功",onClose:t,children:(0,i.BX)("div",{style:{textAlign:"center"},children:[(0,i.tZ)("div",{children:n||"你的举报我们已经收到，处理结果会通过系统通知进行告知。"}),(0,i.tZ)(w,{})]})})})},(0,Z.a)({view:{id:3038},trackCardShow:!0})(w),n(20857),n(87320),n(38889),n(24752),l.Component},33722:function(e,t,n){"use strict";n.d(t,{xu:function(){return X},WD:function(){return V},Zy:function(){return H},AN:function(){return q},Yj:function(){return F},EE:function(){return K},Oo:function(){return j},Gf:function(){return W}});var r,o=n(87320),i=n(55164),a=n(49899),c=n(19774),s=n(37742),l=n(87752),u=n(16839),d=n(33849),p=n(95826),h=n(14888),f=n(42951),_=n(7209),m=n(50130),v=n(87363),g=n.n(v),T=n(66980),E=Object.assign,C=Object.assign,y=Object.assign,S=Object.assign,I=Object.assign,b=Object.assign,A=Object.assign,Z=Object.assign,w=Object.assign,R=Object.assign,N=Object.assign,k=Object.assign,O=Object.assign,x=Object.assign,P=function(e){return g().createElement(T.Z,x({width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},e),g().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M.552 6.167h2.945l2.853 6.575 2.865-6.575h5.352v11.666h-2.619V6.593l-5.163 11.24h-.858L.552 6.167Zm15.457 0h2.842c1.376 0 2.492.292 3.237.982.733.678 1.079 1.598 1.079 2.696 0 1.242-.366 2.267-1.16 2.995-.791.726-1.921 1.046-3.3 1.046h-.064v3.947h-2.634V6.167Zm2.634 2.422v2.86h.107c.798 0 1.21-.181 1.405-.399.25-.28.378-.615.378-1.03 0-.47-.131-.807-.36-1.057-.19-.207-.567-.374-1.279-.374h-.251Z",clipRule:"evenodd"}))},D=Object.assign,L=Object.assign,B=Object.assign,U=Object.assign,M=Object.assign,G=Object.assign,F={pass:"pass",applying:"applying",canDraw:"can_draw",canApply:"can_apply",notActive:"not_active",banned:"banned"},z={vip_coupon:{id:"vip_coupon",name:"盐选会员代金券",icon:P,url:null},vip:{id:"vip",name:"盐选会员卡",icon:P,url:null},enjoy_live_free:{id:"enjoy_live_free",name:"畅享免费 Live",icon:function(e){return g().createElement(T.Z,D({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),g().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M22.429 32.336c-1.4.431-2.887.664-4.429.664-8.284 0-15-6.716-15-15C3 9.716 9.716 3 18 3c8.284 0 15 6.716 15 15 0 1.8-.317 3.524-.898 5.123A8.029 8.029 0 0 0 29 22.5c-3.675 0-6.699 2.482-8.346 5.84l-.325.66.325.66c.48.98 1.078 1.885 1.775 2.676ZM11.77 19.907s-.098.128-.044.29c.053.161.24.154.24.154l4.08-.1-1.564 7.714s-.038.138.075.186c.112.047.208-.082.208-.082l8.497-11.009s.098-.127.045-.289c-.054-.162-.241-.154-.241-.154l-4.08.1 1.565-7.715s.037-.137-.075-.185c-.113-.048-.209.082-.209.082L11.77 19.907Z",clipRule:"evenodd"}),g().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M22 29c1.476-3.007 4.06-5 7-5 2.94 0 5.524 1.993 7 5-1.476 3.007-4.06 5-7 5-2.94 0-5.524-1.993-7-5Zm8.75-.375c0 .958-.784 1.734-1.75 1.734-.967 0-1.75-.776-1.75-1.734s.783-1.734 1.75-1.734c.966 0 1.75.776 1.75 1.734Z",clipRule:"evenodd"}))},url:null},read:{id:"read",name:"读书卡",icon:function(e){return g().createElement(T.Z,k({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),g().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"m32.543 31.104-13.772-7.138V10.783c0-.097.055-.186.142-.229l11.36-5.652a.292.292 0 0 1 .422.237l1.098 12.821-1.53.694-.012-.13-9.937 4.546 10.8 5.675-.694-8.225 1.532-.695.946 11.043a.243.243 0 0 1-.355.236Zm-29.087 0 13.772-7.138V10.783a.256.256 0 0 0-.142-.229L5.726 4.903a.292.292 0 0 0-.421.236L4.203 18.006l1.345.61.008-.091 9.937 4.546-10.8 5.674.697-8.263-1.347-.61-.941 10.996a.243.243 0 0 0 .354.236Z",clipRule:"evenodd"}))},url:null},zhihu_vouchers:{id:"zhihu_vouchers",name:"知乎自营代金券",icon:function(e){return g().createElement(T.Z,U({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),g().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M5 6a2 2 0 0 0-2 2v5.756a4.502 4.502 0 0 1 0 8.488V28a2 2 0 0 0 2 2h26a2 2 0 0 0 2-2v-5.756a4.502 4.502 0 0 1 0-8.488V8a2 2 0 0 0-2-2H5Zm10.523 6.962a.75.75 0 1 0-1.046 1.076l2.773 2.695v1.121h-3a.75.75 0 0 0 0 1.5h3V22.5a.75.75 0 0 0 1.5 0v-3.146h3a.75.75 0 0 0 0-1.5h-3v-1.12l2.773-2.696a.75.75 0 1 0-1.046-1.076L18 15.371l-2.477-2.409Z",clipRule:"evenodd"}))},url:null}},H=(0,i._)({"0513324000":{id:"0513324000",name:"内容分析",icon:c.Z,url:"/creator/analytics"},5713324e3:{id:"5713324000",name:"近期热点",icon:function(e){return g().createElement(T.Z,R({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),g().createElement("path",{fill:"#06F",d:"M30 20.24c0 6.218-5.373 11.26-12 11.26S6 26.458 6 20.24c0-2.052.693-3.975 1.714-5.631 1.199-1.944 2.572-2.703 4.286-4.722 1.714-2.018 2.25-4.583 2.25-5.387 0-.804 3.393.255 5.464 4.41 2.072 4.157 1.072 6.84 2.786 6.84s1.5-5.488 3.214-4.137C28.334 13.68 30 16.777 30 20.24Z"}))},url:"/creator/hot-question/hot/0/hour"},6713324e3:{id:"6713324000",name:"盐选合作",icon:function(e){return g().createElement(T.Z,E({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),g().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M15 31.5c8.284 0 15-1.679 15-3.75 0-1.909-5.706-3.485-13.086-3.72.602-.02 1.214-.03 1.835-.03 8.699 0 15.75 2.015 15.75 4.5S27.448 33 18.75 33c-6.275 0-11.693-1.049-14.225-2.566 2.704.66 6.4 1.066 10.476 1.066Z",clipRule:"evenodd"}),g().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M25.388 4.324a2 2 0 0 0-2.833.004L3.476 23.52a2 2 0 0 0-.565 1.152l-.603 4.645a.5.5 0 0 0 .554.561l4.695-.547a2 2 0 0 0 1.183-.573L27.86 9.623a2 2 0 0 0-.001-2.827l-2.471-2.472Zm-7.025-.209a1 1 0 0 0-1.415 0l-4.95 4.95a1 1 0 0 0 0 1.414l.178.177a1 1 0 0 0 1.414 0l4.95-4.95a1 1 0 0 0 0-1.414l-.177-.177Z",clipRule:"evenodd"}))},url:"/creator-salt/welfare"},9613324e3:{id:"9613324000",name:"主页置顶",icon:s.Z,url:null},9513324e3:{id:"9513324000",name:"知乎直播",icon:function(e){return g().createElement(T.Z,M({width:"24",height:"24",viewBox:"0 0 24 24"},e),g().createElement("defs",null,g().createElement("path",{id:"id-1100645874-a",d:"M14.4 2.778c1.988 0 3.6 1.527 3.6 3.412v7.676c0 1.884-1.612 3.412-3.6 3.412H3.6c-1.988 0-3.6-1.528-3.6-3.412V6.19c0-1.885 1.612-3.412 3.6-3.412h10.8ZM7.771 7c-.556 0-1.014.446-1.066 1.017l-.005.108v3.75l.005.108c.052.57.51 1.017 1.066 1.017.165 0 .32-.039.46-.109l.008.005 2.846-1.878A1.13 1.13 0 0 0 11.7 10c0-.397-.196-.746-.492-.949L8.454 7.258A1.037 1.037 0 0 0 7.771 7Zm-.328-3.444L5.361 1.463A.858.858 0 0 1 6.571.249l2.318 2.33L11.204.252a.856.856 0 1 1 1.213 1.21l-2.083 2.094h-2.89Z"})),g().createElement("g",{fill:"none",fillRule:"evenodd"},g().createElement("path",{d:"M0 0h24v24H0z"}),g().createElement("g",{transform:"translate(3 3)"},g().createElement("mask",{id:"id-1100645874-b",fill:"#fff"},g().createElement("use",{xlinkHref:"#id-1100645874-a"})),g().createElement("use",{xlinkHref:"#id-1100645874-a",fill:"currentColor",fillRule:"nonzero"}),g().createElement("g",{fill:"currentColor",mask:"url(#id-1100645874-b)"},g().createElement("path",{d:"M-3-3h24v24H-3z"})))))},url:"/creator/rights-streaming"},2613324e3:{id:"2613324000",name:"知+自选",icon:function(e){return g().createElement(T.Z,G({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),g().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M18 33c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C9.716 3 3 9.716 3 18c0 8.284 6.716 15 15 15Zm6.482-14.41a5 5 0 0 0-7.071-7.072.834.834 0 0 0 1.178 1.179 3.333 3.333 0 1 1 4.714 4.714.833.833 0 0 0 1.179 1.178ZM11.518 17.41a5 5 0 0 0 7.071 7.071.833.833 0 0 0-1.178-1.178 3.333 3.333 0 0 1-4.714-4.714.833.833 0 0 0-1.179-1.179Zm3.982-.244a.833.833 0 0 0 0 1.667h1.667V20.5a.833.833 0 1 0 1.666 0v-1.666H20.5a.833.833 0 0 0 0-1.667h-1.667V15.5a.833.833 0 0 0-1.666 0v1.667H15.5Z",clipRule:"evenodd"}))},url:"/creator/zixuan"},1613324e3:{id:"1613324000",name:"好物推荐",icon:l.Z,url:"/creator/mcn"},7413324e3:{id:"7413324000",name:"内容自荐",icon:u.ZP,url:"/creator/recommend"},3713324e3:{id:"3713324000",name:"内容收益",icon:function(e){return g().createElement(T.Z,I({width:"24",height:"24",viewBox:"0 0 24 24"},e),g().createElement("path",{fillRule:"evenodd",d:"M4 4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H4Zm10.023 4.462a.75.75 0 1 0-1.046 1.076l1.773 1.723v.392H13a.75.75 0 0 0 0 1.5h1.75v1.68a.75.75 0 0 0 1.5 0v-1.68H18a.75.75 0 0 0 0-1.5h-1.75v-.392l1.773-1.723a.75.75 0 1 0-1.046-1.076L15.5 9.898l-1.477-1.436ZM6 8.25a.75.75 0 0 0 0 1.5h4a.75.75 0 0 0 0-1.5H6Zm0 5.25A.75.75 0 0 0 6 15h4a.75.75 0 0 0 0-1.5H6Z",clipRule:"evenodd"}))},url:"/creator/video-support"},3613324e3:{id:"3613324000",name:"招募任务",icon:function(e){return g().createElement(T.Z,O({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),g().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M7 7.828C9.003 6.34 11.822 4.5 15 4.5c1.934 0 3.189.729 4.404 1.435 1.14.662 2.246 1.304 3.846 1.304 2.634 0 4.405-.58 6.535-1.278.346-.113.7-.23 1.07-.347a.496.496 0 0 1 .645.474v16.62a.097.097 0 0 1-.043.082c-.44.293-4.2 2.71-8.207 2.71-2.32 0-3.669-.956-4.9-1.827-1.032-.731-1.982-1.404-3.35-1.404-1.608 0-3.43.696-5.123 1.342-1.034.395-2.02.771-2.877.958V31.5a1 1 0 1 1-2 0V6.24a1 1 0 0 1 2 0v1.588Z",clipRule:"evenodd"}))},url:"/creator/recruit-task"},"0713324000":{id:"0713324000",name:"创作贴纸",icon:function(e){return g().createElement(T.Z,b({width:"24",height:"24",viewBox:"0 0 24 24"},e),g().createElement("path",{fillRule:"evenodd",d:"M2 4a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4Zm7 4a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm-3.5 6a.5.5 0 0 0 0 1h13a.5.5 0 0 0 0-1h-13ZM5 17.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5ZM14.5 6a.5.5 0 0 0-.5.5v3.761a.5.5 0 0 0 .686.465l1.443-.577a1 1 0 0 1 .742 0l1.443.577A.5.5 0 0 0 19 10.26V6.5a.5.5 0 0 0-.5-.5h-4Z",clipRule:"evenodd"}))},url:null},1513324e3:{id:"1513324000",name:"赞赏功能",icon:d.Z,url:"/creator/reward"},1713324e3:{id:"1713324000",name:"关注者画像",icon:function(e){return g().createElement(T.Z,w({width:"24",height:"24",viewBox:"0 0 24 24"},e),g().createElement("path",{fillRule:"evenodd",d:"M16.27 8.611c0 .346-.03.684-.09 1.012a6.264 6.264 0 0 0-4.075 10.612h-8.66c-.434 0-.869-.18-1.153-.527a1.275 1.275 0 0 1-.152-1.393c.518-1.05 1.7-2.26 3.223-3.204a11.542 11.542 0 0 1 3.084-1.341A5.613 5.613 0 0 1 10.66 3a5.611 5.611 0 0 1 5.611 5.611Zm6.015 6.692c.315 0 .573-.256.542-.569a5.697 5.697 0 0 0-5.1-5.1c-.313-.031-.57.227-.57.541v4.558c0 .315.256.57.57.57h4.558Zm-.556.57a5.128 5.128 0 1 1-5.128-5.127v4.627a.5.5 0 0 0 .5.5h4.628Z",clipRule:"evenodd"}))},url:"/creator/followers"},8713324e3:{id:"8713324000",name:"编辑器扩容",icon:function(e){return g().createElement(T.Z,A({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),g().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M3 7.5a3 3 0 0 1 3-3h9.133a1.5 1.5 0 0 1 1.175.568l2.67 3.364A1.5 1.5 0 0 0 20.153 9H30a3 3 0 0 1 3 3v16.5a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3v-21Zm22.5 10.875c.621 0 1.125.504 1.125 1.125v2.063h2.063a1.125 1.125 0 0 1 0 2.25h-2.063v2.062a1.125 1.125 0 0 1-2.25 0v-2.063h-2.063a1.125 1.125 0 0 1 0-2.25h2.063V19.5c0-.621.504-1.125 1.125-1.125Z",clipRule:"evenodd"}))},url:null},3513324e3:{id:"3513324000",name:"品牌特邀",icon:p.ZP,url:"/creator/commercial-task"},9413324e3:{id:"9413324000",name:"自定义推广",icon:h.Z,url:"/creator/custom-promotion"},7513324e3:{id:"7513324000",name:"圆桌主持人",icon:f.Z,url:"/creator/roundtable-host"},2513324e3:{id:"2513324000",name:"知乎 Live",icon:_.Z,url:"/creator/live"},2713324e3:{id:"2713324000",name:"关注者在看",icon:function(e){return g().createElement(T.Z,Z({width:"24",height:"24",viewBox:"0 0 24 24"},e),g().createElement("path",{fillRule:"evenodd",d:"M15.408 8.665c0 .887-.203 1.726-.566 2.473-1.79.744-3.253 2.282-4.18 4.188l-.204.419.204.418c.948 1.95 2.456 3.514 4.302 4.238H2.459a1.5 1.5 0 0 1-1.164-.532 1.287 1.287 0 0 1-.154-1.407c.524-1.058 1.716-2.282 3.254-3.234a11.657 11.657 0 0 1 3.114-1.354A5.667 5.667 0 0 1 9.743 3a5.666 5.666 0 0 1 5.665 5.665Zm-3.886 7.08c1.21-2.488 3.328-4.136 5.739-4.136 2.41 0 4.529 1.648 5.739 4.136-1.21 2.487-3.328 4.136-5.74 4.136-2.41 0-4.528-1.649-5.738-4.136Zm7.173-.31a1.435 1.435 0 1 1-2.869 0 1.435 1.435 0 0 1 2.87 0Z",clipRule:"evenodd"}))},url:"/creator/followers"},7713324e3:{id:"7713324000",name:"专属小管家",icon:function(e){return g().createElement(T.Z,B({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),g().createElement("path",{fill:"#06F",d:"M18 1.5c-7.27 0-13.33 5.17-14.707 12.035A3 3 0 0 0 .75 16.5v6a3 3 0 0 0 3 3h1.5a3 3 0 0 0 3-3v-6a3.001 3.001 0 0 0-1.922-2.8C7.59 8.423 12.337 4.5 18 4.5s10.41 3.923 11.672 9.2a3.001 3.001 0 0 0-1.922 2.8v6c0 .841.346 1.602.904 2.147A10.497 10.497 0 0 1 19.5 30a1.5 1.5 0 0 0 0 3c5.3 0 9.888-3.055 12.097-7.5h.653a3 3 0 0 0 3-3v-6a3 3 0 0 0-2.543-2.965C31.33 6.67 25.269 1.5 18 1.5Z"}))},url:null},6613324e3:{id:"6613324000",name:"复用任务",icon:function(e){return g().createElement(T.Z,N({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),g().createElement("path",{fill:"#06F",d:"M13.5 3A1.5 1.5 0 0 1 15 1.5h6a1.5 1.5 0 0 1 0 3h-6A1.5 1.5 0 0 1 13.5 3Z"}),g().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M10.5 3h-3a3 3 0 0 0-3 3v24a3 3 0 0 0 3 3h21a3 3 0 0 0 3-3V6a3 3 0 0 0-3-3h-3a3 3 0 0 1-3 3h-9a3 3 0 0 1-3-3Zm2.25 11.25a1.875 1.875 0 1 1-3.75 0 1.875 1.875 0 0 1 3.75 0Zm0 9a1.875 1.875 0 1 1-3.75 0 1.875 1.875 0 0 1 3.75 0Zm3-10.125a1.125 1.125 0 0 0 0 2.25h10.124a1.125 1.125 0 1 0 0-2.25H15.75ZM14.625 23.25c0-.621.504-1.125 1.125-1.125h10.125a1.125 1.125 0 0 1 0 2.25H15.75a1.125 1.125 0 0 1-1.125-1.125Z",clipRule:"evenodd"}))},url:"/creator/reuse-task"},4713324e3:{id:"4713324000",name:"内容分析高级数据",icon:function(e){return g().createElement(T.Z,C({width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},e),g().createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4 7.42a1 1 0 0 1 .594-.914l2.393-1.064a4 4 0 0 1 3.683.226l.463.277a2 2 0 0 0 1.923.074l5.828-2.913a1 1 0 0 1 .84-.025l.119.05a1 1 0 0 1 .514 1.337l-.062.135a1 1 0 0 1-.461.477l-5.759 2.88a4 4 0 0 1-3.846-.149l-.392-.235a2 2 0 0 0-1.841-.112L4.703 8.927A.5.5 0 0 1 4 8.47V7.42Zm6.138 2.858c0-.307.335-.497.599-.339.927.557 2.074.6 3.041.117l.027-.013a.402.402 0 0 1 .583.36V18a1 1 0 0 1-1 1h-2.25a1 1 0 0 1-1-1v-7.722Zm-2.591-.801a.5.5 0 0 1 .703.457V18a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-6.297a1 1 0 0 1 .594-.914l2.953-1.312Zm12.255-2.34a.5.5 0 0 1 .724.447V12h-3.598a1.64 1.64 0 0 0-.652.136V9.518a1 1 0 0 1 .553-.894l2.973-1.487ZM16.928 13h4.135c.117 0 .231.032.332.093a.686.686 0 0 1 .244.255l1.296 2.334a.523.523 0 0 1-.081.614l-3.528 3.564a.465.465 0 0 1-.33.14.464.464 0 0 1-.331-.14l-3.52-3.565a.522.522 0 0 1-.082-.612l1.288-2.334a.686.686 0 0 1 .244-.255.642.642 0 0 1 .333-.094Z",clipRule:"evenodd"}))},url:"/creator/analytics/work/all?detailType=profile"},4613324e3:{id:"4613324000",name:"视频推广",url:"/creator/video-distribution",icon:c.Z},8613324e3:{id:"8613324000",name:"图文流量包",url:"/creator/recommend/article-exposure-promotion",icon:u.ZP},5613324e3:{id:"5613324000",name:"流量加油包",url:"/creator/recommend/exposure-promotion",icon:u.ZP},7613324e3:{id:"7613324000",name:"文章发布回答",url:"/creator/manage/creation/article",icon:null},6513324e3:{id:"6513324000",name:"版权服务",url:"/creator/explore/copyright",icon:m.Z},"0613324000":{id:"0613324000",name:"互选任务",url:"https://cheese.zhihu.com/creator/elect/task",icon:function(e){return g().createElement(T.Z,S({width:"18",height:"20",viewBox:"0 0 18 20"},e),g().createElement("path",{fillRule:"evenodd",d:"M2 0h14a2 2 0 0 1 2 2v15.133a1.9 1.9 0 0 1-2.7 1.723l-1.788-.83a2 2 0 0 0-1.796.055l-1.86 1.009a2 2 0 0 1-1.75.076l-2.7-1.171a2 2 0 0 0-1.77.088l-1.386.773A1.513 1.513 0 0 1 0 17.534V2a2 2 0 0 1 2-2Zm8.005 9.055a1.005 1.005 0 0 0 0 2.011h3.99a1.005 1.005 0 0 0 0-2.011h-3.99Zm-1.05-6.033A3.479 3.479 0 0 0 6.5 2.011 3.51 3.51 0 0 0 3 5.531a3.51 3.51 0 0 0 3.5 3.518A3.51 3.51 0 0 0 10 5.53c0-.478-.095-.934-.267-1.35L7.135 7.685a.654.654 0 0 1-.868.17l-1.859-1.14a.662.662 0 0 1-.218-.907.654.654 0 0 1 .902-.22l1.348.827 2.515-3.392Zm-4.95 10.055a1.005 1.005 0 1 0 0 2.011h9.99a1.005 1.005 0 0 0 0-2.011h-9.99Z"}))}},4513324e3:{id:"4513324000",name:"作者经纪",url:"/creator/manager",icon:null},8413324e3:{id:"8413324000",name:"问题推荐",url:null,icon:null},9713324e3:{id:"9713324000",name:"评论置顶",url:null,icon:function(e){return g().createElement(T.Z,y({width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},e),g().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M12.98 2C18.79 2 23 6.746 23 12.015c0 1.682-.49 3.414-1.35 4.997-.16.26-.18.59-.07.902l.67 2.243c.15.541-.31.94-.82.78l-2.02-.6c-.55-.18-.98.05-1.49.361C16.46 21.558 14.64 22 13 22c-1.622 0-3.253-.41-4.713-1.178V19.45a1.978 1.978 0 0 0 1.555-1.164 1.885 1.885 0 0 0-.509-2.196l-2.998-2.598a2.052 2.052 0 0 0-2.67 0l-.492.427A10.699 10.699 0 0 1 3 11.985C3 6.656 7.3 2 12.98 2Zm4.038 11.32a1.103 1.103 0 1 0 0-2.2 1.103 1.103 0 0 0 0 2.2Zm-4.25 0a1.103 1.103 0 1 0 0-2.2 1.103 1.103 0 0 0 0 2.2Zm-3.147-1.103a1.103 1.103 0 0 1-2.205 0 1.103 1.103 0 0 1 2.205 0Z",clipRule:"evenodd"}),g().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M5.55 14.2a.856.856 0 0 0-1.1 0l-3.198 2.771c-.526.455-.174 1.264.55 1.264h1.025v3.033c0 .404.358.732.8.732h2.745c.443 0 .8-.328.8-.732v-3.033h1.026c.724 0 1.076-.809.55-1.264l-3.197-2.77Z",clipRule:"evenodd"}))}},"0813324000":{id:"0813324000",name:"瓦力保镖",url:"/creator/explore/wall-e",icon:function(e){return g().createElement(T.Z,L({width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},e),g().createElement("path",{fill:"#056DE8",fillRule:"evenodd",d:"m12.628 1.88 7.837 3.236c.554.23.94.742.99 1.34.124 1.501.29 4.384-.091 5.953-.532 2.185-2.443 8.956-9.364 9.974-6.921-1.018-8.832-7.789-9.364-9.974-.381-1.57-.215-4.452-.091-5.954.05-.597.435-1.11.99-1.339l7.837-3.237a1.645 1.645 0 0 1 1.256 0Zm3.927 8.125a.75.75 0 0 0-1.11-1.01l-4.425 4.868-2.198-2.598a.75.75 0 1 0-1.145.97l2.53 2.988a1.05 1.05 0 0 0 1.578.028l4.77-5.246Z",clipRule:"evenodd"}))}}},z),q={analytics:H["0513324000"],hotSpot:H["5713324000"],advancedCreation:H["6713324000"],dynamicTopping:H["9613324000"],drama:H["9513324000"],zixuan:H["2613324000"],mcn:H["1613324000"],recommend:H["7413324000"],contentRevenue:H["3713324000"],recruitTask:H["3613324000"],pasterPaper:H["0713324000"],reward:H["1513324000"],followProfile:H["1713324000"],commercialTask:H["3513324000"],customPromotion:H["9413324000"],roundtableHost:H["7513324000"],live:H["2513324000"],followInteraction:H["2713324000"],yourHelp:H["7713324000"],reuseTask:H["6613324000"],editorExpansion:H["8713324000"],analyticsAdvancedData:H["4713324000"],videoDistribution:H["4613324000"],articleExposurePromotion:H["8613324000"],exposurePromotion:H["5613324000"],articleToAnswer:H["7613324000"],copyright:H["6513324000"],contentTask:H["0613324000"],manager:H["4513324000"],question:H["8413324000"],commentTopping:H["9713324000"]};r={},(0,o._)(r,F.pass,[q.pasterPaper.id]),(0,o._)(r,F.canDraw,(0,a._)(Object.keys(z))),q.mcn.id,q.contentRevenue.id,q.articleToAnswer.id,q.zixuan.id,q.live.id,q.recruitTask.id,q.reuseTask.id,q.commercialTask.id,q.mcn.id,q.exposurePromotion.id,q.articleExposurePromotion.id,q.videoDistribution.id,q.reuseTask.id,q.recruitTask.id,q.contentTask.id,q.manager.id,q.articleToAnswer.id;var V=[q.advancedCreation.id,q.commercialTask.id,q.contentTask.id,q.reuseTask.id,q.recruitTask.id],X=[q.mcn.id],W=function(e){return!!e&&e.status===F.pass},K="https://hm.baidu.com/hm.js?bff3d83079cef1ed8fc5e3f4579ec3b3",j=function(e){return{script:[{src:e,async:"async"}]}}},65033:function(e,t,n){"use strict";n.d(t,{LY:function(){return g},jM:function(){return m},zc:function(){return v}});var r=n(9338),o=n(55164),i=n(57477),a=n(94009),c=n(30971),s=n(85879),l=n(65733),u=n(84871),d=n.n(u),p=n(87363),h=n(29404),f=n(49048),_=function(e){var t=e.type,n=e.id,o=e.extra,i=e.children,u=(0,a._)((0,p.useState)(o),2),d=u[0],_=u[1],m=(0,l.Z)((0,r._)(function(){var e;return(0,c.__generator)(this,function(r){switch(r.label){case 0:if(!t||!n)return[2];return[4,(0,f.a)(t,n)];case 1:return(e=r.sent())&&_(e),[2]}})}));return(0,p.useEffect)(function(){o||m()},[o,m,n,t]),(0,s.tZ)(h.Z.Provider,{value:d,children:i})},m=function(e){var t=e.dataPath;return function(e){return d()(function(n){var r,i;return(0,s.tZ)(_,{type:null===(r=n[t])||void 0===r?void 0:r.type,id:null===(i=n[t])||void 0===i?void 0:i.id,children:(0,s.tZ)(e,(0,o._)({},n))})},e)}},v=function(){return(0,p.useContext)(h.Z)},g=function(e){return d()(function(t){var n=v();return(0,s.tZ)(e,(0,i._)((0,o._)({},t),{promotionExtra:n}))},e)};t.ZP=_},76976:function(e,t,n){"use strict";n.d(t,{Hg:function(){return c},g_:function(){return a},ks:function(){return s}});var r=n(85879),o=n(87363),i=(0,o.createContext)({scene:null}),a=function(e){var t=e.scene,n=e.children,a=(0,o.useMemo)(function(){return{scene:t}},[t]);return(0,r.tZ)(i.Provider,{value:a,children:n})},c=function(){return(0,o.useContext)(i).scene},s={recommend:"recommend",follow:"follow",search:"search",people:"my",answer:"answer_detail",question:"question_detail",article:"article_detail",zvideo:"zvideo_detail",pin:"pin_detail",topic:"topic"}},20312:function(e,t,n){"use strict";n.d(t,{Y_:function(){return v}});var r,o=n(87320),i=(n(55164),n(57477),n(49899)),a=n(17924),c=n(59111),s=n(34473),l=n(48725);n(35597);var u=n(28363),d=n(19774),p=n(64439),h=n(1442),f=n(27548),_=n(33722),m=(n(87363),n(66980),[_.AN.analytics.id,_.AN.hotSpot.id,_.AN.advancedCreation.id,_.AN.contentRevenue.id,_.AN.followProfile.id,_.AN.mcn.id]);r={},(0,o._)(r,_.Yj.banned,[_.AN.recommend.id]),(0,o._)(r,_.Yj.notActive,[_.AN.recommend.id].concat((0,i._)(m))),(0,o._)(r,_.Yj.canApply,[_.AN.commercialTask.id,_.AN.zixuan.id,_.AN.recommend.id].concat((0,i._)(m))),(0,o._)(r,_.Yj.canDraw,[_.AN.commercialTask.id,_.AN.zixuan.id,_.AN.recommend.id].concat((0,i._)(m))),(0,o._)(r,_.Yj.applying,[_.AN.commercialTask.id,_.AN.zixuan.id].concat((0,i._)(m))),s.y,l.E,u.D,d.E,a.Z,p.L,h.Y,c.Z,f.k;var v={ICON_FLAT:"https://zhihu-live.zhimg.com/namespace_1001/static/20210423/237a595e8a3454f3c74a5f587c7bf4a8.png",ICON_RISE:"https://zhihu-live.zhimg.com/namespace_1001/static/20210423/d4c4246f9eda06f25e2f9bb9d5bfdd59.png",ICON_DECLINE:"https://zhihu-live.zhimg.com/namespace_1001/static/20210423/3e1821b2482307dcf4d673a9c2129671.png"}},61879:function(e,t,n){"use strict";n.d(t,{getCreateStore:function(){return _}});var r=n(49899),o=n(93206),i=n(62108),a=n(34959),c=n(28953),s=n(71549),l=n.n(s),u=function(){return{}},d=function(){return function(e){return function(t){if(t.FAILSAFE){var n=e(t=l()(t,{NOTIFICATION:!1,API:{fetchOptions:{failsafe:!0,timeout:t.FAILSAFE.timeout||1e3}}}));return n.catch?n.catch(u):n}return e(t)}}},p=n(84),h=n(25364);function f(){return function(e){return function(t){if(!t.payload)return e(t);var n=t.payload,r=n.rootComment,o=n.topComments;if(r){var i=(0,p.Fv)(r,c.l.COMMENT_V2),a=i.entities,s=i.result;t.rootComment=s,t.entities=(0,h.Z)(t.entities,a)}if(o){var l=o.data,u=o.paging,d=(0,p.Fv)(l,c.l.COMMENT_ARRAY_V2),f=d.entities,_=d.result;t.topComments={result:_,paging:u},t.entities=(0,h.Z)(t.entities,f)}return e(t)}}}function _(e){return function(t,n){var s=n.http,l=n.root,u=[i.Z.withExtraArgument({fnRefs:{}}),d,(0,a.Z)(s,l),c.Z,f];return(0,o.createStore)(e,t,o.applyMiddleware.apply(void 0,(0,r._)(u)))}}},75597:function(e,t,n){e.exports=n(61879)},77234:function(e,t,n){"use strict";n.d(t,{a:function(){return o},n:function(){return i}});var r={1:49,2:50,r:82,t:84,e:69};function o(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(Array.isArray(n)&&"function"==typeof(null==window?void 0:null===(e=window.aria)||void 0===e?void 0:null===(t=e.initcallback)||void 0===t?void 0:t.disableShortKeys)){var o=n.map(function(e){return r[e]});window.aria.initcallback.disableShortKeys(o)}}function i(){var e,t;"function"==typeof(null==window?void 0:null===(e=window.aria)||void 0===e?void 0:null===(t=e.initcallback)||void 0===t?void 0:t.disableShortKeys)&&window.aria.initcallback.disableShortKeys([])}},91269:function(e,t,n){"use strict";n.d(t,{lf:function(){return d},nX:function(){return u},ql:function(){return l}});var r=n(4667),o=n.n(r),i=n(74351),a=n(32900),c=o()(function(){return{promotionExtras:{},pageContentInfo:{}}}),s=(0,i.isBrowser)(),l=function(e){s&&(c().pageContentInfo=e)},u=function(e,t){s&&(c().promotionExtras[e]=t)};function d(e){try{var t=e.za_log_entry_new;if(!t)return;var n=c(),r=n.promotionExtras,o=void 0===r?{}:r,i=n.pageContentInfo,s=void 0===i?{}:i;(0,a.Z)(t,o,s)}catch(e){var l,u="AdvertZAPluginError",d="向给商业同步 ZA 埋点时发生异常";.09>Math.random()?null===(l=window.Raven)||void 0===l||l.captureException(e,{logger:u,extra:{message:d}}):console.error(u,d)}}},25834:function(e,t,n){"use strict";n.d(t,{A$:function(){return E},Hf:function(){return v},WY:function(){return m},jS:function(){return g}});var r=n(15030),o=n(55164),i=n(57477),a=n(54231),c=n(87363),s=n(61533),l=n(69383),u=n(43384),d=n(59590),p=n(74351),h=n(91269);window.__MODULE_FEDERATION__={};var f=function(e,t){window.__MODULE_FEDERATION__[e]=t},_=function(){return null};function m(e){return e?fetch(e,{mode:"no-cors"}).catch(_):Promise.reject(Error("request but no url"))}function v(e,t){var n,p={onBeforeSend:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).defaultSendHandler;return setTimeout(function(){return(0,h.lf)(e)}),"function"!=typeof t||t(e)},userId:null==e?void 0:e.uid,memberHashId:null==e?void 0:e.id,userType:{people:"People",organization:"Org"}[null==e?void 0:e.userType],orgStatus:{normal:"Normal",forbidden:"Forbidden",reject:"Reject",audit:"Audit",register:"Register"}[null==e?void 0:e.orgStatus]},_=(0,i._)((0,o._)({},p),{sdkVersion:"4.20.1",normalizeElement:function(e){return(0,r._)(e,c.Component)?(0,s.findDOMNode)(e):e},shouldAutoTrackPageShow:!1});t.ZhihuHybrid||(_.pageProfile="zhihu-web");var m=(0,i._)((0,o._)({},p),{enableDyeing:!0}),v=new Promise(function(e){n=e});return!function(e){if(t.ZhihuHybrid){var n=/\b(from=home_tab|in_app_home_tab=|position=tab)\b/.test(location.search);if(t.Android&&n)var r=(0,d.Z)("base/viewDidAppear").listen(function(){r(),e()});else d.Z.onceViewAppeared().finally(e)}else e()}(function(){a.ZP.increment("za_helper.init.count"),l.Z.init(_).then(function(){var e=new window.zap.Client(m,{experimentalProto3:!0});f("zaClient",e),(0,u.U3)(e),"function"==typeof n&&(null==n||n())}).catch(function(e){throw a.ZP.increment("za_helper.init_failed.count"),e})}),v}var g={onEnter:function(e){if((0,p.isBrowser)()){var t=e.routes[e.routes.length-1];t.zaNotTrackPageShow||l.Z.trackPageShow({id:t.zaPageShowId})}},onChange:function(e,t){var n=t.routes[t.routes.length-1];n.zaNotTrackPageShow||l.Z.trackPageShow({id:n.zaPageShowId})}},T=["pin","comment","live","search_course","search_special","album"],E=function(e,t){return(t=String(t),"people"===e)?{member_hash_id:t}:T.includes(e)?{id:t}:{token:t}}},53159:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var r=n(60414),o=function(e,t){var n;return(null==e?void 0:null===(n=e.mergedBadges)||void 0===n?void 0:n.length)?e:t},i=function(e,t){return(0,r.TE)(o(e,t))}},16563:function(e,t,n){"use strict";n.d(t,{Kz:function(){return u},M1:function(){return c},Qz:function(){return l},UJ:function(){return a},sO:function(){return s}});var r=n(67516),o=n.n(r),i="enabled_follower_n_days",a=function(){o().set(i,!0)},c=function(){return o().get(i)},s="follower_n_days",l=function(e,t){if(c())return e;var n,r=null===(n=e.find(function(e){return e.permission===s}))||void 0===n?void 0:n.checked;return!c()&&r?(a(),e):"answer"===t||e.find(function(e){return"follower"===e.permission})?e.filter(function(e){return e.permission!==s}):e.map(function(e){return e.permission===s?{permission:"follower",text:"关注我的人能评论",checked:!1,disable:!1,disable_alert:""}:e})},u="censor"},17518:function(e,t,n){"use strict";function r(e){return Promise.all([n.e(6649),n.e(4408)]).then(n.t.bind(n,38343,23)).then(function(t){return t.createMqttClient(e)})}n.d(t,{Z:function(){return r}})},60736:function(e,t,n){"use strict";n.d(t,{AU:function(){return a},JP:function(){return s},ze:function(){return c}});var r=n(74135),o=n(6148);function i(e){var t,n,i;return(null==e?void 0:null===(t=e.bizExt)||void 0===t?void 0:t.creationRelationship)?e.bizExt.creationRelationship:"string"==typeof(null==e?void 0:null===(n=e.creationRelationship)||void 0===n?void 0:n.renderJson)?(0,r.camelizeKeys)(null!==(i=(0,o.dj)(e.creationRelationship.renderJson))&&void 0!==i?i:{}):e.creationRelationship}var a=i,c=i,s=i},35102:function(e,t,n){"use strict";n.d(t,{Xc:function(){return a},hu:function(){return c}});var r=n(76931),o=n.n(r);n(88423);var i={"video-count":"最多只能上传 10 个视频","video-count-one":"视频暂时只支持上传一个","video-size":"请上传大小不超过 2G 的视频","video-duration":"请上传不超过 60 分钟的视频","video-type":"暂不支持该文件格式","video-uploading":"视频上传完成后即可发布","video-uploading-draft":"视频上传完成后即可保存草稿","video-upload-cancelled":"匿名身份不能使用视频功能","video-uploading-entity-small":"请上传大小超过 100KB 的视频","video-upload-error":"视频上传失败，请重新上传","doc-size":"文档最大 10MB，请重新上传","doc-type":"暂不支持该文件格式","image-uploading":"图片上传完成后即可发布","mage-uploading-draft":"图片上传完成后即可保存草稿","video-and-image":"图片、视频暂时无法同时上传","unsupported-browser":"暂不支持的浏览器, 请更换浏览器后重试"};function a(e,t,n,r){if("image-upload-error"===e){n(o()(t,"payload.err.payload.message")||"图片上传失败，请重新上传","red",r);return}if(["doc-size","doc-type"].includes(e)){var a=(null==t?void 0:t.message)||i[e];n(a,"red",r,{shouldTrackShow:!0,zaText:"文档导入-".concat(a),zaBlock:"EditorInsertDoc",key:Date.now()});return}n(i[e],"red",r)}var c=function(e){return"string"==typeof e&&["Failed to fetch","Network request failed","NetworkError when attempting to fetch resource","网络连接已中断","请求超时"].some(function(t){return e.includes(t)})}},4785:function(e,t,n){"use strict";n.d(t,{Z:function(){return i},z:function(){return o}});var r=n(94009);function o(e){return new URLSearchParams(Object.entries(e).filter(function(e){return null!=(0,r._)(e,2)[1]}))}function i(e){return new URLSearchParams(Object.entries(e).map(function(e){var t=(0,r._)(e,2),n=t[0],o=t[1];return[n,null!=o?o:""]}))}},23113:function(e,t,n){"use strict";var r,o,i,a,c=n(9338),s=n(30971),l=n(4667),u=n.n(l),d="growth-chain",p={},h=new Promise(function(e){return a=e}),f=function(){return new Promise(requestAnimationFrame)},_=function(e){try{return e()}catch(e){}},m="https://www.zhihu.com",v=function(e){return _(function(){return localStorage.setItem(d,JSON.stringify(e))})},g=u()((0,c._)(function(){var e,t,n,r,o,i;return(0,s.__generator)(this,function(a){switch(a.label){case 0:return[4,h];case 1:if(!(e=a.sent().userId))return[2,null];if(t=_(function(){return JSON.parse(localStorage.getItem(d))}),n=new Date,!(!t||t.userId!==e||n>new Date(t.expiresAt)))return[3,3];return[4,fetch("".concat(m,"/api/v4/me/guides"),{credentials:"include"}).then(function(e){return e.json()})];case 2:return r=a.sent(),(o=new Date(n)).setDate(n.getDate()+1),v(i={userId:e,data:r,expiresAt:o}),[2,i];case 3:return[2,t]}})})),T=(r=(0,c._)(function(e){var t;return(0,s.__generator)(this,function(n){switch(n.label){case 0:return[4,fetch("".concat(m,"/api/v4/me/operation_guides/").concat(e.operation_guide_id_str),{method:"DELETE",credentials:"include"})];case 1:return n.sent(),[4,g()];case 2:return(t=n.sent())&&(t.data.actions=t.data.actions.filter(function(t){return t!==e}),v(t)),[2]}})}),function(e){return r.apply(this,arguments)}),E=(o=(0,c._)(function(e){var t;return(0,s.__generator)(this,function(n){switch(n.label){case 0:return[4,g()];case 1:return t=n.sent(),[4,f()];case 2:if(n.sent(),t)return[2,t.data.actions.filter(function(t){return e.includes(t.guide_name)})];return[2,[]]}})}),function(e){return o.apply(this,arguments)}),C=(i=(0,c._)(function(e){var t;return(0,s.__generator)(this,function(n){switch(n.label){case 0:return[4,g()];case 1:return t=n.sent(),[4,f()];case 2:if(n.sent(),t)return[2,t.data.actions.filter(function(t){return t.show_page===e})];return[2,[]]}})}),function(e){return i.apply(this,arguments)});t.Z={config:function(e){a(Object.assign(p,e))},markAsShown:T,getActionsByNames:E,getActionsByPage:C}},1785:function(e,t,n){"use strict";function r(e,t){return!!e&&!!t&&(e.id===t.id&&void 0!==e.id||e.urlToken===t.urlToken&&void 0!==e.urlToken)}n.d(t,{Z:function(){return r}})},6148:function(e,t,n){"use strict";function r(e){try{return JSON.stringify(e)}catch(e){return""}}function o(e){try{return JSON.parse(e)}catch(e){return null}}n.d(t,{dj:function(){return o},hZ:function(){return r}})},59937:function(e,t,n){"use strict";n.d(t,{Qm:function(){return u},_x:function(){return l}});var r,o,i=n(18837),a=n.n(i),c=n(61763),s=(r=function(e){var t=new FormData;return t.append("items",JSON.stringify(e)),(0,c.dJ)("/lastread/touch",{method:"POST",body:t})},o=[],a()(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.push(t),setTimeout(function(){o.length&&(r(o),o.length=0)},550)},function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return String(t)})),l="read",u="touch";t.ZP=s},38765:function(e,t,n){"use strict";n.d(t,{NY:function(){return i},l6:function(){return o}});var r=n(80714),o=function(e){var t=e.title,n=e.originTitle,o=e.source,i=e.sourceId,a=e.productTypeName,c=new URLSearchParams({title:t,originTitle:n,source:o,sourceId:i,productTypeName:a}).toString();return"".concat(r.Z.protocol,"//").concat(r.Z.wwwHost,"/selection/goods-editor?").concat(c)},i=function(e){var t=e.contentId,n=e.contentType,o=new URLSearchParams({contentId:t,contentType:n}).toString();return"".concat(r.Z.protocol,"//").concat(r.Z.wwwHost,"/selection/profit-selector?").concat(o)}},65744:function(e,t,n){"use strict";n.d(t,{t:function(){return l},y:function(){return u}});var r=n(55164),o=n(71728),i=n(85879),a=n(57730),c=n(19319),s=n(74351),l=function(e,t){var n=(0,r._)({delay:2e3},t),o=n.delay,a=n.theme,l=n.className;return(0,s.isBrowser)()?c.Z.show((0,i.tZ)(c.Z,{className:l,delay:o,notification:{text:e,theme:a}})):null},u=function(e,t){var n=t||{},c=n.content,s=(0,o._)(n,["content"]),l=c&&(0,i.tZ)("div",{style:{textAlign:"center"},children:c});return a.Z.confirm(l,(0,r._)({title:e},s))}},57138:function(e,t,n){"use strict";n.d(t,{MN:function(){return c},Qu:function(){return s}});var r=n(94009),o=n(57045),i=n(74351),a=function(e){var t=e||{},n=t.type,r=t.id,a=t.urlToken,c=t.q;switch(n){case"question":return"/questions/".concat(r);case"answer":return"/answers/".concat(r);case"article":case"p":return"/articles/".concat(r);case"column":return"/columns/".concat(r);case"live":return"/lives/".concat(r);case"ebook":case"book":return"/pub/book/".concat(r);case"feed":return"/feed";case"topic":return"/topics/".concat(r);case"people":return"/people/".concat(a||r);case"search":return"/search?".concat(o.stringify({q:c}));case"video":return"video_topic/".concat(r);case"zvideo":if((0,i.isBrowser)()){var s=new URL(location.href);if(!/^\d+$/.test(r)){var l="".concat(s.pathname.replace(/^\//,"")).concat(s.search);return"".concat(decodeURIComponent(l))}var u=s.searchParams.get("page");if(u)return"/zvideo/".concat(r,"?page=").concat(u)}return"/zvideo/".concat(r);case"theater":return"/theater/".concat(r);case"zvideo_answer":case"zvideo_article":var d=n.replace("zvideo_","");return"/".concat(d,"s/").concat(r);case"ai":return"/home/ai";default:return null}},c=function(e,t){var n=t?"?".concat(o.stringify(t)):"",r="string"==typeof e?e:a(e);if(r){var i=r.startsWith("/")?r.slice(1):r;return"zhihu://".concat(i).concat(n)}return"zhihu://".concat(n)},s=function(e){if(!e)return"/feed";try{var t=e.match(/(\/[\w]+)?(\/[\w-]+)?(\/[\w]+)?(\/[\w-]+)?/)||[],n=(0,r._)(t[3]&&t[4]?[t[3],t[4]]:[t[1],t[2]],2),o=n[0],i=n[1];return a({type:o.slice(1),id:i.slice(1)})||"/feed"}catch(e){return"/feed"}}},12421:function(e,t,n){"use strict";n.d(t,{U:function(){return o}});var r=n(53159);function o(e){var t,n=e.isOrg,o=e.badgeV2,i=e.badge;return!!n&&!!(null===(t=(0,r.a)(o,i).identity)||void 0===t?void 0:t.length)}},70538:function(e,t,n){"use strict";function r(e){for(var t,n=e.replace(/(<noscript>).*?(<\/noscript>)/g,""),r=[],o=/<\s*img.*?>/g,i=/(zh-lightbox-thumb)|(Slideshow-swiperImage)/,a=/(data-original=").*?"/,c=null;c=null===(t=o.exec(n))||void 0===t?void 0:t[0];)if(i.test(c)){var s=a.exec(c);s&&r.push(s[0].split("data-original=")[1].replace(/"|\\/g,""))}return r}n.d(t,{Z:function(){return r}})},39288:function(e,t,n){"use strict";n.d(t,{FH:function(){return d},N4:function(){return f},O1:function(){return h},co:function(){return p}});var r,o=n(87320),i=n(55164),a=n(57477),c=n(74135),s=n(52905),l=n(66263),u=(r={},(0,o._)(r,l.fH,"username"),(0,o._)(r,100003,"username"),(0,o._)(r,100006,"username"),(0,o._)(r,l.Dm,"username"),(0,o._)(r,100029,"username"),(0,o._)(r,100030,"username"),(0,o._)(r,120017,"username"),(0,o._)(r,12e4,"captcha"),(0,o._)(r,120001,"captcha"),(0,o._)(r,120005,"captcha"),(0,o._)(r,100002,"password"),(0,o._)(r,100004,"password"),(0,o._)(r,100005,"password"),(0,o._)(r,l.o7,"digits"),(0,o._)(r,l.M,"digits"),(0,o._)(r,100085,"digits"),(0,o._)(r,403,"extra"),r);function d(e,t){return t.reduce(function(t,n){return(0,a._)((0,i._)({},t),(0,o._)({},n,["request","success","failure"].reduce(function(t,r){return(0,a._)((0,i._)({},t),(0,o._)({},r,"".concat(e,"/").concat((0,c.camelize)(n.toLowerCase()),"/").concat(r)))},{})))},{})}function p(e,t){return t.reduce(function(t,n){return(0,a._)((0,i._)({},t),(0,o._)({},n,"".concat(e,"/").concat((0,c.camelize)(n.toLowerCase()))))},{})}function h(e){var t=e.code,n=e.message,r=u[t]||"unknown";return(0,o._)({},r,n||"系统繁忙，请稍后再试")}function f(e){(0,s.i4)(!0),(0,s.L0)(e)}},54826:function(e,t,n){"use strict";n.d(t,{LP:function(){return a},ZP:function(){return s},qz:function(){return c}});var r=n(67516),o=n.n(r),i="uhiuhvk_wrnhq";function a(){return o().get(i)}function c(){o().delete(i)}function s(e){o().set(i,JSON.stringify({token:e,timestamp:Date.now()}))}},93547:function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"…";return e.length>t?e.slice(0,t)+n:e}function o(e,t){for(var n,r=0,o="",i=e.length,a=0;a<i&&(128>(n=e[a]).charCodeAt(0)?r+=1:r+=2,o+=n,!(r>=t-1));a+=1);return o}n.d(t,{$G:function(){return r},NJ:function(){return a},Vq:function(){return c},Vt:function(){return s},Xs:function(){return l}});var i=null;function a(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"…",c=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"undefined"==typeof document?t=o(n=e.replace(/<.+?>/g,""),r):((i=i||document.createElement("div")).textContent=e,t=o(n=i.textContent.replace(/<.+?>/g,""),r));var s=!1;return t!==n&&(s=!0,t=t.slice(0,t.length-a.length)+a),c?{output:t,truncated:s}:t}function c(e){return/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g.test(e)}var s=function(e){return e?e.replace(/<.+?>/g,""):""},l=function(e,t){return Array.from(t?s(e):e).length}},25669:function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];var i=r[r.length-1]||{};return n.reduce(function(t,n,o){return t.concat(Number.isInteger(n)&&r[n]||i[n],e[o+1])},[e[0]]).join("")}}n.d(t,{Z:function(){return r}})},79091:function(e,t,n){"use strict";n.d(t,{D:function(){return o}});var r=n(94009),o=function(e,t){try{if(!e||"string"!=typeof e)return"";if(!t||"object"!=typeof t||!Object.keys(t))return e;var n=(0,r._)(e.split("#"),2),o=n[0],i=n[1],a=void 0===i?"":i,c=(0,r._)(o.split("?"),2),s=c[0],l=c[1],u=new URLSearchParams(l);Object.entries(t).forEach(function(e){var t=(0,r._)(e,2),n=t[0],o=t[1];null!=o&&u.set(n,o)});var d=function(e,t){return t?e+t:""};return s+d("?",u.toString())+d("#",a)}catch(t){return console.error(t),e}}},77440:function(e,t,n){"use strict";n.d(t,{Ef:function(){return d},aF:function(){return f}});var r=n(55164),o=n(49899),i=n(97614),a=n(54231),c=n(66111),s=n.n(c),l=n(69383),u={2555:{id:2555,name:"SEM落地页顶部下载点击"},2556:{id:2556,name:"SEM落地页按钮下载点击"},2557:{id:2557,name:"SEM落地页内容下载点击"}},d=function(e,t){var n="number"==typeof t?u[t]:t;"object"==typeof n&&l.Z.trackEvent(e&&e.currentTarget,(0,r._)({action:"Click"},n))},p=["a","b","c","d","e","f","g","h","i","j","k","l"],h=function(e,t){var n=Array(8).fill("").map(function(){return p[s()(11)]}).join("");new Image().src="https://lens.zhihu.com/report?type=msg&msg=".concat(e,"&dummy=").concat(n,"&uploadtype=").concat(t)};function f(e,t){return function(n){for(var r=arguments.length,c=Array(r>1?r-1:0),s=1;s<r;s++)c[s-1]=arguments[s];var l=Date.now(),u=["upload",t?"new":"old",void 0===n?"undefined":(0,i._)(n),n&&n.size?"normal":"empty"].join("_"),d=(0,a.HP)({appName:"heifetz"})("image.".concat((0,a.j0)(),".").concat(u));return a.ZP.increment({raw:"".concat(d,".start.count")}),h("puploadcount",u),Promise.resolve(e.apply(void 0,[n].concat((0,o._)(c)))).then(function(e){var t=Date.now();return h("psuccesscount",u),a.ZP.increment({raw:"".concat(d,".success.count")}),a.ZP.timing({raw:"".concat(d,".success")},t-l),e}).catch(function(e){throw a.ZP.increment({raw:"".concat(d,".error.count")}),h("pfailedcount",u),e})}}},26921:function(e,t,n){"use strict";n.d(t,{H2:function(){return b},Z1:function(){return I}});var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(91850),s=n(29229),l=n(65733),u=n(7835),d=n(84871),p=n.n(d),h=n(88329),f=n.n(h),_=n(87363),m=n(80714),v=n(79446),g=n(81956),T="".concat(m.Z.fetchRoot.api,"/content/publish/control/v2"),E={init:!0},C={write:{instruction:!1,msg:""},contribute:{instruction:!1,msg:""},anonymous:{instruction:!1,msg:""}},y=(0,_.createContext)(void 0),S=function(e){return function(t){return p()(function(d){var p,h=(0,i._)((0,c.Z)(!1),2),m=h[0],S=h[1],I=(0,i._)((0,_.useState)(!0),2),b=I[0],A=I[1],Z=(0,i._)((0,_.useState)(C),2),w=Z[0],R=Z[1],N=(0,r._)({},E,e),k=(0,v.n)(),O=(0,g.Z)(),x=(0,_.useRef)({onClose:f()}),P=(0,s.Z)(function(){return n.e(5634).then(n.bind(n,4238))},k),D=(0,l.Z)(function(e){var t=e.getScene(d);return O(T,{method:"GET",query:(0,r._)({scene:t.type},t.token&&{questionToken:t.token})}).then(function(e){return e.payload})}),L=(0,l.Z)(function(e){x.current.onClose=e}),B=(0,_.useMemo)(function(){return{commands:w,setOnModalClose:L,isLoading:b}},[w,L,b]),U=(0,l.Z)(function(){var e,t;S.off(),null===(e=x.current)||void 0===e||null===(t=e.onClose)||void 0===t||t.call(e)});return(0,u.Z)(function(){N.init&&"function"==typeof N.getScene&&k&&D(N).then(function(e){var t=e.data;R(t),t.write.instruction&&S.on()}).finally(function(){A(!1)})}),(0,a.BX)(y.Provider,{value:B,children:[P?(0,a.tZ)(P,{show:m,text:(null==w?void 0:null===(p=w.write)||void 0===p?void 0:p.msg)||"系统升级中，敬请谅解",onClose:U}):null,(0,a.tZ)(t,(0,o._)((0,r._)({},d),{writeShield:B}))]})},t)}},I=function(){return(0,_.useContext)(y)},b=S({init:!0,getScene:function(e){return e.writeScene}})(function(e){var t=e.writeShield,n=e.onClose;return(0,u.Z)(function(){t.setOnModalClose(function(){null==n||n()})}),null});t.ZP=S},56828:function(e,t,n){"use strict";n.d(t,{O:function(){return l}});var r=n(55164),o=n(49899),i=n(85879),a=n(84871),c=n.n(a),s=n(92718),l=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return function(t){return c()(function(a){var c=s.Z.apply(void 0,(0,o._)(n));return(0,i.tZ)(t,(0,r._)({},a,e(c)))},t)}}},48504:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(85626),u=n(85879),d=n(84871),p=n.n(d),h=n(87363);t.Z=function(e){return function(t){var n=e.shouldLoad,d=void 0===n?function(e){return!e.isDrained}:n,f=e.load,_=function(e){(0,c._)(p,e);var n=(0,l._)(p);function p(){var e;return(0,o._)(this,p),e=n.apply(this,arguments),(0,a._)((0,r._)(e),"load",function(){return f(e.props,e.state)}),e}return(0,i._)(p,[{key:"componentDidMount",value:function(){d(this.props,this.state)&&this.load()}},{key:"componentDidUpdate",value:function(e,t){var n=d(e,t),r=d(this.props,this.state);r&&r!==n&&this.load()}},{key:"render",value:function(){return(0,u.tZ)(t,(0,s._)({},this.props))}}]),p}(h.Component);return p()(_,t)}}},45842:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(85879),a=n(84871),c=n.n(a),s=n(36695),l=n(58909);(0,s.connect)(function(e){return{currentUser:(0,l.ib)(e)}}),t.Z=function(e){return c()(function(t){var n=(0,s.useSelector)(function(e){return(0,l.ib)(e)});return(0,i.tZ)(e,(0,o._)((0,r._)({},t),{isLogin:n&&"guest"!==n.userType,currentUser:n}))},e)}},85576:function(e,t,n){"use strict";n.d(t,{M:function(){return d}});var r=n(87320),o=n(55164),i=n(85879),a=n(84871),c=n.n(a),s=n(14168),l=n.n(s),u=n(45842),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"authRequired";return function(t){var n=function(n,a){var c=a.authRequired,s=(0,r._)({},e,void 0===c?function(){}:c);return(0,i.tZ)(t,(0,o._)({},n,s))};return n.contextTypes={authRequired:l().func},c()((0,u.Z)(n),t)}},p=d();t.Z=p},55679:function(e,t,n){"use strict";n.d(t,{b8:function(){return E},dF:function(){return m},dT:function(){return g},nx:function(){return T}});var r=n(55164),o=n(57477),i=n(85879),a=n(87363),c=n(39658),s=n(36695),l=n(84871),u=n.n(l),d=n(67814),p=n.n(d),h=n(98329),f=n.n(h),_=n(68900),m=(0,a.memo)(function(e){var t,n=e.className,r=Object.keys(t=(0,s.useSelector)(_.Uh)).filter(function(e){return f()(t[e])&&t[e]}).filter(function(e){return"Mobile"!==e||!t.Tablet}).map(function(e){return"Body--".concat(e)});return(0,i.tZ)(c.ql,{children:(0,i.tZ)("body",{className:p()(n,r)})})}),v=function(e){return function(t){var n=(0,a.forwardRef)(function(n,a){return(0,i.BX)(i.HY,{children:[(0,i.tZ)(m,{className:e}),(0,i.tZ)(t,(0,o._)((0,r._)({},n),{ref:a}))]})});return u()(n,t)}},g=v("LightGreyBg-body"),T=v("WhiteBg-body"),E=v("GreyBg-body");t.ZP=v},65277:function(e,t,n){"use strict";n.d(t,{Yz:function(){return g},l:function(){return v}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(49899),u=n(85626),d=n(85879),p=n(84871),h=n.n(p),f=n(87363),_=n(65744),m={isBadBrowserPlugin:void 0},v=function(){return(0,l._)(document.querySelectorAll("script")).filter(function(e){var t;return null===(t=e.src)||void 0===t?void 0:t.startsWith("chrome-extension://")}).map(function(e){return e.src})},g=function(){return m.isBadBrowserPlugin};t.ZP=function(e){var t=function(t){(0,c._)(l,t);var n=(0,u._)(l);function l(){var e;return(0,o._)(this,l),e=n.apply(this,arguments),(0,a._)((0,r._)(e),"state",{isBadBrowserPlugin:!1}),(0,a._)((0,r._)(e),"checkerRef",(0,f.createRef)()),(0,a._)((0,r._)(e),"count",0),(0,a._)((0,r._)(e),"detect",function(){if(e.count++,!(e.count>10)){if(!e.checkerRef.current){setTimeout(e.detect,3e3);return}var t,n=window.getComputedStyle(e.checkerRef.current);if("none"===n.userSelect||"none"===n.webkitUserSelect){setTimeout(e.detect,3e3),m.isBadBrowserPlugin=!1;return}if(e.setState({isBadBrowserPlugin:!0}),m.isBadBrowserPlugin=!0,(0,_.y)("温馨提示",{content:(0,d.BX)(d.HY,{children:[(0,d.tZ)("p",{children:"检测到您安装了某些破解复制的浏览器插件。"}),(0,d.tZ)("p",{children:"这些插件可能会导致您的内容丢失。"}),(0,d.tZ)("p",{children:"建议您移除后再使用编辑器。"})]}),text:{cancel:"仍要继续",ok:"已移除，重新检测"}}).then(function(){window.location.reload()}).catch(function(){return null}),null===(t=e.props.reporter)||void 0===t?void 0:t.reportFail){var r=Error("bad browser plugin detected");r.payload={url:window.location.href},e.props.reporter.reportFail("BadBrowserPlugin",r)}}}),e}return(0,i._)(l,[{key:"componentDidMount",value:function(){this.detect()}},{key:"render",value:function(){return(0,d.BX)(d.HY,{children:[(0,d.tZ)(e,(0,s._)({},this.props)),(0,d.tZ)("p",{ref:this.checkerRef,css:{userSelect:"none",display:"none"}})]})}}]),l}(f.Component);return h()(t,e)}},3028:function(e,t,n){"use strict";var r=n(22107),o=n(94707),i=n(86325),a=n(55164),c=n(57477),s=n(85626),l=n(85879),u=n(87363),d=n(84871),p=n.n(d),h=n(70400);t.Z=function(e){return function(t){var n=function(n){(0,i._)(p,n);var d=(0,s._)(p);function p(){return(0,r._)(this,p),d.apply(this,arguments)}return(0,o._)(p,[{key:"render",value:function(){var n=e&&!(0,u.isValidElement)(e)?e:{replacement:e};return(0,l.tZ)(h.SV,(0,c._)((0,a._)({},n),{children:(0,l.tZ)(t,(0,a._)({},this.props))}))}}]),p}(u.Component);return p()(n,t)}}},77878:function(e,t,n){"use strict";var r=n(55164),o=n(85879),i=n(66011),a=n(84871),c=n.n(a);t.Z=function(e){return function(t){return c()(function(n){return(0,o.tZ)(i.BM,{query:e,children:(0,o.tZ)(t,(0,r._)({},n))})},t)}}},30256:function(e,t,n){"use strict";var r=n(55164),o=n(85879),i=n(43384),a=n(84871),c=n.n(a);t.Z=function(e){return c()(function(t){var n=(0,i.Q4)().trackEvent;return(0,o.tZ)(e,(0,r._)({trackEvent:n},t))},e)}},92718:function(e,t,n){"use strict";var r=n(55164),o=n(36695),i=n(7407);t.Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,o.useSelector)(function(n){return(0,i.tQ)(n,(0,r._)({paramId:e},t))})}},25734:function(e,t,n){"use strict";n.d(t,{W5:function(){return c},ZP:function(){return l},mv:function(){return a},pe:function(){return s}});var r=n(55164),o=n(57477),i=n(36695),a={normal:{logo:"primary",navActiveColor:"primary",headerTitle:"GBL01A"},custom:{logo:"GBK99B",boxShadow:"none",icon:"GBK99B",iconOpacity:"0.9",navColor:"GBK99B",navOpacity:"0.75",navActiveColor:"GBK99B",headerTitle:"GBK99B",searchInputColor:"GBK99B",searchButtonColor:"GBL01A",searchButtonBg:"GBK99B",searchButtonOpacity:"0.9",searchAreaColor:"GBK99B",searchBorder:"none",searchBorderColor:"transparent",searchPlaceHolderOpacity:"0.75",searchInputOpacity:"0.2",searchIconOpacity:"0.8"}},c=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return{transitionProperty:"".concat(t.join(",")),transitionDuration:"0.25s",transitionTimingFunction:"ease-in"}},s=function(e){return function(t){return e.colors[t]||t}};function l(){var e=(0,i.useSelector)(function(e){return e.env.appHeaderTheme}),t=e.current,n=e[t].bgColor;return(0,o._)((0,r._)({type:t,bgColor:n},a[t]),{themeTransition:c})}},78970:function(e,t,n){"use strict";var r=n(94009),o=n(91850),i=n(65733);t.Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,r._)((0,o.Z)(t),2),a=n[0],c=n[1];return{modalShown:a,openVotersModal:(0,i.Z)(function(){e(function(){c.on()})()}),closeVotersModal:(0,i.Z)(function(){c.off()})}}},79446:function(e,t,n){"use strict";n.d(t,{n:function(){return l}});var r=n(49899),o=n(87363),i=n(38322),a=n.n(i),c=n(36695),s=n(58909),l=function(){return(0,c.useSelector)(s.dd)};t.Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(0,c.useDispatch)(),n=(0,c.useSelector)(function(t){return a()((0,s.ib)(t),e)},c.shallowEqual);return(0,o.useEffect)(function(){t((0,s.sF)(e))},[t].concat((0,r._)(e))),n}},62095:function(e,t,n){"use strict";var r=n(36695),o=n(58909);t.Z=function(){var e=(0,r.useSelector)(function(e){return(0,o.ib)(e)}),t=(0,r.useSelector)(function(e){return e.switches}),n="https://www.zhihu.com";if("undefined"!=typeof window){var i=window.location,a=i.hostname,c=i.origin,s=[".zpres.zhihu.dev",".zpres.zhihu.com"].some(function(e){return a.endsWith(e)}),l=c.replace(/\D+/g,"");s&&l&&(n="https://heifetz--box-".concat(l,"--www-zhihu-com.zpres.zhihu.").concat(a.slice(-3)))}return{jumpUrl:e&&!e.isOrg&&t&&t.isCreator?"".concat(n,"/creator/editor-setting"):"".concat(n,"/knowledge-plan/editor-setting")}}},5198:function(e,t,n){"use strict";var r=n(94009),o=n(91850),i=n(36892),a=n(7835),c=n(32210);t.Z=function(e){var t=e||0,n=(0,r._)((0,o.Z)(!1),2),s=n[0],l=n[1],u=(0,i.Z)(function(e,n){n.scroll.top>t?l.on():l.off()},100);return(0,a.Z)(function(){var e=(0,c.subscribe)("scroll",u,{enableScrollInfo:!0});return function(){e.unsubscribe()}}),s}},81956:function(e,t,n){"use strict";n.d(t,{Z:function(){return i},q:function(){return o}});var r=n(87363),o=(0,r.createContext)(null);function i(){return(0,r.useContext)(o)}},16850:function(e,t,n){"use strict";n.d(t,{$:function(){return l}});var r=n(55164),o=n(57477),i=n(85879),a=n(84871),c=n.n(a),s=n(7407);t.Z=s.dD;var l=function(e){return function(t){return c()(function(n){return(0,i.tZ)(t,(0,o._)((0,r._)({},n),{isMobile:(0,s.dD)(e)}))},t)}}},89774:function(e,t,n){"use strict";var r=n(36695),o=n(7407);t.Z=function(){return(0,r.useSelector)(o.Xj)}},36374:function(e,t,n){"use strict";var r=n(36695),o=n(58909);t.Z=function(){return(0,r.useSelector)(o.W5)}},96955:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(94009),c=n(85879),s=n(83697),l=n(95548),u=n.n(l),d=n(87363),p=n(87641),h=n(31467),f=n(38889),_=n(67689),m=function(e){var t=e.title,n=e.content,l=e.ok,u=e.cancel,_=e.onOk,m=e.onCancel,v=e.disabled,g=(0,i._)(e,["title","content","ok","cancel","onOk","onCancel","disabled"]),T=(0,a._)((0,d.useState)(!0),2),E=T[0],C=T[1],y=(0,a._)((0,d.useState)(!1),2),S=y[0],I=y[1],b=function(e){return function(){C(!1),I(!0),e()}},A=(0,s.n)();return(0,c.tZ)(h.Z,(0,o._)((0,r._)({closeButton:null,maskClosable:!1,hotKeyClosable:!1,css:[{overflow:"hidden",maxWidth:"96vw",".Modal-content":{margin:0,padding:0}},A.Mobile&&{width:320,borderRadius:12,boxShadow:""}]},g),{children:E&&(0,c.BX)(p.Box,{px:"36px",py:"24px",children:[t&&(0,c.tZ)(p.Text,{fontSize:"18px",lineHeight:"28px",fontWeight:"bold",textAlign:"center",children:t}),n&&(0,c.tZ)(p.Text,{mt:t?"16px":"0",fontSize:"14px",lineHeight:"normal",color:"GBK03A",maxHeight:"calc(67vh - 100px)",css:{wordBreak:"break-all",overflowY:"auto",WebkitOverflowScrolling:"touch",marginRight:-10,paddingRight:10},children:n}),(0,c.BX)(p.Flex,{mt:"16px",css:{button:{padding:0,flex:1,height:36,lineHeight:1,fontSize:15,borderRadius:4,":active":{opacity:.6}}},justifyContent:"center",fontWeight:"bold",children:[u&&(0,c.tZ)(f.ZP,{css:{marginRight:4},onClick:b(m),children:u}),(0,c.tZ)(f.ZP,{preset:"primary",color:"blue",css:{maxWidth:"60%"},onClick:b(_),disabled:v||S,children:l})]})]})}))};t.Z=function(){var e=(0,_.Z)(),t=e.addInstance,n=e.removeInstance,o=function(e){return setTimeout(function(){return n(e)},300)};return{alert:function(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=a.title,l=a.ok,d=(0,i._)(a,["title","ok"]);return new Promise(function(o){t(n=(0,c.tZ)(m,(0,r._)({content:e,title:s,ok:l||"确定",onOk:o,css:{textAlign:"center"}},d),u()("modal")))}).finally(function(){return o(n)})},confirm:function(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.title,a=r.ok,s=r.cancel,l=r.disabled;return new Promise(function(r,o){t(n=(0,c.tZ)(m,{content:e,title:i,ok:a||"确定",onOk:r,cancel:s||"取消",onCancel:o,disabled:l},u()("modal")))}).finally(function(){return o(n)})}}}},35502:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r=n(94009),o=n(75798),i=n(65733),a=n(58338),c=n(68159),s=n(87363),l=new(n(11197)).EventEmitter,u=Symbol("useAllowOnePlayer/startPlay"),d=!1,p=function(e){var t=e.videoId,n=e.iframeRef,p=(0,r._)((0,s.useState)(null==n?void 0:n.current),2),h=p[0],f=p[1],_=(0,r._)((0,o.Z)({threshold:.5}),2),m=_[0],v=_[1],g=(0,r._)((0,s.useState)((0,c.Wn)(t,"*",!0)),2),T=g[0],E=g[1],C=(0,s.useRef)(!1),y=(0,i.Z)(function(){!v&&(null==h?void 0:h.contentWindow)&&C.current&&!d&&T.dispatchMessage(null==h?void 0:h.contentWindow,c.aO.PAUSE,{dontApplyOnFullScreen:!0})}),S=(0,i.Z)(function(e){t!==e.sourceId&&(null==h?void 0:h.contentWindow)&&T.dispatchMessage(h.contentWindow,c.aO.PAUSE)}),I=(0,i.Z)(function(){C.current=!0,l.emit(u,{sourceId:t})}),b=(0,i.Z)(function(){C.current=!1}),A=(0,a.Z)((0,i.Z)(function(){C.current&&y()}),100),Z=(0,i.Z)(function(){d=!0}),w=(0,i.Z)(function(){d=!1});(0,s.useEffect)(function(){var e=[T.subscribeMessage(c.FP.PLAY,I).unsubscribe,T.subscribeMessage(c.FP.PAUSE,b).unsubscribe,T.subscribeMessage(c.FP.ENTER_PIP,Z).unsubscribe,T.subscribeMessage(c.FP.EXIT_PIP,w).unsubscribe];return l.on(u,S),window.addEventListener("scroll",A),function(){l.removeListener(u,S),e.forEach(function(e){return e()})}},[b,I,A,S,T,Z,w]),(0,s.useEffect)(function(){m(h)},[h,m]),(0,s.useEffect)(function(){y()},[v,h,y]),(0,s.useEffect)(function(){!h&&(null==n?void 0:n.current)&&t&&(f(n.current),E((0,c.Wn)(t,"*",!0)))})}},67689:function(e,t,n){"use strict";n.d(t,{j:function(){return c}});var r=n(94009),o=n(85879),i=n(87363),a=(0,i.createContext)(),c=function(e){var t=e.children,n=(0,r._)((0,i.useState)([]),2),c=n[0],s=n[1],l=(0,i.useCallback)(function(e){return s(function(t){return t.concat(e)})},[]),u=(0,i.useCallback)(function(e){return s(function(t){return t.filter(function(t){return t!==e})})},[]),d=(0,i.useRef)({addInstance:l,removeInstance:u});return(0,o.BX)(o.HY,{children:[(0,o.tZ)(a.Provider,{value:d.current,children:t}),c]})};t.Z=function(){var e=(0,i.useContext)(a);return{addInstance:e.addInstance,removeInstance:e.removeInstance}}},25076:function(e,t,n){"use strict";var r=n(94009),o=n(87363),i=n(67516),a=n.n(i);t.Z=function(e){var t=(0,r._)((0,o.useState)(function(){return a().get(e)}),2),n=t[0],i=t[1];return[n,(0,o.useCallback)(function(t){a().set(e,t),i(t)},[e])]}},4607:function(e,t,n){"use strict";n.d(t,{x:function(){return E}});var r=n(9338),o=n(55164),i=n(57477),a=n(94009),c=n(30971),s=n(85879),l=n(7835),u=n(6080),d=n(17347),p=n(9539),h=n(84871),f=n.n(h),_=n(87363),m=n(80714),v=n(81956),g="SMS_SUPPORTED_COUNTRIES",T="".concat(m.Z.fetchRoot.www,"/api/v3/oauth/sms/supported_countries"),E=function(e){return f()(function(t){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(0,a._)((0,_.useState)(e),2),n=t[0],o=t[1],i=(0,v.Z)(),s="0"===(0,u.c)("use_cached_supported_countries");return(0,l.Z)(function(){function e(){return(e=(0,r._)(function(){var e,t,n,r,a,l,u,d;return(0,c.__generator)(this,function(c){switch(c.label){case 0:return[4,function(e){return C.apply(this,arguments)}(g)];case 1:if(t=null==(e=c.sent())?void 0:e.version,!(!Array.isArray(n=null==e?void 0:e.data)||!t||s))return[3,4];return[4,i(T)];case 2:return a=(r=c.sent().payload).data,[4,y(g,{version:r.version,data:a})];case 3:return c.sent(),o(a),[2];case 4:return[4,i(T,{query:{version:t}})];case 5:if(u=(l=c.sent().payload).data,!(t!==(d=l.version)))return o(n),[2];return[4,y(g,{version:d,data:u})];case 6:return c.sent(),o(u),[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),n}();return(0,s.tZ)(e,(0,i._)((0,o._)({},t),{supportedCountries:n}))},e)};function C(){return(C=(0,r._)(function(e){return(0,c.__generator)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,d.h5.default.get(e)];case 1:return[2,t.sent()];case 2:return I("safe-get",t.sent()),[2,null];case 3:return[2]}})})).apply(this,arguments)}function y(e,t){return S.apply(this,arguments)}function S(){return(S=(0,r._)(function(e,t){var n,r=arguments;return(0,c.__generator)(this,function(o){switch(o.label){case 0:n=r.length>2&&void 0!==r[2]?r[2]:(0,p.Z)(Date.now(),100),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,d.h5.default.set(e,t,n)];case 2:return[2,o.sent()];case 3:return I("safe-set",o.sent()),[3,4];case 4:return[2]}})})).apply(this,arguments)}function I(e,t){if("undefined"!=typeof window){var n;null===(n=window.Raven)||void 0===n||n.captureException(t,{extra:{name:"heifetz-idb-error",type:e}})}}},36591:function(e,t,n){"use strict";n.d(t,{H:function(){return o}});var r=n(87363),o=(0,r.createContext)("");t.Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"https://www.zhihu.com",n=(0,r.useContext)(o);return e?n?((e=new URL(e,t)).searchParams.append("utm_source",n),e.toString()):e:n}},49048:function(e,t,n){"use strict";n.d(t,{a:function(){return u},w:function(){return l}});var r,o=n(9338),i=n(30971),a=n(80714),c={AD_PROMOTION_EXTRA_GET:"ad/getAdPromotionExtra/get",AD_PROMOTION_EXTRA_GIVE:"ad/getAdPromotionExtra/give"},s=function(e){return["https://".concat(a.Z.wwwHost),"https://".concat(a.Z.zhuanlanHost)].includes(e)},l=function(e,t,n){var r=function(o){var i=o.data,a=o.origin,l=o.source;if(s(a)&&i.type===c.AD_PROMOTION_EXTRA_GET){var u=i.data,d=u.type,p=u.id;d===e&&p===t&&(null==l||l.postMessage({type:c.AD_PROMOTION_EXTRA_GIVE,data:{type:e,id:t,promotionExtra:n}},a),window.removeEventListener("message",r))}};window.addEventListener("message",r,!1);var o=setTimeout(function(){window.removeEventListener("message",r),clearTimeout(o)},6e4)},u=(r=(0,o._)(function(e,t){return(0,i.__generator)(this,function(n){return"undefined"!=typeof window&&(null==window?void 0:window.opener)?[2,new Promise(function(n){var r=function(o){var i=o.data;if(s(o.origin)&&i.type===c.AD_PROMOTION_EXTRA_GIVE){var a=i.data,l=a.type,u=a.id,d=a.promotionExtra;l===e&&u===t&&(n(d),window.removeEventListener("message",r))}};window.addEventListener("message",r,!1),window.opener.postMessage({type:c.AD_PROMOTION_EXTRA_GET,data:{type:e,id:t}},"https://".concat(a.Z.wwwHost))})]:[2,void 0]})}),function(e,t){return r.apply(this,arguments)})},81552:function(e,t,n){"use strict";n.d(t,{w:function(){return A}});var r=n(9338),o=n(55164),i=n(57477),a=n(94009),c=n(30971),s=n(85879),l=n(61763),u=n(65733),d=n(84871),p=n.n(d),h=n(74135),f=n(92769),_=n.n(f),m=n(36695),v=n(6148),g=n(8866),T=n(58909),E=n(67927),C=n(40195),y=n(28814),S=n(27521),I=n(62250),b=n(64512),A=function(e){return function(t){var n=function(n){var d,p,h,f,_=(d=(0,m.useStore)(),p=(0,m.useDispatch)(),h=(0,I.u)("answer",e),f=(0,a._)((0,b.zb)(),1)[0],{update:(0,u.Z)(function(e,t){var n,o,i,a=d.getState(),s=(0,g.ae)(a,{id:e}),u=a.entities.drafts,_=(n=(0,r._)(function(){return(0,c.__generator)(this,function(n){return[2,p((0,g.JA)({id:e,data:t},{answer:s}))]})}),function(){return n.apply(this,arguments)}),m=(o=(0,r._)(function(t){var n;return(0,c.__generator)(this,function(r){switch(r.label){case 0:return n=null==t?void 0:t.publish,[4,p((0,g._o)({id:e},n,{answer:s}))];case 1:return r.sent(),[2,{payload:n}]}})}),function(e){return o.apply(this,arguments)}),v=(i=(0,r._)(function(t){return(0,c.__generator)(this,function(n){switch(n.label){case 0:return p((0,E.c0)((0,l.n$)(t),"red")),[4,p((0,g.Ly)({id:e},{answer:s,drafts:u}))];case 1:throw n.sent(),t}})}),function(e){return i.apply(this,arguments)});return _().then(function(){return f.safeRecordStageStart("pre-request"),h.update(Z(t,{answerId:e})).then(m,v)})}),publish:(0,u.Z)(function(e,t){var n,o,i=d.getState(),a=(0,C.Md)(i,{id:e}),s=(0,T.wY)(i),u=(0,y.np)(i,{urlToken:s}),_=(n=(0,r._)(function(t){var n;return(0,c.__generator)(this,function(r){switch(r.label){case 0:return n=null==t?void 0:t.publish,[4,p((0,g.QX)(n,{questionId:e,urlToken:s,user:u,question:a}))];case 1:return r.sent(),[2,{payload:n}]}})}),function(e){return n.apply(this,arguments)}),m=(o=(0,r._)(function(e){return(0,c.__generator)(this,function(t){throw p((0,E.c0)((0,l.n$)(e),"red")),e})}),function(e){return o.apply(this,arguments)});return f.safeRecordStageStart("pre-request"),h.publish(Z(t,{questionId:e})).then(_,m)}),scheduledPublish:(0,u.Z)(function(e,t){var n,o=(n=(0,r._)(function(e){return(0,c.__generator)(this,function(t){throw p((0,E.c0)((0,l.n$)(e),"red")),e})}),function(e){return n.apply(this,arguments)});return h.scheduledPublish(Z(t,{questionId:e})).catch(o)})});return(0,s.tZ)(t,(0,i._)((0,o._)({},n),{answerContentPublish:_}))};return p()(n,t),n}};function Z(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.questionId,o=n.answerId,i=new S.y;o&&i.setDraft("contentId",String(o)),i.setDraft("isPublished",!!o),i.setDraft("disabled",1),r&&i.setExtraInfo("question_id",String(r)),e.publishAt&&i.set("schedule",{publishAt:e.publishAt}),i.setExtraInfo("publisher","pc"),i.setExtraInfo("include",g.EI);var a=(0,v.hZ)((0,h.decamelizeKeys)(_()(e,["content"])));if(a&&i.setExtraInfo("pc_business_params",a),i.set("hybrid",{html:e.content}),i.set("reprint",{reshipment_settings:e.reshipmentSettings}),i.set("commentsPermission",{comment_permission:e.commentPermission}),i.set("appreciate",{can_reward:e.rewardSetting.canReward,tagline:e.rewardSetting.tagline}),-1!==["zvideo","video"].indexOf(null===(t=e.attachment)||void 0===t?void 0:t.type)){var c=e.attachment;return i.set("publishSwitch",{draft_type:"zvideo"===c.type?"video_answer":"video_answer_v2"}),i.set("originalReprint",{originalReprint:c.isOriginal?"original":"reprint"}),i.addMedia({video:{cover:{originalUrl:c.imageUrl,width:1920,height:1080},videoId:c.videoId}}),i.build()}return i.set("publishSwitch",{draft_type:"normal"}),i.set("creationStatement",{disclaimer_status:e.disclaimerStatus,disclaimer_type:e.disclaimerType}),i.set("commercialReportInfo",{isReport:e.isReport?1:0}),e.commercialZhitaskBindInfo&&i.set("commercialZhitaskBindInfo",{bindOperate:e.commercialZhitaskBindInfo.bind_operate,taskId:String(e.commercialZhitaskBindInfo.task_id),taskType:e.commercialZhitaskBindInfo.task_type}),i.set("toFollower",{push_activity:e.pushActivity}),i.setExtraInfo("bizExt",(0,h.decamelizeKeys)(e.bizExt)),i.set("contentsTables",{table_of_contents_enabled:e.tableOfContentsEnabled}),i.set("thanksInvitation",{thank_inviter_status:e.thankInviterStatus,thank_inviter:e.thankInviter}),i.build()}},27521:function(e,t,n){"use strict";n.d(t,{y:function(){return a}});var r=n(22107),o=n(94707),i=n(87320),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r._)(this,e),(0,i._)(this,"data",void 0),this.data=t}return(0,o._)(e,[{key:"set",value:function(e,t){var n="function"==typeof t?t(this.data[e]):t;return this.data[e]=n,this}},{key:"setExtraInfo",value:function(e,t){return this.data.extra_info||(this.data.extra_info={}),this.data.extra_info[e]=t,this}},{key:"setDraft",value:function(e,t){return this.data.draft||(this.data.draft={}),this.data.draft[e]=t,this}},{key:"addMedia",value:function(e){return this.data.media||(this.data.media={}),this.data.media.medias||(this.data.media.medias=[]),this.data.media.medias.push(e),this}},{key:"build",value:function(){return this.data}}]),e}()},94629:function(e,t,n){"use strict";n.d(t,{o:function(){return o}});var r=n(35102),o=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=n.name;return(0,r.hu)(n.message)||"TypeError"===o&&(null==n?void 0:null===(e=n.message)||void 0===e?void 0:e.includes("Load failed"))?"FetchError":"ResponseError"===o?"".concat(o,"_").concat(n.status||0,"_").concat((null===(t=n.payload)||void 0===t?void 0:t.code)||0):o||"Unknown"}},62250:function(e,t,n){"use strict";n.d(t,{u:function(){return Z}});var r=n(9338),o=n(94009),i=n(49899),a=n(30971);n(85879);var c=n(65733),s=n(54231);n(84871);var l=n(74135),u=n(45851),d=n.n(u),p=n(88329),h=n.n(p),f=n(36695),_=n(80714),m=n(81956),v=n(58909),g=n(94629),T=n(38322),E=n.n(T),C=n(75472),y=n.n(C),S=n(6148);function I(){return(I=(0,r._)(function(e,t,n,r,o){var c,s,l,u,d,p,h,f;return(0,a.__generator)(this,function(a){return c=o.currentUserToken,(u=(0,S.dj)(null==n?void 0:null===(s=n.extra_info)||void 0===s?void 0:s.pc_business_params))&&(d=(0,S.dj)(null==r?void 0:r.pcBusinessParams))&&(p=new Set,"answer"===e?(p.add("content"),"update"===t&&(p.add("answer_id"),p.add("question_id"),p.add("is_copyable"),p.add("is_report"),p.add("biz_ext"),u.comment_permission||d.comment_permission||p.add("comment_permission"),p.add("answer_type"),p.add("tagline"),u.reshipment_settings||d.reshipment_settings||p.add("reshipment_settings"),p.add("publish_at"),p.add("published_at"))):"article"===e&&(u.column&&(u.column=E()(u.column,["id"])),u.column||d.column||p.add("column"),y()(u.commercial_report_info,{commercial_types:[]})&&!d.commercial_report_info&&p.add("commercial_report_info"),u.commercial_zhitask_bind_info||d.commercial_zhitask_bind_info||p.add("commercial_zhitask_bind_info"),p.add("article_id"),(null===(h=u.content_source)||void 0===h?void 0:h.method)!==1&&(p.add("content_source.location"),p.add("content_source.create_at"))),f=[],function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!p.has(r.join("."))){if("object"==typeof t&&"object"==typeof n&&t&&n){Array.from(new Set((0,i._)(Object.keys(t)).concat((0,i._)(Object.keys(n))))).forEach(function(o){return e(t[o],n[o],(0,i._)(r).concat([o]))});return}t!==n&&f.push({path:r.join("."),pc:JSON.stringify(t),be:JSON.stringify(n)})}}(u,d),0===f.length||null===(l=window.webReporter)||void 0===l||l.report("pc_content_publish_payload_consistency",{type:e,action:t,diffs:f,pc:u,backend:d,content:n,userToken:c,result:null==r?void 0:r.publish})),[2]})})).apply(this,arguments)}var b=n(64512),A="".concat(_.Z.fetchRoot.www,"/api/v4/content/publish");function Z(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unknown",u=(0,f.useSelector)(v.wY),p=(0,m.Z)(),_=null!==(t=(0,s.j0)())&&void 0!==t?t:"Unknown",T=(0,o._)((0,b.zb)(),1)[0],E=function(t,o){var c,l=function(){for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];s.ZP.increment(["content_publish",_,n,e,t].concat((0,i._)(o),["count"]).join("."))};return c=(0,r._)(function(n){var r,c,s,p,f,_=arguments;return(0,a.__generator)(this,function(a){switch(a.label){case 0:for(c=Array((r=_.length)>1?r-1:0),s=1;s<r;s++)c[s-1]=_[s];a.label=1;case 1:return a.trys.push([1,3,,4]),l("request"),[4,o.apply(void 0,[n].concat((0,i._)(c)))];case 2:return p=a.sent(),l("success"),(function(e,t,n,r,o){return I.apply(this,arguments)})(e,t,n,d()(p),{currentUserToken:u}).catch(h()),[2,p];case 3:throw f=a.sent(),l("fail",(0,g.o)(f)),f;case 4:return[2]}})}),function(e){return c.apply(this,arguments)}};function C(e){return y.apply(this,arguments)}function y(){return(y=(0,r._)(function(t){return(0,a.__generator)(this,function(n){var o;return null==T||T.safeRecordStageStart("request",t),[2,p(A,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e,data:t})}).then((o=(0,r._)(function(e){var t,n,r;return(0,a.__generator)(this,function(o){return null==T||T.safeRecordStageStart("post-request",e.payload),[2,(r=null===(t=e.payload)||void 0===t?void 0:null===(n=t.data)||void 0===n?void 0:n.result)?(0,l.camelizeKeys)(JSON.parse(r)):null]})}),function(e){return o.apply(this,arguments)}))]})})).apply(this,arguments)}return{publish:(0,c.Z)(E("publish",C)),update:(0,c.Z)(E("update",C)),scheduledPublish:(0,c.Z)(E("scheduledPublish",C))}}},64512:function(e,t,n){"use strict";n.d(t,{FK:function(){return w},Ss:function(){return b},zb:function(){return Z}});var r=n(22107),o=n(94707),i=n(87320),a=n(15030),c=n(55164),s=n(57477),l=n(94009),u=n(49899),d=n(85879),p=n(62082),h=n(54231),f=n(84871),_=n.n(f),m=n(45851),v=n.n(m),g=n(87363),T=n(36695),E=n(58909),C=n(12592),y=n.n(C),S=n(80714),I=n(94629);function b(e){return(JSON.stringify(e),e&&"object"==typeof e)?Array.isArray(e)?e.map(b):Object.keys(e).reduce(function(t,n){return t[n]=b(e[n]),t},{}):"string"==typeof e?encodeURI(e):e}var A=function(){function e(){(0,r._)(this,e),(0,i._)(this,"_pageName","Unknown"),(0,i._)(this,"_urlToken",""),(0,i._)(this,"_type","unknown"),(0,i._)(this,"_scene","Unknown"),(0,i._)(this,"_snapshots",[]),(0,i._)(this,"_stage","collect")}return(0,o._)(e,[{key:"safeRecordParamCollected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._safeTakeShot("collected",{name:e,payload:t})}},{key:"safeRecordStageStart",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._stage=e,this._safeTakeShot(e,t)}},{key:"_safeTakeShot",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{var n=v()(t);try{this._snapshots.push({name:e,payload:JSON.parse(JSON.stringify(n)),timestamp:+Date.now()})}catch(t){this._snapshots.push({name:e,payload:String(n),timestamp:+Date.now()})}}catch(e){}}},{key:"safeReport",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unset";try{var n,r=(0,a._)(e,Error)?e:Error(String(e));if(this._safeTakeShot("error",{reportedBy:t}),r.name.startsWith("ResponseError")&&"1"!==S.Z.apollo.reportBackendPublishError)return;var o={type:"PublishError",appName:"heifetz",spanName:this._pageName,release:S.Z.release||"unknown",currentUser:this._urlToken,error:{name:(0,I.o)(r),message:r.message,payload:r.payload||"Unknown",stack:r.stack},publish:{type:this._type,stage:this._stage,scene:this._scene,snapshots:this._snapshots}};null==window||null===(n=window.webReporter)||void 0===n||n.report("pc_publish_error",b(o)),(0,p.zB)(o)}catch(e){}}},{key:"setUrlToken",value:function(e){this._urlToken=e}},{key:"startFreshReport",value:function(e,t){var n;this._pageName=null!==(n=(0,h.j0)())&&void 0!==n?n:"Unknown",this._snapshots=[],this._type=e||"unknown",this._scene=t||"Unknown",this._stage="collect"}},{key:"wrapAutoReport",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{freshReport:!1},n=t.reportedBy,r=t.freshReport,o=this;return function(){for(var t=arguments.length,i=Array(t),a=0;a<t;a++)i[a]=arguments[a];r&&o.startFreshReport(r.type,r.scene);try{var c=e.apply(void 0,(0,u._)(i));if(y()(c))return c.catch(function(e){throw o.safeReport(e,n),e});return c}catch(e){throw o.safeReport(e,n),e}}}}]),e}();function Z(){var e=(0,T.useSelector)(E.wY),t=A.instance;return(0,g.useEffect)(function(){A.instance.setUrlToken(e)},[e]),[t]}function w(e){return _()(function(t){var n=(0,l._)(Z(),1)[0];return(0,d.tZ)(e,(0,s._)((0,c._)({},t),{publishErrorReporter:n}))},e)}(0,i._)(A,"instance",new A)},2493:function(e,t,n){"use strict";var r=n(36695),o=n(31824),i=(0,o.wN)(o.PW,r.shallowEqual);t.Z=i},65379:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(49899),o=n(85456),i=n.n(o);function a(e,t,n){var o=!1,a=i()(function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];o=!1,e.apply(void 0,(0,r._)(n))},t,n);return Object.assign(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o=!0,a.apply(void 0,(0,r._)(t))},{cancel:a.cancel,flush:a.flush,pending:function(){return o}})}},93292:function(e,t){"use strict";t.Z=function(e,t){var n=!1,r=[],o=null;return function(){for(var i=arguments.length,a=Array(i),c=0;c<i;c++)a[c]=arguments[c];return r.push(a),n||(n=!0,o=new Promise(function(o){t(function(){var t=r;n=!1,r=[],o(e(t))})})),o}}},80523:function(e,t){"use strict";t.Z=function(e,t,n){return t in e?e[t]:e[t]=n()}},6366:function(e,t,n){"use strict";n.d(t,{ZP:function(){return K},fn:function(){return X},sQ:function(){return F},F4:function(){return M},t_:function(){return V},Z3:function(){return z},L3:function(){return H},MM:function(){return G},LC:function(){return B},Hr:function(){return U},Rv:function(){return q}});var r=n(55164),o=n(57477),i=n(49899),a=n(74135),c=n(4785);n(58909);var s=n(66263),l=n(39288),u=n(81897),d=n.n(u);function p(){return"undefined"!=typeof document&&d().remove("unlock_ticket"),{unlockTicketStatus:!1,unlockTicket:null,challenge:[]}}var h=[s.An,s.hY,s.M,s.Uw,s.TY],f=(0,r._)({},(0,l.FH)("account",["UNLOCK_TICKET_BY_DIGITS","UNLOCK_TICKET_BY_PASSWORD","GET_UNLOCK_REQUEST","REQUEST_UNLOCK_TICKET","GET_UNBLOCK_INFO","REQUEST_PHONE_VERIFICATION_CODE","UPDATE_PHONE_NUMBER","GET_ACCOUNT_PHONE_VERIFY_CODE","UPDATE_ACCOUNT_PHONE","REQUEST_EMAIL_VERIFY_CODE","UPDATE_EMAIL","ACTIVE_EMAIL","MONOPOLIZE_PHONE_NUMBER","RESET_PASSWORD","RESET_ORG_PASSWORD","REQUEST_URL_TOKEN","UPDATE_URL_TOKEN","GET_ACCOUNT_INFO","GET_ORG_ACCOUNT_INFO","UPDATE_ORG_EMAIL","REQUEST_ORG_EMAIL_VERIFY_CODE","GET_ACCOUNT_CARDINFO","GET_ACCOUNT_STICKERS_LIST","GET_ACCOUNT_WIDGET","GET_ACCOUNT_WIDGETID"]),(0,l.co)("account",["RECOVER_DEFAULT_TYPE","SET_UNLOCK_TICKET","SET_HANDLEWIDGET","SET_ACCOUNTUSER_WIDGETID"])),_=f.UNLOCK_TICKET_BY_DIGITS,m=f.UNLOCK_TICKET_BY_PASSWORD,v=f.GET_UNLOCK_REQUEST,g=f.REQUEST_UNLOCK_TICKET,T=f.GET_UNBLOCK_INFO,E=f.REQUEST_PHONE_VERIFICATION_CODE,C=f.UPDATE_PHONE_NUMBER,y=(f.GET_ACCOUNT_PHONE_VERIFY_CODE,f.UPDATE_ACCOUNT_PHONE),S=(f.REQUEST_EMAIL_VERIFY_CODE,f.REQUEST_ORG_EMAIL_VERIFY_CODE,f.UPDATE_EMAIL),I=(f.ACTIVE_EMAIL,f.MONOPOLIZE_PHONE_NUMBER),b=(f.RESET_PASSWORD,f.RESET_ORG_PASSWORD,f.REQUEST_URL_TOKEN),A=f.UPDATE_URL_TOKEN,Z=f.GET_ACCOUNT_INFO,w=f.GET_ORG_ACCOUNT_INFO,R=f.UPDATE_ORG_EMAIL,N=f.GET_ACCOUNT_CARDINFO,k=f.GET_ACCOUNT_STICKERS_LIST,O=(f.GET_ACCOUNT_WIDGET,f.GET_ACCOUNT_WIDGETID),x=f.RECOVER_DEFAULT_TYPE,P=f.SET_UNLOCK_TICKET,D=f.SET_HANDLEWIDGET,L=f.SET_ACCOUNTUSER_WIDGETID;function B(e){return{API:{types:_,method:"POST",body:(0,c.z)((0,a.decamelizeKeys)({digits:e})),endpoint:"v3/oauth/account/unlock/digits"}}}function U(e){return{API:{types:m,method:"POST",body:(0,c.z)((0,a.decamelizeKeys)({password:e})),endpoint:"v3/oauth/account/unlock/password"}}}function M(){return{API:{types:v,method:"GET",endpoint:"v3/oauth/account/unlock/request",fetchOptions:{credentials:"include"}}}}function G(e){return{API:{types:g,method:"POST",endpoint:"v3/oauth/account/unlock/request/".concat(e)}}}function F(){return{API:{types:T,method:"GET",endpoint:"/antispam/lock_info"}}}function z(){return{type:x}}function H(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.notification;return{API:{types:E,endpoint:"v3/account/api/account/phone_no",method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,c.Z)({new_phone_no:e})}},NOTIFICATION:void 0===n||n}}function q(e,t){return{phone:e,API:{types:C,endpoint:"v3/account/api/account/phone_no",method:"PUT",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,c.Z)({new_phone_no:e,digits:t})}},NOTIFICATION:!1}}var V=function(){return{API:{types:I,endpoint:"v3/account/api/account/phone_no/cover",method:"POST",fetchOptions:{credentials:"include"}}}};function X(){return{API:{types:Z,method:"GET",endpoint:"v3/oauth/account"}}}var W={unlockTicketStatus:!1,unlockTicket:null,challenge:[],errorStatus:!1,message:"",isFetching:!1,accountInfo:{},urlToken:{loading:!1},cardUserInfo:{vipInfo:{}},handleWidget:{},widgetList:[],userWidgetId:""};function K(){var e,t,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,c=arguments.length>1?arguments[1]:void 0,s=c.type,l=c.payload;if(s===T.success){var u=l.spamLevel,d=l.isAppealed;return(0,o._)((0,r._)({},a),{spamLevel:u,isAppealed:d,antispamLockInfo:l,isUnblockInfoFetched:!0})}if(-1!==[_.success,m.success].indexOf(s))return(0,r._)({},a,(e=c.payload,t=c.res,(n=e.unlockTicket)?{unlockTicketStatus:t.ok,unlockTicket:n,challenge:[],errorStatus:!1,message:""}:p()));if(-1!==[C.success,y.success].indexOf(s)){var f=c.phone,g=(0,o._)((0,r._)({},a.accountInfo),{phoneNo:function(e){if(!e)return"";var t=e+"";return t.slice(0,6)+"****"+t.slice(10)}(f)});return(0,o._)((0,r._)({},a,p()),{accountInfo:g})}if(s===S.success||s===R.success){var E=c.email,I=(0,o._)((0,r._)({},a.accountInfo),{email:function(e){if(!e)return"";var t=e.indexOf("@");return t>2?e.slice(0,2)+"****"+e.slice(t):e}(E)});return(0,o._)((0,r._)({},a,p()),{accountInfo:I})}if(s===v.request)return(0,o._)((0,r._)({},a),{isFetching:!0});if(s===v.success)return(0,o._)((0,r._)({},a),{challenge:l.challenge,isFetching:!1});if(s===v.failure)return(0,o._)((0,r._)({},a),{isFetching:!1});if(s===Z.success)return(0,o._)((0,r._)({},a),{accountInfo:l});if(s===w.success)return(0,o._)((0,r._)({},a),{accountInfo:{passwordSet:"已设置"===l.accountPwd.status,email:l.accountEmail.email}});if(s===b.request)return(0,o._)((0,r._)({},a),{urlToken:{loading:!0}});if(s===b.success)return(0,o._)((0,r._)({},a),{urlToken:{loading:!1,setable:l.setable,token:l.urlToken}});if(s===b.failure)return(0,o._)((0,r._)({},a),{urlToken:{loading:!1}});if(s===A.success){var B=c.urlToken;return(0,o._)((0,r._)({},a),{urlToken:{loading:!1,setable:!1,token:B}})}if(s===x)return(0,o._)((0,r._)({},a),{errorStatus:!1,isFetching:!1});if(s===D)return(0,o._)((0,r._)({},a),{handleWidget:(0,r._)({},c.handleWidget)});if(s===P)return(0,o._)((0,r._)({},a),{unlockTicket:c.unlockTicket});if(c.err&&c.err.payload){var U=c.err.payload;if(h.includes(U.code))return(0,o._)((0,r._)({},a),{unlockTicketStatus:!1,errorStatus:!0,message:U.message})}return s===N.success?(0,o._)((0,r._)({},a),{cardUserInfo:(0,r._)({},l)}):s===k.success?(0,o._)((0,r._)({},a),{widgetList:(0,i._)(l.data)}):s===O.success?(0,o._)((0,r._)({},a),{userWidgetId:l.data.widgetId}):s===L?(0,o._)((0,r._)({},a),{userWidgetId:c.widgetId}):a}},22712:function(e,t,n){"use strict";n.d(t,{Cz:function(){return _},SE:function(){return l}});var r,o=n(87320),i=n(94146),a=n(8866),c=n(89250),s=n(35528),l={vote:{positive:"voteup",revertPositive:"revert_voteup",negative:"votedown",revertNegative:"revert_votedown"},like:"like",revertLike:"revert_like",collect:"collect",revertCollect:"revert_collect",follow:"follow",revertFollow:"revert_follow",comments:{show:"show_comments",close:"close_comments",publish:"comment_publish"},shareClick:"share_click"},u={answer:{},article:{}},d=function(e,t){var n=t.type,r=t.id,o=t.action;Object.keys(u).includes(n)&&r&&(e[n][r]=o)},p=function(e){return function(t,n){var r=n.meta,o=n.payload,i=t.answer[r.id];1===o.voting?i=l.vote.positive:-1===o.voting?i=l.vote.negative:0===o.voting&&1===r.beforeVoting?i=l.vote.revertPositive:0===o.voting&&-1===r.beforeVoting&&(i=l.vote.revertNegative),d(t,{type:e,id:r.id,action:i})}},h=function(e){return function(t,n){var r=n.meta,o=n.payload;d(t,{type:e,id:r.id,action:o.isThanked||o.isLiked?l.like:l.revertLike})}},f=(0,i.oM)({initialState:u,name:"adPromotion",reducers:{updateAdPromotionAction:function(e,t){var n=t.payload;d(e,{type:n.type,id:n.id,action:n.currentAction})}},extraReducers:(r={},(0,o._)(r,a.uJ.UPDATE_VOTE.success,p("answer")),(0,o._)(r,c.VA.VOTE.success,p("article")),(0,o._)(r,a.uJ.UPDATE_THANK.success,h("answer")),(0,o._)(r,c.VA.LIKE.success,h("article")),(0,o._)(r,s.xb.UPDATE_FAVLIST_ITEM.success,function(e,t){var n=t.meta,r=n.collected,o=n.contentId;d(e,{type:n.contentType,id:o,action:r?l.collect:l.revertCollect})}),r)}),_=f.actions.updateAdPromotionAction;t.ZP=f.reducer},8866:function(e,t,n){"use strict";n.d(t,{EI:function(){return m},G:function(){return I},G_:function(){return H},Hh:function(){return R},JA:function(){return D},Ly:function(){return B},Md:function(){return F},Mn:function(){return X},ON:function(){return N},Pe:function(){return A},QX:function(){return x},TC:function(){return E},Uk:function(){return Z},Vc:function(){return k},Yu:function(){return w},Zq:function(){return g},_o:function(){return L},ae:function(){return z},bs:function(){return M},eP:function(){return V},eu:function(){return C},f0:function(){return b},fT:function(){return y},iM:function(){return S},i_:function(){return T},oe:function(){return P},p3:function(){return U},ri:function(){return G},uJ:function(){return f},z:function(){return q}});var r=n(87320),o=n(55164),i=n(57477),a=n(74135),c=n(93206),s=n(28953),l=n(84054),u=n.n(l),d=n(80714),p=n(39288),h=n(69906),f=(0,p.FH)("answer",["UPDATE_VOTE","UPDATE_THANK","UPDATE_COMMENT_PERMISSION","UPDATE_RESHIPMENTSETTINGS","DELETE","RESTORE","GET","GET_SOME","GET_VOTERS","GET_COPYRIGHT_APPLICANTS","GET_FAVLISTS","GET_COMMENT_PERMISSION","COLLAPSE","ADD","UPDATE","STICK","UPDATE_ANSWER_REWARD","GET_UPVOTERS","LOAD_MARKET_ANSWER_PAID_CONTENT","GET_SETTINGS","SCHEDULED_PUBLISH","VALIDATE_SCHEDULED_PUBLISH","CANCEL_SCHEDULED_PUBLISH","CHECK_IF_CAN_CONVERT_TO_VESSAY","SUBMIT_EVALUTE","LOAD_ANSWER_SEARCH_ENTITY","LOAD_ANSWER_RELATION_ENDORSEMENT","LOAD_ANSWER_RECOMMEND_LIST"]),_=(0,p.co)("answer",["UPDATE_SETTINGS_DISCLAIMER"]),m=u()({is_visible:!0,paid_info:!0,paid_info_content:!0,admin_closed_comment:!0,reward_info:!0,annotation_action:!0,annotation_detail:!0,collapse_reason:!0,is_normal:!0,is_sticky:!0,collapsed_by:!0,suggest_edit:!0,comment_count:!0,thanks_count:!0,favlists_count:!0,can_comment:!0,content:!0,editable_content:!0,voteup_count:!0,reshipment_settings:!0,comment_permission:!0,created_time:!0,updated_time:!0,review_info:!0,relevant_info:!0,question:!0,excerpt:!0,attachment:!0,relationship:{is_authorized:!0,voting:!0,is_thanked:!0,is_author:!0,is_nothelp:!0},is_labeled:!0,author:{badge:[{topics:!0}],vip_info:!0},settings:{table_of_content:{enabled:!0}},reaction_instruction:!0,ip_info:!0});u()({"":[{is_normal:!0,is_sticky:!0,collapsed_by:!0,suggest_edit:!0,comment_count:!0,content:!0,editable_content:!0,voteup_count:!0,reshipment_settings:!0,comment_permission:!0,created_time:!0,updated_time:!0,question:!0,excerpt:!0,relationship:{is_authorized:!0,voting:!0,is_thanked:!0,is_author:!0,is_nothelp:!0},is_labeled:!0,author:{badge:[{topics:!0}]},settings:{table_of_content:{enabled:!0}},ip_info:!0}]});var v={up:1,down:-1,neutral:0};function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"answer";return function(n){return n({meta:{id:e},API:{types:f.CHECK_IF_CAN_CONVERT_TO_VESSAY,endpoint:"vessay/".concat(t,"s/").concat(e,"/status")},UPDATE:{success:function(n){return(0,r._)({},"".concat(t,"s"),(0,r._)({},e,(0,o._)({},n)))}}})}}function T(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=n.zVideoId,s=n.cardType,l=arguments.length>3?arguments[3]:void 0;return function(n,u){var d,p,h,_,m,g,T=u().entities,E=T.answers,C=void 0===E?{}:E,y=T.users,S=T.videoanswers,I=l||("videoanswers"===s?(void 0===S?{}:S)[e]:("koc"===s?null===(d=C[e])||void 0===d?void 0:d.answer:C[e])||{}),b=I.author||{},A=b.urlToken,Z="videoanswers"===s?"videoanswers":"answers";return h="up"===t?1:1===I.voting?-1:0,n({API:{types:f.UPDATE_VOTE,endpoint:c?"zvideos/".concat(c,"/voters"):"answers/".concat(e,"/voters"),method:"POST",body:(0,a.decamelizeKeys)(c?{voting:t}:{type:t})},meta:{beforeVoting:I.relationship.voting,id:e},UPDATE:{request:(m={},(0,r._)(m,Z,(0,r._)({},e,(0,i._)((0,o._)({},I),{voteupCount:I.voteupCount+h,relationship:(0,i._)((0,o._)({},I.relationship),{voting:v[t]})}))),(0,r._)(m,"users",(0,r._)({},A,{voteupCount:(null!==(_=null===(p=(void 0===y?{}:y)[A])||void 0===p?void 0:p.voteupCount)&&void 0!==_?_:0)+h})),m),failure:(g={},(0,r._)(g,Z,(0,r._)({},e,I)),(0,r._)(g,"users",(0,r._)({},A,b)),g),success:function(t){return c?{answers:(0,r._)({},e,{voteupCount:t.voteupCount,relationship:(0,i._)((0,o._)({},I.relationship),{voting:t.voting})})}:"koc"===s?{answers:(0,r._)({},e,{answer:{voteupCount:t.voteupCount,relationship:(0,i._)((0,o._)({},I.relationship),{voting:t.voting})}})}:(0,r._)({},Z,(0,r._)({},e,t))}}})}}function E(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.zVideoId,c=n.cardType,s=arguments.length>3?arguments[3]:void 0;return function(n,l){var u,d=l().entities,p=d.answers,h=void 0===p?{}:p,_=d.videoanswers,m="videoanswers"===c?"videoanswers":"answers",v=s||("videoanswers"===c?(void 0===_?{}:_)[e]:"koc"===c?null===(u=h[e])||void 0===u?void 0:u.answer:h[e]);return n({API:{types:f.UPDATE_THANK,endpoint:a?"zvideos/".concat(a,"/likers"):"answers/".concat(e,"/thankers"),method:t?"POST":"DELETE"},meta:{id:e},UPDATE:{request:(0,r._)({},m,(0,r._)({},e,(0,i._)((0,o._)({},v),{relationship:(0,i._)((0,o._)({},v.relationship),{isThanked:t}),thanksCount:v.thanksCount+(t?1:-1)}))),success:function(t){if(a){var n=t.isLiked,o=t.likedCount;return{answers:(0,r._)({},e,{relationship:{isThanked:n},thanksCount:o})}}var i=t.isThanked,s=t.thanksCount;return"koc"===c?{answers:(0,r._)({},e,{answer:{relationship:{isThanked:i},thanksCount:s}})}:(0,r._)({},m,(0,r._)({},e,{relationship:{isThanked:i},thanksCount:s}))},failure:(0,r._)({},m,(0,r._)({},e,v))}})}}function C(e,t){return function(n,o){var i=o().entities.answers[e];return n({API:{types:f.UPDATE_RESHIPMENTSETTINGS,endpoint:"answers/".concat(e),method:"PUT",body:(0,a.decamelizeKeys)({reshipmentSettings:t})},UPDATE:{request:{answers:(0,r._)({},e,{reshipmentSettings:t})},failure:{answers:(0,r._)({},e,i)}}})}}function y(e,t){return function(n,c){var s=c().entities.answers[e];return n({API:{types:f.UPDATE_ANSWER_REWARD,endpoint:"answers/".concat(e),method:"PUT",query:{include:m},body:(0,a.decamelizeKeys)({rewardSetting:{canReward:!!t,tagline:t}})},UPDATE:{success:function(t){return{answers:(0,r._)({},e,(0,i._)((0,o._)({},t),{rewardInfo:(0,o._)({},t.rewardInfo)}))}},failure:{answers:(0,r._)({},e,s)}}})}}function S(e,t){return function(n,o){var i=o().entities.answers[e];return n({API:{types:f.UPDATE_COMMENT_PERMISSION,endpoint:"answers/".concat(e),method:"PUT",body:(0,a.decamelizeKeys)({commentPermission:t})},UPDATE:{request:{answers:(0,r._)({},e,{commentPermission:t})},failure:{answers:(0,r._)({},e,i)}}})}}function I(e){return function(t,n){var o=n(),i=o.currentUser,a=o.entities,c=a.answers,s=a.questions,l=a.users,u=c[e],d=u.question.id,p=s[d],h=l[i];return t({API:{types:f.DELETE,endpoint:"answers/".concat(e),method:"DELETE"},UPDATE:{request:{answers:(0,r._)({},e,{isDelete:!0}),questions:(0,r._)({},d,{answerCount:p?p.answerCount-1:0,relationship:{myAnswer:{answerId:e,isDeleted:!0}}}),users:(0,r._)({},i,{answerCount:h.answerCount-1})},failure:{answers:(0,r._)({},e,u),questions:(0,r._)({},d,p),users:(0,r._)({},i,h)}}})}}function b(e,t){return function(n,o){var i=o(),a=i.currentUser,c=i.entities,l=c.answers,u=c.questions,d=c.users,p=l[t],h=u[e],_=d[a];return n({API:{types:f.RESTORE,endpoint:"/answers/".concat(t,"/actions/restore"),query:{include:m},method:"POST"},schema:s.l.ANSWER,id:e,UPDATE:{request:{answers:(0,r._)({},t,{isDelete:!1}),questions:(0,r._)({},e,{answerCount:h?h.answerCount+1:0,relationship:{myAnswer:{answerId:t,isDeleted:!1}}}),users:(0,r._)({},a,{answerCount:_.answerCount+1})},failure:{answers:(0,r._)({},t,p),questions:(0,r._)({},e,h),users:(0,r._)({},a,_)}}})}}function A(e){return{API:{endpoint:"v3/entity_word",query:{type:"answer",token:e},types:f.LOAD_ANSWER_SEARCH_ENTITY},meta:e}}function Z(e){return{API:{types:f.LOAD_ANSWER_RELATION_ENDORSEMENT,endpoint:"/answers/".concat(e,"/relationship"),query:{desktop:!0}},meta:{id:e},FAILSAFE:!0}}function w(e){return function(t,n){var r=n().answers.upvoters,i=((void 0===r?{}:r)[e]||{}).next;return t({id:e,API:(0,o._)({types:f.GET_UPVOTERS},i?{endpoint:i}:{endpoint:"answers/".concat(e,"/upvoters"),query:{offset:0,limit:h.VZ}}),schema:s.l.USER_ARRAY})}}function R(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.isQiangZhiSafe;return{API:{types:f.GET,endpoint:"answers/".concat(e),query:{include:t||m,ws_qiangzhisafe:r?"1":"0"}},schema:s.l.ANSWER}}(e,u()({reshipment_settings:!0,comment_permission:!0}))}function N(e){return function(t,n){var o,i=n(),a=i.currentUser,c=i.entities,s=c.answers[e]||{},l=s.question.questionType,u=c.users[a],d=u.isAdvertiser,p=u.isOrg,h="nobody"!==s.collapsedBy;return t({id:e,answer:s,collapsedBy:o=h?"nobody":d&&"commercial"===l?"advertiser":p?"org":"community",API:{types:f.COLLAPSE,endpoint:"answers/".concat(e,"/actions/collapse"),method:h?"DELETE":"POST"},UPDATE:{request:{answers:(0,r._)({},e,{collapsedBy:o,isSticky:!1})},failure:{answers:(0,r._)({},e,{collapsedBy:s.collapsedBy,isSticky:s.isSticky})}}})}}function k(e){return function(t,n){var i,a=n().entities,c=(a.answers[e]||{}).isSticky,s=Object.values(a.answers).find(function(e){return e.isSticky}),l={};return i=c?"已取消当前精选回答。":s?"已设置为精选，之前的精选回答将被替换。":"已设置为精选，刷新后回答将置顶",s&&(l[s.id]={isSticky:!1}),t({id:e,API:{types:f.STICK,endpoint:"answers/".concat(e,"/actions/stick"),method:c?"DELETE":"POST"},UPDATE:{request:{answers:(0,o._)((0,r._)({},e,{isSticky:!c}),l)},failure:{answers:(0,r._)({},e,{isSticky:c})}},NOTIFICATION:{success:i,failure:function(e){return e.message}}})}}function O(e){var t=e.questionId,n=e.urlToken,a=e.user,c=e.question;return function(e){var s=c.answerCount;"commercial"!==c.questionType&&s++;var l=c.followerCount+1;return{users:(0,r._)({},n,{answerCount:a.answerCount+1}),questions:(0,r._)({},t,(0,i._)((0,o._)({},l&&{followerCount:l}),{answerCount:s,relationship:{myAnswer:{answerId:e.id,isDeleted:!1},isFollowing:!0}})),drafts:(0,r._)({},"question_".concat(t),null)}}}function x(e,t){var n=t.questionId,r=t.urlToken,o=t.user,i=t.question;return{payload:e,type:f.ADD.success,schema:s.l.ANSWER,UPDATE:{success:O({questionId:n,urlToken:r,user:o,question:i})}}}function P(e,t){return function(n,r){var o=r(),i=o.currentUser,c=o.entities,l=c.users,u=c.questions,d=l[i]||{},p=u[e]||{};return n({API:{types:f.ADD,method:"POST",endpoint:t.publishAt?"questions/".concat(e,"/scheduled-answer"):"questions/".concat(e,"/answers"),query:{include:m},body:(0,a.decamelizeKeys)(t),fetchOptions:{zsAutoSignature:!1}},schema:s.l.ANSWER,id:e,question:p,UPDATE:{success:O({questionId:e,urlToken:i,user:d,question:p})}})}}function D(e,t){var n=e.id,o=e.data,i=t.answer;return{type:f.UPDATE.request,UPDATE:{update:{answers:(0,r._)({},n,o),drafts:(0,r._)({},"question_".concat(i.question.id),null)}}}}function L(e,t,n){var a=e.id,c=n.answer;return{payload:t,type:f.UPDATE.success,schema:s.l.ANSWER,UPDATE:{success:function(e){return{answers:(0,r._)({},a,(0,i._)((0,o._)({},e),{rewardInfo:(0,i._)((0,o._)({},e.rewardInfo),{rewardMemberCount:c.rewardInfo.rewardMemberCount,rewardTotalMoney:c.rewardInfo.rewardTotalMoney})})),drafts:(0,r._)({},"question_".concat(c.question.id),null)}}}}}function B(e,t){var n=e.id,o=t.answer,i=t.drafts;return{type:f.UPDATE.failure,UPDATE:{update:{answers:(0,r._)({},n,o),drafts:i}}}}function U(e,t){return function(n,c){var l=c().entities,u=l.answers,d=l.drafts,p=u[e];return n({API:{types:f.UPDATE,method:"PUT",endpoint:"answers/".concat(e),query:{include:m},body:(0,a.decamelizeKeys)(t),fetchOptions:{zsAutoSignature:!1}},schema:s.l.ANSWER,UPDATE:{request:{answers:(0,r._)({},e,t),drafts:(0,r._)({},"question_".concat(p.question.id),null)},success:function(t){return{answers:(0,r._)({},e,(0,i._)((0,o._)({},t),{rewardInfo:(0,i._)((0,o._)({},t.rewardInfo),{rewardMemberCount:p.rewardInfo.rewardMemberCount,rewardTotalMoney:p.rewardInfo.rewardTotalMoney})})),drafts:(0,r._)({},"question_".concat(p.question.id),null)}},failure:{answers:(0,r._)({},e,p),drafts:d}}})}}function M(e){return{id:e,API:{root:d.Z.fetchRoot.api,endpoint:"/kmqa/answers/".concat(e,"/paid_content"),query:{include:u()({goods_card:!0,btn_info:!0,za_info:!0,ab_param:!0,benefits_pics:!0})},types:f.LOAD_MARKET_ANSWER_PAID_CONTENT}}}function G(e){return{id:e,API:{types:f.GET_SETTINGS,endpoint:"/answers/".concat(e,"/settings")}}}function F(e,t,n){return{type:_.UPDATE_SETTINGS_DISCLAIMER,id:e,payload:{status:t,type:n}}}function z(e,t){var n=t.id;return e.entities.answers[n]}function H(e){return!!e&&!!e.relevantInfo&&["self_commercial","self_community"].includes(e.relevantInfo.relevantType)}function q(e){return!!e&&!!e.relevantInfo&&["brand_special","brand_best"].includes(e.relevantInfo.relevantType)}function V(e){return!!e&&!!e.relevantInfo&&["brand_answer","brand_special","brand_best"].includes(e.relevantInfo.relevantType)}function X(e,t){var n,r;return null===(n=e.answers)||void 0===n?void 0:null===(r=n.paidContent)||void 0===r?void 0:r[t]}t.ZP=(0,c.combineReducers)({voters:(0,h.Fd)(f.GET_VOTERS),upvoters:(0,h.Fd)(f.GET_UPVOTERS),copyrightApplicants:(0,h.Fd)(f.GET_COPYRIGHT_APPLICANTS),favlists:(0,h.Fd)(f.GET_FAVLISTS),newAnswer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===f.ADD.success?t.payload:e},entityWords:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===f.LOAD_ANSWER_SEARCH_ENTITY.success){var n=t.meta,a=t.payload,c=(void 0===a?{}:a).searchWords;return(0,i._)((0,o._)({},e),(0,r._)({},n,c))}return t.type===f.LOAD_ANSWER_SEARCH_ENTITY.failure&&window.Raven.captureException(t.err,{logger:"searchEntityError",extra:{id:t.meta,type:"answer"}}),e},paidContent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===f.LOAD_MARKET_ANSWER_PAID_CONTENT.request){var n=t.id;return(0,i._)((0,o._)({},e),(0,r._)({},n,{isRequesting:!0}))}if(t.type===f.LOAD_MARKET_ANSWER_PAID_CONTENT.success){var a=t.id;return(0,i._)((0,o._)({},e),(0,r._)({},a,{isRequesting:!1,result:t.payload}))}if(t.type===f.LOAD_MARKET_ANSWER_PAID_CONTENT.failure){var c=t.id;return(0,i._)((0,o._)({},e),(0,r._)({},c,{isRequesting:!1,error:!0}))}return e},settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===f.GET_SETTINGS.success){var n=t.id,a=t.payload;return(0,i._)((0,o._)({},e),(0,r._)({},n,a))}if(t.type===_.UPDATE_SETTINGS_DISCLAIMER){var c=t.id,s=t.payload,l=s.status,u=s.type;return(0,i._)((0,o._)({},e),(0,r._)({},c,(0,i._)((0,o._)({},e[c]),{disclaimerInfo:[{type:u,status:l}]})))}return e},relationEndorsement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.meta,c=t.payload;return n===f.LOAD_ANSWER_RELATION_ENDORSEMENT.success?(0,i._)((0,o._)({},e),(0,r._)({},a.id,c)):e},interests:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===f.LOAD_ANSWER_RECOMMEND_LIST.success?(0,i._)((0,o._)({},e),{data:r.data}):e}})},89250:function(e,t,n){"use strict";n.d(t,{Id:function(){return _},Pt:function(){return h},VA:function(){return d},cg:function(){return v},iv:function(){return m},k5:function(){return f}});var r=n(87320),o=n(55164),i=n(57477),a=n(93206),c=n(28953);n(84054);var s=n(39288),l=n(69906),u=n(67927),d=(0,s.FH)("article",["LIKE","VOTE","GET_VOTERS","GET_UPVOTERS","GET_COMMENT_PERMISSION","LOAD_ARTICLE_RELATION_ENDORSEMENT"]),p={up:1,down:-1,neutral:0};function h(e,t,n){return function(i,a){var c,s=a().entities.articles[e],l=("koc"===n?s.article:s)||{},h=l.voteupCount,f=l.votePosting,_=l.voting;if(c=-1===_&&"neutral"===t||0===_&&"down"===t?h:Math.max(h+p[t],0),!f)return i({id:e,API:{types:d.VOTE,endpoint:"articles/".concat(e,"/voters"),method:"POST",body:{voting:p[t]}},meta:{id:e,beforeVoting:_},UPDATE:{request:{articles:(0,r._)({},e,{voteupCount:c,voting:p[t],votePosting:!0})},success:function(t){return"koc"===n?{articles:(0,r._)({},e,{votePosting:!1,article:(0,o._)({},t)})}:{articles:(0,r._)({},e,(0,o._)({votePosting:!1},t))}},failure:{articles:(0,r._)({},e,(0,o._)({votePosting:!1},s))}},NOTIFICATION:{failure:u.XR}})}}function f(e){return function(t,n){var o=n().entities.articles[e],i=o.voteupCount,a=o.voting;return t({id:e,API:{types:d.LIKE,endpoint:"articles/".concat(e,"/likers"),method:1===a?"delete":"post"},UPDATE:{request:{articles:(0,r._)({},e,{voteupCount:Math.max(1===a?i-1:i+1,0),voting:1===a?0:1})},success:function(t){return{articles:(0,r._)({},e,t)}},failure:{articles:(0,r._)({},e,o)}},NOTIFICATION:{failure:u.XR}})}}function _(e){return function(t,n){var r=n().articles,i=((void 0===r?{}:r).upvoters[e]||{}).next;return t({id:e,API:(0,o._)({types:d.GET_UPVOTERS},i?{endpoint:i}:{endpoint:"articles/".concat(e,"/upvoters"),query:{offset:0,limit:l.VZ}}),schema:c.l.USER_ARRAY})}}function m(e){return{API:{types:d.LOAD_ARTICLE_RELATION_ENDORSEMENT,endpoint:"/articles/".concat(e,"/relationship"),query:{desktop:!0}},meta:{id:e},FAILSAFE:!0}}var v=function(e){return function(t,n){var o=n().entities.articles[e].isLiked;return t({API:{types:d.LIKE,endpoint:"/articles/".concat(e,"/like"),method:o?"DELETE":"POST"},meta:{id:e},UPDATE:{success:function(){return{articles:(0,r._)({},e,{isLiked:!o})}}}})}};t.ZP=(0,a.combineReducers)({voters:(0,l.Fd)(d.GET_VOTERS),upvoters:(0,l.Fd)(d.GET_UPVOTERS),relationEndorsement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.meta,c=t.payload;return n===d.LOAD_ARTICLE_RELATION_ENDORSEMENT.success?(0,i._)((0,o._)({},e),(0,r._)({},a.id,c)):e}})},58857:function(e,t,n){"use strict";n.d(t,{ZP:function(){return l},c1:function(){return s}});var r=n(87320),o=n(55164),i=n(57477),a=n(39288),c=(0,o._)({},(0,a.FH)("banner",["GET","GET_BRANDTRACK"]),(0,a.co)("banner",["CLOSE"]));function s(e){var t=e.type,n=e.id;return{API:{types:c.GET_BRANDTRACK,endpoint:"/brand/track",query:{content_type:t,url_token:n}},NOTIFICATION:!1,FAILSAFE:!0}}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===c.GET.success){var n=t.id,a=t.location,s=t.payload.banner;e=(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},e[n]),(0,r._)({},a,{banner:s,isDrained:!0}))))}if(t.type===c.CLOSE){var l=t.id,u=t.location;e=(0,i._)((0,o._)({},e),(0,r._)({},l,(0,i._)((0,o._)({},e[l]),(0,r._)({},u,null))))}return e}},79540:function(e,t,n){"use strict";n.d(t,{PQ:function(){return l},RD:function(){return c},ZP:function(){return d}});var r=n(87320),o=n(55164),i=n(57477),a=(0,n(39288).FH)("brand",["LOAD_CONTENT_PLUGIN"]).LOAD_CONTENT_PLUGIN;function c(e,t){var n={contentType:e,contentToken:t};return{FAILSAFE:!0,API:{types:Object.values(a),endpoint:"brand/content/plugin",query:n},meta:n}}var s=function(e){var t=e.contentType,n=e.contentToken;return"".concat(t,"_").concat(n)},l=function(e,t){var n,r=e.brand,o=t.contentType,i=t.contentToken;return null==r?void 0:null===(n=r.contentPlugin)||void 0===n?void 0:n[s({contentType:o,contentToken:i})]},u={contentPlugin:{}};function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;if(n===a.success){var l=e.contentPlugin,d=s(t.meta);return(0,i._)((0,o._)({},e),{contentPlugin:(0,i._)((0,o._)({},l),(0,r._)({},d,c))})}return e}},13737:function(e,t,n){"use strict";n.d(t,{PI:function(){return d},ZP:function(){return f},hU:function(){return u},il:function(){return l},o5:function(){return p}});var r=n(55164),o=n(57477),i=n(4785),a=n(68900),c=n(39288),s=(0,r._)({},(0,c.FH)("captcha",["GET","GET_V2","PUT_V2"]),(0,c.co)("captcha",["RESET_CAPTCHA_INFO","CAPTCHA_EXPIRES","RESET_CAPTCHA_V2"]));function l(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{API:{types:s.GET_V2,endpoint:"v3/oauth/captcha/v2",method:"GET",query:{type:e},fetchOptions:{zsAutoSignature:!1}},NOTIFICATION:t}}function u(){return{type:s.RESET_CAPTCHA_V2}}function d(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,o){var c,l=(null!==(c=(0,a.Uh)(o()))&&void 0!==c?c:{}).isAppleDevice;return n({API:(0,r._)({types:s.PUT_V2,endpoint:"v3/oauth/captcha/v2",method:"PUT",fetchOptions:{body:(0,i.Z)({ticket:e})}},l&&{query:{ticket:e}}),NOTIFICATION:t})}}function p(){return{type:s.RESET_CAPTCHA_INFO}}var h={captchaNeeded:!1,captchaValidated:!1};function f(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,n=arguments.length>1?arguments[1]:void 0,i=n.type,a=n.payload;return i===s.GET_V2.success?(0,o._)((0,r._)({},t),{v2:a,captchaNeeded:!!(null===(e=a.script)||void 0===e?void 0:e.length),captchaValidated:!1}):i===s.PUT_V2.success?(0,o._)((0,r._)({},t),{captchaNeeded:!a.success,captchaValidated:a.success}):i===s.RESET_CAPTCHA_INFO?(0,o._)((0,r._)({},h),{captchaValidated:t.captchaValidated,v2:t.v2}):i===s.RESET_CAPTCHA_V2?(0,o._)((0,r._)({},t),{captchaValidated:!1}):t}},73086:function(e,t,n){"use strict";n.d(t,{Ok:function(){return A},vn:function(){return b},JB:function(){return C},ZP:function(){return q},Rn:function(){return U},$Z:function(){return B},sT:function(){return x},ii:function(){return O},tw:function(){return k},fb:function(){return R},wh:function(){return M},N1:function(){return y},$x:function(){return w},Vq:function(){return P},RW:function(){return D},bG:function(){return N},Hf:function(){return Z},BI:function(){return L}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(74135),s=n(57266),l=n.n(s),u=n(95548),d=n.n(u),p=n(60683),h=n(68455),f=n(80714),_=n(39288),m=n(33068),v=n(64813),g=n(25130),T=(0,_.co)("chat",["UPDATE_INBOX"]),E=function(e){var t=e.senderId,n=e.isRead;return function(e,o){var i=o(),a=i.entities,c=i.chat,s=a.chats[t],l=[],u=c.inbox.strangers||{};if(u.result&&(l=u.result),!s)return e(function(e){return e((0,m.pU)(!0)).then(function(t){return t.payload.strangerMessage.switch?e((0,v.v)(!0)):Promise.resolve()})});var d=s.unreadCount,p=void 0===d?0:d;return e(n?l.includes(t)?(0,g.pP)(!1):(0,g.cs)(-1*p):l.includes(t)?(0,g.pP)(!0):(0,g.cs)(1)),e({type:T.UPDATE_INBOX,UPDATE:{update:{chats:(0,r._)({},t,{unreadCount:n?0:p+1})}}})}},C=(0,o._)({},(0,_.FH)("chat",["GET_HISTORY_MESSAGES","GET_LATEST_MESSAGES","SEND_MESSAGE","SEND_ECOM_MESSAGE","SET_MESSAGE_READ","DELETE_MESSAGE","DELETE_MESSAGE_THREAD","GET_ECOM_EVENT","GET_ECOM_COUPON","GET_ECOM_PROFILE","SEND_ECOM_SUBMIT"]),(0,_.co)("chat",["ADD_NEW_MESSAGE","INPUT_MESSAGE","ADD_TEMP_IMAGE_MESSAGE","ADD_TEMP_ECOM_CARD_MESSAGE","SET_IMAGE_SEND_FAILURE","DELETE_LOCAL_MESSAGE","RESET_HISTORY_MESSAGES"]));function y(e){var t=e.senderId,n=e.inputValue;return{type:C.INPUT_MESSAGE,meta:{inputValue:n,senderId:t}}}function S(e){return!!e&&new RegExp(/<a href="https:\/\/www.zhihu.com\/inbox\/+[\s\S]*?is_ecom=1/).test(e)}function I(e){var t=e.contentType,n=e.receiverId,r=e.data,a=e.tempMessageId||d()("tempMessageId_"),c=null;return t===p.wF.text&&(c=(0,h.Wf)(r.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"))),{receiverId:n,data:(0,i._)((0,o._)({userType:"receiver",type:"message",createdTime:Date.now(),contentType:t,id:a},r),{richText:c})}}function b(e,t,n,r,o){var i=I({contentType:p.wF.image,receiverId:e,data:{id:n,image:{height:r,width:o,url:t}},tempMessageId:n});return{type:C.ADD_TEMP_IMAGE_MESSAGE,meta:i}}function A(e,t,n){var r=I({contentType:p.wF.ecomcard,receiverId:e,data:{id:t,ecomCard:{cardType:n}},tempMessageId:t});return{type:C.ADD_TEMP_ECOM_CARD_MESSAGE,meta:r}}function Z(e){var t=e.receiverId,n=e.tempMessageId,r=e.file;return{type:C.SET_IMAGE_SEND_FAILURE,meta:{receiverId:t,tempMessageId:n,file:r}}}function w(e){var t=e.senderId;return function(e){return e({type:C.RESET_HISTORY_MESSAGES,meta:{senderId:t}})}}function R(e){var t=e.senderId,n=e.clientScene;return function(e,r){var i=(r().chat.chats[t]||{}).nextApiUrl,a=(void 0===i?"":i).split("?")[1],s=a?{endpoint:"/chat?".concat(a)}:{endpoint:"/chat",query:(0,c.decamelizeKeys)(l()({senderId:t,clientScene:n}))};return e({API:(0,o._)({types:C.GET_HISTORY_MESSAGES},s),meta:{senderId:t}})}}function N(e){var t=e.contentType,n=e.receiverId,r=e.data,i=e.tempMessageId,a=e.sourceType,c=e.sourceId,s=e.replySource,l=I({contentType:t,receiverId:n,data:r,tempMessageId:i});return{API:{types:C.SEND_MESSAGE,endpoint:"/chat",method:"POST",body:(0,o._)({content_type:p.YX[t],receiver_id:n},a&&{source_type:a},c&&{source_id:c},s&&{reply_source:s},r)},meta:l}}function k(e){return{API:{types:C.GET_ECOM_PROFILE,root:f.Z.fetchRoot.api,endpoint:"api/v4/crm/chat/plugin/profile/".concat(e),method:"GET"}}}function O(e){var t=e.templateType,n=e.senderId;return{API:{types:C.GET_ECOM_EVENT,root:f.Z.fetchRoot.api,endpoint:"api/v4/crm/chat/plugin/clue_activities?template_type=".concat(void 0===t?2:t),method:"GET"},meta:{senderId:n}}}function x(){return{API:{types:C.GET_ECOM_COUPON,root:f.Z.fetchRoot.api,endpoint:"api/v4/crm/chat/plugin/coupons",method:"GET"}}}function P(e){var t=e.contentType,n=e.id,r=e.token,o=e.data,i=e.tempMessageId,a=o.receiverId,c=o.cardType,s=I({contentType:t,receiverId:a,data:o,tempMessageId:i});return{API:{types:C.SEND_ECOM_MESSAGE,root:f.Z.fetchRoot.api,endpoint:1===c?"api/v4/crm/chat/plugin/clue_activities/".concat(r,"/action/send"):"api/v4/crm/chat/plugin/coupons/".concat(n,"/action/send"),method:"POST",body:{receiver_id:a}},meta:s}}function D(e){var t=e.token,n=e.data.phone;return{API:{types:C.SEND_ECOM_SUBMIT,root:f.Z.fetchRoot.api,endpoint:"api/v4/crm/chat/plugin/clue_activities/".concat(t,"/action/submit"),method:"POST",body:{phone_no:n}}}}function L(e){return function(t){t(E({senderId:e,isRead:!0})),t({API:{types:C.SET_MESSAGE_READ,endpoint:"/messages/read/".concat(e),method:"PUT"}})}}function B(e,t){return{API:{types:C.DELETE_MESSAGE,endpoint:"/messages/".concat(e),method:"DELETE"},meta:{messageId:e,senderId:t}}}function U(e,t){return{type:C.DELETE_LOCAL_MESSAGE,meta:{messageId:e,senderId:t}}}function M(e,t){var n=e.content,r=void 0===n?{}:n,i=e.meta,a=void 0===i?{}:i,s=a.sender_id,l=a.content_type,u=a.created_at,d=a.id,f=e.extra,_=e.extra,m=void 0===_?{}:_,v=m.message_type,g=m.extra_content,T=m.associate_id,y=m.unfriendly,I={userType:t!==s?"sender":"receiver",type:v||"message",createdTime:u,contentType:l,id:d,status:p.Gs.success,extraInfo:(0,c.camelizeKeys)(void 0===f?{}:f),extraContent:g,unfriendly:!!Number(y),associateId:T,isEcomWelcomeCard:!1};return I[I.contentType]=(0,c.camelizeKeys)(r[I.contentType]),l===p.wF.text&&(I.richText=(0,h.Wf)(I.text),I.isEcomWelcomeCard=S(I.richText)),l===p.wF.ecomcard&&(I.ecomCard=(0,o._)({},r.ecom_card)),l===p.wF.csevaluationcard&&(I.csevaluationCard=r.csevaluation_card),function(e){e(E({senderId:s})),e({type:C.ADD_NEW_MESSAGE,meta:{messageInfo:I,senderId:s}})}}function G(e){var t=p.HG[e.contentType],n="text"===t?(0,h.Wf)(e.text||e.content):null;return(0,i._)((0,o._)({},e),{contentType:t,createdTime:1e3*e.createdTime,status:p.Gs.success,richText:n,isEcomWelcomeCard:"text"===t&&S(e.text||e.content)})}var F=function(e){return(null==e?void 0:e.messages)||[]},z=function(e){var t=(e||{}).lastTimeStamp;return{lastTimeStamp:void 0===t?null:t}};function H(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(0,a._)(e),c=n.file,s=e.length-1;s>=0;s--)if(e[s].id===t){r[s]=(0,i._)((0,o._)({},r[s],c&&{file:c}),{status:p.Gs.failure});break}return r}function q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===C.GET_HISTORY_MESSAGES.request){var n=t.meta.senderId;return(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},e[n]),{isLoading:!0})))}if(t.type===C.GET_HISTORY_MESSAGES.success||t.type===C.GET_LATEST_MESSAGES.success){var c=t.payload,s=c.warning,l=c.paging,u=c.data,d=l.isEnd,h=l.next,f=u.receiver,_=u.sender,m=u.messages,v=_.id,g=e[v],T=(null==g?void 0:g.sender)?F(g):[],E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!(null==e?void 0:e.length))return{formattedMessages:[],lastTimeStamp:t};var n=t||1e3*e[0].createdTime;return{formattedMessages:e.map(function(t,r){var a=(0,i._)((0,o._)({},t),{showTime:!1}),c=1e3*a.createdTime;if(Math.abs(n-c)>p.X||n===c)a.showTime=!0;else{var s=e[r+1];s&&Math.abs(c-1e3*s.createdTime)>p.X&&(a.showTime=!0)}return n=c,G(a)}).reverse(),lastTimeStamp:n}}(m,z(g).lastTimeStamp),y=E.formattedMessages,S=E.lastTimeStamp,I=t.type===C.GET_LATEST_MESSAGES.success?(0,a._)(y):(0,a._)(y).concat((0,a._)(T));return(0,i._)((0,o._)({},e),(0,r._)({},v,{receiver:f,sender:_,messages:I,isLoading:!1,isEnd:d,nextApiUrl:h,lastTimeStamp:S,inputValue:e[v].inputValue,warning:void 0===s?{}:s}))}if(t.type===C.RESET_HISTORY_MESSAGES){var b=t.meta.senderId;return(0,i._)((0,o._)({},e),(0,r._)({},b,void 0))}if(t.type===C.ADD_NEW_MESSAGE){var A,Z,w=t.meta,R=w.senderId,N=w.messageInfo,k=e[R],O=F(k),x=z(k).lastTimeStamp,P=(A=(0,o._)({},N),Z=x,A.createdTime-Z>=p.X?(A.showTime=!0,Z=A.createdTime):A.showTime=!1,{message:A,lastTimeStamp:Z}),D=P.message,L=P.lastTimeStamp;return O.length&&O[O.length-1].id===D.id?(0,o._)({},e):(0,i._)((0,o._)({},e),(0,r._)({},R,(0,i._)((0,o._)({},e[R]),{messages:(0,a._)(O).concat([D]),lastTimeStamp:L})))}if(t.type===C.INPUT_MESSAGE){var B=t.meta,U=B.senderId,M=B.inputValue;return(0,i._)((0,o._)({},e),(0,r._)({},U,(0,i._)((0,o._)({},e[U]),{inputValue:M})))}if(t.type===C.ADD_TEMP_IMAGE_MESSAGE||t.type===C.ADD_TEMP_ECOM_CARD_MESSAGE){var q=t.meta.receiverId;return(0,i._)((0,o._)({},e),(0,r._)({},q,(0,i._)((0,o._)({},e[q]),{messages:(0,a._)(e[q].messages).concat([(0,i._)((0,o._)({},t.meta.data),{status:p.Gs.loading})])})))}if(t.type===C.SET_IMAGE_SEND_FAILURE){var V=t.meta,X=V.receiverId,W=V.tempMessageId,K=V.file,j=H(e[X].messages,W,{file:K});return(0,i._)((0,o._)({},e),(0,r._)({},X,(0,i._)((0,o._)({},e[X]),{messages:j})))}if(t.type===C.SEND_MESSAGE.request||t.type===C.SEND_ECOM_MESSAGE.request){var Y=t.meta,Q=Y.receiverId,J=Y.data.contentType;if(J===p.wF.image){var $=t.meta.data,ee=$.image.url,et=$.id,en=function(e,t,n){for(var r=(0,a._)(e),o=e.length-1;o>=0;o--)if(e[o].id===t){r[o].image.url=n;break}return r}(e[Q].messages,et,ee);return(0,i._)((0,o._)({},e),(0,r._)({},Q,(0,i._)((0,o._)({},e[Q]),{messages:en})))}if(J===p.wF.ecomcard&&1===t.meta.data.cardType){var er=e[Q].messages;return(0,i._)((0,o._)({},e),(0,r._)({},Q,(0,i._)((0,o._)({},e[Q]),{messages:er})))}return(0,i._)((0,o._)({},e),(0,r._)({},Q,(0,i._)((0,o._)({},e[Q],J===p.wF.text&&{inputValue:""}),{messages:(0,a._)(e[Q].messages).concat([(0,i._)((0,o._)({},t.meta.data),{status:p.Gs.loading})])})))}if(t.type===C.SEND_MESSAGE.success||t.type===C.SEND_ECOM_MESSAGE.success){var eo=t.payload.info,ei=t.meta,ea=ei.receiverId,ec=ei.data,es=ec.id,el=ec.contentType,eu=e[ea],ed=z(eu).lastTimeStamp,ep=function(e,t,n,r){for(var c=(0,a._)(e),s=(0,o._)({},n),l=r,u=e.length-1;u>=0;u--)if(e[u].id===t){1e3*s.createdTime-l>=p.X?(s.showTime=!0,l=1e3*s.createdTime):s.showTime=!1,c[u]=(0,i._)((0,o._)({},G(s)),{tempMessageId:t});break}return{realMessageList:c,lastTimeStamp:l}}(eu.messages,es,eo,ed),eh=ep.realMessageList,ef=ep.lastTimeStamp;return(0,i._)((0,o._)({},e),(0,r._)({},ea,(0,i._)((0,o._)({},e[ea],el===p.wF.text&&{inputValue:""}),{messages:eh,lastTimeStamp:ef})))}if(t.type===C.SEND_MESSAGE.failure||t.type===C.SEND_ECOM_MESSAGE.failure){var e_=t.meta,em=e_.receiverId,ev=e_.data.id,eg=H(e[em].messages,ev);return(0,i._)((0,o._)({},e),(0,r._)({},em,(0,i._)((0,o._)({},e[em]),{messages:eg})))}if(t.type===C.DELETE_MESSAGE.success||t.type===C.DELETE_LOCAL_MESSAGE){var eT=t.meta,eE=eT.messageId,eC=eT.senderId,ey=e[eC].messages.filter(function(e){return e.id!==eE});return(0,i._)((0,o._)({},e),(0,r._)({},eC,(0,i._)((0,o._)({},e[eC]),{messages:ey})))}if(t.type===C.GET_ECOM_PROFILE.success){var eS=t.payload.receiver;return(0,i._)((0,o._)({},e),{isEcomMerchant:!!eS.isMerchant})}return e}},25130:function(e,t,n){"use strict";n.d(t,{ZP:function(){return p},cs:function(){return u},pP:function(){return d}});var r=n(55164),o=n(57477),i=n(39288),a=n(33068),c=n(73135),s={newCount:0,strangerMessageSwitch:!1,strangerMessageUnread:!1,friendCount:0},l=(0,i.co)("chat",["UPDATE_TOTAL_UNREAD_COUNT","CHANGE_STRANGER_MESSAGE_UNREAD_STATUS"]);function u(e){return{type:l.UPDATE_TOTAL_UNREAD_COUNT,meta:{count:e}}}function d(e){return{type:l.CHANGE_STRANGER_MESSAGE_UNREAD_STATUS,meta:{status:e}}}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.Hp.GET_RECENTS.success:var n=t.payload,i=n.newCount,u=n.strangerMessage,d=u.switch,p=u.unread;return(0,o._)((0,r._)({},e),{newCount:i,strangerMessageSwitch:d,strangerMessageUnread:p});case c.Hp.GET_FRIENDS.success:return(0,o._)((0,r._)({},e),{friendCount:t.totals});case l.UPDATE_TOTAL_UNREAD_COUNT:var h=e.newCount,f=t.meta.count,_=h+(void 0===f?0:f);return(0,o._)((0,r._)({},e),{newCount:_>0?_:0});case l.CHANGE_STRANGER_MESSAGE_UNREAD_STATUS:var m=t.meta.status;return(0,o._)((0,r._)({},e),{strangerMessageUnread:m});default:return e}}},86871:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(54463),a=n.n(i),c={isFetching:!1,isDrained:!1,isPrevDrained:!1,result:[],next:null,key:null};t.Z=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},i=e.request,s=e.success,l=e.failure;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,u=arguments.length>1?arguments[1]:void 0;switch(u.type){case t:return c;case i:return(0,o._)((0,r._)({},e),{isFetching:!0});case s:var d=u.key,p=u.result,h=u.next,f=u.isDrained,_=u.isPrevDrained,m=d!==e.key;return(0,o._)((0,r._)({},e),{result:m?p:a()(e.result,p),key:d,next:h,isDrained:f||p.length<10,isPrevDrained:_,isFetching:!1});case l:return(0,o._)((0,r._)({},e),{isFetching:!1});default:return n(e,u)}}}},73135:function(e,t,n){"use strict";n.d(t,{Hp:function(){return i}}),n(28953);var r=n(39288),o=n(86871),i=(0,r.FH)("chat",["GET_FRIENDS"]);t.ZP=(0,o.Z)(i.GET_FRIENDS)},33068:function(e,t,n){"use strict";n.d(t,{Hp:function(){return u},pU:function(){return d}});var r=n(55164),o=n(57477),i=n(49899),a=n(56669),c=n(39288),s=n(86871),l=n(73086),u=(0,c.FH)("chat",["GET_RECENTS"]),d=function(e){return function(t,n){var r=n().chat.inbox.recents.next;return t({API:{types:u.GET_RECENTS,endpoint:e||!r?"/inbox":r},schema:a.e})}};t.ZP=(0,s.Z)(u.GET_RECENTS,null,function(e,t){if(t.type===l.JB.SEND_MESSAGE.success){var n=e.result,a=t.meta.receiverId;return n.indexOf(a)>=0?e:(0,o._)((0,r._)({},e),{result:[a].concat((0,i._)(n))})}if(t.type===l.JB.DELETE_MESSAGE_THREAD.success){var c=t.meta.chatId;return(0,o._)((0,r._)({},e),{result:e.result.filter(function(e){return e!==c})})}return e})},64813:function(e,t,n){"use strict";n.d(t,{v:function(){return u}});var r=n(55164),o=n(57477),i=n(56669),a=n(39288),c=n(86871),s=n(73086),l=(0,a.FH)("chat",["GET_STRANGERS"]),u=function(e){return function(t,n){var r=n().chat.inbox.strangers.next;return t({API:{types:l.GET_STRANGERS,endpoint:e||!r?"/stranger_inbox":r},schema:i.e})}};t.Z=(0,c.Z)(l.GET_STRANGERS,null,function(e,t){if(t.type===s.JB.SEND_MESSAGE.success){var n=e.result,i=t.meta.receiverId;return 0>n.indexOf(i)?e:(0,o._)((0,r._)({},e),{result:n.filter(function(e){return e!==i})})}if(t.type===s.JB.DELETE_MESSAGE_THREAD.success){var a=t.meta.chatId;return(0,o._)((0,r._)({},e),{result:e.result.filter(function(e){return e!==a})})}return e})},56669:function(e,t,n){"use strict";n.d(t,{e:function(){return a}});var r=n(84),o=n(28953),i=new r.fK.Entity("chats",{participant:o.l.USER},{idAttribute:function(e){return e.participant.id}}),a=new r.fK.Array(i)},82335:function(e,t,n){"use strict";n.d(t,{e:function(){return h},u:function(){return p}});var r=n(87320),o=n(55164),i=n(57477),a=n(74135),c=n(4785),s=n(39288),l=n(66263),u=(0,o._)({},(0,s.FH)("collaboration",["ADD_ANNOTATION","CANCEL_ANNOTATION"])),d=function(e){return e===l.R8?"answers":e===l.oP?"pins":e===l.zs?"articles":null},p=function(e,t,n,o){return{API:{types:u.ADD_ANNOTATION,endpoint:"v3/collaboration/annotation",method:"POST",body:(0,c.z)((0,a.decamelizeKeys)({objectType:e,urlToken:t,reason:n,detail:o}))},UPDATE:{success:function(n){var o=d(e);return o?(0,r._)({},o,(0,r._)({},t,n)):null}}}},h=function(e,t,n,s){return{API:{types:u.CANCEL_ANNOTATION,endpoint:"v3/collaboration/annotation_cancel",method:"POST",body:(0,c.z)((0,a.decamelizeKeys)({objectType:e,urlToken:t,reason:n,detail:s}))},UPDATE:{success:function(n){var a=d(e);return a?(0,r._)({},a,(0,r._)({},t,(0,i._)((0,o._)({},n),{annotationDetail:null}))):null}}}}},25809:function(e,t,n){"use strict";n.d(t,{Hp:function(){return p},ZP:function(){return m},Nn:function(){return v}});var r=n(55164),o=n(57477),i=n(49899),a=n(93206),c=n(35528),s=n(84),l=n(28953),u=n(39288),d=n(74135);new s.fK.Array(new s.fK.Entity("favlistFeedsByIds",{content:new s.fK.Union({article:l.l.ARTICLE,answer:l.l.ANSWER,pin:l.l.PIN,zvideo:l.l.ZVIDEO,eduCourse:l.l.EDU_COURSE,eduSection:l.l.EDU_SECTION},function(e){return(0,d.camelize)(e.type)})},{idAttribute:function(e){var t=e.content,n=t.type,r=t.id;return"".concat(n,"_").concat(r)}}));var p=(0,r._)({},(0,u.FH)("collections",["ADD","DELETE","UPDATE","GET_DETAIL","GET_FEEDS","DELETE_FEED_ITEM","CANCEL_DELETE_FEED_ITEM"])),h=n(98104),f={data:[],paging:{},isLoading:!1},_=(0,h.V6)(p.GET_FEEDS,{additionalCaseTypes:[p.DELETE_FEED_ITEM.success,p.CANCEL_DELETE_FEED_ITEM.success],additionalCase:function(e,t){return t.type===p.DELETE_FEED_ITEM.success?(0,o._)((0,r._)({},e),{deletedItems:(0,i._)(e.deletedItems||[]).concat([t.deletedItemId])}):t.type===p.CANCEL_DELETE_FEED_ITEM.success?(0,o._)((0,r._)({},e),{deletedItems:e.deletedItems.filter(function(e){return e!==t.deletedItemId})}):e}}),m=(0,a.combineReducers)({hot:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;if(t.type===c.xb.GET_HOT_FAVLISTS.request)return(0,o._)((0,r._)({},e),{isLoading:!0});if(t.type===c.xb.GET_HOT_FAVLISTS.success){var n=t.payload,a=n.data,s=n.paging;return{data:(0,i._)(e.data).concat((0,i._)(a.map(function(e){return e.id}))),paging:s,isLoading:!1}}return t.type===c.xb.GET_HOT_FAVLISTS.failure?(0,o._)((0,r._)({},e),{paging:(0,o._)((0,r._)({},e.paging),{isEnd:!0}),isLoading:!1}):e},collectionFeeds:_});function v(e,t){return t.type===p.ADD.success?(0,o._)((0,r._)({},e),{totals:e.totals+1,ids:[t.result].concat((0,i._)(e.ids))}):t.type===p.DELETE.success?(0,o._)((0,r._)({},e),{totals:e.totals-1,ids:e.ids.filter(function(e){return e!==t.id})}):e}},10886:function(e,t,n){"use strict";n.d(t,{As:function(){return p},PG:function(){return d},Pu:function(){return l},bK:function(){return h},ly:function(){return u}});var r=n(87320),o=n(55164),i=n(93206),a=n(28953),c=n(39288),s=n(69906),l=(0,c.FH)("column",["GET","UPDATE_FOLLOW","GET_COLUMN_FOLLOWERS","SUBMIT_REQUEST"]);function u(e){return{API:{types:l.GET,endpoint:"columns/".concat(e),query:{include:"title,intro,description,image_url,articles_count,followers,is_following,last_article.created"}},urlToken:e,schema:a.l.COLUMN}}function d(e){var t=e.title,n=e.intro;return{API:{types:l.SUBMIT_REQUEST,endpoint:"/columns/request",method:"POST",body:{title:t,intro:n}},NOTIFICATION:!1}}function p(e){return function(t,n){var o=n(),i=o.entities,a=i.columns,c=i.users,s=o.currentUser,u=a[e],d=c[s],p=u.isFollowing,h=u.followers,f=p?-1:1;return t({urlToken:s,columnId:e,expect:!p,API:{types:l.UPDATE_FOLLOW,endpoint:"columns/".concat(e,"/followers"),method:p?"DELETE":"POST"},UPDATE:{request:{columns:(0,r._)({},e,{isFollowing:!p,followers:h+f}),users:(0,r._)({},s,{followingColumnsCount:d.followingColumnsCount+f})},failure:{columns:(0,r._)({},e,u),users:(0,r._)({},s,c)}}})}}function h(e){return function(t,n){var r=(n().columns.voters[e]||{}).next;return t({id:e,API:(0,o._)({types:l.GET_COLUMN_FOLLOWERS},r?{endpoint:r}:{endpoint:"columns/".concat(e,"/followers"),query:{include:"data[*].follower_count,gender,is_followed,is_following",offset:0,limit:s.VZ}}),schema:a.l.USER_ARRAY})}}t.ZP=(0,i.combineReducers)({voters:(0,s.Fd)(l.GET_COLUMN_FOLLOWERS)})},803:function(e,t,n){"use strict";n.d(t,{I6:function(){return l},ZP:function(){return d},n5:function(){return u}});var r=n(87320),o=n(55164),i=n(57477),a=n(39288),c=n(16563),s=(0,a.FH)("commentPermission",["LOAD_TYPE_RELATED_COMMENT_PERMISSIONS","LOAD_CONTENT_COMMENT_PERMISSION"]);function l(e){return{API:{types:s.LOAD_TYPE_RELATED_COMMENT_PERMISSIONS,endpoint:"/comment_v5/".concat(e,"s/permission")},meta:{type:e}}}function u(e,t){return{API:{types:s.LOAD_CONTENT_COMMENT_PERMISSION,endpoint:"/comment_v5/".concat(e,"s/").concat(t,"/permission")},meta:{type:e,id:t}}}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.payload,a=t.meta;switch(t.type){case s.LOAD_TYPE_RELATED_COMMENT_PERMISSIONS.success:var l=a.type;return(0,i._)((0,o._)({},e),(0,r._)({},l,(0,i._)((0,o._)({},e[l]),{default:n.data})));case s.LOAD_CONTENT_COMMENT_PERMISSION.success:var u=a.type,d=a.id;return(0,i._)((0,o._)({},e),(0,r._)({},u,(0,i._)((0,o._)({},e[u]),(0,r._)({},d,(0,c.Qz)(n.data,u)))))}return e}},11345:function(e,t,n){"use strict";n.d(t,{Z:function(){return l},z:function(){return s}});var r=n(55164),o=n(57477),i=n(80714),a=(0,n(39288).FH)("cities",["LOAD_CITIES"]),c={cityData:[]};function s(){return{API:{method:"GET",types:a.LOAD_CITIES,endpoint:"content/publish/content_source/config",root:i.Z.fetchRoot.api}}}function l(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,i=arguments.length>1?arguments[1]:void 0;return i.type===a.LOAD_CITIES.success?(0,o._)((0,r._)({},n),{cityData:null===(e=i.payload)||void 0===e?void 0:null===(t=e.data)||void 0===t?void 0:t.regions}):n}},19958:function(e,t,n){"use strict";n.d(t,{NC:function(){return p},Uq:function(){return h},ZP:function(){return _}});var r=n(87320),o=n(55164),i=n(57477),a=n(74135),c=n(36762),s=n.n(c),l=n(39288);n(58909);var u=n(45347),d=(0,o._)({},(0,l.FH)("creator",["GET_CREATOR_CAPTCHA","GET_CREATOR_SMS_SUPPORTED_COUNTRIES","VALIDATE_CREATOR_CAPTCHA","POST_CREATOR_APPLY_INFO","VALIDATE_CREATOR_CAPTCHA","LOAD_CREATOR_SMS_SUPPORTED_COUNTRIES","GET_TOOLS_QUESTION_INVITED_COUNT","GET_TOOLS_QUESTION_DOMAIN","GET_TOOLS_HOT_QUESTION_LIST","GET_TOOLS_MCN_QUESTION_LIST","SUBSCRIBE_TOOLS_HOTSPOT_DOMAIN_LIST","UPDATE_TOOLS_HOTSPOT_DOMAIN","GET_PROFIT_REWARD_COMMUNITY_LIST","GET_PROFIT_REWARD_PROMOTION_TOTAL","GET_PROFIT_REWARD_PROMOTION_LIST","LOAD_PROMOTION_PROTOCOL","GET_CONTENT_RIGHTS_NOTIFICATION","READ_CONTENT_RIGHTS_NOTIFICATION","GET_REALNAME_STATUS","GET_MCN_DAILY_STATUS","GET_MCN_ORDER_LIST","GET_MCN_OVERDUE_GOODS_LIST","GET_MCN_ORDER_DETAIL","GET_MCN_STATISTICS","GET_MCN_CURRENT_MONTH_STATS","GET_MCN_OVERVIEW_DATA","GET_MCN_BALANCE_DATA","GET_MCN_BALANCE_LIST","LOAD_TABLE","GET_CREATOR_TASKS","DO_CREATOR_TASK","LOAD_HOT_QUESTION_LIST","LOAD_CREATOR_STATISTICS","GET_RECOMMEND_QUESTION_LIST"]),(0,l.co)("creator",["READ_CONTENT_RIGHTS_NOTIFICATION_LOCALLY","CLEAN_MCN_ORDER_LIST","UPDATE_EDIT_MODAL_STATUS"]));function p(e,t){return{API:{types:d.GET_CONTENT_RIGHTS_NOTIFICATION,method:"GET",endpoint:"/creator/notification/content/".concat(e,"s/").concat(t)},UPDATE:{success:function(n){return(0,r._)({},"".concat(e,"s"),(0,r._)({},t,{creatorRightsNotification:n}))}}}}function h(e,t,n){return function(o,i){var a=i().entities["".concat(e,"s")][t].creatorRightsNotification,c=(0,r._)({},"".concat(e,"s"),(0,r._)({},t,{creatorRightsNotification:s()(a,function(){return 0})}));return o("current"===n?{type:d.READ_CONTENT_RIGHTS_NOTIFICATION_LOCALLY,UPDATE:{update:c}}:{API:{types:d.READ_CONTENT_RIGHTS_NOTIFICATION,method:"next"===n?"PATCH":"DELETE",endpoint:"/creator/notification/content/".concat(e,"s/").concat(t)},UPDATE:{request:c}})}}var f={tools:{question:{invitationCount:{questionFolloweeCount:0,questionTotalCount:0}},recommend:{recommendTimes:{}}},explore:{},levelUpperLimit:10,mcn:{},mcnManage:{},tasks:{},announcement:{},creatorsRecommendInfo:{}};function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0,n=t.meta,c=void 0===n?{}:n,s=t.payload;switch(t.type){case d.GET_TOOLS_QUESTION_INVITED_COUNT.success:return(0,i._)((0,o._)({},e),{tools:(0,i._)((0,o._)({},e.tools),{question:(0,i._)((0,o._)({},e.tools.question),{invitationCount:t.payload.data,isDrained:!0})})});case d.CLEAN_MCN_ORDER_LIST:return(0,i._)((0,o._)({},e),{mcn:(0,i._)((0,o._)({},e.mcn),{orderSource:void 0,orders:void 0})});case d.GET_MCN_ORDER_LIST.success:var l=t.payload,p=l.data,h=l.paging.totals,_=t.source,m=t.limit,v=t.offset,g=e.mcn.orderSource===_?e.mcn.orders:Array.from({length:h});return(0,i._)((0,o._)({},e),{mcn:(0,i._)((0,o._)({},e.mcn),{orderSource:_,orders:g.map(function(e,t){return t>=v&&t<v+m?p[t-v]:e})})});case d.GET_MCN_OVERDUE_GOODS_LIST.success:var T=t.payload,E=T.data,C=T.paging.totals,y=t.source,S=t.limit,I=t.offset,b=e.mcn.goodsListSource===y?e.mcn.goodsList:Array.from({length:C});return(0,i._)((0,o._)({},e),{mcn:(0,i._)((0,o._)({},e.mcn),{goodsListSource:y,goodsList:b.map(function(e,t){return t>=I&&t<I+S?E[t-I]:e})})});case d.GET_MCN_ORDER_DETAIL.success:var A=t.payload,Z=t.id;return(0,i._)((0,o._)({},e),{mcn:(0,i._)((0,o._)({},e.mcn),{orders:e.mcn.orders.map(function(e){return(null==e?void 0:e.id)&&String(e.id)===Z?(0,i._)((0,o._)({},e,A),{id:e.id,imgURL:e.imgURL}):e})})});case d.LOAD_TABLE.success:var w,R=c.stateKey,N=c.pagesKey,k=c.totalKey,O=c.dataKey,x=c.current,P=s.data,D=s.paging;return(0,i._)((0,o._)({},e),(0,r._)({},R,(0,u.qS)(null!==(w=e[R])&&void 0!==w?w:{},x,{data:null!=P?P:[],total:null==D?void 0:D.totals},{pagesKey:N,totalKey:k,dataKey:O})))}switch(t.type){case d.GET_CREATOR_TASKS.success:var L=t.payload;return(0,i._)((0,o._)({},e),{tasks:L});case d.LOAD_HOT_QUESTION_LIST.success:var B=t.payload;return(0,i._)((0,o._)({},e),{hotQuestionList:null==B?void 0:B.data});case d.LOAD_CREATOR_STATISTICS.success:return(0,i._)((0,o._)({},e),{creatorStatistics:t.payload});case d.GET_RECOMMEND_QUESTION_LIST.success:if(!s)return(0,o._)({},e);return(0,i._)((0,o._)({},e),{creatorsRecommendInfo:(0,i._)((0,o._)({},s),{showType:(0,a.camelize)(s.showType||"")})});case d.GET_RECOMMEND_QUESTION_LIST.failure:return(0,i._)((0,o._)({},e),{creatorsRecommendInfo:{showType:"data"}})}return e}},26267:function(e,t,n){"use strict";n.d(t,{Sy:function(){return l},Xd:function(){return s},ZP:function(){return u}});var r=n(55164),o=n(57477),i=n(39288),a={list:[]},c=(0,i.FH)("creatorRightStatus",["LOAD_CREATOR_RIGHT_STATUS"]);function s(){return{API:{types:c.LOAD_CREATOR_RIGHT_STATUS,endpoint:"/creators/rights/status"}}}var l=function(e){var t;return(null===(t=e.creatorRightStatus)||void 0===t?void 0:t.list)||a.list};function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1?arguments[1]:void 0;if(t.type===c.LOAD_CREATOR_RIGHT_STATUS.success){var n=t.payload;return(0,o._)((0,r._)({},e),{list:Array.isArray(null==n?void 0:n.data)?n.data:[]})}return e}},44893:function(e,t,n){"use strict";n.d(t,{UH:function(){return u},ZP:function(){return p}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(84054),s=n.n(c),l=n(39288),u=s()({data:[{question:{answer_count:!0,follower_count:!0,visit_count:!0,detail:!0,excerpt:!0,relationship:{is_following:!0},author:!0,created:!0}}]}),d=(0,o._)({},(0,l.FH)("creators",["GET_GOODAT_TOPIC_LIST","MODIFY_GOODAT_TOPIC","SEARCH_TOPIC","DELETE_TOOLS_QUESTION","GET_TOOLS_QUESTION_LIST","DELETE_TOOLS_QUESTION_INVITED","GET_TOOLS_QUESTION_INVITED_LIST"]));function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{goodatTopics:[]},t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload,s=t.meta;switch(n){case d.GET_GOODAT_TOPIC_LIST.success:return(0,i._)((0,o._)({},e),{goodatTopics:c.data.map(function(e){return(0,i._)((0,o._)({},e),{isGoodat:!0})}),isDrained:!0});case d.MODIFY_GOODAT_TOPIC.success:var l=s.goodatTopics;return(0,i._)((0,o._)({},e),{goodatTopics:l});case d.DELETE_TOOLS_QUESTION.success:var u=s.stateKey;return(0,i._)((0,o._)({},e),(0,r._)({},u,(0,i._)((0,o._)({},e[u]),{data:e[u].data.filter(function(e){return e.question.id!==t.meta.questionId})})));case d.GET_TOOLS_QUESTION_LIST.request:var p=s.stateKey;return(0,i._)((0,o._)({},e),(0,r._)({},p,(0,i._)((0,o._)({},e[p]),{isLoading:!0})));case d.GET_TOOLS_QUESTION_LIST.success:var h,f=s.stateKey;return(0,i._)((0,o._)({},e),(0,r._)({},f,(0,i._)((0,o._)((0,i._)((0,o._)({},e[f]),{isLoading:!1}),c),{data:(0,a._)((null===(h=e[f])||void 0===h?void 0:h.data)||[]).concat((0,a._)(c.data))})));case d.GET_TOOLS_QUESTION_LIST.failure:var _=s.stateKey;return(0,i._)((0,o._)({},e),(0,r._)({},_,(0,i._)((0,o._)({},e[_]),{isLoading:!1})))}return e}},40382:function(e,t,n){"use strict";n.d(t,{EtQ:function(){return y},Skx:function(){return w},ZPm:function(){return ei},oEW:function(){return et},bGQ:function(){return E},sOG:function(){return en},XX4:function(){return $},iGT:function(){return C}});var r=n(93206),o=n(55164),i=n(57477),a=n(74135),c=n(39288),s=(0,o._)({},(0,c.FH)("creators",["GET_CREATOR_SETTINGS","PATCH_CREATOR_SETTINGS_INFO","GET_ACCOUNT_BINDING","POST_ACCOUNT_BINDING_INFO","GET_VALIDATION_MSG","GET_ACCOUNT_BINDING_URL","SET_CANCEL_ACCOUNT_BINDING","GET_ACCOUNT_BINDING_SYNC","POST_ACCOUNT_BINDING_SYNC","GET_CONTENT_SYNC_PERMISSION","ACCOUNT_BINDING_AGGREMENT","GET_SCORE_CHANGE_LOG","GET_CREATOR_APPLY_INFO","GET_GROWTH_LEVEL","LOAD_CONTENT_SYNC_PERMISSION_V2"])),l=n(87320),u=n(49899),d=(0,o._)({},(0,c.FH)("creators",["LOAD_ACTIVITY_LIST"])),p=(0,o._)({},(0,c.FH)("creators",["LOAD_ANALYTICS_AGGREGATION","LOAD_ANALYTICS_AGGREGATION_V2","LOAD_ANALYTICS_DAILY_TOTAL_DETAIL","LOAD_ANALYTICS_DAILY_TOTAL_DETAIL_V2","LOAD_ANALYTICS_DAILY_SINGLE_DETAIL","LOAD_ANALYTICS_SINGLE_CONTENT_AGGREGATION","LOAD_ANALYTICS_SINGLE_CONTENT_DETAIL","LOAD_ANALYTICS_SINGLE_PIN_CONTENT_AGGREGATION","LOAD_ANALYTICS_SINGLE_PIN_CONTENT_DETAIL","LOAD_ANALYTICS_VISTER_PORTRAIT","LOAD_ANALYTICS_SINGLE_VISTER_PORTRAIT","LOAD_ANALYTICS_FOLLOW_PROFILE"]));n(20312);var h=(0,o._)({},(0,c.FH)("creators",["LOAD_ANNOUNCEMENT_LIST","LOAD_ANNOUNCEMENT"])),f=(0,o._)({},(0,c.FH)("creators",["LOAD_BAYES_DOMAINS_STATUES","SAVE_POPUP_HAS_SHOWN","LOAD_BAYES_DOMAINS_OPYTIONAL","UPDATE_SELECTED_DOMAINS","LOAD_CONTENTS"])),_={status:{},options:{topDomains:null,allDomains:null,editable:0},contents:null};n(18837);var m=n(4667),v=n.n(m),g=n(80523),T=(0,o._)({},(0,c.FH)("creators",["GET_CREATOR_APPLY_STATUS","READ_NOTIFICATION","GET_CREATOR_RIGHTS_STATUS"]));function E(){return function(e,t,n){var r=n.fnRefs;return(0,g.Z)(r,"loadCreatorApplyStatus",function(){return v()(function(){return e({API:{types:T.GET_CREATOR_APPLY_STATUS,endpoint:"/creator/apply"}})})})()}}function C(e){return{API:{types:T.READ_NOTIFICATION,endpoint:"/creator/notification/read",method:"PATCH",body:{type:e}},meta:{type:e}}}var y=function(e){return e.creators.common.applyStatus};n(84054);var S=n(67516),I=n.n(S),b="VIDEO_CLIP",A={videoSucccess:1,videoEdit:2,pinPublish:3,pinSuccess:4},Z=(0,o._)({},(0,c.FH)("creators",["LOAD_CREATION_LIST","LOAD_CREATION","GET_DRAFT_COUNT","GET_DRAFTS","LOAD_ANALYSIS_STATUS","CANCEL_CREATION_RELATION","DELETE_ANSWER","CHECK_ARTICLE_PUBLISH"]),(0,c.co)("creator",["UPDATE_EDIT_MODAL_STATUS"]));function w(e,t){var n={article_token:e};return t&&(n.question_token=t),{API:{types:Z.CHECK_ARTICLE_PUBLISH,endpoint:"creators/article_publish/check/question",method:"POST",body:n}}}var R=(0,o._)({},(0,c.FH)("creators",["GET_EDITOR_SETTING","UPDATE_EDITOR_SETTING"])),N=(0,o._)({},(0,c.FH)("creators",["GET_ACADEMY_TABS","GET_ACADEMY_ARTICLES"])),k={tabs:[],article:{}};n(74351);var O=n(31824),x=n(33722),P=n(7407),D=(0,O.P1)(function(e){return e.creators.home.newRights},P.Xj,function(e,t){return e.map(function(e){var n=Object.values(x.Zy).find(function(t){return t.id===e.id});return!n||(null==n?void 0:n.officeOnly)&&!t?null:(0,o._)({},n,e)}).filter(Boolean)});(0,O.P1)(D,function(e){return e.filter(function(e){return e.needShow})});var L=(0,o._)({},(0,c.FH)("creators",["GET_HOME_DATA","APPLY_CREATOR_RIGHTS","GET_CREATOR_NEW_RIGHTS","GET_CREATOR_DIGITAL_ASSISTANT_RIGHTS","LOAD_BVIP_RECOMMEND_MENU_SHOULD_SHOW","LOAD_CREATION_RELATIONSHIP_MENU_SHOULD_SHOW","LOAD_CREATOR_SCORE_INFO","GET_NEW_RIGHTS_IS_ACTIVE","LOAD_BANNER_LIST","GET_FALLBACK","UPDATE_FALLBACK","GET_LEVEL_UP_WINDOW_SHOW","UPGRADE_WINDOW_DONE","LOAD_RECOMMENDED_FOLLOW_LIST","LOAD_NEW_TASK_HOME_CARD"]),(0,c.co)("creators",["SET_CURRENT_CREATOR","CLEAN_GRADE_INFO"])),B=(0,o._)({},(0,c.FH)("creators",["LOAD_AGGREGATION_CARD_DATA","LOAD_TABLE_DATA"])),U=(0,o._)({},(0,c.FH)("creators",["LOAD_KM_RESOURCE"]));n(23391);var M=(0,o._)({},(0,c.FH)("creators",["GET_TEXT_INCOME_INFO","GET_TEXT_INCOME","GET_TEXT_INCOME_APPLY_INFO","TEXT_INCOME_APPLY","GET_INCOME_AUTHORIZE","GET_DOMAIN_LIST"]),(0,c.co)("creators",["SWITCH_DOMAIN_MODAL"])),G=(0,o._)({},(0,c.FH)("creators",["GET_KNOWLEDGE_TASK_INFO","GET_KNOWLEDGE_TASK_DETAIL","GET_KNOWLEDGE_BENEFIT","GET_KNOWLEDGE_QUESTIONS","GET_CLOSED_TASKS","GET_RUNNING_TASKS","RECEIVE_TASK"])),F=(0,o._)({},(0,c.FH)("creators",["ACCEPT_UNBIND","LAUNCH_UNBIND","LOAD_MCN_HOMEPAGE","REJECT_UNBIND","REJECT_MCN_INVITE","ACCEPT_MCN_INVITE"])),z=(0,o._)({},(0,c.FH)("profilePoster",["LOAD_CREATOR_POSTER_CONFIG"])),H={creatorPosterConfig:{},creatorPosterData:{}},q=(0,o._)({},(0,c.FH)("creators",["GET_USER_STATUS","OPEN_SAFEGUARD_RIGHTS","CONFIRM_SAFEGUARD_RIGHTS","POST_PROTECT_CONTENT","GET_PROTECT_INFRINGEMENT","GET_PROTECT_CONTENT","POST_INFRINGEMENT","INGORE_INFRINGEMENT","POST_INFRINGEMENT_MATERIAL","GET_PROTECT_STATISTIC","GET_PROTECT_CONTENT_DETAIL","GET_PROTECT_WHITE","POST_PROTECT_WHITE","UPDATE_PROTECT_WHITE","GET_SAFEGUARD_RIGHTS_SKU"])),V=n(76931),X=n.n(V),W=(0,o._)({},(0,c.FH)("creators",["LOAD_CREATOR_SCHOOL_KM_DATA","LOAD_CREATOR_SCHOOL_CONTENT_DETAIL","LOAD_MY_RECENTLY_STUDING","LOG_STUDING"])),K={tabs:[],contents:[],banner:null,entities:{}},j=(0,o._)({},(0,c.FH)("creators",["UPDATE_CURRENT_PROMOTION","DELETE_CURRENT_PROMOTION","GET_CUSTOM_PROMOTION_STATUS","GET_PROMOTION_ITEM_LIST","GET_PROMOTION_ITEM"])),Y=(0,o._)({},(0,c.FH)("creators",["GET_TOOLS_HOTSPOT_DOMAIN_LIST","GET_TOOLS_HOTSPOT_LIST"])),Q=n(44893);n(85879),n(12506),n(92995);var J=(0,o._)({},(0,c.FH)("creators",["LOAD_ARTICLE_EXPOSURE_PROMOTION_LIST","LOAD_ARTICLE_EXPOSURE_PROMOTION_AMOUNT_BALANCE","LOAD_ARTICLE_EXPOSURE_PROMOTION_RECORD","CHECK_ARTICLE_EXPOSURE_PROMOTION_PERMISSION","START_ARTICLE_EXPOSURE_PROMOTION","LOAD_EXPOSURE_PROMOTION_AMOUNT_BALANCE","LOAD_EXPOSURE_PROMOTION_LIST","LOAD_EXPOSURE_PROMOTION_RECORD","CHECK_EXPOSURE_PROMOTION_PERMISSION","START_EXPOSURE_PROMOTION","GET_TOOLS_RECOMMEND_LIST","GET_TOOLS_RECOMMEND_LIST_AVAILABLE_TIMES","GET_TOOLS_RECOMMEND_TIMES_RECORD","POST_TOOLS_RECOMMEND","GET_TOOLS_RECOMMEND_RECORD"]));function $(e,t){return{API:{types:J.POST_TOOLS_RECOMMEND,endpoint:"/creators/recommendation/".concat(e),body:{url_token:t},method:"POST"}}}var ee=(0,o._)({},(0,c.FH)("creators",["GET_ALGORITHM_RECOMMEND_LIST","GET_TOOLS_SEARCH_QUESTION_LIST","GET_HOT_EVENT","LOAD_HOUR_HOT_QUESTION"]));function et(e){return{API:{types:ee.GET_ALGORITHM_RECOMMEND_LIST,endpoint:"creators/match/question/list",method:"GET",query:{article_token:e}}}}function en(e,t){return{API:{types:ee.GET_TOOLS_SEARCH_QUESTION_LIST,endpoint:e,query:t}}}var er=(0,o._)({},(0,c.FH)("creators",["LOAD_USER_INFO","LOAD_GRADUATE_INFO"]));(0,o._)({},(0,c.FH)("creators",["LOAD_VIDEO_DISTRIBUTION_LIST","LOAD_VIDEO_DISTRIBUTION_MAPS","VIDEO_DISTRIBUTION_AUTH","VIDEO_DISTRIBUTION_ANSWER_DELETE","LOAD_VIDEO_DISTRIBUTION_RESOURCE"])),n(57266);var eo=(0,o._)({},(0,c.FH)("creators",["GET_VIDEO_SUPPORT_BASE_STATISTICS","GET_TEXT_SUPPORT_BASE_STATISTICS","GET_VIDEO_SUPPORT_CONTENT_STATISTICS","GET_TEXT_SUPPORT_CONTENT_STATISTICS","GET_VIDEO_SUPPORT_BANNER","GET_VIDEO_SUPPORT_DAILY_STATISTICS","GET_VIDEO_SUPPORT_USER_SHOW_STATUS","GET_VIDEO_SUPPORT_USER_STATUS","APPLY_VIDEO_SUPPORT"])),ei=(0,r.combineReducers)({common:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{applyStatus:{},rightsStatus:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,c=t.meta;switch(n){case T.GET_CREATOR_APPLY_STATUS.success:return(0,i._)((0,o._)({},e),{applyStatus:(0,o._)({},r)});case T.GET_CREATOR_APPLY_STATUS.failure:if(t.err&&403===t.err.status)return(0,i._)((0,o._)({},e),{guide:!0});break;case T.READ_NOTIFICATION.success:return(0,i._)((0,o._)({},e),{applyStatus:(0,i._)((0,o._)({},e.applyStatus),{notification:(0,i._)((0,o._)({},e.applyStatus.notification),(0,l._)({},(0,a.camelize)(t.meta.type),0))})});case T.GET_CREATOR_RIGHTS_STATUS.success:return(0,i._)((0,o._)({},e),{rightsStatus:(0,i._)((0,o._)({},e.rightsStatus),(0,l._)({},c.rightsId,r))})}return e},bayesDomains:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,n=arguments.length>1?arguments[1]:void 0,r=n.payload;return n.type===f.LOAD_BAYES_DOMAINS_STATUES.success?(0,i._)((0,o._)({},t),{status:r}):n.type===f.LOAD_BAYES_DOMAINS_OPYTIONAL.success?(0,i._)((0,o._)({},t),{options:r}):n.type===f.LOAD_CONTENTS.success?(0,i._)((0,o._)({},t),{contents:{data:(0,u._)((null===(e=t.contents)||void 0===e?void 0:e.data)||[]).concat((0,u._)(r.data)),paging:r.paging}}):t},school:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0,n=t.meta,r=t.payload;switch(t.type){case W.LOAD_CREATOR_SCHOOL_KM_DATA.success:var a=(void 0===n?{}:n).stateKey;return(0,i._)((0,o._)({},e),(0,l._)({},a,X()(r,{tabs:"data.tabs",contents:"data.tabContents",banner:"data.banners"}[a])));case W.LOAD_CREATOR_SCHOOL_CONTENT_DETAIL.success:var c=r.data.filter(Boolean).reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,l._)({},t.id,t))},{});return(0,i._)((0,o._)({},e),{entities:(0,o._)({},e.entities,c)})}return e},faq:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N.GET_ACADEMY_TABS.success:var n=t.payload.data;return(0,i._)((0,o._)({},e),{isDrained:!0,tabs:n.tabs});case N.GET_ACADEMY_ARTICLES.success:var r=t.payload.data;return(0,i._)((0,o._)({},e),{article:r.contents.reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,l._)({},t.id,t))},e.article)})}return e},knowledgeIncome:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,a=t.meta;switch(n){case M.SWITCH_DOMAIN_MODAL:return(0,i._)((0,o._)({},e),{domainModalStatus:a});case M.GET_TEXT_INCOME_INFO.success:return(0,i._)((0,o._)({},e),{textIncomeInfo:r});case M.GET_TEXT_INCOME_INFO.failure:return(0,i._)((0,o._)({},e),{textIncomeInfo:{error:!0}});case M.GET_TEXT_INCOME.success:return(0,i._)((0,o._)({},e),{textIncomeAmount:r});case M.GET_INCOME_AUTHORIZE.success:return(0,i._)((0,o._)({},e),{tabAuthorize:r});case M.GET_INCOME_AUTHORIZE.failure:return(0,i._)((0,o._)({},e),{tabAuthorize:{error:!0}});case M.GET_TEXT_INCOME_APPLY_INFO.success:return(0,i._)((0,o._)({},e),{textIncomeApplyInfo:r});case M.GET_TEXT_INCOME_APPLY_INFO.failure:return(0,i._)((0,o._)({},e),{textIncomeApplyInfo:{error:!0}})}return e},safeguardRights:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case q.GET_USER_STATUS.success:return(0,i._)((0,o._)({},e),{userStatus:r});case q.GET_PROTECT_STATISTIC.success:return(0,i._)((0,o._)({},e),{protectStatistic:r});case q.GET_PROTECT_CONTENT_DETAIL.success:return(0,i._)((0,o._)({},e),{protectContentDetail:r});case q.GET_PROTECT_WHITE.success:return(0,i._)((0,o._)({},e),{protectWhiteList:r});case q.GET_SAFEGUARD_RIGHTS_SKU.success:return(0,i._)((0,o._)({},e),{skuData:r})}return e},analytics:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{all:{},answer:{},zvideo:{},article:{},pin:{},singleContent:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,a=t.meta;switch(n){case p.LOAD_ANALYTICS_AGGREGATION.success:var c=a.stateKey;return(0,i._)((0,o._)({},e),(0,l._)({},c,(0,i._)((0,o._)({},e[c]),{aggregation:r})));case p.LOAD_ANALYTICS_FOLLOW_PROFILE.success:return(0,i._)((0,o._)({},e),{followProfile:r});case p.LOAD_ANALYTICS_AGGREGATION_V2.success:var s=a.stateKey;return(0,i._)((0,o._)({},e),(0,l._)({},s,(0,i._)((0,o._)({},e[s]),{aggregationV2:r})));case p.LOAD_ANALYTICS_DAILY_TOTAL_DETAIL.success:var u=a.stateKey;return(0,i._)((0,o._)({},e),(0,l._)({},u,(0,i._)((0,o._)({},e[u]),{totalDetail:r})));case p.LOAD_ANALYTICS_DAILY_TOTAL_DETAIL_V2.success:var d=a.stateKey;return(0,i._)((0,o._)({},e),(0,l._)({},d,(0,i._)((0,o._)({},e[d]),{totalDetailV2:r})));case p.LOAD_ANALYTICS_DAILY_SINGLE_DETAIL.success:var h=a.stateKey;return(0,i._)((0,o._)({},e),(0,l._)({},h,(0,i._)((0,o._)({},e[h]),{singleDetail:r})));case p.LOAD_ANALYTICS_SINGLE_CONTENT_AGGREGATION.success:case p.LOAD_ANALYTICS_SINGLE_PIN_CONTENT_AGGREGATION.success:var f=a.stateKey;return(0,i._)((0,o._)({},e),{singleContent:(0,i._)((0,o._)({},e.singleContent),(0,l._)({},f,(0,i._)((0,o._)({},e.singleContent[f]),{aggregation:r})))});case p.LOAD_ANALYTICS_VISTER_PORTRAIT.success:var _=a.stateKey;return(0,i._)((0,o._)({},e),(0,l._)({},_,(0,i._)((0,o._)({},e[_]),{visterPortrait:r})));case p.LOAD_ANALYTICS_SINGLE_VISTER_PORTRAIT.success:var m=a.stateKey;return(0,i._)((0,o._)({},e),(0,l._)({},m,(0,i._)((0,o._)({},e[m]),{singleVisterPortrait:r})));case p.LOAD_ANALYTICS_SINGLE_CONTENT_DETAIL.success:case p.LOAD_ANALYTICS_SINGLE_PIN_CONTENT_DETAIL.success:var v=a.stateKey;return(0,i._)((0,o._)({},e),{singleContent:(0,i._)((0,o._)({},e.singleContent),(0,l._)({},v,(0,i._)((0,o._)({},e.singleContent[v]),{detail:r})))})}return e},account:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{growthLevel:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case s.GET_CREATOR_SETTINGS.success:return(0,i._)((0,o._)({},e),{settings:r.data});case s.PATCH_CREATOR_SETTINGS_INFO.success:return(0,i._)((0,o._)({},e),{settings:(0,o._)({},e.settings,t.data)});case s.GET_ACCOUNT_BINDING.success:return(0,i._)((0,o._)({},e),{accountBinding:r});case s.GET_VALIDATION_MSG.success:return(0,i._)((0,o._)({},e),{validationMsg:r});case s.GET_ACCOUNT_BINDING_SYNC.success:return(0,i._)((0,o._)({},e),{accountBindingSync:r});case s.GET_CREATOR_APPLY_INFO.success:return(0,i._)((0,o._)({},e),{applyConfigInfo:t.payload});case s.GET_GROWTH_LEVEL.success:var a=t.payload;return(0,i._)((0,o._)({},e),{growthLevel:(0,o._)({},e.growthLevel,a)})}return e},KMResource:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.meta;if(t.type===U.LOAD_KM_RESOURCE.success&&n.data){var a=r.stateKey;return(0,i._)((0,o._)({},e),(0,l._)({},a,n.data))}return e},training:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===er.LOAD_USER_INFO.success?(0,i._)((0,o._)({},e),{userInfo:t.payload}):t.type===er.LOAD_GRADUATE_INFO.success?(0,i._)((0,o._)({},e),{graduate:t.payload}):e},ToolsQuestion:Q.ZP,ToolsHotspot:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{domains:[]},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,a=t.meta;switch(n){case Y.GET_TOOLS_HOTSPOT_DOMAIN_LIST.success:return(0,i._)((0,o._)({},e),{domains:r.domains});case Y.GET_TOOLS_HOTSPOT_LIST.success:return(0,i._)((0,o._)({},e),(0,l._)({},a.stateKey,r))}return e},ToolsRecommend:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e},ToolsCustomPromotion:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{itemLists:{},baseInfo:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case j.GET_CUSTOM_PROMOTION_STATUS.success:return(0,i._)((0,o._)({},e),{baseInfo:r});case j.GET_PROMOTION_ITEM_LIST.success:var a=t.itemType,c=t.offset,s=t.limit,d=t.payload,p=d.data,h=d.count,f=e.itemLists[a]||{count:h,data:Array.from({length:h},function(){return null})},_=(0,i._)((0,o._)({},f),{data:(0,u._)(f.data.slice(0,c)).concat((0,u._)(p),(0,u._)(f.data.slice(c+s)))});return(0,i._)((0,o._)({},e),{itemLists:(0,i._)((0,o._)({},e.itemLists),(0,l._)({},a,_))})}return e},ToolsSearchQuestion:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case ee.GET_HOT_EVENT.success:return(0,i._)((0,o._)({},e),{hotEventsList:null==r?void 0:r.data});case ee.LOAD_HOUR_HOT_QUESTION.success:return(0,i._)((0,o._)({},e),{hotHourQuestionList:null==r?void 0:r.data})}return e},editorSetting:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===R.GET_EDITOR_SETTING.success?(0,i._)((0,o._)({},e),{baseInfo:r}):e},MCNManage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===F.LOAD_MCN_HOMEPAGE.success?(0,i._)((0,o._)({},e),{mcnInfo:r}):e},knowledgeTasks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case G.GET_KNOWLEDGE_TASK_INFO.success:return(0,i._)((0,o._)({},e),{knowledgeTaskInfo:null==r?void 0:r.data});case G.GET_KNOWLEDGE_TASK_INFO.failure:return(0,i._)((0,o._)({},e),{knowledgeTaskInfo:{error:!0}});case G.GET_KNOWLEDGE_TASK_DETAIL.success:return(0,i._)((0,o._)({},e),{knowledgeTaskDetail:null==r?void 0:r.data});case G.GET_KNOWLEDGE_TASK_DETAIL.failure:return(0,i._)((0,o._)({},e),{knowledgeTaskDetail:{error:!0}});case G.GET_KNOWLEDGE_BENEFIT.success:return(0,i._)((0,o._)({},e),{knowledgeBenefit:r});case G.GET_KNOWLEDGE_BENEFIT.failure:return(0,i._)((0,o._)({},e),{knowledgeBenefit:{error:!0}})}return e},incomeAnalysis:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{income:{aggregation:{}}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===B.LOAD_AGGREGATION_CARD_DATA.success?(0,i._)((0,o._)({},e),{income:(0,i._)((0,o._)({},e.income),{aggregation:r})}):e},creationManage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{editModal:{status:!1,type:A.videoSuccess}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Z.UPDATE_EDIT_MODAL_STATUS:var n=function(){var e=I().get(b,"edit");if(!e)return null;var t=e.sourceId,n=e.timestamp;return(I().delete(b),Date.now()-n>3e5)?null:t}(),r=t.payload||{},a=r.status,c=r.zvideoId,s=n||c,u=A.videoSucccess,d=A.videoEdit;if(a&&s)return(0,i._)((0,o._)({},e),{editModal:{status:a,type:n?u:d,sourceId:s}});return(0,i._)((0,o._)({},e),{editModal:(0,i._)((0,o._)({},e.editModal),{status:!1})});case Z.GET_DRAFT_COUNT.success:var p,h,f,_=t.meta.contentType;if("zvideo"===_)return(0,i._)((0,o._)({},e),{draftCount:(0,i._)((0,o._)({},e.draftCount),(0,l._)({},_,null===(h=t.payload)||void 0===h?void 0:null===(f=h.paging)||void 0===f?void 0:f.totals))});return(0,i._)((0,o._)({},e),{draftCount:(0,i._)((0,o._)({},e.draftCount),(0,l._)({},_,null===(p=t.payload)||void 0===p?void 0:p.count))});case Z.LOAD_ANALYSIS_STATUS.success:return(0,i._)((0,o._)({},e),{analysisStatus:t.payload})}return e},activity:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,a=t.meta;if(n===d.LOAD_ACTIVITY_LIST.success){var c,s=a.groupToken;return(0,i._)((0,o._)({},e),(0,l._)({},s,(0,i._)((0,o._)({},e[s],r),{data:(0,u._)((null===(c=e[s])||void 0===c?void 0:c.data)||[]).concat((0,u._)(r.data||[])),page:(0,i._)((0,o._)({},r.page),{isLoading:!1})})))}return e},announcement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,a=t.meta;if(n===h.LOAD_ANNOUNCEMENT_LIST.success){var c,s=a.stateKey,u=a.offset;return(0,i._)((0,o._)({},e),(0,l._)({},s,(0,i._)((0,o._)({},r),{data:(0,i._)((0,o._)({},null===(c=e[s])||void 0===c?void 0:c.data),(0,l._)({},u,r.data))})))}return e},home:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{currentCreatorUrlToken:null,rights:[],newRights:[],scoreInfo:{},menusShowControlByServer:{bVipRecomend:!1,creationRelationship:!1},newTasks:{creatorTask:{tasks:[],des:[]}},bannerList:[],recentlyCreated:[],homecard:{},homeData:{}},a=arguments.length>1?arguments[1]:void 0,c=a.type,s=a.payload;switch(c){case L.GET_HOME_DATA.success:return(0,i._)((0,o._)({},r),{homeData:(0,o._)({},r.homeData,s)});case L.GET_HOME_DATA.failure:return(0,i._)((0,o._)({},r),{isHomepageForbidden:(null===(e=a.err)||void 0===e?void 0:null===(t=e.payload)||void 0===t?void 0:t.code)==="403"});case L.LOAD_NEW_TASK_HOME_CARD.success:return(0,i._)((0,o._)({},r),{homecard:s});case L.LOAD_NEW_TASK_HOME_CARD.failure:return(0,i._)((0,o._)({},r),{homecard:{error:!0}});case L.APPLY_CREATOR_RIGHTS.success:var l=a.meta,u=l.rightsId,d=l.isExperience,p=a.payload;return(0,i._)((0,o._)({},r),{newRights:r.newRights.map(function(e){return(0,i._)((0,o._)({},e),{status:e.id===u?p.status:e.status})}),rights:r.rights.map(function(e){return(0,i._)((0,o._)({},e),{status:e.id===u?d?"experience":p.status:e.status})})});case L.GET_CREATOR_NEW_RIGHTS.success:var h=a.payload.rights;return(0,i._)((0,o._)({},r),{newRights:void 0===h?[]:h});case L.GET_CREATOR_DIGITAL_ASSISTANT_RIGHTS.request:return(0,i._)((0,o._)({},r),{digitalAssistantRight:Object.assign({isLoading:!0},r.digitalAssistantRight)});case L.GET_CREATOR_DIGITAL_ASSISTANT_RIGHTS.success:var f=a.payload;return(0,i._)((0,o._)({},r),{digitalAssistantRight:Object.assign({isLoading:!1},f.data)});case L.GET_CREATOR_DIGITAL_ASSISTANT_RIGHTS.failure:return(0,i._)((0,o._)({},r),{digitalAssistantRight:Object.assign({isLoading:!1},r.digitalAssistantRight)});case L.LOAD_BVIP_RECOMMEND_MENU_SHOULD_SHOW.success:return(0,i._)((0,o._)({},r),{menusShowControlByServer:(0,i._)((0,o._)({},r.menusShowControlByServer),{bVipRecomend:s.data})});case L.LOAD_CREATION_RELATIONSHIP_MENU_SHOULD_SHOW.success:return(0,i._)((0,o._)({},r),{menusShowControlByServer:(0,i._)((0,o._)({},r.menusShowControlByServer),{creationRelationship:s.canRef})});case L.LOAD_CREATOR_SCORE_INFO.success:var _=a.payload;return(0,i._)((0,o._)({},r),{scoreInfo:_});case L.SET_CURRENT_CREATOR:return(0,i._)((0,o._)({},r),{currentCreatorUrlToken:s});case L.LOAD_BANNER_LIST.success:return(0,i._)((0,o._)({},r),{bannerList:(null==s?void 0:null===(n=s.data)||void 0===n?void 0:n.bannerList)||[]});case L.GET_LEVEL_UP_WINDOW_SHOW.success:return(0,i._)((0,o._)({},r),{upgradeInfo:s});case L.CLEAN_GRADE_INFO:return(0,i._)((0,o._)({},r),{upgradeInfo:(0,i._)((0,o._)({},r.upgradeInfo),{needPop:!1})})}return r},videoSupport:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{textBenefit:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case eo.GET_VIDEO_SUPPORT_BASE_STATISTICS.success:return(0,i._)((0,o._)({},e),{base:r});case eo.GET_VIDEO_SUPPORT_BASE_STATISTICS.failure:return(0,i._)((0,o._)({},e),{base:{error:!0}});case eo.GET_TEXT_SUPPORT_BASE_STATISTICS.success:return(0,i._)((0,o._)({},e),{textBenefit:(0,i._)((0,o._)({},e.textBenefit),{base:r})});case eo.GET_TEXT_SUPPORT_BASE_STATISTICS.failure:return(0,i._)((0,o._)({},e),{textBenefit:(0,i._)((0,o._)({},e.textBenefit),{base:{error:!0}})});case eo.GET_VIDEO_SUPPORT_CONTENT_STATISTICS.success:return(0,i._)((0,o._)({},e),{content:r});case eo.GET_VIDEO_SUPPORT_CONTENT_STATISTICS.failure:return(0,i._)((0,o._)({},e),{content:{error:!0}});case eo.GET_TEXT_SUPPORT_CONTENT_STATISTICS.success:return(0,i._)((0,o._)({},e),{textBenefit:(0,i._)((0,o._)({},e.textBenefit),{content:r})});case eo.GET_TEXT_SUPPORT_CONTENT_STATISTICS.failure:return(0,i._)((0,o._)({},e),{textBenefit:(0,i._)((0,o._)({},e.textBenefit),{content:{error:!0}})});case eo.GET_VIDEO_SUPPORT_BANNER.success:return(0,i._)((0,o._)({},e),{banner:r});case eo.GET_VIDEO_SUPPORT_DAILY_STATISTICS.success:return(0,i._)((0,o._)({},e),{daily:r});case eo.GET_VIDEO_SUPPORT_DAILY_STATISTICS.failure:return(0,i._)((0,o._)({},e),{daily:{error:!0}});case eo.GET_VIDEO_SUPPORT_USER_SHOW_STATUS.success:return(0,i._)((0,o._)({},e),{userShowStatus:r});case eo.GET_VIDEO_SUPPORT_USER_SHOW_STATUS.failure:return(0,i._)((0,o._)({},e),{userShowStatus:{error:!0}});case eo.GET_VIDEO_SUPPORT_USER_STATUS.success:return(0,i._)((0,o._)({},e),{userStatus:r});case eo.GET_VIDEO_SUPPORT_USER_STATUS.failure:return(0,i._)((0,o._)({},e),{userStatus:{error:!0}})}return e},videoDistribution:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e},profilePoster:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0,n=t.payload;if(t.type===z.LOAD_CREATOR_POSTER_CONFIG.success&&(null==n?void 0:n.data)){var r=JSON.parse(n.data),a=r.config,c=r.data;return(0,i._)((0,o._)({},e),{creatorPosterConfig:a,creatorPosterData:c})}return e}})},51921:function(e,t,n){"use strict";n.d(t,{Hp:function(){return p},Pq:function(){return _},sF:function(){return f}});var r=n(55164),o=n(49899),i=n(46942),a=n.n(i),c=n(74135),s=n(93292),l=n(80523),u=n(39288),d=n(59523),p=(0,r._)({},(0,u.FH)("currentUser",["GET","GET_COLUMN_CONTRIBUTIONS","UPDATE_FULLNAME","GET_REAL_NAME_STATUS"]),(0,u.co)("currentUser",["ACTIVE_USER"])),h=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n,i){var u=i.fnRefs;return(0,l.Z)(u,"fetchCurrentUser",function(){return(0,s.Z)(function(t){var n;return e((n=t.map(function(e){return e[0]}).flat(),{API:(0,r._)({types:p.GET,endpoint:"me"},n&&{query:{include:a()(n.map(c.decamelize)).join(",")}})}))},queueMicrotask)}).apply(void 0,(0,o._)(t))}};function f(e){return function(t,n){var r=(0,d.ib)(n());if(r){var o=e.filter(function(e){return!(e in r)});if(o.length)return t(h(o))}}}var _=function(){return function(e,t){var n=t().currentUser;return e({API:{types:p.GET_COLUMN_CONTRIBUTIONS,endpoint:"/members/".concat(n,"/column-contributions"),method:"GET",query:{offset:0,limit:50,include:"data[*].column.articles_count,voteup_count"},fetchOptions:{credentials:"include"}}})}}},58909:function(e,t,n){"use strict";n.d(t,{Hp:function(){return o.Hp},ib:function(){return c.ib},wY:function(){return c.wY},ZP:function(){return s},sF:function(){return o.sF},Pq:function(){return o.Pq},dd:function(){return c.dd},W5:function(){return c.W5},pG:function(){return c.pG},cE:function(){return c.cE},me:function(){return a},xw:function(){return c.xw}});var r=n(93206),o=n(51921),i=n(98424),a=(0,r.combineReducers)({columnContributions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===o.Hp.GET_COLUMN_CONTRIBUTIONS.success?t.payload.data.map(function(e){return e.column}):e}}),c=n(59523),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.Hp.GET.success:return t.payload.urlToken;case i.Hp.UPDATE_AUTHINFO:return t.token||"";default:return e}}},59523:function(e,t,n){"use strict";n.d(t,{W5:function(){return s},cE:function(){return l},dd:function(){return p},ib:function(){return c},pG:function(){return u},wY:function(){return a},xw:function(){return d}});var r=n(36695),o=n(31824),i=n(66263),a=function(e){return e.currentUser},c=(0,o.P1)(function(e){var t;return null===(t=e.entities)||void 0===t?void 0:t.users},a,function(e,t){if(t){if(e[t])return e[t];var n=Object.keys(e).find(function(n){return e[n].id===t});return n?e[n]:void 0}}),s=(0,o.P1)(c,function(e){return!!e&&"organization"===e.userType}),l=(0,o.P1)(c,function(e){var t;return null==e?void 0:null===(t=e.vipInfo)||void 0===t?void 0:t.isVip});(0,o.P1)(c,function(e){var t;return null==e?void 0:null===(t=e.vipInfo)||void 0===t?void 0:t.renameAwaitDays}),(0,o.P1)(c,function(e){var t;return null==e?void 0:null===(t=e.vipInfo)||void 0===t?void 0:t.renameFrequency});var u=(0,o.P1)([c,function(e,t){return t}],function(e,t){return!!(e&&t&&e.id===t.id)}),d=function(e){return(0,r.useSelector)(function(t){return u(t,e)})};(0,o.P1)(c,function(e){var t;return[i.of.NO_SETTING,i.of.PASS].includes(null==e?void 0:null===(t=e.mcnUserInfo)||void 0===t?void 0:t.status)}),(0,o.P1)(c,function(e){var t;return(null==e?void 0:null===(t=e.mcnUserInfo)||void 0===t?void 0:t.availableSource)||[]});var p=(0,o.P1)(c,function(e){return!!(null==e?void 0:e.userType)&&"guest"!==e.userType})},74065:function(e,t,n){"use strict";n.d(t,{ZP:function(){return v},eJ:function(){return p},s1:function(){return d},mc:function(){return f},CU:function(){return h}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(93206),s=n(74135),l=n(39288),u=(0,o._)({},(0,l.FH)("draftHistory",["GET_HISTORY","GET_DRAFT","REVERT"]),(0,l.co)("draftHistory",["RESET"]));function d(e,t){return function(n,r){var o=r().draftHistory.history["".concat(e,"_").concat(t)];return n({meta:{type:e,id:t},API:{types:u.GET_HISTORY,endpoint:o&&o.next?o.next:"draft-histories",query:{objectType:e,objectId:t}}})}}function p(e,t){return{meta:{versionType:e,versionId:t},API:{types:u.GET_DRAFT,endpoint:"draft-history",query:{versionType:e,id:t}}}}function h(e,t){return{meta:{versionType:e,versionId:t},API:{types:u.REVERT,method:"POST",endpoint:"draft-history/revert",body:(0,s.decamelizeKeys)({versionType:e,id:t})}}}function f(e,t){return{type:u.RESET,meta:{type:e,id:t}}}function _(e){return"".concat(e.meta.type,"_").concat(e.meta.id)}function m(e){return"".concat(e.meta.versionType,"_").concat(e.meta.versionId)}var v=(0,c.combineReducers)({history:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.GET_HISTORY.request:var n=_(t);return(0,r._)({},n,{items:e[n]?e[n].items:null,next:e[n]?e[n].next:null,isFetching:!0,isDrained:!1});case u.GET_HISTORY.success:var o=_(t);return(0,r._)({},o,{items:e[o]&&e[o].items?(0,a._)(e[o].items).concat((0,a._)(t.payload.data)):t.payload.data,next:t.payload.paging.next,isFetching:!1,isDrained:t.payload.paging.isEnd});case u.GET_HISTORY.failure:var i=_(t);return(0,r._)({},i,{items:e[i]?e[i].items:null,next:e[i]?e[i].next:null,isFetching:!1,isDrained:!0});case u.RESET:return{};default:return e}},drafts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.GET_DRAFT.request:var n=m(t);return(0,i._)((0,o._)({},e),(0,r._)({},n,{data:null,isFetching:!0}));case u.GET_DRAFT.success:var a=m(t);return(0,i._)((0,o._)({},e),(0,r._)({},a,{data:t.payload,isFetching:!1}));case u.GET_DRAFT.failure:var c=m(t);return(0,i._)((0,o._)({},e),(0,r._)({},c,{data:null,isFetching:!1}));case u.RESET:return{};default:return e}}})},20765:function(e,t,n){"use strict";n.d(t,{Qm:function(){return a},jY:function(){return i}});var r=n(87320),o=n(93206);function i(e,t){return function(n){return n({type:"UPDATE_LIKE",UPDATE:{update:{eduSections:(0,r._)({},e,{isLiked:t})}}})}}function a(e,t,n){var o={voteUp:1,voteDown:2};return function(i){return i({type:"UPDATE_VOTE",UPDATE:{update:{eduSections:(0,r._)({},e,{voting:o[t],voteCount:n})}}})}}t.ZP=(0,o.combineReducers)({eduSectionState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e}})},62039:function(e,t,n){"use strict";n.d(t,{Jb:function(){return h},P0:function(){return u},XO:function(){return p},ZP:function(){return f},aV:function(){return d}});var r=n(87320),o=n(55164),i=n(57477),a=n(39288),c=n(68455),s={emoticonGroupList:[],emoticonGroupDetail:{}},l=(0,o._)({},(0,a.FH)("emoticons",["GET_EMOTICONGROUP_LIST","GET_EMOTICONS_DETAIL"]),(0,a.co)("emoticons",["SAVE_EMOTICONS_TO_REDUX","CHANGE_SELECTED_EMOTICON_GROUP","CHANGE_SELECTED_EMOTICON_PANEL"]));function u(){return{API:{types:l.GET_EMOTICONGROUP_LIST,endpoint:"/me/sticker-groups"}}}function d(e){return{API:{types:l.GET_EMOTICONS_DETAIL,endpoint:"/sticker-groups/".concat(e),query:{business:"message"}},meta:{id:e}}}function p(e){return{type:l.CHANGE_SELECTED_EMOTICON_GROUP,meta:{id:e}}}function h(e){return{type:l.CHANGE_SELECTED_EMOTICON_PANEL,meta:{id:e}}}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;if(t.type===l.GET_EMOTICONGROUP_LIST.success){var n=t.payload.data;return(0,i._)((0,o._)({},e),{emoticonGroupList:n,curEmoticonGroupId:t.payload.data[0].id})}if(t.type===l.GET_EMOTICONS_DETAIL.success){var a=t.meta.id,u=(0,i._)((0,o._)({},e.emoticonGroupDetail),(0,r._)({},a,t.payload.data)),d=(0,c.GM)(u,e.emoticonGroupList);return(0,i._)((0,o._)({},e),{emoticonGroupDetail:u,emoticonPanelList:d})}if(t.type===l.SAVE_EMOTICONS_TO_REDUX){var p=t.meta.data.id,h=(0,i._)((0,o._)({},e.emoticonGroupDetail),(0,r._)({},p,t.meta.data)),f=(0,c.GM)(h,e.emoticonGroupList);return(0,i._)((0,o._)({},e),{emoticonGroupDetail:h,emoticonPanelList:f})}if(t.type===l.CHANGE_SELECTED_EMOTICON_GROUP){var _=t.meta.id;return(0,i._)((0,o._)({},e),{curEmoticonGroupId:_})}if(t.type===l.CHANGE_SELECTED_EMOTICON_PANEL){var m=t.meta.id;return(0,i._)((0,o._)({},e),{curEmoticonPanelId:m})}return e}},87441:function(e,t,n){"use strict";n.d(t,{N7:function(){return g}});var r=n(87320),o=n(55164),i=n(57477),a=n(92769),c=n.n(a),s=n(33720),l=n.n(s),u=n(21654),d=n(21389),p=n(44900),h=n(25364),f=n(82865),_=n(58909),m={users:{},questions:{},answers:{},articles:{},columns:{},topics:{},roundtables:{},favlists:{},comments:{},notifications:{},ebooks:{},activities:{},feeds:{},pins:{},promotions:{},drafts:{},chats:{},posts:{},zvideos:{},zvideoContributions:{},eduCourses:{}},v=function(e,t){var n=t.schema,r=t.id,o=t.urlToken;return n?e["".concat(n,"s")][o||r]:t},g=function(e,t){return v(e.entities,t)};t.ZP=l()(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,n=arguments.length>1?arguments[1]:void 0;if(n.type===_.Hp.GET.success)return n.payload.isZombie=(0,f.Eh)(),(0,i._)((0,o._)({},t),{users:c()((0,i._)((0,o._)({},t.users),(0,r._)({},n.payload.urlToken,(0,o._)({},t.users[n.payload.id],t.users[n.payload.urlToken],n.payload))),n.payload.id)});if(n.type===_.Hp.ACTIVE_USER)return(0,i._)((0,o._)({},t),{users:(0,i._)((0,o._)({},t.users),(0,r._)({},n.currentUser,(0,i._)((0,o._)({},t.users[n.currentUser]),{isActive:!0})))});if(n.entities&&(t=(0,h.Z)(t,"function"==typeof(null===(e=n.meta)||void 0===e?void 0:e.entitiesPrefilter)?n.meta.entitiesPrefilter(n.entities):n.entities)),n.UPDATE){var a=n.type,s=n.payload,l=n.UPDATE,u=l.request,d=l.success,p=l.failure,v=l.update,g=n.err;if(a.endsWith("request")&&u&&(t=(0,h.Z)(t,"function"==typeof u?u(s,n):u)),a.endsWith("success")&&d&&(t=(0,h.Z)(t,"function"==typeof d?d(s,n):d)),a.endsWith("failure")&&p){var T="function"==typeof p?p(g):p;t=(0,h.Z)(t,T)}else v&&(t=(0,h.Z)(t,v))}return t},(0,d.y)({users:p.r,favlists:u.B}))},98424:function(e,t,n){"use strict";n.d(t,{Ct:function(){return p},GM:function(){return u},Hp:function(){return s},JT:function(){return d},ph:function(){return l}});var r=n(55164),o=n(67516),i=n.n(o),a=n(66263),c=n(39288),s=(0,r._)({},(0,c.co)("env",["UPDATE_USERAGENT","SET_TRAFFICSOURCE","UPDATE_EDITION","SET_CTX","SET_THEME","SET_APP_HEADER_THEME","TOGGLE_ENABLE_SHORTCUT","GET_ANNOUNCEMENT","SET_REFERER","UPDATE_CONF","UPDATE_LOGGED","UPDATE_AUTHINFO","UPDATE_APPVIEW_CONFIG","UPDATE_TRAFFIC_FREE","SET_UDID","SET_MODE","SET_ENV_VARS"]),(0,c.FH)("env",["GET_IPINFO"]));function l(){return{API:{types:s.GET_IPINFO,endpoint:"ip_info"},FAILSAFE:!0}}function u(e){return{type:s.UPDATE_USERAGENT,payload:e}}function d(e){return e?i().delete(a.Xq):i().set(a.Xq,!1),{type:s.TOGGLE_ENABLE_SHORTCUT,payload:e}}var p=function(e){return{type:s.SET_ENV_VARS,payload:e}}},7407:function(e,t,n){"use strict";n.d(t,{tQ:function(){return d.tQ},ZP:function(){return p},cM:function(){return d.cM},H8:function(){return d.H8},Hu:function(){return d.Hu},Xj:function(){return d.Xj},Hs:function(){return d.Hs},nR:function(){return d.nR},ph:function(){return l.ph},Kv:function(){return d.Kv},Ct:function(){return l.Ct},XE:function(){return d.XE},cq:function(){return d.cq},hV:function(){return d.hV},JT:function(){return l.JT},Uh:function(){return d.Uh},GM:function(){return l.GM},dD:function(){return d.dD}});var r=n(55164),o=n(57477),i=n(63306),a=n(93206),c=n(17132),s=n.n(c),l=n(98424),u=(0,a.combineReducers)({abV2:i.Z,userAgent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===l.Hp.UPDATE_USERAGENT){var n=t.payload;return(0,r._)({},e,s()(n))}return e},appViewConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===l.Hp.UPDATE_APPVIEW_CONFIG){var n=t.payload,i=n.can_auto_load_image,a=n.font_resize;return(0,o._)((0,r._)({},e),{can_auto_load_image:i,font_resize:a||1})}return e},ctx:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===l.Hp.SET_CTX?t.payload:e},trafficSource:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return t.type===l.Hp.SET_TRAFFICSOURCE?t.payload:e},edition:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{beijing:!1,baidu:!1,sogou:!1,baiduBeijing:!1,sogouBeijing:!1,sogouInput:!1,oppoSearch:!1},t=arguments.length>1?arguments[1]:void 0;return t.type===l.Hp.UPDATE_EDITION?(0,r._)({},e,t.payload):t.type===l.Hp.GET_IPINFO.success&&"北京"===t.payload.cityName?(0,o._)((0,r._)({},e),{beijing:!0,baiduBeijing:e.baidu,sogouBeijing:e.sogou}):e},theme:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return t.type===l.Hp.SET_THEME?"dark"===t.payload?"dark":"light":e},appHeaderTheme:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{current:"normal",disable:!0,normal:{bgColor:"GBK99A"},custom:{bgColor:"GBK99A"}},t=arguments.length>1?arguments[1]:void 0;if(t.type===l.Hp.SET_APP_HEADER_THEME){var n=t.payload||{current:"normal"};return(0,r._)({},e,n)}return e},enableShortcut:function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1?arguments[1]:void 0;return t.type===l.Hp.TOGGLE_ENABLE_SHORTCUT?t.payload:e},referer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return t.type===l.Hp.SET_REFERER?t.payload:e},xUDId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return t.type===l.Hp.SET_UDID?t.payload:e},mode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ssr",t=arguments.length>1?arguments[1]:void 0;return t.type===l.Hp.SET_MODE&&t.payload?t.payload:e},conf:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===l.Hp.UPDATE_CONF?(0,r._)({},e,t.payload):e},xTrafficFreeOrigin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if(t.type===l.Hp.UPDATE_TRAFFIC_FREE){var n=t.payload;return void 0===n?"":n}return e},ipInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===l.Hp.GET_IPINFO.success?t.payload:e},logged:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return t.type===l.Hp.UPDATE_LOGGED?t.payload:e},vars:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===l.Hp.SET_ENV_VARS?(0,r._)({},e,t.payload):e}}),d=n(68900),p=u},68900:function(e,t,n){"use strict";n.d(t,{H8:function(){return f},Hs:function(){return E},Hu:function(){return d},Kv:function(){return v},Uh:function(){return u},XE:function(){return _},Xj:function(){return C},cM:function(){return l},cq:function(){return m},dD:function(){return p},hV:function(){return y},nR:function(){return h},tQ:function(){return T}});var r=n(36695),o=n(31824),i=n(80714),a=n(66263),c=n(2493),s=n(58909),l=function(e){return e.env.edition},u=function(e){return e.env.userAgent},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.includeTablet,r=u(e),o=r.Mobile||r.iOS,i=r.Tablet;return void 0!==n&&n?o:o&&!i},p=function(e){return(0,r.useSelector)(function(t){return d(t,e)})},h=(0,o.P1)(u,function(e){return e.Zhihu||e.ZhihuHybrid}),f=(0,o.P1)(u,function(e){return!e.isBot}),_=(0,o.P1)(d,f,s.ib,function(e,t,n){return(t||!n)&&e});(0,o.P1)(_,l,function(e,t){return e&&t.baidu}),(0,o.P1)(_,l,function(e,t){return e&&t.sogouBeijing});var m=(0,o.P1)(_,l,function(e,t){return e&&!t.sogouBeijing&&!t.baidu&&!t.miniProgram}),v=function(e){return e.env.referer},g=["zhihu.com/special/19590770"],T=(0,c.Z)(function(e){return e.env.abV2.config.paramMap},function(e,t){return t},function(e,t){var n,r,o=t.paramId;return t.mock,null!==(r=null==e?void 0:null===(n=e[o])||void 0===n?void 0:n.value)&&void 0!==r?r:null}),E=function(e){var t=u(e).Mobile||i.Z.isMobileEntry;return"1"===T(e,{paramId:t?"ws_must_login":"ws_qiangzhisafe"})};function C(e){var t=e.env;return(null==t?void 0:t.trafficSource)==="office"}(0,o.P1)(m,function(e){return g.some(function(t){return e.env.referer.includes(t)})},function(e,t){return e&&!t});var y=function(e,t){var n,r=t.type,o=t.id;return!!a.o$[r]&&e.env.userAgent.Mobile&&(null===(n=a.o$[r])||void 0===n?void 0:n.includes(String(o)))}},35528:function(e,t,n){"use strict";n.d(t,{I3:function(){return _},NK:function(){return v},Vf:function(){return h},ZP:function(){return T},k1:function(){return m},n2:function(){return f},xb:function(){return d}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(74135),s=n(28953),l=n(39288),u=n(59523),d=(0,l.FH)("favlist",["GET_HOT_FAVLISTS","GET_CURRENT_USER_FAVLISTS","UPDATE_FOLLOWERS","UPDATE_FAVLIST_ITEM","ADD_FAVLIST"]),p=(0,l.co)("favlist",["UPDATE_FAV_RELATIONS"]);function h(e,t){var n=t.type,r=t.id;return function(t,o){return t({meta:{currentUser:o().currentUser,type:n,id:r},API:{types:d.ADD_FAVLIST,endpoint:"/collections",method:"POST",query:{include:"updated_time,answer_count,follower_count"},zsEncrypt:!0,bodyType:"json",body:(0,c.decamelizeKeys)(e)},schema:s.l.COLLECTION})}}function f(e,t){return function(n,r){var o=r(),i=o.currentUser,a=(o.favlists[i]||{}).paging,c=void 0===a?{}:a;return n({meta:{currentUser:i},API:{endpoint:c.next||"/collections/contents/".concat(e,"/").concat(t),types:d.GET_CURRENT_USER_FAVLISTS,query:c.next?void 0:{offset:0,limit:5}},schema:s.l.FAVLIST_ARRAY})}}function _(e,t){return function(n,o){var i=o(),a=i.entities.favlists,c=(0,u.ib)(i).id,s=a[e],l=t?1:-1;return n({API:{types:d.UPDATE_FOLLOWERS,endpoint:"collections/".concat(e,"/followers").concat(t?"":"/".concat(c)),method:t?"POST":"DELETE"},UPDATE:{request:{favlists:(0,r._)({},e,{followerCount:s.followerCount+l,isFollowing:t})},failure:{favlists:(0,r._)({},e,s)}}})}}var m=function(e){var t=e.contentId,n=e.contentType,r=e.relations;return{type:p.UPDATE_FAV_RELATIONS,contentId:t,contentType:n,payload:{relations:r}}};function v(e,t,n){return function(o,i){var a,s=i().entities.favlists[e].answerCount,l=null===(a=i().favlists.relations["".concat(n,"_").concat(t)])||void 0===a?void 0:a[e],u=l?{endpoint:"/collections/".concat(e,"/contents/").concat(t),method:"DELETE",query:(0,c.decamelizeKeys)({contentType:n})}:{endpoint:"/collections/".concat(e,"/contents"),method:"POST",query:(0,c.decamelizeKeys)({contentId:t,contentType:n})},p=u.endpoint,h=u.method,f=u.query;return o({API:{types:d.UPDATE_FAVLIST_ITEM,endpoint:p,method:h,query:f},meta:{contentType:n,contentId:t,collectionId:e,collected:!l},UPDATE:{request:function(){return{favlists:(0,r._)({},e,{answerCount:l?s-1:s+1})}},failure:function(){return{favlists:(0,r._)({},e,{answerCount:s})}}}})}}var g={isFetching:!1,isDrained:!1,ids:[],offset:0,limit:10};function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{relations:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d.ADD_FAVLIST.success:var n,c=t.meta,s=c.currentUser,l=c.type,u=c.id,h="".concat(l,"_").concat(u);return(0,i._)((0,o._)({},e),(n={},(0,r._)(n,s,(0,i._)((0,o._)({},e[s]),{ids:[t.payload.collection.id].concat((0,a._)(e[s].ids))})),(0,r._)(n,"relations",(0,i._)((0,o._)({},e.relations),(0,r._)({},h,(0,i._)((0,o._)({},e.relations[h]),(0,r._)({},t.payload.collection.id,!1))))),n));case d.GET_CURRENT_USER_FAVLISTS.request:var f=t.meta.currentUser;return(0,i._)((0,o._)({},e),(0,r._)({},f,(0,i._)((0,o._)({},g,e[f]),{isFetching:!0,isDrained:!1})));case d.GET_CURRENT_USER_FAVLISTS.success:var _=t.result,m=t.meta.currentUser,v=t.payload,T=_.filter(function(t){return!e[m].ids.includes(t)});return(0,i._)((0,o._)({},e),(0,r._)({},m,(0,i._)((0,o._)({},g,e[m]),{isFetching:!1,ids:(0,a._)(e[m].ids).concat((0,a._)(T)),isDrained:v.paging.isEnd,paging:v.paging})));case d.GET_CURRENT_USER_FAVLISTS.failure:var E=t.meta.currentUser;return(0,i._)((0,o._)({},e),(0,r._)({},E,(0,i._)((0,o._)({},e[E]),{isFetching:!1})));case p.UPDATE_FAV_RELATIONS:var C=t.contentId,y=t.contentType,S=t.payload,I="".concat(y,"_").concat(C);return(0,i._)((0,o._)({},e),{relations:(0,i._)((0,o._)({},e.relations),(0,r._)({},I,(0,o._)({},e.relations[I],S.relations)))});case d.UPDATE_FAVLIST_ITEM.success:var b=t.meta,A=b.contentId,Z=b.contentType,w=b.collectionId,R=b.collected,N="".concat(Z,"_").concat(A);return(0,i._)((0,o._)({},e),{relations:(0,i._)((0,o._)({},e.relations),(0,r._)({},N,(0,i._)((0,o._)({},e.relations[N]),(0,r._)({},w,R))))});default:return e}}},25364:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(15030),o=n(55164);function i(e,t){var n=(0,o._)({},e);return Object.keys(t).forEach(function(e){var i=(0,o._)({},n[e]),a=t[e]||{};Object.keys(a).forEach(function(e){var t=a[e],n=(0,o._)({},i[e]);if(t&&"object"==typeof t){var c=!0,s=!1,l=void 0;try{for(var u,d=Object.keys(t)[Symbol.iterator]();!(c=(u=d.next()).done);c=!0){var p=u.value,h=n[p],f=t[p];!Array.isArray(h)&&(0,r._)(h,Object)&&(0,r._)(f,Object)?n[p]=(0,o._)({},h,f):n[p]=f}}catch(e){s=!0,l=e}finally{try{c||null==d.return||d.return()}finally{if(s)throw l}}i[e]=n}else i[e]=t}),n[e]=i}),n}},45347:function(e,t,n){"use strict";n.d(t,{ZP:function(){return f},qS:function(){return u.q}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(93206),s=n(39288);n(74135);var l=(0,s.FH)("host",["GET_USER_PERMISSIONS","UPDATE_ROUNDTABLE_SUBJECT","GET_ROUNDTABLE_SUBJECT","GET_ROUNDTABLE_APPLICATIONS","GET_ONLINE_ROUNDTABLES","UPDATE_ROUNDTABLE_APPLY","CREATE_ROUNDTABLE_APPLY","GET_ROUNDTABLE_APPLY","GET_ROUNDTABLE_DETAIL","GET_ROUNDTABLE_INCLUDEDRESOURCE","GET_ROUNDTABLE_HOT_QUESTIONS","UPDATE_HIDDEN_ROUNDTABLE_INCLUDEDRESOURCE","UPDATE_ROUNDTABLE_INCLUDERESOURCE","TOGGLE_ROUNDTABLE_HOT_QUESTION_HIDDEN","POST_ROUNDTABLE_INCLUDEDRESOURCE","ADD_ROUNDTABLE_HOT_QUESTIONS","UPDATE_ROUNDTABLE_HOT_QUESTION","SEARCH_ROUNDTABLE_INCLUDED_RESOURCE","BATCH_ADD_ROUNDTABLE_INCLUDED_RESOURCE","GET_ROUNDTABLE_WARMUP_CONTENTS","TOGGLE_WARMUP_CONTENT_HIDDEN","SET_WARMUP_CONTENT_WEIGHT","GET_SPECIAL_APPLICATIONS","GET_SPECIAL_APPLY_CENSOR_HISTORY","GET_SPECIAL_DRAFT","SAVE_SPECIAL_DRAFT","SUBMIT_SPECIAL_APPLY"]),u=n(42412),d=n(44808),p=(0,c.combineReducers)({subjects:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===l.GET_ROUNDTABLE_SUBJECT.success){var n=t.payload.data;return(0,i._)((0,o._)({},e),(0,r._)({},n.id,n))}return e},applications:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{total:0},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,o=t.meta;return n===l.GET_ROUNDTABLE_APPLICATIONS.success?(0,u.q)(e,o.current,r):e},online:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{total:0},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,o=t.meta;return n===l.GET_ONLINE_ROUNDTABLES.success?(0,u.q)(e,o.current,r):e},applies:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===l.GET_ROUNDTABLE_APPLY.success){var n=t.payload.data;return(0,i._)((0,o._)({},e),(0,r._)({},n.id,n))}return e},details:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.meta,a=t.payload;return t.type===l.GET_ROUNDTABLE_DETAIL.success?(0,i._)((0,o._)({},e),(0,r._)({},n.id,a.data)):e},includedResource:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload,s=t.meta;if(n===l.GET_ROUNDTABLE_INCLUDEDRESOURCE.success)return(0,i._)((0,o._)({},e),(0,r._)({},s.id,(0,o._)({},e[s.id],(0,u.q)(e[s.id]||{},s.current,c,{dataKey:"objectId"}))));if(n===l.UPDATE_HIDDEN_ROUNDTABLE_INCLUDEDRESOURCE.success)return(0,d.Uy)(e,function(e){e[s.id].entities[s.objectId].isDeleted=s.isDeleted});if(n===l.UPDATE_ROUNDTABLE_INCLUDERESOURCE.success)return(0,d.Uy)(e,function(e){Object.assign(e[s.id].entities[s.resource.objectId],s.body)});if(n===l.POST_ROUNDTABLE_INCLUDEDRESOURCE.success){var p=t.payload.payload;if(p){var h=p.objectId;return(0,d.Uy)(e,function(e){e[s.id].pages[1]=e[s.id].pages[1]?[h].concat((0,a._)(e[s.id].pages[1])):[h],e[s.id].entities[h]=p})}}return e},hotQuestions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,c=t.meta;return n===l.GET_ROUNDTABLE_HOT_QUESTIONS.success?(0,i._)((0,o._)({},e),(0,r._)({},c.id,(0,o._)({},e[c.id],(0,u.q)(e[c.id]||{},c.current,a,{dataKey:"question.id"})))):n===l.TOGGLE_ROUNDTABLE_HOT_QUESTION_HIDDEN.success?(0,d.Uy)(e,function(e){e[c.id].entities[c.questionId].isDeleted=c.isDeleted}):n===l.UPDATE_ROUNDTABLE_HOT_QUESTION.success?(0,d.Uy)(e,function(e){Object.assign(e[c.id].entities[c.question.id],c.body)}):e},warmupContents:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,c=t.meta;return n===l.GET_ROUNDTABLE_WARMUP_CONTENTS.success?(0,i._)((0,o._)({},e),(0,r._)({},c.roundtableId,(0,o._)({},e[c.roundtableId],(0,u.q)(e[c.roundtableId]||{},c.current,a,{dataKey:"id"})))):n===l.TOGGLE_WARMUP_CONTENT_HIDDEN.success?(0,d.Uy)(e,function(e){e[c.roundtableId].entities[c.contentId].isDeleted=c.isDeleted}):n===l.SET_WARMUP_CONTENT_WEIGHT.success?(0,d.Uy)(e,function(e){e[c.roundtableId].entities[c.contentId].weight=c.weight}):e},batchInclude:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,c=t.meta;return n===l.SEARCH_ROUNDTABLE_INCLUDED_RESOURCE.success?(0,i._)((0,o._)({},e),(0,r._)({},c.id,(0,o._)({},e[c.id],(0,u.q)(e[c.id]||{},c.current,a)))):e}}),h=(0,c.combineReducers)({applications:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{total:0,pages:{},entities:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.meta,o=t.payload;return n===l.GET_SPECIAL_APPLICATIONS.success?(0,u.q)(e,r.current,{total:o.paging.total,data:o.data}):e},censorHistory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.meta,c=t.payload;return n===l.GET_SPECIAL_APPLY_CENSOR_HISTORY.success?(0,i._)((0,o._)({},e),(0,r._)({},a.draftId,c.data)):e},drafts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;return n===l.GET_SPECIAL_DRAFT.success?(0,i._)((0,o._)({},e),(0,r._)({},a.draftId,a)):e}}),f=(0,c.combineReducers)({roundtable:p,special:h})},42412:function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var r=n(87320),o=n(55164),i=n(57477),a=n(76931),c=n.n(a),s=function(e,t,n){var a,s=n.total,l=n.data,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},d=u.dataKey,p=void 0===d?"id":d,h=u.pagesKey,f=void 0===h?"pages":h,_=u.entitiesKey,m=void 0===_?"entities":_,v=u.totalKey,g=void 0===v?"total":v,T=l.map(function(e,n){return"index"===p?"".concat(t,"-").concat(n):c()(e,p)});return(0,i._)((0,o._)({},e),(a={},(0,r._)(a,g,s),(0,r._)(a,m,T.reduce(function(e,t,n){return e[t]=l[n],e},(0,o._)({},e[m]||{}))),(0,r._)(a,f,(0,i._)((0,o._)({},e[f]),(0,r._)({},t,T))),a))}},50605:function(e,t,n){"use strict";n.d(t,{k:function(){return o}});var r=(0,n(39288).FH)("interactText",["GET_INTERACT_TEXT"]);function o(e,t){return{API:{types:r.GET_INTERACT_TEXT,endpoint:"/".concat(e,"/").concat(t,"/segments")},FAILSAFE:!0}}},10416:function(e,t,n){"use strict";n.d(t,{T$:function(){return l},ZP:function(){return u},yM:function(){return s}});var r=n(87320),o=n(55164),i=n(57477),a=n(39288),c=(0,o._)({},(0,a.FH)("label",["GET"])),s=function(e,t){return t&&e.label["".concat(t.type,"_").concat(t.id)]};function l(e,t){return{itemType:e,id:t,API:{types:c.GET,endpoint:"/".concat(e,"s/").concat(t,"/labels/v2")}}}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===c.GET.success){var n=t.id,a=t.itemType,s=t.payload;e=(0,i._)((0,o._)({},e),(0,r._)({},"".concat(a,"_").concat(n),s))}return e}},69906:function(e,t,n){"use strict";n.d(t,{VZ:function(){return r.VZ},W2:function(){return r.W2},kf:function(){return i},Fd:function(){return r.Fd},QT:function(){return r.QT},TS:function(){return r.TS},V6:function(){return r.V6}});var r=n(98104),o=n(87320),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.itemsKey,r=void 0===n?"items":n;return e||(0,o._)({isFetching:!1,isDrained:!1},r,[])}},98104:function(e,t,n){"use strict";n.d(t,{Fd:function(){return f},QT:function(){return g},TS:function(){return v},V6:function(){return _},VZ:function(){return d},W2:function(){return p}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(75472),s=n.n(c),l=n(23391),u=n.n(l),d=10,p=5;function h(e){return e.id}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.mapActionToKey,c=void 0===n?h:n,s=t.additionalCase,l=t.additionalCaseTypes,u=t.addSuccessType,d=void 0===u?"addSuccessType does not exist":u,p=t.addAtTop,f=void 0===p||p,_=function(){var e,t,n,r,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,ids:[],newIds:[],totals:0,antiSpider:!1},l=arguments.length>1?arguments[1]:void 0;switch(l.type){case m:return(0,i._)((0,o._)({},c),{isFetching:!0,error:!1,antiSpider:!1});case v:var u=c.ids,p=(l.result||[]).filter(function(e){return!e||!u.includes(e)}),h=l.isPrevious,_=l.isPrevDrained,T=l.isDrained,E=l.previous,C=l.next,y=l.totals,S=l.payload,I=l.needForceLogin,b=null,A=l.rootComment,Z=l.topComments;b=A&&Z?h?(0,a._)(p).concat((0,a._)(u)):[A].concat((0,a._)(Z.result),(0,a._)(u),(0,a._)(p)):h?(0,a._)(p).concat((0,a._)(u)):(0,a._)(u).concat((0,a._)(p));var w=h||!u.length,R=!h||!u.length;return(0,o._)((0,i._)((0,o._)((0,i._)((0,o._)({},c),{emptyText:(null==S?void 0:S.emptyText)||"",filterItems:null==S?void 0:S.filterItems,isFetching:!1,totals:y,topComments:Z,ids:b,newIds:l.result,needForceLogin:I||!1}),w?{isPrevDrained:_,previous:E}:{},R?{isDrained:T,next:C}:{}),{error:!1,sensitiveLevel:null==S?void 0:S.sensitiveLevel,warning:null==S?void 0:S.warning,warningBox:null==S?void 0:S.warningBox,warnNotes:null==S?void 0:S.warnNotes,antiSpider:!1}),(null==S?void 0:S.session)?{sessionId:S.session.id}:{});case g:if((null===(e=l.err)||void 0===e?void 0:null===(t=e.payload)||void 0===t?void 0:t.code)===101&&(null===(n=l.err)||void 0===n?void 0:null===(r=n.payload)||void 0===r?void 0:r.message)==="ZERR_NOT_LOGIN")return(0,i._)((0,o._)({},c),{isFetching:!1,isDrained:!0,error:!1,antiSpider:!0,ids:[]});return(0,i._)((0,o._)({},c),{isFetching:!1,isDrained:!0,error:!0,antiSpider:!1});case d:return"commercial"===l.question.questionType?c:(0,i._)((0,o._)({},c),{totals:c.totals+1,ids:f?[l.result].concat((0,a._)(c.ids)):(0,a._)(c.ids).concat([l.result]),newIds:f?[l.result].concat((0,a._)(c.newIds)):(0,a._)(c.newIds).concat([l.result])});default:if(s)return s(c,l);return c}},m=e.request,v=e.success,g=e.failure,T=(0,a._)(Object.values(e)).concat((0,a._)(void 0===l?[]:l),[d]);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(T.includes(t.type)){var n=c(t);if(void 0!==n)return(0,i._)((0,o._)({},e),(0,r._)({},n,_(e[n],t)))}return e}}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.mapActionToKey,c=void 0===n?h:n,s=t.additionalCase,l=t.additionalCaseTypes,u=t.addSuccessType,d=void 0===u?"addSuccessType does not exist":u,p=t.addAtTop,f=void 0===p||p,_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{error:void 0,isLoadedOnce:!1,isDrained:!1,isFetching:!1,ids:[],totals:0},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.offset;switch(n){case m:return(0,i._)((0,o._)({},e),{isFetching:!0});case v:var c=t.totals,l=t.isDrained,u=t.result,p=t.limit,h=void 0===p?20:p,_=e.ids,T=(void 0===u?[]:u).filter(function(e){return!_.includes(e)}),E=_.slice(r,r+h).filter(Boolean),C=h-E.length-T.length,y=(0,a._)(E).concat((0,a._)(T),(0,a._)(C<=0?[]:Array.from({length:C}).map(function(){return!1}))),S=c||_.length+T.length;return _.length=S,(0,i._)((0,o._)({},e),{isDrained:l,isLoadedOnce:!0,isFetching:!1,ids:(0,a._)(_.slice(0,r)).concat((0,a._)(y),(0,a._)(_.slice(r+y.length))).slice(0,S),totals:c});case g:var I=t.limit,b=e.ids;return(0,i._)((0,o._)({},e),{error:Error(),isLoadedOnce:!0,isFetching:!1,isDrained:!0,ids:(0,a._)(b.slice(0,r)).concat((0,a._)(Array.from({length:I}).map(function(){return!1})))});case d:var A=e.ids,Z=e.totals;return(0,i._)((0,o._)({},e),{totals:Z+1,ids:f?[t.result].concat((0,a._)(A)):(0,a._)(A).concat([t.result])});default:if(s)return s(e,t);return e}},m=e.request,v=e.success,g=e.failure,T=(0,a._)(Object.values(e)).concat((0,a._)(void 0===l?[]:l),[d]);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(T.includes(t.type)){var n=c(t);if(void 0!==n)return(0,i._)((0,o._)({},e),(0,r._)({},n,_(e[n],t)))}return e}}function m(e,t){if(Array.isArray(e))return e.concat(t)}var v=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return u().apply(void 0,[{}].concat((0,a._)(t),[m]))};function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.defaultState,a=t.mergeState,c=void 0===a?function(e,t){var n=e.items,r=t.result;return{items:n&&n.length?r.filter(function(e){return!n.find(function(t){return s()(t,e)})}):r,next:t.next}}:a,l=t.additionCase,u=t.keySelector,d=void 0===u?function(e){return e.id}:u,p=(0,o._)({isFetching:!1,isDrained:!1},n);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case e.request:return v(t,(0,r._)({},d(n),(0,i._)((0,o._)({},p),{isFetching:!0})));case e.success:var a=d(n),s=(n.payload||{}).paging,u=(void 0!==s&&s).isEnd;return v(t,(0,r._)({},a,(0,o._)({isFetching:!1,isDrained:u},c(t[a],n))));case e.failure:return v(t,(0,r._)({},d(n),{isFetching:!1,isDrained:!0}));default:if(l)return l(t,n);return t}}}},63315:function(e,t,n){"use strict";n.d(t,{L1:function(){return E},O:function(){return f},S7:function(){return g},Yu:function(){return m},ZP:function(){return S},gf:function(){return C},qo:function(){return _},uJ:function(){return T},zq:function(){return v}});var r=n(55164),o=n(57477),i=n(54231),a=n(74135),c=n(80714),s=n(4785),l=n(54826),u=n(66263),d=n(39288),p=n(67927),h=(0,r._)({},(0,d.FH)("login",["DIGITS","LOGIN","VALIDATE_LOGIN_FORM","VALIDATE_LOGIN_DIGITS","GET_WECHAT_SOCIAL_INFO","SMS_IDENTIFY"]),(0,d.co)("login",["RESET_LOGIN_VALIDATE_RESULT"]),(0,d.FH)("qrcodeLogin",["TOKEN","SCAN_STATUS"]));function f(e){return{API:{types:h.SMS_IDENTIFY,endpoint:"v3/oauth/guardians/verify",query:{phone_no:e}}}}function _(e){return{API:{types:h.SMS_IDENTIFY,endpoint:"v3/oauth/guardians/verify",method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,s.Z)({phone_no:e})}}}}function m(e,t){var n={phoneNo:e};return t&&(n.smsType=t),function(e){return e({API:{types:h.DIGITS,endpoint:"v3/oauth/sign_in/digits",method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,s.Z)((0,a.decamelizeKeys)(n))}}}).then(null,function(t){t&&t.err&&120001===t.err.payload.code&&e((0,p.c0)("页面已过期，请刷新重试","red"))})}}function v(e){return function(t){return t({API:{types:h.LOGIN,endpoint:"v3/oauth/sign_in",method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,s.Z)((0,a.decamelizeKeys)(e))}},NOTIFICATION:!1}).catch(function(n){if(null==n?void 0:n.payload){var r=n.payload,o=r.code,a=r.message;if(null==e?void 0:e.refreshToken){(0,l.qz)(),i.ZP.increment("token.error.refresh.".concat(o));return}return t((0,p.c0)(120001===o?"页面已过期，请刷新重试":a,"red"))}})}}function g(){return{type:h.RESET_LOGIN_VALIDATE_RESULT}}function T(e){return function(t){return(t(g()),"digits"===e.grantType)?(e.phoneNo=e.username,t({API:{types:h.VALIDATE_LOGIN_DIGITS,endpoint:"v3/oauth/validate/sign_in/digits",method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,s.Z)((0,a.decamelizeKeys)(e))}}}).then(function(n){if(n&&n.payload&&n.payload.success)return t(v(e))})):t(v(e))}}function E(){return function(e){return e({API:{types:h.TOKEN,root:c.Z.fetchRoot.www,endpoint:"/api/v3/account/api/login/qrcode",method:"POST",fetchOptions:{credentials:"include"}},NOTIFICATION:!1})}}function C(e){var t=e.token;return function(e){return e({API:{root:c.Z.fetchRoot.www,types:h.SCAN_STATUS,endpoint:"/api/v3/account/api/login/qrcode/".concat(t,"/scan_info"),method:"GET",fetchOptions:{credentials:"include"}},NOTIFICATION:!1})}}var y={loginUnregisteredError:!1,loginBindWechatError:!1,loginConfirmError:null,sendDigitsError:null,needSMSIdentify:!1,validateDigitsError:!1,loginConfirmSucceeded:null,qrcodeLoginToken:"",qrcodeLoginScanStatus:0,qrcodeLoginError:null,qrcodeLoginReturnNewToken:!1};function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0,n=t.type;if(n===h.RESET_LOGIN_VALIDATE_RESULT)return(0,o._)((0,r._)({},y),{qrcodeLoginToken:e.qrcodeLoginToken,qrcodeLoginScanStatus:e.qrcodeLoginScanStatus,qrcodeLoginError:e.qrcodeLoginError,qrcodeLoginReturnNewToken:e.qrcodeLoginReturnNewToken});if(n===h.LOGIN.success){var i=(null==t?void 0:t.payload)||{},a=i.verification,c=i.refreshToken;return c&&(0,l.ZP)(c),(0,o._)((0,r._)({},e),{loginConfirmSucceeded:!0,verification:a})}if(n===h.LOGIN.failure){var s=t.err.payload;return(0,o._)((0,r._)({},e),{loginConfirmSucceeded:!1,loginUnregisteredError:s.code===u.fH,loginBindWechatError:100077===s.code,loginConfirmError:(0,r._)({},e.loginConfirmError,(0,d.O1)(s))})}if(n===h.DIGITS.failure)return(0,o._)((0,r._)({},e),{sendDigitsError:(0,r._)({},e.sendDigitsError,(0,d.O1)(t.err.payload)),needSMSIdentify:410001===t.err.payload.code});if(n===h.VALIDATE_LOGIN_DIGITS.failure)return(0,o._)((0,r._)({},e),{loginConfirmError:(0,r._)({},e.loginConfirmError,(0,d.O1)(t.err.payload))});if(n===h.VALIDATE_LOGIN_DIGITS.success)return t.payload.success?e:(0,o._)((0,r._)({},e),{loginConfirmError:(0,o._)((0,r._)({},e.loginConfirmError),{validateDigitsError:"验证码填写错误"})});if(n===h.TOKEN.failure||n===h.SCAN_STATUS.failure)return(0,o._)((0,r._)({},e),{qrcodeLoginError:t.err.payload});if(n===h.TOKEN.success)return(0,o._)((0,r._)({},e),{qrcodeLoginToken:t.payload.token,qrcodeLoginTokenExpires:t.payload.expiresAt,qrcodeLoginError:null});if(n===h.SCAN_STATUS.success){var p={qrcodeLoginError:null};return t.payload.accessToken?p.loginConfirmSucceeded=!0:(t.payload.newToken&&t.payload.newToken.token&&(p.qrcodeLoginReturnNewToken=!0),p.qrcodeLoginScanStatus=t.payload.status,p.qrcodeLoginToken=t.payload.newToken&&t.payload.newToken.token||e.qrcodeLoginToken,p.qrcodeLoginTokenExpires=t.payload.newToken&&t.payload.newToken.expiresAt||e.qrcodeLoginTokenExpires),(0,r._)({},e,p)}return e}},71240:function(e,t,n){"use strict";n.d(t,{ZP:function(){return d},ko:function(){return l}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899);n(74135),n(58909);var c=n(39288),s=(0,o._)({},(0,c.FH)("mcn",["AGREE_CONTRACT","AGREE_TARGET_SOURCE_CONTRACT","GET_BIND_INFO","SET_BIND_INFO","SET_PINDUODUO_BIND_INFO","REMOVE_BIND_INFO","GET_MEMBER_CATEGORY","SET_MEMBER_CATEGORY","GET_PRODUCER","GET_CATEGORY","GET_SECONDARY_CATEGORY","SEARCH_GOOD","GET_TAOBAO_GOOD","GENERATE_LINK_CARD","UPDATE_LINK_CARD","GET_HOT_CITIES","SEARCH_CITY","GET_CITY_DISTRICTS","LOAD_LIST","LOAD_MCN_PERMISSION","GET_LINK_CARD_URL","LOAD_MCN_BANNER","GET_MCN_QUESTION_RECOMMEND_TABS","GET_MCN_QUESTION_RECOMMEND_LIST","LOAD_REDPACKET","GET_MEMBER_STATUS"]),(0,c.co)("mcn",["CLEAN_CATEGORY","REMOVE_RECENT_ADDED_GOODS"]));function l(e){return{API:{types:s.UPDATE_LINK_CARD,endpoint:"/mcn/linkcard/".concat(e.id),method:"PUT",body:{title:e.title}}}}var u={bindInfo:{},memberCategoryList:[],producerList:[],categoryList:[],lists:{},banners:{},protocolStatus:{isAgreedNew:!0,isAgreedOld:!0},probationCountdownDays:0};function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;if(t.type===s.GET_BIND_INFO.success){var n=t.meta.source;return(0,i._)((0,o._)({},e),{bindInfo:(0,i._)((0,o._)({},e.bindInfo),(0,r._)({},n,t.payload))})}if(t.type===s.SET_BIND_INFO.success){var c=t.meta,l=c.source,d=c.pid;return(0,i._)((0,o._)({},e),{bindInfo:(0,i._)((0,o._)({},e.bindInfo),(0,r._)({},l,(0,i._)((0,o._)({},e.bindInfo[l]),{pid:d})))})}if(t.type===s.SET_PINDUODUO_BIND_INFO.success){var p=t.payload.pid;return(0,i._)((0,o._)({},e),{bindInfo:(0,i._)((0,o._)({},e.bindInfo),{pinduoduo:(0,i._)((0,o._)({},e.bindInfo.pinduoduo),{pid:p})})})}if(t.type===s.REMOVE_BIND_INFO.success){var h=t.meta.source;return(0,i._)((0,o._)({},e),{bindInfo:(0,i._)((0,o._)({},e.bindInfo),(0,r._)({},h,(0,i._)((0,o._)({},e.bindInfo[h]),{pid:"",store:{}})))})}if(t.type===s.GET_MEMBER_CATEGORY.success)return(0,i._)((0,o._)({},e),{memberCategoryList:t.payload.data});if(t.type===s.SET_MEMBER_CATEGORY.success){var f=t.meta.categoryList;return(0,i._)((0,o._)({},e),{memberCategoryList:f})}if(t.type===s.GET_PRODUCER.success)return(0,i._)((0,o._)({},e),{producerList:t.payload.data});if(t.type===s.CLEAN_CATEGORY)return(0,i._)((0,o._)({},e),{categoryList:[]});if(t.type===s.GET_CATEGORY.success)return(0,i._)((0,o._)({},e),{categoryList:t.payload.data});if(t.type===s.GET_SECONDARY_CATEGORY.success){var _=t.meta.categoryId;return(0,i._)((0,o._)({},e),{categoryList:e.categoryList.map(function(e){return e.id===_?(0,i._)((0,o._)({},e),{categoryList:t.payload.data}):e})})}if(t.type===s.LOAD_LIST.request){var m=t.meta.key;return(0,i._)((0,o._)({},e),{lists:(0,i._)((0,o._)({},e.lists),(0,r._)({},m,(0,i._)((0,o._)({},e.lists[m]),{isLoading:!0})))})}if(t.type===s.LOAD_LIST.success){var v=t.meta.key,g=t.payload,T=g.data,E=g.paging,C=E.next,y=E.isEnd;return(0,i._)((0,o._)({},e),{lists:(0,i._)((0,o._)({},e.lists),(0,r._)({},v,{data:(0,a._)(e.lists[v].data||[]).concat((0,a._)(T)),paging:{next:C,isEnd:y},isLoading:!1}))})}if(t.type===s.LOAD_LIST.failure){var S=t.meta.key;return(0,i._)((0,o._)({},e),{lists:(0,i._)((0,o._)({},e.lists),(0,r._)({},S,(0,i._)((0,o._)({},e.lists[S]),{isLoading:!1})))})}if(t.type===s.REMOVE_RECENT_ADDED_GOODS){var I,b,A=t.meta.skuid,Z=e.lists.recentAddedGoods;return Z?(0,i._)((0,o._)({},e),{lists:(0,i._)((0,o._)({},e.lists),{recentAddedGoods:(0,i._)((0,o._)({},Z),{data:null!==(b=null===(I=Z.data)||void 0===I?void 0:I.filter(function(e){return e.skuid!==A}))&&void 0!==b?b:[]})})}):e}if(t.type===s.LOAD_MCN_BANNER.success){var w=t.meta.stateKey,R=t.payload.data;return(0,i._)((0,o._)({},e),{banners:(0,i._)((0,o._)({},e.banners),(0,r._)({},w,R))})}if(t.type===s.AGREE_CONTRACT.success)return(0,i._)((0,o._)({},e),{protocolStatus:(0,i._)((0,o._)({},e.protocolStatus),{isAgreedNew:!0})});if(t.type===s.GET_MEMBER_STATUS.success){var N=t.payload,k=N.isAgreed,O=N.previousIsAgreed;return(0,i._)((0,o._)({},e),{protocolStatus:{isAgreedNew:k,isAgreedOld:O}})}if(t.type===s.LOAD_MCN_PERMISSION.success){var x=t.payload.probationCountdownDays;return(0,i._)((0,o._)({},e),{probationCountdownDays:x||0})}return e}},38030:function(e,t,n){"use strict";n.d(t,{EV:function(){return g},Lw:function(){return T},fg:function(){return E},nB:function(){return C}});var r,o,i,a,c,s,l=n(87320),u=n(55164),d=n(57477),p=n(49899);n(74135);var h=n(93206),f=n(28953),_=n(58909),m=n(39288),v=(0,u._)({},(0,m.FH)("message",["GET_INBOXES","ADD","MARK_READ","UPDATE_COMMENTPERMISSION","UPDATE_RESHIPMENTSETTINGS"]),(0,m.co)("message",["CURRENT_TAB","INBOX_UNREAD_COUNT"]));function g(e){return function(t,n){var r=n(),o=r.messages,i=r.messages.currentTab,a=(!e&&o.data[i]||{}).next;return t({reFetch:e,currentTab:i,API:{types:v.GET_INBOXES,endpoint:a||("stranger"===i?"stranger_inbox":"inbox")},schema:f.l.MESSAGE_ARRAY})}}function T(e){return{currentTab:e,type:v.CURRENT_TAB}}function E(){return function(e,t){var n=t(),r=n.entities.messages,o=n.messages,i=o.currentTab,a=o.data[i].ids.filter(function(e){return r[e].unreadCount>0});return a.length?e({API:{types:v.MARK_READ,endpoint:"messages/actions/mark-as-read",method:"POST",body:{type:i,tokens:a}}}):null}}function C(e){var t=e.event_name,n=e.data;if("INBOX_UNREAD_COUNT"===t)return{type:v.INBOX_UNREAD_COUNT,payload:n}}t.ZP=(0,h.combineReducers)({data:(r=v.GET_INBOXES,o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i:if(t.reFetch)return s;return(0,d._)((0,u._)({},e),{isFetching:!0});case a:var n=t.result,r=t.next,o=t.isDrained,l=e.ids;return(0,d._)((0,u._)({},e),{isFetching:!1,isDrained:o,next:r,ids:(0,p._)(l).concat((0,p._)(n.filter(function(e){return!l.includes(e)})))});case c:return(0,d._)((0,u._)({},e),{isFetching:!1,isDrained:!0});default:return e}},i=r.request,a=r.success,c=r.failure,s={isFetching:!1,isDrained:!1,ids:[]},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.currentTab;switch(n){case i:case a:case c:return(0,d._)((0,u._)({},e),(0,l._)({},r,o(e[r],t)));default:return e}}),currentTab:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common",t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.currentTab;return n===v.CURRENT_TAB?r:e},messageCount:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===v.INBOX_UNREAD_COUNT?r:n===_.Hp.GET.success?t.payload.messagesCount:e}})},67927:function(e,t,n){"use strict";n.d(t,{V8:function(){return s},XR:function(){return p},ZP:function(){return T},_X:function(){return _},c0:function(){return m},zQ:function(){return l}});var r=n(87320),o=n(55164),i=n(57477),a=n(31824),c=(0,n(39288).co)("notification",["SHOW","CLEAR"]),s="global",l="comment",u="askQuestion",d="editQuestion",p="出错了！请稍后再试。",h={},f=[s,u,d,l],_=(0,a.P1)(function(e){return e.notification},function(e){return f.reduce(function(t,n){var r=e[n];return!t&&r||r&&r.timestamp>t.timestamp?r:t},null)});function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"white",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s,r=arguments.length>3?arguments[3]:void 0;return{type:c.SHOW,NOTIFICATION:{key:n,text:e,theme:t,zaProps:r}}}function v(e){return e.err?e.err.payload:e.result?e.result.error:null}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p,n=e||{},r=n.code,o=n.message;return h[r]||o||t}function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.requestMethod,p=t.NOTIFICATION;if(n===c.CLEAR){var h=p.key;return(0,i._)((0,o._)({},e),(0,r._)({},h,null))}if(p&&!0!==p){var f=p.text,_=p.theme,m=p.success,T=p.failure,E=p.key,C=void 0===E?s:E,y=p.zaProps;if(f&&_)return(0,i._)((0,o._)({},e),(0,r._)({},C,{text:f,theme:_,timestamp:Date.now(),zaProps:y}));if(m&&n.endsWith("success")){var S="function"==typeof m?m(t.payload):m;return(0,i._)((0,o._)({},e),(0,r._)({},C,(0,o._)({text:"string"==typeof S&&S,theme:"white",timestamp:Date.now(),zaProps:y},S)))}if(T&&n.endsWith("failure")){var I=v(t),b="function"==typeof T?T(I,t):T;if(!b)return e;var A=g(I,b);return(0,i._)((0,o._)({},e),(0,r._)({},C,(0,o._)({text:A,theme:C===l||C===u||C===d?"red-ghost":"red",timestamp:Date.now(),zaProps:y},b)))}return e}if(!1!==p&&n.endsWith("failure")&&"GET"!==(void 0===a?"GET":a)){var Z=g(v(t));return(0,i._)((0,o._)({},e),(0,r._)({},s,{text:Z,theme:"red",timestamp:Date.now()}))}return e}},6438:function(e,t,n){"use strict";n.d(t,{Gm:function(){return F},J2:function(){return G},R8:function(){return H},XD:function(){return z},_u:function(){return R},cR:function(){return U},ck:function(){return N},eB:function(){return B},hr:function(){return w},t:function(){return Z}});var r=n(87320),o=n(55164),i=n(57477),a=n(71728),c=n(49899),s=n(74135),l=n(84),u=n(93206),d=n(28953),p=n(46467),h=n(44900),f=n(84054),_=n.n(f),m=n(80714),v=n(39288),g=n(25809),T=n(10886),E=n(69906),C=n(40195),y=n(76741),S=n(28814),I=new l.fK.Array(d.l.ZVIDEO),b=(0,o._)({},(0,v.FH)("people",["GET","GET_MEMBER","GET_ACTIVITIES","GET_PUBLICATIONS","GET_ANSWERS","GET_ANSWERS_SORT_BY_VOTES","GET_ANSWERS_INCLUDED","GET_ZVIDEOS","GET_ARTICLES","GET_ARTICLES_SORT_BY_VOTES","GET_ARTICLES_INCLUDED","GET_PINS","GET_COLUMNS","GET_QUESTIONS","GET_COMMERCIAL_QUESTIONS","GET_FAVLISTS","GET_FOLLOWINGS","GET_FOLLOWERS","GET_FOLLOWING_COLUMNS","GET_FOLLOWING_QUESTIONS","GET_FOLLOWING_FAVLISTS","GET_FOLLOWING_TOPICS","GET_RELATIONS_VOTED","GET_RELATIONS_THANKED","GET_VOTE_ANSWERS","GET_VOTED_ANSWERS","GET_THANK_ANSWERS","GET_THANKED_ANSWERS","GET_IKNOW_FOLLOWERS","GET_TOPIC_ANSWERS","GET_ALL_FAVLISTS","GET_BRANDS","GET_CREATIONS","GET_CREATIONS_SORT_BY_VOTES","GET_CREATIONS_FEED","GET_INFINITY_INFO","UPDATE","UPDATE_SHIELD","DELETE_COLUMN","GET_BATCH_USERS","GET_PROFILE_INFINITY"]),(0,v.co)("people",["CHANGE_ANSWER_ORDER","CHANGE_ARTICLE_ORDER","CHANGE_ANSWERS_TOPIC","MARK_USER_STATUS","CLEAR_CREATION_FEED","TOGGLE_USER_BLOCKING"]));function A(e,t){var n=("string"==typeof t?{include:t}:t)||{},r=n.include,i=n.types,c=(0,a._)(n,["include","types"]);return(0,o._)({API:{types:i||b.GET_MEMBER,endpoint:"members/".concat(encodeURIComponent(e)),query:{include:r}},schema:d.l.USER},c)}function Z(e,t){return{type:b.TOGGLE_USER_BLOCKING,UPDATE:{update:{users:(0,r._)({},e,{isBlocking:t})}}}}function w(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2?arguments[2]:void 0;return function(o){return o(A(e,{include:"juror,locations,employments,gender,educations,business,mcn_company,voteup_count,thanked_Count,follower_count,following_count,cover_url,following_topic_count,following_question_count,following_favlists_count,following_columns_count,avatar_hue,answer_count,zvideo_count,articles_count,pins_count,question_count,columns_count,commercial_question_count,favorite_count,favorited_count,logs_count,included_answers_count,included_articles_count,included_text,message_thread_token,account_status,is_intelligence,is_active,is_bind_phone,is_force_renamed,is_privacy_protected,is_blocking,is_blocked,is_following,is_followed,mutual_followees_count,vote_to_count,vote_from_count,thank_to_count,thank_from_count,thanked_count,description,hosted_live_count,participated_live_count,allow_message,widgets,realname,institution,industry_category,org_name,org_homepage,is_org_createpin_white_user,badge[?(type=best_answerer)].topics",types:b.GET,isOwnProfile:t,NOTIFICATION:!1})).catch(function(t){var i=t.payload,a=(void 0===i?{}:i).message;return n?o({type:b.MARK_USER_STATUS,UPDATE:{update:{users:(0,r._)({},e,{errorMessage:a})}}}):Promise.reject(t)})}}function R(e){return A(e,"allow_message,is_followed,is_following,is_org,is_blocking,employments,answer_count,follower_count,articles_count,gender,badge[?(type=best_answerer)].topics")}function N(e,t){return function(n,o){var i=o(),a=i.entities.users,c=i.currentUser,l=a[c],u=(0,s.decamelizeKeys)(t||e);return n({API:{types:b.UPDATE,endpoint:"me",method:"PUT",query:{include:"".concat(Object.keys(u).join(","),",cover_url,verify_apply")},fetchOptions:{zsEncrypt:!0,body:u}},UPDATE:{request:{users:(0,r._)({},c,e||l)},success:function(e){return{users:(0,r._)({},c,e)}},failure:{users:(0,r._)({},c,l)}}})}}var k=(0,r._)({},m.Z.isMobileEntry?"mobile":"desktop",!0);function O(e){var t=e.urlToken,n=e.topicId,r=e.types,i=e.resource,a=void 0===i?"answers":i,c=e.offset,s=void 0===c?0:c,l=e.sortBy,u=e.endpoint,p=e.limit,h=void 0===p?E.W2:p,f=e.isQiangZhiSafe,_=["data[*].is_normal,","admin_closed_comment,","reward_info,","is_collapsed,","annotation_action,","annotation_detail,","collapse_reason,","collapsed_by,","suggest_edit,","comment_count,","can_comment,","content,","editable_content,","attachment,","voteup_count,","reshipment_settings,","comment_permission,","created_time,","updated_time,","review_info,","excerpt,","paid_info,","reaction_instruction,",n?"":"is_labeled,label_info,","relationship.is_authorized,","voting,is_author,","is_thanked,","is_nothelp;","data[*].vessay_info;","data[*].author.badge[?(type=best_answerer)].topics;","data[*].author.vip_info;","data[*].question.has_publishing_draft,","relationship"].join("");return{urlToken:t,topicId:n,API:(0,o._)({types:r},u?{endpoint:u}:{endpoint:"members/".concat(encodeURIComponent(t),"/").concat(a),query:(0,o._)({include:_,offset:s,limit:h,sortBy:void 0===l?"created":l},"boolean"==typeof f&&{ws_qiangzhisafe:f?"1":"0"})}),limit:h,offset:s,schema:d.l.ANSWER_ARRAY}}function x(e,t){var n=t.endpoint,r=t.sortBy,o=void 0===r?"created":r,i=t.offset,a=t.limit,c=void 0===a?E.W2:a,s=t.isQiangZhiSafe,l={urlToken:e,endpoint:n,offset:i,limit:c,types:{created:b.GET_ANSWERS,voteups:b.GET_ANSWERS_SORT_BY_VOTES,included:b.GET_ANSWERS_INCLUDED}[o],isQiangZhiSafe:s};return"included"===o?(l.resource="marked-answers",l.sortBy="created"):l.sortBy=o,O(l)}function P(e,t){var n=t.endpoint,r=t.sortBy,i=void 0===r?"created":r,a=t.offset,c=void 0===a?0:a,s=t.limit,l=void 0===s?E.W2:s,u=t.isQiangZhiSafe,p={created:b.GET_ARTICLES,voteups:b.GET_ARTICLES_SORT_BY_VOTES,included:b.GET_ARTICLES_INCLUDED};return{urlToken:e,offset:c,limit:l,API:(0,o._)({types:p[i]},n?{endpoint:n}:{endpoint:"members/".concat(encodeURIComponent(e),"/").concat("included"===i?"included-articles":"articles"),query:(0,o._)({include:"data[*].comment_count,suggest_edit,is_normal,thumbnail_extra_info,thumbnail,can_comment,comment_permission,admin_closed_comment,content,voteup_count,created,updated,upvoted_followees,voting,review_info,reaction_instruction,is_labeled,label_info;data[*].vessay_info;data[*].author.badge[?(type=best_answerer)].topics;data[*].author.vip_info;",offset:c,limit:l,sortBy:i},"boolean"==typeof u&&{ws_qiangzhisafe:u?"1":"0"})}),schema:d.l.ARTICLE_ARRAY}}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.endpoint,r=t.offset,i=void 0===r?0:r,a=t.limit,c=void 0===a?E.VZ:a,s=t.isAll;return{urlToken:e,API:(0,o._)({types:s?b.GET_ALL_FAVLISTS:b.GET_FAVLISTS},n?{endpoint:n}:{endpoint:"people/".concat(encodeURIComponent(e),"/collections"),query:{include:"data[*].updated_time,answer_count,follower_count,creator,description,is_following,comment_count,created_time;data[*].creator.vip_info",offset:i,limit:c}}),offset:i,schema:d.l.FAVLIST_ARRAY}}function L(e){var t=e.urlToken,n=e.resource,r=e.types,i=e.endpoint,a=e.offset,c=e.limit;return{urlToken:t,API:(0,o._)({types:r},i?{endpoint:i}:{endpoint:"members/".concat(encodeURIComponent(t),"/").concat(n),query:{include:"data[*].answer_count,articles_count,gender,follower_count,is_followed,is_following,badge[?(type=best_answerer)].topics",offset:a,limit:c}}),offset:a,schema:d.l.USER_ARRAY}}function B(e,t){return function(n,a){var c=a().entities.users[e];return n({columnId:t,memberToken:e,API:{types:b.DELETE_COLUMN,endpoint:"columns/".concat(t,"/coauthors/").concat(e),method:"DELETE"},UPDATE:{success:function(){return{users:(0,r._)({},e,(0,i._)((0,o._)({},c),{columnsCount:c.columnsCount-1}))}}}})}}function U(e,t){return function(n,o){var i=o().entities.users[e];return n({API:{types:b.UPDATE_SHIELD,endpoint:"members/".concat(encodeURIComponent(e),"/actions/block"),method:t?"POST":"DELETE"},UPDATE:{request:{users:(0,r._)({},e,{isBlocking:t})},failure:{users:(0,r._)({},e,i)}}})}}function M(e,t){var n=t.topicId,r=t.sortBy,i=void 0===r?"created":r,a=t.offset,c=void 0===a?0:a,s=t.limit,l=void 0===s?E.W2:s,u=t.endpoint,p={created:b.GET_CREATIONS,votenum:b.GET_CREATIONS_SORT_BY_VOTES};return{urlToken:e,offset:c,limit:l,topicId:n,API:(0,o._)({types:p[i]},u?{endpoint:u}:{endpoint:"members/".concat(encodeURIComponent(e),"/topics/").concat(n,"/creations"),query:{offset:c,limit:l,sortBy:i}}),schema:d.l.CREATION_ARRAY}}function G(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="/members/".concat(encodeURIComponent(e),"/profile/creations/feed"),i=t.type,a=void 0===i?"all":i;return function(e,i){var c,s=null===(c=i().people.creationsFeed)||void 0===c?void 0:c[a],l=((null==s?void 0:s.paging)||{}).next;return e({meta:{contentType:a},API:(0,o._)({types:b.GET_CREATIONS_FEED},l?{endpoint:l}:{endpoint:r,query:t}),FAILSAFE:n})}}function F(){return{type:b.CLEAR_CREATION_FEED}}function z(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.offset,a=n.limit,c=n.topicId,s=n.isQiangZhiSafe;return function(n,l){var u,p,h,f,v,g,T,C,y,S,A,Z,w,R,N,B,U,G,F,z,H,q,V,X,W,K,j,Y,Q,J,$,ee,et,en,er,eo,ei,ea,ec,es,el,eu,ed,ep,eh,ef,e_,em,ev,eg,eT,eE,eC,ey,eS,eI,eb,eA,eZ,ew,eR,eN,ek,eO,ex,eP,eD,eL,eB,eU,eM,eG,eF,ez,eH,eq,eV,eX,eW,eK,ej,eY,eQ,eJ,e$,e0,e1,e2,e3,e4,e5=l(),e6=e5.people,e7=e5.currentUser,e8=(e6["".concat(t,"ByUser")][e]||{}).next,e9=r||!e8?{offset:r,limit:a,isQiangZhiSafe:s}:{endpoint:e8};switch(t){case"activities":return n(function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).isQiangZhiSafe;return{urlToken:e,API:{types:b.GET_ACTIVITIES,endpoint:t||"v3/moments/".concat(encodeURIComponent(e),"/activities"),query:!t&&(0,o._)({limit:E.W2},k,"boolean"==typeof n&&{ws_qiangzhisafe:n?"1":"0"}),headers:{"X-API-VERSION":"3.0.40"}},FAILSAFE:{timeout:3e3},schema:d.l.ACTIVITY_ARRAY}}(e,e8,{isQiangZhiSafe:s}));case"answers":return n(x(e,e9));case"answersSortByVotes":return n(x(e,(0,o._)({sortBy:"voteups"},e9)));case"answersIncluded":return n(x(e,(0,o._)({sortBy:"included"},e9)));case"votedAnswers":return n((u=e,p=e9.endpoint,O({urlToken:u,endpoint:p,offset:void 0===(h=e9.offset)?0:h,limit:void 0===(f=e9.limit)?E.W2:f,types:b.GET_VOTED_ANSWERS,resource:"relations/voted"})));case"thankedAnswers":return n((v=e,g=e9.endpoint,O({urlToken:v,endpoint:g,offset:void 0===(T=e9.offset)?0:T,limit:void 0===(C=e9.limit)?E.W2:C,types:b.GET_THANKED_ANSWERS,resource:"relations/thanked"})));case"voteAnswers":return n((y=e,S=e9.endpoint,O({urlToken:y,endpoint:S,offset:void 0===(A=e9.offset)?0:A,limit:void 0===(Z=e9.limit)?E.W2:Z,types:b.GET_VOTE_ANSWERS,resource:"relations/vote"})));case"thankAnswers":return n((w=e,R=e9.endpoint,O({urlToken:w,endpoint:R,offset:void 0===(N=e9.offset)?0:N,limit:void 0===(B=e9.limit)?E.W2:B,types:b.GET_THANK_ANSWERS,resource:"relations/thank"})));case"topicAnswers":return n((U=e,F=(G=(0,o._)({topicId:c},e9)).endpoint,z=G.topicId,O({topicId:z,urlToken:U,endpoint:F,offset:void 0===(H=G.offset)?0:H,limit:void 0===(q=G.limit)?E.W2:q,types:b.GET_TOPIC_ANSWERS,resource:"topics/".concat(z,"/answers")})));case"zvideos":return n((V=e,W=void 0===(X=e9.offset)?0:X,j=void 0===(K=e9.limit)?E.W2:K,{urlToken:V,API:{types:b.GET_ZVIDEOS,endpoint:"/members/".concat(encodeURIComponent(V),"/zvideos"),query:{offset:W,limit:j,similarAggregation:!0,include:_()({similar_zvideo:!0,creation_relationship:!0,reaction_instruction:!0})}},offset:W,limit:j,schema:I}));case"articles":return n(P(e,e9));case"pins":return n((Y=e,J=void 0===(Q=e9.offset)?0:Q,ee=void 0===($=e9.limit)?E.W2:$,{urlToken:Y,API:{types:b.GET_PINS,endpoint:"/v2/pins/".concat(encodeURIComponent(Y),"/moments"),query:{offset:J,limit:ee,includes:"data[*].upvoted_followees,admin_closed_comment"}},offset:J,limit:ee,schema:d.l.PIN_ARRAY}));case"articlesSortByVotes":return n(P(e,(0,o._)({sortBy:"voteups"},e9)));case"articlesIncluded":return n(P(e,(0,o._)({sortBy:"included"},e9)));case"columns":return n((et=e,en=e9.endpoint,eo=void 0===(er=e9.offset)?0:er,ea=void 0===(ei=e9.limit)?E.VZ:ei,{urlToken:et,offset:eo,API:(0,o._)({types:b.GET_COLUMNS},en?{endpoint:en}:{endpoint:"members/".concat(encodeURIComponent(et),"/column-contributions"),query:{include:"data[*].column.intro,followers,articles_count,voteup_count,items_count",offset:eo,limit:ea}}),schema:d.l.COLUMN_CONTRIBUTION_ARRAY}));case"questions":return n((ec=e,es=e9.endpoint,eu=void 0===(el=e9.offset)?0:el,ep=void 0===(ed=e9.limit)?E.VZ:ed,eh=e9.isQiangZhiSafe,{urlToken:ec,offset:eu,API:(0,o._)({types:b.GET_QUESTIONS},es?{endpoint:es}:{endpoint:"members/".concat(encodeURIComponent(ec),"/questions"),query:(0,o._)({include:"data[*].created,answer_count,follower_count,author,admin_closed_comment",offset:eu,limit:ep},"boolean"==typeof eh&&{ws_qiangzhisafe:eh?"1":"0"})}),schema:d.l.QUESTION_ARRAY}));case"commercialQuestions":return n((ef=e,e_=e9.endpoint,ev=void 0===(em=e9.offset)?0:em,eT=void 0===(eg=e9.limit)?E.VZ:eg,{urlToken:ef,offset:ev,API:(0,o._)({types:b.GET_COMMERCIAL_QUESTIONS},e_?{endpoint:e_}:{endpoint:"members/".concat(encodeURIComponent(ef),"/commercial-questions"),query:{include:"data[*].created,answer_count,follower_count,author,is_muted,question_type,admin_closed_comment",offset:ev,limit:eT}}),schema:d.l.COMMERCIAL_QUESTION_ARRAY}));case"favlists":return n(D(e,e9));case"following":return n((eE=e,eC=e9.endpoint,ey=e9.offset,eI=void 0===(eS=e9.limit)?E.VZ:eS,L({urlToken:eE,types:b.GET_FOLLOWINGS,resource:"followees",offset:void 0===ey?0:ey,endpoint:eC,limit:eI})));case"followers":return n((eb=e,eA=e9.endpoint,eZ=e9.offset,eR=void 0===(ew=e9.limit)?E.VZ:ew,L({urlToken:eb,types:b.GET_FOLLOWERS,resource:"followers",endpoint:eA,offset:void 0===eZ?0:eZ,limit:eR})));case"mutuals":return n((eN=e,ek=e9.endpoint,eO=e9.offset,eP=void 0===(ex=e9.limit)?E.VZ:ex,(0,i._)((0,o._)({},L({urlToken:eN,types:b.GET_IKNOW_FOLLOWERS,resource:"relations/mutuals",offset:void 0===eO?0:eO,endpoint:ek,limit:eP})),{NOTIFICATION:!1})));case"followingColumns":return n((eD=e,eL=e9.endpoint,eU=void 0===(eB=e9.offset)?0:eB,eG=void 0===(eM=e9.limit)?E.VZ:eM,{urlToken:eD,API:(0,o._)({types:b.GET_FOLLOWING_COLUMNS},eL?{endpoint:eL}:{endpoint:"members/".concat(encodeURIComponent(eD),"/following-columns"),query:{include:"data[*].intro,followers,articles_count,voteup_count,items_count",offset:eU,limit:eG}}),offset:eU,schema:d.l.COLUMN_ARRAY}));case"followingQuestions":return n((eF=e,ez=e9.endpoint,eq=void 0===(eH=e9.offset)?0:eH,eX=void 0===(eV=e9.limit)?E.VZ:eV,{urlToken:eF,API:(0,o._)({types:b.GET_FOLLOWING_QUESTIONS},ez?{endpoint:ez}:{endpoint:"members/".concat(encodeURIComponent(eF),"/following-questions"),query:{include:"data[*].created,answer_count,follower_count,author",offset:eq,limit:eX}}),offset:eq,schema:d.l.QUESTION_ARRAY}));case"followingFavlists":return n((eW=e,eK=e9.endpoint,eY=void 0===(ej=e9.offset)?0:ej,eJ=void 0===(eQ=e9.limit)?E.VZ:eQ,{urlToken:eW,API:(0,o._)({types:b.GET_FOLLOWING_FAVLISTS},eK?{endpoint:eK}:{endpoint:"members/".concat(encodeURIComponent(eW),"/following-favlists"),query:{include:"data[*].updated_time,answer_count,follower_count,creator,description,is_following,comment_count,created_time",offset:eY,limit:eJ}}),offset:eY,schema:d.l.FAVLIST_ARRAY}));case"followingTopics":return n((e$=e,e0=e9.endpoint,e2=void 0===(e1=e9.offset)?0:e1,e4=void 0===(e3=e9.limit)?E.VZ:e3,{urlToken:e$,API:(0,o._)({types:b.GET_FOLLOWING_TOPICS},e0?{endpoint:e0}:{endpoint:"/topics/".concat(encodeURIComponent(e$),"/following_topics_contributions"),root:"".concat(m.Z.fetchRoot.www,"/api/v5.1/"),query:{include:"data[*].topic.introduction",offset:e2,limit:e4}}),offset:e2,schema:d.l.TOPIC_CONTRIBUTION_ARRAY}));case"publications":return n(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.endpoint,r=t.offset,i=void 0===r?0:r;return{urlToken:e,API:(0,o._)({types:b.GET_PUBLICATIONS},n?{endpoint:n}:{root:m.Z.fetchRoot.api,endpoint:"/books/people/".concat(encodeURIComponent(e),"/publications"),query:{offset:i,limit:5}}),offset:i,schema:d.l.EBOOK_ARRAY,FAILSAFE:!1}}(e,e9));case"allFavlists":e=e||e7;var te=(e6["".concat(t,"ByUser")][e]||{}).next;return n(D(e,(0,o._)({isAll:!0},{endpoint:te})));case"creations":return n(M(e,(0,o._)({topicId:c,sortBy:"created"},e9)));case"creationsSortByVotes":return n(M(e,(0,o._)({topicId:c,sortBy:"votenum"},e9)));default:return Promise.reject(Error("Mismatched loadItems ".concat(t)))}}}function H(e){return{API:{types:b.GET_BRANDS,endpoint:"/brand/".concat(e,"/brands")}}}var q=(0,E.V6)(b.GET_COLUMNS,{mapActionToKey:function(e){return e.urlToken}}),V=(0,E.V6)(b.DELETE_COLUMN,{mapActionToKey:function(e){return e}}),X=(0,E.V6)(b.GET_FOLLOWING_TOPICS,{mapActionToKey:function(e){return e.urlToken},additionalCaseTypes:[y.Hp.UPDATE_FOLLOW.success],additionalCase:function(e,t){if(t.type===y.Hp.UPDATE_FOLLOW.success){var n=t.topicId,r=e.ids,a=e.totals;if(!r.includes(n))return(0,i._)((0,o._)({},e),{totals:a+1,ids:[n].concat((0,c._)(r))})}return e}}),W=(0,E.V6)(b.GET_TOPIC_ANSWERS,{mapActionToKey:function(e){return e.topicId}}),K=(0,E.V6)(b.GET_CREATIONS,{mapActionToKey:function(e){return e.topicId}}),j=(0,E.V6)(b.GET_CREATIONS_SORT_BY_VOTES,{mapActionToKey:function(e){return e.topicId}}),Y=function(e){return e.urlToken};t.ZP=(0,u.combineReducers)({profileStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b.GET.failure:case b.GET.success:return(0,i._)((0,o._)({},e),(0,r._)({},t.result,(0,i._)((0,o._)({},t.payload&&{token:{id:t.payload.id,urlToken:t.payload.urlToken}}),{isFetching:!1,isDrained:!0})));default:return e}},activitiesByUser:(0,E.Fd)(b.GET_ACTIVITIES,{mapActionToKey:Y}),answersByUser:m.Z.isMobileEntry?(0,E.Fd)(b.GET_ANSWERS,{mapActionToKey:Y}):(0,E.V6)(b.GET_ANSWERS,{mapActionToKey:Y}),answersSortByVotesByUser:(0,E.V6)(b.GET_ANSWERS_SORT_BY_VOTES,{mapActionToKey:Y}),answersIncludedByUser:(0,E.V6)(b.GET_ANSWERS_INCLUDED,{mapActionToKey:Y}),votedAnswersByUser:(0,E.V6)(b.GET_VOTED_ANSWERS,{mapActionToKey:Y}),thankedAnswersByUser:(0,E.V6)(b.GET_THANKED_ANSWERS,{mapActionToKey:Y}),voteAnswersByUser:(0,E.V6)(b.GET_VOTE_ANSWERS,{mapActionToKey:Y}),thankAnswersByUser:(0,E.V6)(b.GET_THANK_ANSWERS,{mapActionToKey:Y}),topicAnswersByUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,o=t.urlToken;return Object.values(b.GET_TOPIC_ANSWERS).includes(n)?(0,r._)({},o,W(e[o],t)):e},zvideosByUser:(0,E.V6)(b.GET_ZVIDEOS,{mapActionToKey:Y}),articlesByUser:m.Z.isMobileEntry?(0,E.Fd)(b.GET_ARTICLES,{mapActionToKey:Y}):(0,E.V6)(b.GET_ARTICLES,{mapActionToKey:Y}),articlesSortByVotesByUser:(0,E.V6)(b.GET_ARTICLES_SORT_BY_VOTES,{mapActionToKey:Y}),articlesIncludedByUser:(0,E.V6)(b.GET_ARTICLES_INCLUDED,{mapActionToKey:Y}),pinsByUser:(0,E.V6)(b.GET_PINS,{mapActionToKey:Y}),questionsByUser:m.Z.isMobileEntry?(0,E.Fd)(b.GET_QUESTIONS,{mapActionToKey:Y,addSuccessType:C.Hp.ADD.success}):(0,E.V6)(b.GET_QUESTIONS,{mapActionToKey:Y,addSuccessType:C.Hp.ADD.success}),commercialQuestionsByUser:(0,E.V6)(b.GET_COMMERCIAL_QUESTIONS,{mapActionToKey:Y}),favlistsByUser:(0,E.V6)(b.GET_FAVLISTS,{mapActionToKey:Y,additionalCaseTypes:[g.Hp.ADD.success,g.Hp.UPDATE.success,g.Hp.DELETE.success],additionalCase:g.Nn,addSuccessType:p.Z.ADD.SUCCESS}),followingByUser:(0,E.V6)(b.GET_FOLLOWINGS,{mapActionToKey:Y,additionalCaseTypes:[S.cw.UPDATE_FOLLOWERS.success],additionalCase:function(e,t){var n=t.type,r=t.expect,a=t.userUrlToken;if(n===S.cw.UPDATE_FOLLOWERS.success&&r){var s=e.ids,l=e.totals;if(!s.includes(a))return(0,i._)((0,o._)({},e),{totals:l+1,ids:[a].concat((0,c._)(s))})}return e}}),followersByUser:(0,E.V6)(b.GET_FOLLOWERS,{mapActionToKey:Y}),mutualsByUser:(0,E.Fd)(b.GET_IKNOW_FOLLOWERS,{mapActionToKey:Y}),followingColumnsByUser:(0,E.V6)(b.GET_FOLLOWING_COLUMNS,{mapActionToKey:Y,additionalCaseTypes:[T.Pu.UPDATE_FOLLOW.success],additionalCase:function(e,t){var n=t.type,r=t.expect,a=t.columnId;if(n===T.Pu.UPDATE_FOLLOW.success&&r){var s=e.ids,l=e.totals;if(!s.includes(a))return(0,i._)((0,o._)({},e),{totals:l+1,ids:[a].concat((0,c._)(s))})}return e}}),followingQuestionsByUser:(0,E.V6)(b.GET_FOLLOWING_QUESTIONS,{mapActionToKey:Y,addSuccessType:C.Hp.ADD.success}),followingFavlistsByUser:(0,E.V6)(b.GET_FOLLOWING_FAVLISTS,{mapActionToKey:Y}),followingTopicsByUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.urlToken;if(Object.values(b.GET_FOLLOWING_TOPICS).includes(n)){var c=t.result||[];t.result=c.map(function(e){return e.topic});var s=e[a]||{isFetching:!1,isDrained:!1,totals:0,ids:[],contributions:{}};return X((0,i._)((0,o._)({},e),(0,r._)({},a,(0,i._)((0,o._)({},s),{contributions:c.reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t.topic,t.contributionsCount))},s.contributions)}))),t)}return e},publicationsByUser:(0,E.Fd)(b.GET_PUBLICATIONS,{mapActionToKey:Y}),columnsByUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.urlToken;if(Object.values(b.DELETE_COLUMN).includes(n)){var c=t.columnId,s=t.memberToken,l=e[s].ids;return V((0,i._)((0,o._)({},e),(0,r._)({},s,(0,i._)((0,o._)({},e[s]),{ids:l.map(function(e){if(e!==c)return e})}))),t)}if(Object.values(b.GET_COLUMNS).includes(n)){var u=t.result||[];t.result=u.map(function(e){return e.column});var d=e[a]||{isFetching:!1,isDrained:!1,totals:0,ids:[],contributions:{}};return q((0,i._)((0,o._)({},e),(0,r._)({},a,(0,i._)((0,o._)({},d),{contributions:u.reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t.column,t.contributionsCount))},d.contributions)}))),t)}return e},allFavlistsByUser:h.f,brands:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return t.type===b.GET_BRANDS.success?t.payload.data:e},creationsByUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,o=t.urlToken;return Object.values(b.GET_CREATIONS).includes(n)?(0,r._)({},o,K(e[o],t)):e},creationsSortByVotesByUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,o=t.urlToken;return Object.values(b.GET_CREATIONS_SORT_BY_VOTES).includes(n)?(0,r._)({},o,j(e[o],t)):e},creationsFeed:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case b.GET_CREATIONS_FEED.request:var c=t.meta.contentType,s=e[c]||{isFetching:!0,isDrained:!1,paging:{},ids:[],items:[]};return(0,i._)((0,o._)({},e),(0,r._)({},c,(0,E.TS)(s,{isFetching:!0})));case b.GET_CREATIONS_FEED.failure:var l=t.meta.contentType;return(0,i._)((0,o._)({},e),(0,r._)({},l,(0,E.TS)(e[l],{isFetching:!1,isDrained:!0})));case b.GET_CREATIONS_FEED.success:var u=a.data,d=a.paging;if(!u||!d)return e;var p=t.meta.contentType,h=d.isStart,f=d.isEnd,_=e[p],m=u.map(function(e){var t=e.content,n=e.notiSubtype;return(0,i._)((0,o._)({},t),{contentType:n})}).filter(function(e){var t=e.urlToken;return!t||!_.ids.includes(t)}),v=(0,E.TS)(_,{isFetching:!1,isDrained:!h&&f||h&&f,paging:d,ids:m.map(function(e){return e.urlToken}),items:m});return(0,i._)((0,o._)({},e),(0,r._)({},p,v));case b.CLEAR_CREATION_FEED:return{};default:return e}},infinity:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===b.GET_INFINITY_INFO.success){var n=t.meta,a=t.payload;return(0,i._)((0,o._)({},e),(0,r._)({},n,a))}return e},batchUsers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===b.GET_BATCH_USERS.success){var n=t.payload;return(0,o._)({},e,n)}return e},profileInfinity:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;if(t.type===b.GET_PROFILE_INFINITY.success){var n=t.payload;return(0,o._)({},e,n)}return e}})},26797:function(e,t,n){"use strict";n.d(t,{ZP:function(){return _},q$:function(){return f},T8:function(){return p},A0:function(){return d},uC:function(){return h}});var r=n(93206),o=n(87320),i=n(55164),a=n(57477),c=(0,r.combineReducers)({reviewing:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if("pins/SET_REVIEWING_ERROR"===t.type){var n=t.payload,r=n.id,c=n.error;return(0,a._)((0,i._)({},e),(0,o._)({},r,c))}return e}});n(28953),n(80714);var s=n(39288),l=n(67927),u=(0,s.FH)("pin",["LIKE","REACTION","DELETE","GET_VOTERS","CREATE_PINS","GET_LINK_CONTENT","GET_PIN_CONTENT","LOAD_HOT_TOPIC","FETCH_RECOMMAND_TOPIC","FETCH_RECOMMAND_BY_KEYWORD","ADD_TOPIC","UPDATE_VOTE_PIN","UPDATE_LIKE_PIN"]);function d(e){return function(t,n){var r,c=n().entities.pins[e],s=c.reaction,d=(void 0===s?{}:s).relation,p=(void 0===d?{}:d).liked;return t({id:e,API:{types:u.UPDATE_LIKE_PIN,endpoint:"pins/".concat(e,"/likers"),method:p?"delete":"post",body:{is_real_pin_like:!0}},UPDATE:{request:{pins:(0,o._)({},e,{reaction:(0,a._)((0,i._)({},c.reaction),{relation:(0,a._)((0,i._)({},null===(r=c.reaction)||void 0===r?void 0:r.relation),{liked:!p})})})},failure:{pins:(0,o._)({},e,c)}},NOTIFICATION:{failure:l.XR}})}}function p(e){return function(t,n){var r=n().entities.pins[e],i=r.likeCount,a=r.virtuals,c=(void 0===a?{}:a).isLiked;return t({id:e,API:{types:u.LIKE,endpoint:"pins/".concat(e,"/likers"),method:c?"delete":"post"},UPDATE:{request:{pins:(0,o._)({},e,{likeCount:i+(c?-1:1),virtuals:{isLiked:!c}})},failure:{pins:(0,o._)({},e,r)}},NOTIFICATION:{failure:l.XR}})}}function h(e,t){return function(n,r){var c,s,l,d,p,h,f=r().entities,_=f.pins,m=f.users,v=(void 0===_?{}:_)[e],g=v.author||{},T=g.urlToken,E=null===(c=v.reaction)||void 0===c?void 0:null===(s=c.relation)||void 0===s?void 0:s.vote,C=E===t.toUpperCase(),y=0;return"up"===t&&(y="UP"===E?-1:1),"down"===t&&(y="UP"===E?-1:0),n({API:{types:u.UPDATE_VOTE_PIN,endpoint:"pins/".concat(e,"/voters/").concat(t),method:C?"DELETE":"POST",body:{not_sync_moments:!0}},UPDATE:{request:{pins:(0,o._)({},e,(0,a._)((0,i._)({},v),{reaction:(0,a._)((0,i._)({},v.reaction),{relation:(0,a._)((0,i._)({},v.reaction.relation),{vote:C?"Neutral":t.toUpperCase()}),statistics:(0,a._)((0,i._)({},v.reaction.statistics),{upVoteCount:(null!==(p=null===(l=v.reaction.statistics)||void 0===l?void 0:l.upVoteCount)&&void 0!==p?p:0)+y})})})),users:(0,o._)({},T,{voteupCount:(null!==(h=null===(d=(void 0===m?{}:m)[T])||void 0===d?void 0:d.voteupCount)&&void 0!==h?h:0)+y})},failure:{pins:(0,o._)({},e,v),users:(0,o._)({},T,g)}}})}}function f(e){return function(t,n){var r=n().entities.pins[e];return t({API:{types:u.DELETE,endpoint:"pins/".concat(e),method:"DELETE"},UPDATE:{request:{pins:(0,o._)({},e,{isDelete:!0})},failure:{pins:(0,o._)({},e,r)}}})}}(0,n(31824).P1)(function(e,t){return{pin:e.entities.pins[t],users:e.entities.users}},function(e){var t=e.pin,n=e.users;return t?"string"==typeof t.author?Object.assign({},t,{author:n[t.author]}):t:{}});var _=c},19680:function(e,t,n){"use strict";n.d(t,{F7:function(){return v},Lw:function(){return m},VN:function(){return g},_T:function(){return f}});var r=n(87320),o=n(55164),i=n(57477),a=n(94009),c=n(49899),s=n(93206),l=n(28953),u=n(58909),d=n(39288),p=(0,o._)({},(0,d.FH)("pushNotifications",["GET_DEFAULT","GET_FOLLOW","GET_VOTE_THANK","MARK_ALL_READ"]),(0,d.co)("pushNotifications",["ADD","CURRENT_TAB"])),h={default:p.GET_DEFAULT,follow:p.GET_FOLLOW,vote_thank:p.GET_VOTE_THANK};function f(e){return function(t,n){var r=n(),o=r.pushNotifications,i=r.pushNotifications.currentTab,a=(!e&&o[i]||{}).next;return t({reFetch:e,API:{types:h[i],endpoint:a||"notifications/v2/".concat(i)},schema:l.l.NOTIFICATION_ARRAY})}}function _(e){var t=e.request,n=e.success,r=e.failure,a={isFetching:!1,isDrained:!1,ids:[]};return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,s=arguments.length>1?arguments[1]:void 0;switch(s.type){case t:if(s.reFetch)return a;return(0,i._)((0,o._)({},e),{isFetching:!0});case n:var l=s.result,u=s.next,d=s.isDrained,p=e.ids;return(0,i._)((0,o._)({},e),{isFetching:!1,isDrained:d,next:u,ids:(0,c._)(p).concat((0,c._)(l.filter(function(e){return!p.includes(e)})))});case r:return(0,i._)((0,o._)({},e),{isFetching:!1,isDrained:!1});default:return e}}}function m(e){return{type:p.CURRENT_TAB,currentTab:e}}function v(e){return{type:p.ADD,payload:e}}function g(){return function(e,t){var n=t().pushNotifications.currentTab;return e({API:{types:p.MARK_ALL_READ,endpoint:"notifications/v2/".concat(n,"/actions/readall"),method:"POST"},tab:n})}}var T={default:0,follow:0,vote_thank:0};t.ZP=(0,s.combineReducers)({default:_(p.GET_DEFAULT),follow:_(p.GET_FOLLOW),vote_thank:_(p.GET_VOTE_THANK),currentTab:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.currentTab;return n===p.CURRENT_TAB?r:e},notificationsCount:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0,n=t.type;if(n===p.ADD){var i=(0,a._)(t.payload,3);return{default:i[0],follow:i[1],vote_thank:i[2]}}if(n===u.Hp.GET.success){var c=t.payload;return{default:c.defaultNotificationsCount,follow:c.followNotificationsCount,vote_thank:c.voteThankNotificationsCount}}return n===p.MARK_ALL_READ.success?(0,o._)({},e,(0,r._)({},t.tab,0)):e}})},31021:function(e,t,n){"use strict";n.d(t,{Gl:function(){return N},Hp:function(){return p},IF:function(){return w},J_:function(){return R},Kd:function(){return m},Kx:function(){return f},Ky:function(){return g},PW:function(){return O},R5:function(){return I},XX:function(){return T},_u:function(){return S},dY:function(){return C},k9:function(){return _},nH:function(){return v},po:function(){return E},qX:function(){return b},uF:function(){return A},uN:function(){return y},vL:function(){return Z},yV:function(){return h},zp:function(){return k}});var r=n(87320),o=n(55164),i=n(57477),a=n(74135),c=n(28953),s=n(84054),l=n.n(s);n(74351),n(80714),n(40195);var u=n(66263),d=n(39288);n(8866),n(69906),n(67927);var p=(0,d.FH)("question",["GET","GET_TITLE","ADD","VOTE","DELETE","UPDATE","GET_INVITERS","GET_ALL_INVITERS","DELETE_INVITERS","GET_INVITEES","GET_FOLLOWERS","UPDATE_FOLLOWERS","GET_LATERS_COUNT","GET_LATERS","GET_INVITED_QUESTIONS_COUNT","GET_INVITED_QUESTIONS","IGNORE_INVITED_QUESTION","UPDATE_LATER","UPDATE_ANONYMOUS","CREATE_REDIRECTION","REVOKE_REDIRECTION","GET_BIO","CHOOSE_BIO","GET_SIMILAR_QUESTIONS","GET_RELATED_COMMODITIES","GET_ANSWERS","GET_UPDATED_ANSWERS","GET_COLLAPSED_ANSWERS","GET_HIDDEN_ANSWERS","GET_A11Y_ANSWERS","GET_NOTIFICATION_ANSWER_TOKENS","GET_INVITATION_CANDIDATES","GET_WAITING_QUESTIONS","DELETE_WAITING_QUESTION","DELETE_TOOLS_QUESTION_INVITED","GET_BIOS","UPDATE_INVITATION","UPDATE_LOCK","TOGGLE_QUESTION_EDIT_LOCK","GET_DRAFT","ADD_DRAFT","GET_ATTACHED_POST_TO_DRAFT","UPDATE_DRAFT","DELETE_DRAFT","GET_BRAND","GET_BRAND_QUESTION_ADVANCED_STYLE","UPDATE_BRAND_QUESTION_ADVANCED_STYLE","GET_BRAND_QUESTION_RECOMMENDATION","GET_BRAND_QUESTION_PERMISSION","GET_BRAND_QUESTION_OPEN_STATUS","UPDATE_BRAND_QUESTION_OPEN_STATUS","GET_BRAND_QUESTION_RED_PACKET","GET_BRAND_QUESTION_PRIZE","GET_BRAND_QUESTION_ANSWER_SUMMARIES","GET_BRAND_QUESTION_WINNERS","CREATE_BRAND_QUESTION_PRIZE","SET_BRAND_QUESTION_WINNERS","GET_CONCERNED_FOLLOWERS","GET_ANSWER_COUNT","UPDATE_COMMENT_PERMISSION","GET_META_TOPICS","LOAD_RELATED_BLUESTAR_RANKLIST","GET_RELATED_SEARCH","GET_AUTO_INVITATION","OPEN_AUTO_INVITATION","CLOSE_AUTO_INVITATION","UPDATE_ONCE_INVITE","GET_SIMPLE_CONCERNED_FOLLOWERS","UPDATE_VOTE_TOPIC","GET_DISCLAIMERS","GET_QUESTION_SHARE","GET_READING_MEMBERSHIP","GET_BRAND_QUESTION_ANSWER_MARK","PUT_BRAND_QUESTION_ANSWER_MARK","PUT_BRAND_QUESTION_STATUS","GET_BRAND_QUESTION_STATUSINFO","GET_QUESTION_BANNER","OPEN_BUS_VIP","QUERY_BUS_VIP_STATUS","QUERY_DEFAULT_SETTINGS","QUERY_QUESTION_DRAFT","UPDATE_MARKDOWN_ENABLED","REMOVE_SESSION"]),h=(0,d.co)("question",["REMOVE_RED_PACKET","SHOW_MOBILE_SIGN_IN_MODAL"]),f=l()({is_visible:!0,related_cards:!0,ad_track_url:!0,review_info:!0,mute_info:!0,detail:!0,editable_detail:!0,comment_count:!0,can_comment:!0,comment_permission:!0,admin_closed_comment:!0,answer_count:!0,collapsed_answer_count:!0,follower_count:!0,visit_count:!0,topics:!0,author:!0,show_author:!0,show_encourage_author:!0,excerpt:!0,thumbnail_info:!0,voteup_count:!0,is_editable:!0,is_normal:!0,status:!0,redirection:!0,question_type:!0,is_labeled:!0,is_muted:!0,created:!0,updated_time:!0,has_publishing_draft:!0,annotation_detail:!0,relationship:{is_author:!0,voting:!0,is_anonymous:!0,is_following:!0,can_edit:!0,can_collapse_answers:!0,can_stick_answers:!0,can_lock:!0,can_vote:!0,my_answer:!0},is_bannered:!0,event:!0,reaction_instruction:!0,ai_summary:!0});function _(e,t){var n=e.id,i=e.optimisticData,a=t.entities.questions[n];return{type:p.UPDATE.request,UPDATE:{request:{questions:(0,r._)({},n,(0,o._)({},a,i))}}}}function m(e,t){var n=e.id;return{type:p.UPDATE.success,payload:t,schema:c.l.QUESTION,UPDATE:{success:function(e){return{questions:(0,r._)({},n,e)}}},NOTIFICATION:{key:"updateQuestion",success:function(e){return{id:e.id}}}}}function v(e,t,n){var o=e.id,i=n.entities.questions[o];return{type:p.UPDATE.failure,err:t,UPDATE:{failure:{questions:(0,r._)({},o,i)}},NOTIFICATION:{key:"updateQuestion",failure:function(e){return{code:e.code}}}}}function g(e){return{type:h.SHOW_MOBILE_SIGN_IN_MODAL,payload:e}}function T(e,t){return function(n,a){var c=a(),s=c.currentUser,l=c.entities,u=l.users,d=l.questions,h=u[s],f=d[e],_=t?1:-1,m={types:p.UPDATE_FOLLOWERS,endpoint:"questions/".concat(e,"/followers"),method:t?"POST":"DELETE"};return n(f?{meta:{id:e,expect:t},API:m,UPDATE:{request:{users:(0,r._)({},s,{followingQuestionCount:h.followingQuestionCount+_}),questions:(0,r._)({},e,{followerCount:f.followerCount+_,relationship:(0,i._)((0,o._)({},f.relationship||{}),{isFollowing:t})})},failure:{users:(0,r._)({},s,h),questions:(0,r._)({},e,f)}}}:{meta:{id:e,expect:t},API:m})}}function E(e,t){return function(n,a){var c=a(),s=c.currentUser,l=c.entities,d=l.users,h=l.questions,f=l.answers,_=d[s],m=h[e],v=m.relationship,g=v.myAnswer,T=v.isAnonymous,E=g&&g.answerId?f[g.answerId]:null;return t="boolean"==typeof t?t:!T,n({API:{types:p.UPDATE_ANONYMOUS,endpoint:"questions/".concat(e,"/anonyms"),method:t?"POST":"DELETE"},UPDATE:{request:{questions:(0,r._)({},e,{relationship:(0,i._)((0,o._)({},m.relationship),{isAnonymous:t})}),answers:E?(0,r._)({},E.id,{author:t?u.aK:_}):{}},failure:{questions:(0,r._)({},e,m),answers:E?(0,r._)({},E.id,E):{}}}})}}function C(e){return{id:e,API:{types:p.GET_DRAFT,endpoint:"questions/".concat(e,"/draft"),query:{include:"question,schedule"}},schema:c.l.DRAFT,NOTIFICATION:{failure:"草稿加载失败"},UPDATE:{success:function(t){return t.question?(0,r._)({},"question_".concat(e),{attachment:t.attachment}):{drafts:(0,r._)({},"question_".concat(e),null)}}}}}function y(e,t,n,c,s,l){return function(u,d){var h="question_".concat(e),f=d().entities.drafts;return u({API:{types:p.ADD_DRAFT,endpoint:"questions/".concat(e,"/draft"),method:"POST",body:(0,a.decamelizeKeys)({content:t,deltaTime:n,draftType:c,attachment:s,settings:l}),fetchOptions:{zsAutoSignature:!1}},UPDATE:{request:{drafts:(0,r._)({},h,{editableContent:t,draftType:c,attachment:s,updating:!0,updated:!1,updateFailed:!1})},success:function(e){return{drafts:(0,r._)({},h,{createdTime:e.createdTime,updatedTime:e.updatedTime,updating:!1,updated:!0,updateFailed:!1})}},failure:{drafts:(0,r._)({},h,(0,i._)((0,o._)({},f[h]),{updating:!1,updated:!1,updateFailed:!0}))}}})}}function S(e,t,n,c,s,l){return function(u,d){var h="question_".concat(e),f=d().entities.drafts;return u({API:{types:p.UPDATE_DRAFT,endpoint:"questions/".concat(e,"/draft"),method:"PUT",body:(0,a.decamelizeKeys)({content:t,deltaTime:n,draftType:c,attachment:s,settings:l}),fetchOptions:{zsSignature:!1}},UPDATE:{request:{drafts:(0,r._)({},h,{editableContent:t,draftType:c,attachment:s,updating:!0,updated:!1,updateFailed:!1})},success:function(e){return{drafts:(0,r._)({},h,{createdTime:e.createdTime,updatedTime:e.updatedTime,updating:!1,updated:!0,updateFailed:!1})}},failure:{drafts:(0,r._)({},h,(0,i._)((0,o._)({},f[h]),{updating:!1,updated:!1,updateFailed:!0}))}}})}}function I(e){return function(t,n){var o="question_".concat(e),i=n().entities.drafts;return t({API:{types:p.DELETE_DRAFT,endpoint:"questions/".concat(e,"/draft"),method:"DELETE"},UPDATE:{request:{drafts:(0,r._)({},o,null)},failure:{drafts:i}}})}}function b(e){return{id:e,API:{types:p.GET_ALL_INVITERS,endpoint:"questions/".concat(e,"/inviters"),query:{with_answered:!0,with_ignored:!0,with_admin:!0}},schema:c.l.USER_ARRAY}}function A(e){return{API:{endpoint:"questions/".concat(e,"/bios"),types:p.GET_BIOS}}}function Z(e,t){return function(n,r){var c=r().topic.bios;return n({API:{endpoint:"questions/".concat(e,"/bio"),types:p.CHOOSE_BIO,body:(0,a.decamelizeKeys)({type:t.type,topicId:(t.topic||{}).id}),method:"POST"},id:e,bio:(0,i._)((0,o._)({},t),{bio:c[(t.topic||{}).id]})})}}function w(e){return{API:{types:p.GET_BIO,endpoint:"questions/".concat(e,"/bio")},id:e}}function R(e){return{id:e,API:{types:p.GET_DISCLAIMERS,endpoint:"/questions/".concat(e,"/disclaimers")}}}function N(){return{API:{types:p.QUERY_DEFAULT_SETTINGS,endpoint:"/editor/default-settings",method:"GET"}}}function k(e){return{API:{types:p.UPDATE_MARKDOWN_ENABLED,endpoint:"editor/default-settings",method:"PUT",body:{common_settings:(0,a.decamelizeKeys)(e)}}}}function O(e){return{API:{types:p.QUERY_QUESTION_DRAFT,endpoint:"/questions/".concat(e,"/draft"),method:"GET"}}}l()({data:[{is_normal:!0,admin_closed_comment:!0,reward_info:!0,is_collapsed:!0,annotation_action:!0,annotation_detail:!0,collapse_reason:!0,is_sticky:!0,collapsed_by:!0,suggest_edit:!0,comment_count:!0,can_comment:!0,content:!0,editable_content:!0,attachment:!0,voteup_count:!0,reshipment_settings:!0,comment_permission:!0,created_time:!0,updated_time:!0,review_info:!0,relevant_info:!0,question:!0,excerpt:!0,relationship:{is_authorized:!0,is_author:!0,voting:!0,is_thanked:!0,is_nothelp:!0},is_labeled:!0,paid_info:!0,paid_info_content:!0,author:{follower_count:!0,badge:[{topics:!0}],vip_info:!0},settings:{table_of_content:{enabled:!0}},reaction_instruction:!0}]})},40195:function(e,t,n){"use strict";n.d(t,{Hp:function(){return S.Hp},uN:function(){return S.uN},em:function(){return k},vL:function(){return S.vL},nH:function(){return S.nH},k9:function(){return S.k9},Kd:function(){return S.Kd},ZP:function(){return O},R5:function(){return S.R5},qX:function(){return S.qX},IF:function(){return S.IF},SZ:function(){return R},gW:function(){return w},uF:function(){return S.uF},J_:function(){return S.J_},dY:function(){return S.dY},hh:function(){return N},Gl:function(){return S.Gl},Kx:function(){return S.Kx},Md:function(){return Z},Ky:function(){return S.Ky},_u:function(){return S._u},zp:function(){return S.zp},po:function(){return S.po},XX:function(){return S.XX}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(46942),s=n.n(c),l=n(93206),u=[{name:"total",text:"所有人",filterBy:"",countKey:"questionTotalCount"},{name:"followees",text:"我关注的人",filterBy:"followees",countKey:"questionFolloweeCount"}];n(85879);var d=n(43998),p=n(34473),h=n(48498),f=n(57032),_=n(42951),m=n(30577),v=n(60811);n(82806),n(87641),n(69383),n(99447),n(30722),n(44169),n(31142);var g=n(44893),T="pc_panel",E=[{name:"recommend",queryName:"",icon:d.$,text:"为你推荐",request:{endpoint:"creators/question_route/pc_member_related/recommend",query:{pageSource:T}}},{name:"invite",queryName:"invite",icon:p.y,text:"邀请回答",request:{endpoint:"notifications/v3/timeline/entry/invite",query:{invite_with_time_slice:1}}},{name:"newest",queryName:"new",icon:h.k,text:"最新问题",request:{endpoint:"/creators/question_route/pc_member_related/newest",query:{pageSource:T,include:g.UH}}},{name:"hot",queryName:"hot",icon:f.ZV,text:"人气问题",request:{endpoint:"creators/question_route/pc_member_related/hot",query:{pageSource:T}}}];_.T,m.xl,h.k,v.RF;var C=n(8866),y=n(69906),S=n(31021),I=(0,y.Fd)(S.Hp.GET_NOTIFICATION_ANSWER_TOKENS,{mapActionToKey:function(e){return e.notificationId}}),b=(0,l.combineReducers)({followers:(0,y.Fd)(S.Hp.GET_FOLLOWERS),concernedFollowers:(0,y.Fd)(S.Hp.GET_CONCERNED_FOLLOWERS),answers:(0,y.Fd)(S.Hp.GET_ANSWERS,{addSuccessType:C.uJ.ADD.success,addAtTop:!1,additionalCaseTypes:[C.uJ.RESTORE.success,C.uJ.COLLAPSE.success],additionalCase:function(e,t){return t.type!==C.uJ.RESTORE.success||e.ids.includes(t.result)?e:(0,i._)((0,o._)({},e),{ids:(0,a._)(e.ids).concat([t.result])})}}),hiddenAnswers:(0,y.Fd)(S.Hp.GET_HIDDEN_ANSWERS,{addSuccessType:C.uJ.ADD.success,addAtTop:!1,additionalCaseTypes:[C.uJ.RESTORE.success,C.uJ.COLLAPSE.success],additionalCase:function(e,t){return t.type!==C.uJ.RESTORE.success||e.ids.includes(t.result)?e:(0,i._)((0,o._)({},e),{ids:(0,a._)(e.ids).concat([t.result])})}}),updatedAnswers:(0,y.Fd)(S.Hp.GET_UPDATED_ANSWERS,{addSuccessType:C.uJ.ADD.success,addAtTop:!1,additionalCaseTypes:[C.uJ.RESTORE.success],additionalCase:function(e,t){return t.type!==C.uJ.RESTORE.success||e.ids.includes(t.result)?e:(0,i._)((0,o._)({},e),{ids:(0,a._)(e.ids).concat([t.result])})}}),ariaAnswers:function(e,t){return(0,y.Fd)(S.Hp.GET_A11Y_ANSWERS)(e,t)},collapsedAnswers:function(e,t){return(0,y.Fd)(S.Hp.GET_COLLAPSED_ANSWERS)(e,t)},notificationAnswers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.type;if(Object.values(S.Hp.GET_NOTIFICATION_ANSWER_TOKENS).includes(r)){if(r===S.Hp.GET_NOTIFICATION_ANSWER_TOKENS.success){var o=n.data,i=n.paging,a=i.isEnd,c=i.next;t.result=o,t.isDrained=a,t.next=c}return I(e,t)}return e},invitedQuestions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t.name,{count:null,isEnd:!1,isLoading:!1,questions:[]}))},{}),t=arguments.length>1?arguments[1]:void 0;if(t.type===S.Hp.GET_INVITED_QUESTIONS_COUNT.success)return u.reduce(function(e,n){return(0,i._)((0,o._)({},e),(0,r._)({},n.name,(0,i._)((0,o._)({},e[n.name]),{count:t.payload.data[n.countKey]})))},e);if(t.type===S.Hp.GET_INVITED_QUESTIONS.request){var n=t.meta.typeName;return(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},e[n]),{isLoading:!0})))}if(t.type===S.Hp.GET_INVITED_QUESTIONS.success){var c=t.meta.typeName,s=t.payload,l=s.paging,d=s.data;return(0,i._)((0,o._)({},e),(0,r._)({},c,(0,i._)((0,o._)({},e[c]),{isEnd:l.isEnd,isLoading:!1,questions:(0,a._)(e[c].questions).concat((0,a._)(d))})))}return e},laterQuestions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{count:null,isEnd:!1,isLoading:!1,questions:[]},t=arguments.length>1?arguments[1]:void 0;if(t.type===S.Hp.GET_LATERS_COUNT.success)return(0,i._)((0,o._)({},e),{count:t.payload.count});if(t.type===S.Hp.UPDATE_LATER.success)return(0,i._)((0,o._)({},e),{count:e.count+(t.meta.expect?1:-1)});if(t.type===S.Hp.GET_LATERS.request)return(0,i._)((0,o._)({},e),{isLoading:!0});if(t.type===S.Hp.GET_LATERS.success){var n=t.payload,r=n.paging,c=n.data;return(0,i._)((0,o._)({},e),{isEnd:r.isEnd,isLoading:!1,questions:(0,a._)(e.questions).concat((0,a._)(c))})}return e},waitingQuestions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E.reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t.name,{isEnd:!1,isLoading:!1,questions:[]}))},{}),t=arguments.length>1?arguments[1]:void 0;if(t.type===S.Hp.GET_WAITING_QUESTIONS.request){var n=t.meta.type;return(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},e[n]),{isLoading:!0})))}if(t.type===S.Hp.GET_WAITING_QUESTIONS.success){var c=t.meta.type,s=t.payload,l=s.paging,u=s.data;return(0,i._)((0,o._)({},e),(0,r._)({},c,{paging:l,isEnd:l.isEnd,isLoading:!1,questions:(0,a._)(e[c].questions).concat((0,a._)(u))}))}if(t.type===S.Hp.UPDATE_FOLLOWERS.success){var d=t.meta,p=d.id,h=d.expect;return Object.keys(e).reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t,(0,i._)((0,o._)({},e[t]),{questions:e[t].questions.map(function(e){return e.question.id===p?(0,i._)((0,o._)({},e),{question:(0,i._)((0,o._)({},e.question),{relationship:(0,i._)((0,o._)({},e.question.relationship),{isFollowing:h})})}):e})})))},e)}return e},invitationCandidates:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return(0,a._)(Object.values(S.Hp.GET_INVITATION_CANDIDATES)).concat((0,a._)(Object.values(S.Hp.UPDATE_INVITATION)),(0,a._)(Object.values(S.Hp.UPDATE_ONCE_INVITE))).includes(t.type)?(0,r._)({},t.id,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,items:[],searchItems:[],onceDisabled:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S.Hp.GET_INVITATION_CANDIDATES.request:return(0,i._)((0,o._)({},e),{isFetching:!0});case S.Hp.GET_INVITATION_CANDIDATES.success:return(0,i._)((0,o._)({},e),(0,r._)({isFetching:!1,isDrained:!0},t.keyword?"searchItems":"items",t.result));case S.Hp.GET_INVITATION_CANDIDATES.failure:return(0,i._)((0,o._)({},e),{isFetching:!1});case S.Hp.UPDATE_ONCE_INVITE.success:var n=e.items.map(function(e){return(0,i._)((0,o._)({},e),{isInvited:!0})});return(0,i._)((0,o._)({},e),{items:n});case S.Hp.UPDATE_ONCE_INVITE.request:return(0,i._)((0,o._)({},e),{onceDisabled:!0});case S.Hp.UPDATE_INVITATION.request:case S.Hp.UPDATE_INVITATION.failure:var c=e.items,s=e.searchItems,l=c.findIndex(function(e){return e.member===t.urlToken}),u=s.findIndex(function(e){return e.member===t.urlToken});if(l>=0){var d=c[l];return(0,i._)((0,o._)({},e),{items:(0,a._)(c.slice(0,l)).concat([(0,i._)((0,o._)({},d),{isInvited:!d.isInvited})],(0,a._)(c.slice(l+1)))})}if(u>=0){var p=s[u];return(0,i._)((0,o._)({},e),{searchItems:(0,a._)(s.slice(0,u)).concat([(0,i._)((0,o._)({},p),{isInvited:!p.isInvited})],(0,a._)(s.slice(u+1)))})}return e;default:return e}}(e[t.id],t)):e},inviters:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===S.Hp.GET_INVITERS.success){var n=t.id,a=t.payload.data;return(0,i._)((0,o._)({},e),(0,r._)({},n,a))}if(t.type===S.Hp.GET_ALL_INVITERS.success){var c=t.id,s=t.payload.data;return(0,i._)((0,o._)({},e),(0,r._)({},"".concat(c,"_all"),s))}return e},invitees:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return(0,a._)(Object.values(S.Hp.GET_INVITEES)).concat((0,a._)(Object.values(S.Hp.UPDATE_INVITATION)),(0,a._)(Object.values(S.Hp.UPDATE_ONCE_INVITE))).includes(t.type)?(0,r._)({},t.id,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,items:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S.Hp.GET_INVITEES.request:return(0,i._)((0,o._)({},e),{isFetching:!0});case S.Hp.GET_INVITEES.success:return(0,i._)((0,o._)({},e),{isFetching:!1,isDrained:!0,items:t.result});case S.Hp.GET_INVITEES.failure:return(0,i._)((0,o._)({},e),{isFetching:!1});case S.Hp.UPDATE_ONCE_INVITE.success:var n=e.items,r=t.userTokens,c=(0,a._)(n);return(0,i._)((0,o._)({},e),{items:s()((0,a._)(r).concat((0,a._)(c)))});case S.Hp.UPDATE_INVITATION.request:var l=t.urlToken,u=e.items,d=u.indexOf(l),p=(0,a._)(u);if(d<0)return(0,i._)((0,o._)({},e),{items:[l].concat((0,a._)(p))});return p.splice(d,1),(0,i._)((0,o._)({},e),{items:(0,a._)(p),deleteIndex:d});case S.Hp.UPDATE_INVITATION.failure:var h=t.urlToken,f=e.items,_=f.indexOf(h),m=(0,a._)(f);if(_>=0)return m.splice(h,1),(0,i._)((0,o._)({},e),{items:(0,a._)(m)});return m.splice(e.deleteIndex,0,h),(0,i._)((0,o._)({},e),{items:(0,a._)(m),deleteIndex:-1});default:return e}}(e[t.id],t)):e},similarQuestions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===S.Hp.GET_SIMILAR_QUESTIONS.success){var n=t.id,a=t.payload.data;return(0,i._)((0,o._)({},e),(0,r._)({},n,a))}return e},questionBanners:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===S.Hp.GET_QUESTION_BANNER.success){var n=t.id,a=t.payload.data;return(0,i._)((0,o._)({},e),(0,r._)({},n,a))}return e},relatedCommodities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===S.Hp.GET_RELATED_COMMODITIES.success){var n=t.id,a=t.payload,c=a.data,s=a.attachedInfo;return c.attachedInfo=s,(0,i._)((0,o._)({},e),(0,r._)({},n,c))}return e},bio:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,a=e[n]||{};return t.type===S.Hp.GET_BIO.success?(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},a),{result:t.payload}))):t.type===S.Hp.CHOOSE_BIO.success?(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},a),{result:t.bio}))):e},brand:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===S.Hp.GET_BRAND.success?t.payload:e},permission:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===S.Hp.GET_BRAND_QUESTION_PERMISSION.success?t.payload:e},adverts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===S.Hp.GET_ANSWERS.success&&t.payload.adInfo){var n=t.payload.adInfo,i=n.position,a=n.ad,c=n.adjson;return(0,o._)({},e,(0,r._)({},i,{ad:a,adjson:c}))}return e},advancedStyle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===S.Hp.GET_BRAND_QUESTION_ADVANCED_STYLE.success?t.payload:e},commonAnswerCount:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return t.type===S.Hp.GET_ANSWER_COUNT.success?t.payload.answerCount:t.type===C.uJ.COLLAPSE.success?"nobody"===t.answer.collapsedBy?e-1:e+1:e},hiddenAnswerCount:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return t.type===S.Hp.GET_ANSWER_COUNT.success?t.payload.hiddenAnswerCount:t.type===C.uJ.COLLAPSE.success?"org"===t.collapsedBy||"advertiser"===t.collapsedBy?e+1:e-1:e},topicMeta:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isLoading:{}},t=arguments.length>1?arguments[1]:void 0;if(t.type===S.Hp.GET_META_TOPICS.request){var n=t.id;return(0,i._)((0,o._)({},e),{isLoading:(0,i._)((0,o._)({},e.isLoading),(0,r._)({},n,!0))})}if(t.type===S.Hp.GET_META_TOPICS.success){var a,c=t.payload,s=t.id;return(0,i._)((0,o._)({},e),(a={},(0,r._)(a,s,c),(0,r._)(a,"isLoading",(0,i._)((0,o._)({},e.isLoading),(0,r._)({},s,!1))),a))}if(t.type===S.Hp.GET_META_TOPICS.failure){var l=t.id;return(0,i._)((0,o._)({},e),{isLoading:(0,i._)((0,o._)({},e.isLoading),(0,r._)({},l,!1))})}return e},bluestarRanklist:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===S.Hp.LOAD_RELATED_BLUESTAR_RANKLIST.success){var n=t.payload,a=t.id;return(0,i._)((0,o._)({},e),(0,r._)({},a,n))}return e},relatedSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===S.Hp.GET_RELATED_SEARCH.success){var n=t.id,a=t.payload;return(0,i._)((0,o._)({},e),(0,r._)({},n,a))}return e},autoInvitation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===S.Hp.GET_AUTO_INVITATION.success){var n=t.payload,a=void 0===n?{}:n,c=t.id;return(0,i._)((0,o._)({},e),(0,r._)({},c,a))}if(t.type===S.Hp.OPEN_AUTO_INVITATION.success){var s=t.id,l=e[s];return(0,i._)((0,o._)({},e),(0,r._)({},s,(0,i._)((0,o._)({},l),{status:"open"})))}if(t.type===S.Hp.CLOSE_AUTO_INVITATION.success){var u=t.id,d=e[u];return(0,i._)((0,o._)({},e),(0,r._)({},u,(0,i._)((0,o._)({},d),{status:"close"})))}return e},simpleConcernedFollowers:(0,y.Fd)(S.Hp.GET_SIMPLE_CONCERNED_FOLLOWERS),draftStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===S.Hp.GET_DRAFT.request){var n=t.id;return(0,i._)((0,o._)({},e),(0,r._)({},n,{loading:!0}))}if(t.type===S.Hp.GET_DRAFT.success||t.type===S.Hp.GET_DRAFT.failure){var a=t.id;return(0,i._)((0,o._)({},e),(0,r._)({},a,{loading:!1}))}return e},disclaimers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===S.Hp.GET_DISCLAIMERS.success){var n=t.id,a=t.payload.data;return(0,i._)((0,o._)({},e),(0,r._)({},n,a))}return e},isShowMobileSignInModal:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return t.type===S.yV.SHOW_MOBILE_SIGN_IN_MODAL?t.payload:e}}),A=n(31824);function Z(e,t){var n=t.id;return(e.entities.questions||{})[n]}function w(e){var t;return(null==e?void 0:null===(t=e.muteInfo)||void 0===t?void 0:t.type)==="special_mute"}function R(e){var t;return(null==e?void 0:null===(t=e.muteInfo)||void 0===t?void 0:t.type)==="freeze"}function N(e){return e.question?e.question.permission:{}}function k(e,t){return e.question.inviters["".concat(t,"_all")]}n(28814),(0,A.P1)(function(e){return e.question.adverts},function(e){return[0].concat((0,a._)(Object.keys(e||{}).map(Number).sort(function(e,t){return e-t})))});var O=b},35586:function(e,t,n){"use strict";n.d(t,{O8:function(){return s},ZP:function(){return l},m3:function(){return c}});var r=n(87320),o=n(55164),i=n(57477),a=(0,n(39288).co)("readStatus",["UPDATE"]);function c(e,t){return{type:a.UPDATE,data:{item:e,isRead:t}}}function s(e,t){if(t){var n=t.type,r=t.id,o=e.readStatus[n];if("answer"===n||"article"===n)return!!(o&&o[r])}return!0}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===a.UPDATE){var n=t.data,c=n.item,s=c.type,l=c.id,u=n.isRead;return(0,i._)((0,o._)({},e),(0,r._)({},s,(0,i._)((0,o._)({},e[s]),(0,r._)({},l,u))))}return e}},72238:function(e,t,n){"use strict";n.d(t,{Gz:function(){return v},To:function(){return _},ZP:function(){return T},cP:function(){return m},mA:function(){return f}});var r=n(10840),o=n(20382),i=n(55164),a=n(57477),c=n(74135),s=n(81897),l=n.n(s),u=n(4785),d=n(66263),p=n(39288),h=(0,i._)({},(0,p.FH)("register",["DIGITS","REGISTER","VALIDATE_DIGITS","VALIDATE_REGISTER_FORM","GET_WECHAT_SOCIAL_INFO"]),(0,p.co)("register",["RESET_REGISTER_VALIDATE_RESULT"]));function f(){return{type:h.RESET_REGISTER_VALIDATE_RESULT}}function _(e){return{API:{types:h.VALIDATE_REGISTER_FORM,endpoint:"v3/oauth/validate/register_form",method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,u.Z)((0,c.decamelizeKeys)(e))}}}}function m(e){var t=(0,r._)({},(0,o._)(e));return function(e){return e(f()),e(_(t)).then(function(n){n.payload.success&&e(function(e){return e(f()),e({API:{types:h.REGISTER,endpoint:"v3/oauth/register",method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,u.Z)((0,c.decamelizeKeys)(t))}},NOTIFICATION:!1})})})}}var v=function(e,t){return function(n){var r=l().get("atoken"),o=l().get("atoken_expired_in");if(!r)return Promise.reject();var i=(0,u.z)((0,c.decamelizeKeys)({socialType:e,appkey:d.M5[t||e],expires_at:o,accessToken:r,source:"com.zhihu.web"}));return n({API:{types:h.GET_WECHAT_SOCIAL_INFO,endpoint:"/v3/oauth/social/info",method:"POST",body:i,fetchOptions:{credentials:"include"}},NOTIFICATION:!1})}},g={registerValidateSucceeded:null,registerValidateErrors:{},registerConfirmError:null,sendDigitsError:null,registerConfirmSucceeded:null};function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0,n=t.type;if(n===h.VALIDATE_REGISTER_FORM.success){var r=t.payload;return(0,a._)((0,i._)({},e),{registerValidateSucceeded:!!r.success,registerValidateErrors:(0,i._)({},e.registerValidateErrors,r)})}return n===h.VALIDATE_REGISTER_FORM.failure?(0,a._)((0,i._)({},e),{registerConfirmError:(0,p.O1)(t.err.payload)}):n===h.RESET_REGISTER_VALIDATE_RESULT?(0,i._)({},g):n===h.REGISTER.success?(0,a._)((0,i._)({},e),{registerConfirmSucceeded:!0}):n===h.REGISTER.failure?(0,a._)((0,i._)({},e),{registerConfirmSucceeded:!1,registerConfirmError:(0,p.O1)(t.err.payload)}):n===h.DIGITS.failure?(0,a._)((0,i._)({},e),{sendDigitsError:t.err.payload.message}):n===h.VALIDATE_DIGITS.failure?(0,a._)((0,i._)({},e),{registerValidateErrors:(0,i._)({},e.registerValidateErrors,(0,p.O1)(t.err.payload))}):e}},39041:function(e,t,n){"use strict";n.d(t,{ZP:function(){return C},bG:function(){return T},Jg:function(){return h},$T:function(){return p},gT:function(){return f},ij:function(){return E},OO:function(){return _}});var r=n(87320),o=n(55164),i=n(57477),a=n(39288),c=n(4785),s=n(28953),l=(0,a.FH)("republish",["GET_ARTICLE_REPUBLISH_REQUESTS","GET_ALL_REPUBLISH_REQUESTS","POST_ARTICLE_REPUBLISH","UPDATE_REPUBLISH_PERMISSION"]),u={cancel:"canceled",approve:"approved",reject:"rejected"},d={column:"column_owner",article:"article_author"};function p(e){return{meta:{entityType:"article"},API:{types:l.GET_ARTICLE_REPUBLISH_REQUESTS,endpoint:"/articles/".concat(e,"/republish-requests")},FAILSAFE:!0,schema:s.l.REPUBLISH_ARRAY}}function h(e,t){var n=d[t];return function(r,o){var i,a,c=(null!==(a=null===(i=o().republish)||void 0===i?void 0:i[t])&&void 0!==a?a:{}).paging,u=(null==c?void 0:c.isEnd)===!1?c.next:"/members/".concat(e,"/republish-requests?role=").concat(n);return r({meta:{id:e,entityType:t},API:{types:l.GET_ALL_REPUBLISH_REQUESTS,endpoint:u},FAILSAFE:!0,schema:s.l.REPUBLISH_ARRAY})}}function f(e){var t=e.requestId,n=e.action,i=e.articleId,a=e.columnId;return{API:{types:l.POST_ARTICLE_REPUBLISH,endpoint:"/articles/".concat(i,"/republish"),method:"POST",body:(0,o._)({action:n},"create"===n?{column:a}:{request_id:t})},meta:{articleId:i,requestId:t,result:n},UPDATE:{success:function(){return{republishes:(0,r._)({},t,{state:u[n]})}}}}}function _(e,t){return function(n,o){var i=o().entities.articles[e];return n({API:{types:l.UPDATE_REPUBLISH_PERMISSION,endpoint:"/articles/".concat(e,"/copyright-permission"),method:"PUT",body:(0,c.Z)({copyright_permission:t})},UPDATE:{request:{articles:(0,r._)({},e,{copyrightPermission:t})},failure:{articles:(0,r._)({},e,i)}}})}}var m=n(71728),v=function(e,t){return(null==t?void 0:t[0])?t.map(function(t){var n,r=t.object,a=r.id,c=r.schema,s=t.destination,l=t.proposer,u=t.approver,d=(0,m._)(t,["object","destination","proposer","approver"]);return(0,i._)((0,o._)({},d),{object:null===(n=e.entities["".concat(c,"s")])||void 0===n?void 0:n[a],destination:e.entities.columns[s],approver:e.entities.users[u],proposer:e.entities.users[l]})}):[]},g=function(e){var t=e.isAuthor,n=e.isProfile,r=e.requestType;return n?"approver":t&&"self_recommend"===r?"proposer":"approver"},T=function(e,t){var n=t.isAuthor,r=t.isProfile,o=t.entityType,i=t.requestType,a=e.entities.republishes||{},c=Object.keys(a).map(function(e){return a[e]}).filter(function(){var t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=g({isAuthor:n,isProfile:r,requestType:i});if("column"===o)return a[c]===e.currentUser&&"self_recommend"===a.requestType;var s=i||"invite";return a[c]===e.currentUser&&(null===(t=a.object)||void 0===t?void 0:t.schema)===o&&a.requestType===s});return v(e,c)},E=function(e){var t=e.entities.republishes||{},n=Object.keys(t).map(function(e){return t[e]}).filter(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.proposer===e.currentUser&&"pending"===t.state&&"self_recommend"===t.requestType});return v(e,n)},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.meta,c=t.payload;if(n===l.GET_ARTICLE_REPUBLISH_REQUESTS.request||n===l.GET_ARTICLE_REPUBLISH_REQUESTS.failure||n===l.GET_ALL_REPUBLISH_REQUESTS.failure||n===l.GET_ALL_REPUBLISH_REQUESTS.request){var s=a.entityType;return(0,i._)((0,o._)({},e),(0,r._)({},s,(0,i._)((0,o._)({},e[s]),{isLoading:n===l.GET_ARTICLE_REPUBLISH_REQUESTS.request||n===l.GET_ALL_REPUBLISH_REQUESTS.request})))}if(n===l.GET_ALL_REPUBLISH_REQUESTS.success||n===l.GET_ARTICLE_REPUBLISH_REQUESTS.success){var u=a.entityType,d=c.paging;return(0,i._)((0,o._)({},e),(0,r._)({},u,(0,i._)((0,o._)({},e[u]),{paging:d,isLoading:!1})))}return e}},67036:function(e,t,n){"use strict";n.d(t,{$U:function(){return Z},$j:function(){return w},Ad:function(){return _},BE:function(){return E},Cf:function(){return m},Js:function(){return S},OC:function(){return b},TN:function(){return A},ZP:function(){return k},Ze:function(){return T},i3:function(){return C},nb:function(){return g},on:function(){return I},pb:function(){return v},vu:function(){return y}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(74135),s=n(95769),l=n.n(s),u=n(39288),d=n(67927),p=n(69906),h=n(66263),f=(0,o._)({},(0,u.FH)("reward",["ADD_REWARD","GET_REWARD_USER","ADD_ARTICLE_REWARD","GET_REWARD_USER_DETAILS","GET_ARTICLE_REWARD_USER","GET_PAGING_ARTICLE_REWARD_USER","GET_PAGING_ARTICLE_REWARD_USER_DETAILS","UPDATE_ARTICLE_REWARD","UPDATE_REWARD_FOLLOWERS"]),(0,u.co)("reward",["REMOVE_TRADE_NUMBER","ADD_REWARD_TAGLINE","ON_REWARD_SUCCESS","UPDATE_ENTITIES_USERS","UPDATE_QUESTION_REWARDINFO"]));function _(e,t){return function(n,r){var o=r().reward,i=o.answer,a=o.article,c=Object.keys(i).length>0,s=c?i:a,l=Object.keys(s)[0],u=Object.values(s)[0].users,p=u.filter(function(t){return t.urlToken===e})[0],_=u.indexOf(p);return n(p.isBlocked?(0,d.c0)(h.T$.blocked,"red"):{id:l,user:p,count:t?1:-1,index:_,expect:t,rewardType:c?"answer":"article",API:{types:f.UPDATE_REWARD_FOLLOWERS,endpoint:"members/".concat(p.urlToken,"/followers"),method:t?"POST":"DELETE"}})}}function m(e,t,n){return function(r){return r({API:{types:f.ADD_REWARD,endpoint:"/answers/".concat(e,"/rewarders"),method:"POST",body:(0,c.decamelizeKeys)({amount:t,type:n})},id:e})}}function v(e,t){return function(n){return n({API:{types:f.ADD_ARTICLE_REWARD,endpoint:"/articles/".concat(e,"/tipjar_wallet"),method:"POST",body:(0,c.decamelizeKeys)({price:Number(t)})},id:e})}}function g(e){return function(t){return t({API:{types:f.GET_ARTICLE_REWARD_USER,endpoint:"/articles/".concat(e,"/tipjar"),method:"GET"},id:e})}}function T(e){return function(t){return t({API:{types:f.GET_PAGING_ARTICLE_REWARD_USER,endpoint:"/articles/".concat(e,"/tipjarors"),method:"GET"},id:e})}}function E(e){return function(t){return t({API:{types:f.GET_PAGING_ARTICLE_REWARD_USER_DETAILS,endpoint:"/articles/".concat(e,"/rewarddetails"),method:"GET"},id:e})}}function C(e,t,n){return function(r){var o={tagline:t};return"boolean"==typeof n&&(o.canTip=n),r({API:{types:f.UPDATE_ARTICLE_REWARD,endpoint:"/articles/".concat(e),method:"PUT",body:(0,c.decamelizeKeys)({tipjarSetting:o})},id:e,tagline:t,canTip:n})}}function y(e){return function(t,n){var r=(n().reward[e]||{}).endpoint;return t({API:(0,o._)({types:f.GET_REWARD_USER},r?{endpoint:r}:{endpoint:"answers/".concat(e,"/rewarders"),method:"GET",query:{include:"data[*].answer_count,articles_count,follower_count,is_blocking,is_blocked,is_following,is_followed",offset:0,limit:p.VZ}}),id:e})}}function S(e){return function(t,n){var r=(n().reward[e]||{}).endpoint;return t({API:(0,o._)({types:f.GET_REWARD_USER_DETAILS},r?{endpoint:r}:{endpoint:"answers/".concat(e,"/rewarddetails"),method:"GET",query:{include:"data[*].rewarder.answer_count,articles_count,follower_count,is_blocking,is_blocked,is_following,is_followed",offset:0,limit:p.VZ}}),id:e,NOTIFICATION:!1})}}function I(e,t){return{type:f.REMOVE_TRADE_NUMBER,appsType:t,id:e}}function b(e,t){return{type:f.ADD_REWARD_TAGLINE,text:e,id:t}}function A(e,t,n){return{type:f.ON_REWARD_SUCCESS,appsType:n,users:e,id:t}}function Z(e){return{type:f.UPDATE_ENTITIES_USERS,entities:{users:e}}}function w(e,t){return{type:f.UPDATE_QUESTION_REWARDINFO,questionId:e,isRewardable:t}}function R(e){var t=[];return e.forEach(function(e){var n=e.amount,r=e.created,o=e.rewarder;o.amount=n,o.rewardCreated=r;var i=t.findIndex(function(e){return e.urlToken===o.urlToken});if(-1!==i){t[i].amount+=o.amount;return}t.push(o)}),t}var N={answer:{},article:{},question:{}};function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload,s=t.id;if(n===f.ADD_REWARD.success)return(0,i._)((0,o._)({},e),{answer:(0,i._)((0,o._)({},e.answer),(0,r._)({},s,{users:e.answer[s].users,tradeNumber:c.tradeNumber}))});if(n===f.REMOVE_TRADE_NUMBER){var u=t.appsType;return(0,i._)((0,o._)({},e),(0,r._)({},u,(0,i._)((0,o._)({},e[u]),(0,r._)({},s,{users:e.answer[s].users,tradeNumber:""}))))}if(n===f.ADD_REWARD_TAGLINE)return(0,i._)((0,o._)({},e),{answer:(0,i._)((0,o._)({},e.answer),(0,r._)({},s,{users:e.answer[s].users,tradeNumber:e[s].tradeNumber,rewardTagline:t.text}))});if(n===f.GET_REWARD_USER.success)return(0,i._)((0,o._)({},e),{answer:(0,i._)((0,o._)({},e.answer),(0,r._)({},s,{users:e.answer[s]?l()((0,a._)(e.answer[s].users).concat((0,a._)(c.data)),"id"):c.data,endpoint:c.paging.next}))});if(n===f.ON_REWARD_SUCCESS){var d=t.users,p=t.appsType;return(0,i._)((0,o._)({},e),(0,r._)({},p,(0,i._)((0,o._)({},e[p]),(0,r._)({},s,{users:d}))))}if(n===f.GET_REWARD_USER_DETAILS.success){var h=R(c.data);return(0,i._)((0,o._)({},e),{answer:(0,i._)((0,o._)({},e.answer),(0,r._)({},s,{users:e.answer[s]?l()((0,a._)(e.answer[s].users).concat((0,a._)(h)),"id"):h,notice:c.notice,endpoint:c.paging.next}))})}if(n===f.UPDATE_QUESTION_REWARDINFO){var _=t.questionId,m=t.isRewardable;return(0,i._)((0,o._)({},e),{question:(0,i._)((0,o._)({},e.question),(0,r._)({},_,{isRewardable:m}))})}else if(n===f.GET_ARTICLE_REWARD_USER.success)return(0,i._)((0,o._)({},e),{article:(0,i._)((0,o._)({},e.article),(0,r._)({},s,(0,o._)({},c)))});else if(n===f.GET_PAGING_ARTICLE_REWARD_USER.success){var v=c.data,g=c.paging.next;return(0,i._)((0,o._)({},e),{article:(0,i._)((0,o._)({},e.article),(0,r._)({},s,(0,i._)((0,o._)({},e.article[s]),{users:v,endpoint:g})))})}else if(n===f.GET_PAGING_ARTICLE_REWARD_USER_DETAILS.success){var T=c.data,E=c.paging.next,C=c.notice,y=R(T);return(0,i._)((0,o._)({},e),{article:(0,i._)((0,o._)({},e.article),(0,r._)({},s,(0,i._)((0,o._)({},e.article[s]),{users:y,notice:C,endpoint:E})))})}else if(n===f.UPDATE_ARTICLE_REWARD.success){var S=t.tagline,I=t.canTip;return(0,i._)((0,o._)({},e),{article:(0,i._)((0,o._)({},e.article),(0,r._)({},s,(0,i._)((0,o._)({},e.article[s]),{bio:S,canTip:I})))})}else if(n===f.ADD_ARTICLE_REWARD.success)return(0,i._)((0,o._)({},e),{article:(0,i._)((0,o._)({},e.article),(0,r._)({},s,(0,i._)((0,o._)({},e.article[s]),{tradeNumber:c.tradeNumber})))});else if(n===f.UPDATE_REWARD_FOLLOWERS.request){var b=t.rewardType,A=t.id,Z=t.user,w=t.count,k=t.expect,O=t.index,x=e[b][A].users.map(function(e,t){return t===O&&(e.followerCount=Z.followerCount+w,e.isFollowing=k),e});return(0,i._)((0,o._)({},e),(0,r._)({},b,(0,i._)((0,o._)({},e[b]),(0,r._)({},A,(0,i._)((0,o._)({},e[b][A]),{users:x})))))}else if(n===f.UPDATE_REWARD_FOLLOWERS.failure){var P=t.rewardType,D=t.id,L=t.user,B=t.index,U=e[P][D].users.map(function(e,t){var n=e;return B===t&&(n=L),n});return(0,i._)((0,o._)({},e),(0,r._)({},P,(0,i._)((0,o._)({},e[P]),(0,r._)({},D,(0,i._)((0,o._)({},e[P][D]),{users:U})))))}return e}},87964:function(e,t,n){"use strict";n.d(t,{ZP:function(){return v},AO:function(){return f},OQ:function(){return _}});var r=n(87320),o=n(55164),i=n(57477),a=n(97379),c=n.n(a),s=n(54463),l=n.n(s),u=n(28953),d=n(39288),p="roundtable",h=(0,o._)({},(0,d.FH)(p,["LOAD_OLD_ROUNDTABLE","LOAD_ROUNDTABLE_LIST","LOAD_ROUNDTABLE_DETAIL","LOAD_ROUNDTABLE_HOT_QUESTIONS","LOAD_ROUNDTABLE_WARM_UP_CONTENTS","LOAD_ROUNDTABLE_HOT_DISCUSSIONS","LOAD_ROUNDTABLE_SELECTED_CONTENTS","TOGGLE_FOLLOW_ROUNDTABLE"]),(0,d.co)(p,["EMPTY_ROUNDTABLE"]));function f(e){return{API:{types:h.LOAD_OLD_ROUNDTABLE,endpoint:"roundtables/".concat(e),query:{include:"description,guests,activities_count,questions_count,followers,stop_time,banner,is_following"}},schema:u.l.ROUNDTABLE}}function _(e){return function(t,n){var o=n().entities.roundtables[e],i=o.isFollowing,a=o.followersCount;return t({API:{types:h.TOGGLE_FOLLOW_ROUNDTABLE,endpoint:"roundtables/".concat(e,"/followers"),method:i?"DELETE":"POST"},UPDATE:{request:{roundtables:(0,r._)({},e,{isFollowing:!i,followersCount:i?a-1:a+1})},failure:{roundtables:(0,r._)({},e,o)}}})}}var m={hotQuestions:{},warmupContents:{},hotDiscussions:{},selectedContents:{},roundtables:{}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case h.LOAD_ROUNDTABLE_LIST.request:return(0,i._)((0,o._)({},e),{roundtables:(0,i._)((0,o._)({},e.roundtables),{isLoading:!0})});case h.LOAD_ROUNDTABLE_LIST.failure:return(0,i._)((0,o._)({},e),{roundtables:(0,i._)((0,o._)({},e.roundtables),{isLoading:!1})});case h.LOAD_ROUNDTABLE_LIST.success:if(a){var s=a.data,u=a.paging;return(0,i._)((0,o._)({},e),{roundtables:(0,i._)((0,o._)({},e.roundtables),{isLoading:!1,paging:u,data:l()(e.roundtables.data,s,"urlToken")})})}return(0,i._)((0,o._)({},e),{roundtables:(0,i._)((0,o._)({},e.roundtables),{isLoading:!1})});case h.LOAD_ROUNDTABLE_HOT_QUESTIONS.request:var d=t.meta.urlToken;return(0,i._)((0,o._)({},e),{hotQuestions:(0,i._)((0,o._)({},e.hotQuestions),(0,r._)({},d,(0,i._)((0,o._)({},e.hotQuestions[d]),{isLoading:!0})))});case h.LOAD_ROUNDTABLE_HOT_QUESTIONS.failure:var p=t.meta.urlToken;return(0,i._)((0,o._)({},e),{hotQuestions:(0,i._)((0,o._)({},e.hotQuestions),(0,r._)({},p,(0,i._)((0,o._)({},e.hotQuestions[p]),{isLoading:!1})))});case h.LOAD_ROUNDTABLE_HOT_QUESTIONS.success:var f,_=t.meta.urlToken,v=a.data,g=a.paging,T=v.map(function(e){var t=e.question,n=e.answers;return t?{question:{id:t.id},answers:n.map(function(e){return{id:e.id}})}:null});return(0,i._)((0,o._)({},e),{hotQuestions:(0,i._)((0,o._)({},e.hotQuestions),(0,r._)({},_,(0,i._)((0,o._)({},e.hotQuestions[_]),{isLoading:!1,paging:g,data:c()(null===(f=e.hotQuestions[_])||void 0===f?void 0:f.data,T)})))});case h.LOAD_ROUNDTABLE_WARM_UP_CONTENTS.request:var E=t.meta.urlToken;return(0,i._)((0,o._)({},e),{warmupContents:(0,i._)((0,o._)({},e.warmupContents),(0,r._)({},E,(0,i._)((0,o._)({},e.warmupContents[E]),{isLoading:!0})))});case h.LOAD_ROUNDTABLE_WARM_UP_CONTENTS.failure:var C=t.meta.urlToken;return(0,i._)((0,o._)({},e),{warmupContents:(0,i._)((0,o._)({},e.warmupContents),(0,r._)({},C,(0,i._)((0,o._)({},e.warmupContents[C]),{isLoading:!1})))});case h.LOAD_ROUNDTABLE_WARM_UP_CONTENTS.success:var y=t.meta.urlToken,S=a.data.map(function(e){return{question:{id:e.id}}});return(0,i._)((0,o._)({},e),{warmupContents:(0,i._)((0,o._)({},e.warmupContents),(0,r._)({},y,(0,i._)((0,o._)({},e.warmupContents[y]),{isLoading:!1,data:S})))});case h.LOAD_ROUNDTABLE_HOT_DISCUSSIONS.request:var I=t.meta.urlToken;return(0,i._)((0,o._)({},e),{hotDiscussions:(0,i._)((0,o._)({},e.hotDiscussions),(0,r._)({},I,(0,i._)((0,o._)({},e.hotDiscussions[I]),{isLoading:!0})))});case h.LOAD_ROUNDTABLE_HOT_DISCUSSIONS.failure:var b=t.meta.urlToken;return(0,i._)((0,o._)({},e),{hotDiscussions:(0,i._)((0,o._)({},e.hotDiscussions),(0,r._)({},b,(0,i._)((0,o._)({},e.hotDiscussions[b]),{isLoading:!1})))});case h.LOAD_ROUNDTABLE_HOT_DISCUSSIONS.success:var A,Z=t.meta.urlToken,w=a.paging,R=a.data.map(function(e){var t=e.question,n=e.answers,r=e.article;return t?{question:{id:t.id},answers:(null==n?void 0:n.map(function(e){return{id:e.id}}))||[]}:r?{article:{id:r.id}}:null});return(0,i._)((0,o._)({},e),{hotDiscussions:(0,i._)((0,o._)({},e.hotDiscussions),(0,r._)({},Z,(0,i._)((0,o._)({},e.hotDiscussions[Z]),{isLoading:!1,paging:w,data:c()(null===(A=e.hotDiscussions[Z])||void 0===A?void 0:A.data,R)})))});case h.LOAD_ROUNDTABLE_SELECTED_CONTENTS.request:var N=t.meta.urlToken;return(0,i._)((0,o._)({},e),{selectedContents:(0,i._)((0,o._)({},e.selectedContents),(0,r._)({},N,(0,i._)((0,o._)({},e.selectedContents[N]),{isLoading:!0})))});case h.LOAD_ROUNDTABLE_SELECTED_CONTENTS.failure:var k=t.meta.urlToken;return(0,i._)((0,o._)({},e),{selectedContents:(0,i._)((0,o._)({},e.selectedContents),(0,r._)({},k,(0,i._)((0,o._)({},e.selectedContents[k]),{isLoading:!1})))});case h.LOAD_ROUNDTABLE_SELECTED_CONTENTS.success:var O,x=t.meta.urlToken,P=a.paging,D=a.data.map(function(e){var t=e.answer,n=e.article;return t?{answer:{id:t.id}}:n?{article:{id:n.id}}:null});return(0,i._)((0,o._)({},e),{selectedContents:(0,i._)((0,o._)({},e.selectedContents),(0,r._)({},x,(0,i._)((0,o._)({},e.selectedContents[x]),{isLoading:!1,paging:P,data:c()(null===(O=e.selectedContents[x])||void 0===O?void 0:O.data,D)})))});case h.EMPTY_ROUNDTABLE:return(0,o._)({},e,m);default:return e}}},40861:function(e,t,n){"use strict";n.d(t,{ZP:function(){return s},kB:function(){return c}});var r=n(87320),o=n(55164),i=n(57477),a=(0,n(39288).FH)("shareText",["GET"]);function c(e,t){return{id:e,shareType:t,API:{types:a.GET,endpoint:"".concat(t,"s/").concat(e),query:{include:"share_text"}}}}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===a.GET.success){var n=t.id,c=t.shareType,s=t.payload.shareText;return(0,i._)((0,o._)({},e),(0,r._)({},"".concat(c).concat(n),s))}return e}},55344:function(e,t,n){"use strict";n.d(t,{X2:function(){return v},yS:function(){return m}});var r=n(9338),o=n(55164),i=n(57477),a=n(30971),c=n(74135),s=n(18837),l=n.n(s),u=n(46942),d=n.n(u),p=n(31824),h=n(93292),f=n(80523),_=(0,n(39288).FH)("switches",["GET","GET_VIP_SWITCHES"]),m=["hong-yuan-81-63","te-bie-mi-wang","15101089713","lewisiii","zhihuadmin","fei-xiao-gui","yan-sha-long","dong-hua-si-shu","bei-sen-80-3","2c0db1125100e7229cf159f66d859f8e","807e863f27d8bdb7d3bde20a991ace1d","c64379c8e25578f97e29c6395401d234","869e3a50498ee9f9b4e062267f4d7007","3d198a56310c02c4a83efb9f4a4c027e","41cd5c7249081389da3a523b3cb0629b","dbe159e1503acb112148055bb5b87e1d","07738e6e3211b95849334a4dc95a60a0","bab986472d44f9caa8d2c875f225b216","3b4c31848309b4109a738ee0e523cad7"],v=function(e){var t;return t=(0,r._)(function(t,n){return(0,a.__generator)(this,function(r){switch(r.label){case 0:return[4,Promise.all(e.map(function(e){return t(function(t,n,r){var o=r.fnRefs;return(0,f.Z)(o,"loadSwitches",function(){return l()((0,h.Z)(function(e){return t(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(t,n){var r=n(),o=r.currentUser,i=r.switches;if(o){var a=e.filter(function(e){return!(e in i)});if(a.length)return t({API:{types:_.GET,endpoint:"me/switches",query:{include:d()(a.map(c.decamelize)).join(",")}},meta:{couldSuperVideoUpload:-1!==m.indexOf(o)},NOTIFICATION:!1,FAILSAFE:!0})}}}(e.flat()))},queueMicrotask))})(e)})}))];case 1:return r.sent(),[2,n().switches]}})}),function(e,n){return t.apply(this,arguments)}};function g(e){return e.switches&&e.switches.vipSwitches}(0,p.P1)(g,function(e){return e&&e.mAINSWITCH&&e.sPEEDRENAME}),(0,p.P1)(g,function(e){return e&&e.mAINSWITCH&&e.vIPICON}),(0,p.P1)(g,function(e){return e&&e.mAINSWITCH&&e.wIDGET}),t.ZP=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _.GET.success:return(0,i._)((0,o._)({},e,t.payload),{couldSuperVideoUpload:t.meta.couldSuperVideoUpload});case _.GET_VIP_SWITCHES.success:return(0,i._)((0,o._)({},e),{vipSwitches:t.payload});default:return e}}},76741:function(e,t,n){"use strict";n.d(t,{Hp:function(){return X},sF:function(){return ee},HV:function(){return j},ZP:function(){return er},hX:function(){return W},KS:function(){return Q},rl:function(){return Y}});var r,o=n(87320),i=n(55164),a=n(57477),c=n(49899),s=n(74135),l=n(71549),u=n.n(l),d=n(93206),p=n(69906),h=n(40195),f=n(85879),_=n(84),m=n(57045),v=n(28953),g=n(80714),T=n(65744),E=n(39288),C=n(58909),y=n(31824),S=n(87441),I=n(28814),b=function(e){return e&&e.items},A=function(e,t){var n=t.id;return e.entities.topics[n]},Z=function(e,t){var n=t.id;return e.topic.parent[n]};(0,y.P1)(Z,b);var w=(0,y.P1)(function(e,t){var n=t.id;return e.topic.children[n]},b),R=function(e,t){var n=t.id;return e.topic.bestAnswerers[n]};(0,y.P1)(R,b);var N=function(e){return function(t,n){var r=n.id;return t.topic[e][r]}},k=function(e){return(0,y.P1)(function(e){return e},(0,y.P1)(e,p.kf),function(e,t){return(0,a._)((0,i._)({},t),{items:(t.items||[]).map(function(t){return{sourceTopic:A(e,{id:t.sourceTopic}),target:(0,S.N7)(e,t.target)}})})})},O=N("top");k(O);var x=N("hot");k(x);var P=N("newest");k(P);var D=N("unanswered");k(D);var L=N("questions");k(L);var B=N("zivdeo");k(B);var U=N("zvideo-new");k(U);var M=N("pin20");k(M);var G=N("pin20-new");k(G);var F=N("pin");k(F);var z=N("followers");(0,y.P1)(function(e){return e},(0,y.P1)(z,p.kf),function(e,t){return(0,a._)((0,i._)({},t),{items:(t.items||[]).map(function(t){return(0,I.np)(e,{id:t})})})});var H=N("contributors");(0,y.P1)(function(e){return e},(0,y.P1)(H,p.kf),function(e,t){return(0,a._)((0,i._)({},t),{items:t.items||[]})});var q=(0,y.P1)(function(e,t){var n=t.id;return e.topic.intro[n]},function(e){return e&&e.abstract});(0,y.P1)([q,function(e,t){return t}],function(e,t){var n=t.sid;return e.filter(function(e){return e.sid!==n})}),(0,y.P1)([q,function(e,t){return t}],function(e,t){return t.rank.map(function(t){return e.find(function(e){return e.sid===t})})}),(0,y.P1)(R,w,Z,function(e,t,n){return e&&t&&n}),(0,y.P1)(A,function(e){if(e.showIntro)return!0;var t=e&&e.meta&&e.meta.category;return!!t&&(["variety_show","tv","movie","book","game"].includes(t)||t.startsWith("n_"))});var V={topicBasicMessage:"topicBasicMessage"},X=(0,E.FH)("topic",["GET","GET_VOTE","CREATE","GET_STICKY","GET_INTRO","GET_INDEX","GET_TOP","GET_HOT","GET_NEWEST","GET_ESSENCE_STICKY","UPDATE_ESSENCE_STICKY","GET_UNANSWERED","GET_QUESTIONS","GET_ZVIDEO","GET_ZVIDEO_NEW","GET_PIN20","GET_PIN20_NEW","GET_PIN","GET_PARENT","GET_CHILDREN","GET_BESTANSWERERS","GET_WIKI_META","GET_WIKI_EDIT_INFO","GET_COMMITTED_WIKI","VOTE_WIKI","GET_FOLLOWERS","GET_CONTRIBUTORS","UPDATE_FOLLOW","UPDATE_BIO","UPDATE","UPDATE_INTRO","GET_META_CATEGORIES","GET_META_CATEGORY","CREATE_META","UPDATE_META","GET_META","UPDATE_TOPIC_CONTRIBUTOR_FOLLOWERS","GET_CREATOR_WALL","GET_CREATOR_WALL_ENTRY","GET_CREATOR_WALL_USER_INFO","UPDATE_VOTE_TOPIC","COMMIT_WIKI","CREATE_ABSTRACT","UPDATE_ABSTRACT_RANK","DELETE_ABSTRACT","GET_LANDING_BASIC_DATA","GET_LANDING_EXCELLENT_ITEMS","GET_LANDING_EXCELLENT_EDITORS","GET_LANDING_CATALOG","GET_LANDING_ENTRIES","APPLY_LANDING_PERMISSION"]);function W(e){return{id:e,API:{types:X.GET,endpoint:"topics/".concat(e),query:{include:"introduction,questions_count,best_answers_count,followers_count,is_following,header_card"},root:"".concat(g.Z.fetchRoot.www,"/api/v5.1/")},UPDATE:{success:function(t){return(0,o._)({},"topics",(0,o._)({},e,function(e,t){var n=t.include,r=(void 0===n?{}:n).vote,o=t.permission,c=void 0===o?{}:o,s=c.isMetaEditable,l=c.isIndexEditable,u=c.viewCommit,d=c.editBaike,p=c.createBaike,h=c.addMoreInfo,f=t.include,_=void 0===f?{}:f,m=_.vote,v=void 0===m?{}:m,g=v.score,T=v.disliked,E=v.liked,C=_.meta,y=t.excerpt,S=t.introduction,I=t.wikiDescription,b=t.name,A=t.subtitle,Z=t.avatarUrl,w=t.pubInfo,R=void 0===w?{}:w,N=R.status,k=R.pubDate,O=t.themeConfig,x=(void 0===O?{}:O).avatarStyle;if(e===V.topicBasicMessage)return(0,a._)((0,i._)({},t),{relationship:{isMetaEditable:s},vote:(0,a._)((0,i._)({},r),{ratio:g,status:T?"dislike":E?"like":"none"}),headerCard:{description1:void 0===y?"":y,description2:void 0===S?"":S,wikiDescription:void 0===I?"":I,title:void 0===b?"":b,subtitle:void 0===A?"":A,avatarUrl:Z,pubInfo:{status:N,pubDate:k},config:{avatarType:x}},meta:void 0===C?{}:C,isIndexEditable:l,viewCommit:u,editBaike:d,createBaike:p,addMoreInfo:h})}("topicBasicMessage",t)))}}}}var K=/创建 ([\w\W]*) 话题/;function j(e){return{API:{types:X.CREATE,endpoint:"/topics",method:"POST",body:{name:function e(t){return K.test(t)?e(t.match(K)[1]):t}(e)}},NOTIFICATION:{failure:function(t){return 269!==t.code||((0,T.t)((0,f.BX)("div",{children:["该话题被暂停使用，请",(0,f.tZ)("a",{style:{color:"#3e7ac2"},href:"//".concat(g.Z.wwwHost,"/messages/3d198a56310c02c4a83efb9f4a4c027e?").concat(m.stringify({message:"我想要创建「".concat(e,"」话题，系统提示被暂停使用，需要恢复")})),children:"私信「知一声」"}),"申请恢复创建"]}),{delay:6e3}),!1)}}}}function Y(e,t){return{API:{types:X.UPDATE_BIO,endpoint:"/topics/".concat(e,"/bio"),body:(0,s.decamelizeKeys)({bio:t}),method:"PUT"},id:e,bio:t}}function Q(e,t){return function(n,r){var c,s=r(),l=(0,C.ib)(s),u=A(s,{id:e}),d=(t=void 0===t?!u.isFollowing:t)?1:-1,p={request:{},failure:{}};return u&&(p.request.topics=(0,o._)({},e,{isFollowing:t}),p.failure.topics=(0,o._)({},e,u)),l&&(p.request.users=(0,o._)({},l.urlToken,{followingTopicCount:l.followingTopicCount+d}),p.failure.users=(0,o._)({},l.urlToken,l)),n((0,i._)((0,a._)((0,i._)({},l&&{urlToken:l.urlToken}),{topicId:e,UPDATE:p}),(c=t,{API:{types:X.UPDATE_FOLLOW,endpoint:"topics/".concat(e,"/followers"),method:c?"POST":"DELETE"}})))}}function J(e,t){var n=t.resource,r=t.endpoint,o=t.types,c=t.query,s="".concat(g.Z.fetchRoot.www,"/api");return{id:e,API:(0,a._)((0,i._)({types:o},r?{root:s,endpoint:r}:{root:s,endpoint:"/v5.1/topics/".concat(e,"/feeds/").concat(n),query:{include:"data[?(target.type=topic_sticky_module)].target.data[?(target.type=answer)].target.content,relationship.is_authorized,is_author,voting,is_thanked,is_nothelp;data[?(target.type=topic_sticky_module)].target.data[?(target.type=answer)].target.is_normal,comment_count,voteup_count,content,relevant_info,excerpt.author.badge[?(type=best_answerer)].topics;data[?(target.type=topic_sticky_module)].target.data[?(target.type=article)].target.content,voteup_count,comment_count,voting,author.badge[?(type=best_answerer)].topics;data[?(target.type=topic_sticky_module)].target.data[?(target.type=people)].target.answer_count,articles_count,gender,follower_count,is_followed,is_following,badge[?(type=best_answerer)].topics;data[?(target.type=answer)].target.annotation_detail,content,hermes_label,is_labeled,relationship.is_authorized,is_author,voting,is_thanked,is_nothelp,answer_type;data[?(target.type=answer)].target.author.badge[?(type=best_answerer)].topics;data[?(target.type=answer)].target.paid_info;data[?(target.type=article)].target.annotation_detail,content,hermes_label,is_labeled,author.badge[?(type=best_answerer)].topics;data[?(target.type=question)].target.annotation_detail,comment_count;"}}),{query:c}),schema:v.l.TOPIC_FEED_ARRAY}}function $(e,t){return function(n,r){return function(o,i){var a=(e(i(),{id:n})||{}).next,c=r||{},s=c.offset,l=c.limit,u=s||!a?{offset:s,limit:l}:{endpoint:a};return o(t(n,u))}}}$(O,function(e,t){return J(e,(0,a._)((0,i._)({},t),{resource:"top_activity",types:X.GET_TOP}))}),$(x,function(e,t){return J(e,(0,a._)((0,i._)({},t),{resource:"essence",types:X.GET_HOT}))}),$(P,function(e,t){return J(e,(0,a._)((0,i._)({},t),{resource:"timeline_activity",types:X.GET_NEWEST}))}),new _.fK.Array(new _.fK.Object({data:v.l.TOPIC_FEED_ARRAY})),$(D,function(e,t){return J(e,(0,a._)((0,i._)({},t),{resource:"top_question",types:X.GET_UNANSWERED}))}),$(L,function(e,t){return J(e,(0,a._)((0,i._)({},t),{resource:"new_question",types:X.GET_QUESTIONS}))}),$(B,function(e,t){return J(e,(0,a._)((0,i._)({},t),{resource:"top_zvideo",types:X.GET_ZVIDEO}))}),$(U,function(e,t){return J(e,(0,a._)((0,i._)({},t),{resource:"new_zvideo",types:X.GET_ZVIDEO_NEW}))}),$(M,function(e,t){return J(e,(0,a._)((0,i._)({},t),{resource:"pin-hot",types:X.GET_PIN20}))}),$(G,function(e,t){return J(e,(0,a._)((0,i._)({},t),{resource:"pin-new",types:X.GET_PIN20_NEW}))}),$(F,function(e,t){return J(e,(0,a._)((0,i._)({},t),{resource:"pin-new",types:X.GET_PIN,query:{offset:0,limit:30}}))}),$(z,function(e,t){var n=t.offset,r=t.limit,o=void 0===r?20:r,a=t.endpoint;return{id:e,API:(0,i._)({types:X.GET_FOLLOWERS},a?{endpoint:a}:{endpoint:"topics/".concat(e,"/followers"),query:{offset:n,limit:o,include:"data[*].gender,answer_count,articles_count,follower_count,is_following,is_followed"}}),offset:n,limit:o,schema:v.l.USER_ARRAY}}),$(H,function(e,t){var n=t.offset,r=t.limit,o=void 0===r?20:r,a=t.endpoint;return{id:e,API:(0,i._)({types:X.GET_CONTRIBUTORS},a?{endpoint:a}:{endpoint:"topics/".concat(e,"/contributors"),query:{offset:n,limit:o,include:"data[*].gender,is_following,is_followed"}}),offset:n,limit:o,schema:v.l.USER_ARRAY}});var ee=function(e){var t=e.topicId,n=e.type,r=e.token,o=e.content;return{API:{endpoint:"/topics/".concat(t,"/abstract"),types:X.CREATE_ABSTRACT,method:"POST",body:(0,s.decamelizeKeys)({type:n,token:r,content:o})},NOTIFICATION:{success:"操作成功",failure:function(e){return e.message}}}},et=Object.prototype.hasOwnProperty;function en(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(n.type===e){var r=n.payload,a=n.id;return(0,i._)({},t,r.data?(0,o._)({},a,{items:r.data,next:(r.paging||{}).next,isDrained:(r.paging||{}).isEnd}):(0,o._)({},a,n.result||r))}return t}}var er=(0,d.combineReducers)((r={bios:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h.Hp.GET_BIOS.request:return(0,a._)((0,i._)({},e),{isFetching:!0});case h.Hp.GET_BIOS.success:return t.payload.data.reduce(function(e,t){var n=t.topic.id,r=t.bio;return(0,a._)((0,i._)({},e),(0,o._)({},n,r))},(0,a._)((0,i._)({},e),{isFetching:!1}));case h.Hp.GET_BIOS.failure:return(0,a._)((0,i._)({},e),{isFetching:!1});case X.UPDATE_BIO.success:return(0,a._)((0,i._)({},e),(0,o._)({},t.id,t.bio));default:return e}},hot:(0,p.QT)(X.GET_HOT),newest:(0,p.QT)(X.GET_NEWEST),top:(0,p.QT)(X.GET_TOP),sticky:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===X.GET_ESSENCE_STICKY.success?t.payload||null:e},pin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id;switch(t.type){case X.GET_PIN.success:return(0,o._)({},n,(0,a._)((0,i._)({data:t.result},e[n]),{isFetching:!1,isDrained:!0}));case X.GET_PIN.request:return(0,o._)({},n,(0,a._)((0,i._)({},e[n]),{isFetching:!0,isDrained:!0}));default:return e}},unanswered:(0,p.QT)(X.GET_UNANSWERED),questions:(0,p.QT)(X.GET_QUESTIONS),zivdeo:(0,p.QT)(X.GET_ZVIDEO),"zvideo-new":(0,p.QT)(X.GET_ZVIDEO_NEW),pin20:(0,p.QT)(X.GET_PIN20),"pin20-new":(0,p.QT)(X.GET_PIN20_NEW),followers:(0,p.QT)(X.GET_FOLLOWERS),contributors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.id;switch(t.type){case X.GET_CONTRIBUTORS.request:return(0,a._)((0,i._)({},e),(0,o._)({},r,(0,a._)((0,i._)({},e[r]),{isFetching:!0,isDrained:!1})));case X.GET_CONTRIBUTORS.success:return(0,i._)({},e,n.data?(0,o._)({},r,{items:n.data,next:(n.paging||{}).next,isDrained:(n.paging||{}).isEnd,isFetching:!1}):(0,o._)({},r,t.result||n));case X.GET_CONTRIBUTORS.failure:return(0,a._)((0,i._)({},e),(0,o._)({},r,(0,a._)((0,i._)({},e[r]),{isFetching:!1,isDrained:!0})));case X.UPDATE_TOPIC_CONTRIBUTOR_FOLLOWERS.success:var c=t.userUrlToken,s=e[r].items.map(function(e){var t=e.author,n=e.author,r=n.urlToken,o=n.isFollowing;return r===c?(0,a._)((0,i._)({},e),{author:(0,a._)((0,i._)({},t),{isFollowing:!o})}):e});return(0,a._)((0,i._)({},e),(0,o._)({},r,(0,a._)((0,i._)({},e[r]),{items:s})));default:return e}},parent:en(X.GET_PARENT.success),children:en(X.GET_CHILDREN.success),bestAnswerers:en(X.GET_BESTANSWERERS.success)},(0,o._)(r,"wikiMeta",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id;switch(t.type){case X.GET_WIKI_META.success:return(0,a._)((0,i._)({},e),(0,o._)({},n,t.payload));case X.VOTE_WIKI.success:var r=t.upVote,c=e[n].voteInfo.num;return(0,a._)((0,i._)({},e),(0,o._)({},n,(0,a._)((0,i._)({},e[n]),{hasVoted:r,voteInfo:{num:r?c+1:c-1}})));default:return e}}),(0,o._)(r,"index",en(X.GET_INDEX.success)),(0,o._)(r,"intro",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.topicAbstract,c=t.topicRestAbstract,s=t.topicRankedAbstract;switch(t.type){case X.GET_INTRO.success:return(0,a._)((0,i._)({},e),(0,o._)({},n,t.payload));case X.DELETE_ABSTRACT.request:return(0,a._)((0,i._)({},e),(0,o._)({},n,(0,a._)((0,i._)({},e[n]),{abstract:c})));case X.UPDATE_ABSTRACT_RANK.request:return(0,a._)((0,i._)({},e),(0,o._)({},n,(0,a._)((0,i._)({},e[n]),{abstract:void 0===s?[]:s})));case X.DELETE_ABSTRACT.failure:case X.UPDATE_ABSTRACT_RANK.failure:return(0,a._)((0,i._)({},e),(0,o._)({},n,(0,a._)((0,i._)({},e[n]),{abstract:r})));default:return e}}),(0,o._)(r,"meta",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case X.GET_META.success:return(0,a._)((0,i._)({},e),(0,o._)({},t.id,t.payload.data));case X.UPDATE_META.success:var n=t.id,r=t.payload,c=e[n];return(0,a._)((0,i._)({},e),(0,o._)({},n,c.map(function(e){var t=e.target;if("Table"===t.type)return(0,a._)((0,i._)({},e),{target:(0,a._)((0,i._)({},e.target),{value:t.value.map(function(e){var t=(0,s.camelize)(e.target.name);return et.call(r,t)?(0,a._)((0,i._)({},e),{target:(0,a._)((0,i._)({},e.target),{value:r[t].value})}):e})})});if(Array.isArray(t))return(0,a._)((0,i._)({},e),{target:t.map(function(e){var t=(0,s.camelize)(e.target.name);return et.call(r,t)?(0,a._)((0,i._)({},e),{target:(0,a._)((0,i._)({},e.target),{value:r[t].value})}):e})});var n=(0,s.camelize)(t.name);return et.call(r,n)?(0,a._)((0,i._)({},e),{target:(0,a._)((0,i._)({},e.target),{value:r[n].value})}):e})));default:return e}}),(0,o._)(r,"schema",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case X.GET_META_CATEGORIES.success:return(0,a._)((0,i._)({},e),{categories:t.payload.data});case X.GET_META_CATEGORY.success:return(0,a._)((0,i._)({},e),{category:(0,a._)((0,i._)({},e.category),(0,o._)({},t.category,t.payload.schema))});default:return e}}),(0,o._)(r,"creatorWall",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.id;if(t.type===X.GET_CREATOR_WALL.request)return u()(e,(0,o._)({},r,{paging:{loading:!0}}));if(t.type===X.GET_CREATOR_WALL.success){var s=e[r],l=(void 0===s?{}:s).items,d=void 0===l?[]:l;return(0,a._)((0,i._)({},e),(0,o._)({},r,(0,a._)((0,i._)({},n),{items:(0,c._)(d).concat((0,c._)(t.result)),paging:(0,a._)((0,i._)({},n.paging),{loading:!1})})))}return e}),(0,o._)(r,"wikiEditInfo",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.type,c=t.payload;if(r===X.GET_WIKI_EDIT_INFO.success){var s=c.canEdit,l=c.hasCommit;return void 0===s||void 0===l?e:(0,a._)((0,i._)({},e),(0,o._)({},n,c))}return e}),(0,o._)(r,"committedWiki",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.type,c=t.payload;if(r===X.GET_COMMITTED_WIKI.success){var s=c.data;return s?(0,a._)((0,i._)({},e),(0,o._)({},n,s)):e}return e}),(0,o._)(r,"landingBasicData",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===X.GET_LANDING_BASIC_DATA.success?r:e}),(0,o._)(r,"landingExcellentItems",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===X.GET_LANDING_EXCELLENT_ITEMS.success?r.excellentItems:e}),(0,o._)(r,"landingExcellentEditors",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===X.GET_LANDING_EXCELLENT_EDITORS.success?r.editors:e}),(0,o._)(r,"landingCatalog",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===X.GET_LANDING_CATALOG.success?r.data:e}),(0,o._)(r,"landingEntries",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===X.GET_LANDING_ENTRIES.success?r:e}),r))},61317:function(e,t,n){"use strict";n.d(t,{ZP:function(){return D},Tl:function(){return I}});var r,o=n(87320),i=n(55164),a=n(57477),c=n(49899),s=n(93206),l=n(2466),u=n(44986),d=n(74351),p=n(57266),h=n.n(p),f=n(95769),_=n.n(f),m=function(e){var t=e.payloadOrigin,n=e.currentUser;if((0,d.isBrowser)()){var r=t.data.map(function(e){return e.target}).filter(function(e){return!!e});_()(r,function(e){return"".concat(e.type,"_").concat(e.id)}).length<r.length&&window.Raven.captureException(Error("topstory recommend list duplication"),{extra:h()({payloadOrigin:t,currentUser:n},Boolean),level:"warning"})}},v=n(74135);n(28953);var g=n(80714),T=n(4785),E=n(39288),C=n(69906),y=(0,i._)({},(0,E.FH)("topstory",["GET_RECOMMEND","GET_FOLLOW","GET_FOLLOW_WONDERFUL","GET_ASIDEDATA","UNINTEREST","UNINTEREST_REASONS","GET_ANNOUNCEMENT","GET_HOT_LIST_CATEGORIES","UPDATE_HOT_LIST_CATEGORIES","GET_HOT_LIST","GET_GUEST_FEEDS","GET_FOLLOW_EXTRA","GET_HOT_DAILY","GET_HOT_HIGHLIGHT","GET_BANNER","GET_COMMERCIAL_BANNER","GET_VIDEOS"]),(0,E.co)("topstory",["DIMISS_ANNOUNCEMENT","UPDATE_FOLLOW_COUNT","RESET_RECOMMEND","RESET_FOLLOW","RESET_FOLLOW_WONDERFUL","RESET_HOT_LIST","CLEAR_VIDEOS"])),S=(0,o._)({},g.Z.isMobileEntry?"mobile":"desktop",!0);function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"topstorys";return function(n,r){var i=r(),a=i.topstory,c=i.entities,s=a[t],l=s.sessionToken,u=s.items.find(function(t){return t.id===e}).schema,d="".concat(u,"s"),p=c[d][e],h=p.brief;return n({API:{types:y.UNINTEREST,endpoint:"v3/feed/topstory/uninterestv2",body:(0,T.z)((0,v.decamelizeKeys)({itemBrief:h,sessionToken:l})),method:"POST"},UPDATE:{request:(0,o._)({},d,(0,o._)({},e,{isDelete:!0})),failure:(0,o._)({},d,(0,o._)({},e,p))},NOTIFICATION:{success:"已减少此类内容出现"}})}}(0,i._)({limit:C.VZ},S);var b=n(44808),A=(0,i._)({},(0,E.FH)("negativeFeedback",["NEGATIVE_FEEDBACK_UNINTERESTED","NEGATIVE_FEEDBACK_CONTENT"]));function Z(){return{meta:{},isFetching:!1,isDrained:!1,afterId:0,items:[],next:null}}r={},["repeat","quality"].forEach(function(e){return r[e]=e});var w=(0,s.combineReducers)({recommend:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,afterId:0,items:[],next:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y.GET_RECOMMEND.request:return(0,a._)((0,i._)({},e),{isFetching:!0});case y.GET_RECOMMEND.success:var n=t.result,r=t.isDrained,o=t.next,s=t.payloadOrigin,l=t.currentUser,u=e.items,p=n.filter(function(e){var t=e.id;return!u.find(function(e){return e.id===t})});m({payloadOrigin:s,currentUser:l});var h=(0,c._)(u).concat((0,c._)(p));return(0,a._)((0,i._)({},e),{isDrained:r,isFetching:!1,afterId:(h[h.length-1]||{}).id,items:h,next:o,sessionToken:t.payload.sessionToken,serverPayloadOrigin:(0,d.isBrowser)()?null:s});case y.GET_RECOMMEND.failure:return(0,a._)((0,i._)({},e),{isFetching:!1,isDrained:!0});case y.RESET_RECOMMEND:return Z();default:return e}},follow:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,afterId:0,items:[],next:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y.GET_FOLLOW.request:return(0,a._)((0,i._)({},e),{isFetching:!0});case y.GET_FOLLOW.success:var n=t.result,r=t.isDrained,o=t.next,s=e.items,l=n.filter(function(e){var t=e.id;return!s.find(function(e){return e.id===t})}),u=(0,c._)(s).concat((0,c._)(l));return(0,a._)((0,i._)({},e),{isDrained:r,isFetching:!1,afterId:(u[u.length-1]||{}).id,items:u,next:o,sessionToken:t.payload.sessionToken});case y.GET_FOLLOW.failure:return(0,a._)((0,i._)({},e),{isFetching:!1,isDrained:!0});case y.RESET_FOLLOW:return Z();default:return e}},followWonderful:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,afterId:0,items:[],next:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y.GET_FOLLOW_WONDERFUL.request:return(0,a._)((0,i._)({},e),{isFetching:!0});case y.GET_FOLLOW_WONDERFUL.success:var n=t.result,r=t.isDrained,o=t.next,s=t.hasNew,l=e.items,u=n.filter(function(e){var t=e.id;return!l.find(function(e){return e.id===t})}),d=(0,c._)(l).concat((0,c._)(u));return(0,a._)((0,i._)({},e),{isDrained:r,isFetching:!1,afterId:(d[d.length-1]||{}).id,items:d,next:o,sessionToken:t.payload.sessionToken,hasNew:s});case y.GET_FOLLOW_WONDERFUL.failure:return(0,a._)((0,i._)({},e),{isFetching:!1,isDrained:!0,hasNew:!0});case y.RESET_FOLLOW_WONDERFUL:return Z();default:return e}},sidebar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return t.type===y.GET_ASIDEDATA.success?t.payload:e},announcement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===y.GET_ANNOUNCEMENT.success&&t.payload?(0,a._)((0,i._)({},e),{data:t.payload}):t.type===y.DIMISS_ANNOUNCEMENT?(0,a._)((0,i._)({},e),{dimiss:!0}):e},hotList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=(t.payload||{}).data;return t.type===y.GET_HOT_LIST.success?n:t.type===y.RESET_HOT_LIST?[]:e},hotListHeadZone:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=(t.payload||{}).headZone;return t.type===y.GET_HOT_LIST.success?n||{}:e},guestFeeds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,afterId:0,items:[],next:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y.GET_GUEST_FEEDS.request:return(0,a._)((0,i._)({},e),{isFetching:!0});case y.GET_GUEST_FEEDS.success:var n=t.result,r=t.isDrained,o=t.next,s=t.offset,l=e.items,u=n.slice(s||0).filter(function(e){var t=e.id;return!l.find(function(e){return e.id===t})}),d=(0,c._)(l).concat((0,c._)(u));return(0,a._)((0,i._)({},e),{isDrained:r,isFetching:!1,afterId:(d[d.length-1]||{}).id,items:d,next:o,sessionToken:t.payload.sessionToken});case y.GET_GUEST_FEEDS.failure:return(0,a._)((0,i._)({},e),{isFetching:!1,isDrained:!0});default:return e}},followExtra:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isNewUser:null,isFetched:!1,followCount:0,followers:[]},t=arguments.length>1?arguments[1]:void 0;if(t.type===y.GET_FOLLOW_EXTRA.success){var n=t.payload.guideCard.styleType;return(0,a._)((0,i._)({},e),{isNewUser:"big"===n,isFetched:!0})}if(t.type===y.UPDATE_FOLLOW_COUNT){var r,o=t.payload.urlToken,s=e.followers;return r=s.findIndex(function(e){return e===o})>-1?s.filter(function(e){return e!==o}):(0,c._)(s).concat([o]),(0,a._)((0,i._)({},e),{followers:r,followCount:r.length})}return e},hotDaily:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{data:[],paging:{}},t=arguments.length>1?arguments[1]:void 0;return t.type===y.GET_HOT_DAILY.success?t.payload:e},hotHighlight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,data:[],paging:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case y.GET_HOT_HIGHLIGHT.request:case y.GET_HOT_HIGHLIGHT.failure:return(0,a._)((0,i._)({},e),{isFetching:t.type===y.GET_HOT_HIGHLIGHT.request});case y.GET_HOT_HIGHLIGHT.success:return(0,a._)((0,i._)({},e),{isFetching:!1,paging:t.payload.paging,data:(0,c._)(e.data).concat((0,c._)(r.data))});default:return e}},banner:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;if(n===y.GET_BANNER.success){var c=t.meta.position;return(0,a._)((0,i._)({},e),(0,o._)({},c,r.data))}return e},commercialBanner:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{show:!1,banner:{},trackData:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;if(n===y.GET_COMMERCIAL_BANNER.success){var o=(0,l.iL)((0,u.PO)({adjson:null==r?void 0:r.banner})),c=o.creative,s=o.ad,d=void 0===s?{}:s,p=d.id,h=d.template,f=void 0===h?"":h,_=d.impressionTracks,m=d.viewTracks,v=d.clickTracks,g=(void 0===c?{asset:{}}:c).asset,T=g.imgs,E=g.landingUrl,C=g.imgHue;return(0,a._)((0,i._)({},e),{show:"home_top_big_pc_template"===f,trackData:"home_top_big_pc_template"===f?{impressionTracks:void 0===_?[]:_,viewTracks:void 0===m?[]:m,clickTracks:void 0===v?[]:v}:{},banner:{id:p,url:void 0===E?"":E,imageUrl:(void 0===T?[]:T)[0],bgColor:C?"#".concat(C):"GBK99A"}})}return e},video:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{items:[],next:null,isLoading:!1,isDrained:!1},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,o=t.index;switch(n){case y.CLEAR_VIDEOS:return(0,a._)((0,i._)({},e),{items:[],isLoading:!1});case y.GET_VIDEOS.request:return(0,a._)((0,i._)({},e,t.clear&&{items:[]}),{isLoading:!0});case y.GET_VIDEOS.success:return(0,a._)((0,i._)({},e),{items:(0,c._)(e.items).concat((0,c._)(r.data)),next:r.paging.next,isDrained:r.paging.isEnd,isLoading:!1});case A.NEGATIVE_FEEDBACK_UNINTERESTED.success:case A.NEGATIVE_FEEDBACK_CONTENT.success:return(0,b.Uy)(e,function(e){e.items[o]&&(e.items[o].blocked=t.blocked,e.items[o].blockedType=t.blockedType)})}return e}}),R=n(31824),N=n(2493);function k(e,t){var n=e.feeds[t.id],r=n.target,o=(e["".concat(r.schema,"s")]||{})[r.id];return null!=o?(0,i._)({},n,o&&{target:o}):n}var O={meta:{},isFetching:!1,items:[],isDrained:!1},x=function(e,t){var n=e.topstory[t]||O,r=n.meta,o=n.isFetching,a=n.isDrained,c=n.items,s=n.serverPayloadOrigin;return(0,i._)({meta:r,isFetching:o,isDrained:a,items:c},"recommend"===t&&{serverPayloadOrigin:s,currentUser:e.currentUser})},P=function(e){return(0,N.Z)(function(t){return x(t,e)},function(e){return e.entities},function(t,n){return(0,a._)((0,i._)({},t),{items:t.items.map(function(t){return function(e,t){var n,r,o,c,s,l,u,p=t.id,h=t.schema;try{switch(h){case"actionCard":return n=e.actionCards,r=e.topics,c=(o=n[p]).card,(s=o.card.topicList)?(0,a._)((0,i._)({},o),{card:(0,a._)((0,i._)({},c),{topicList:s.map(function(e){return r[e]})})}):null;case"feed":return k(e,{id:p});case"feedAdvert":return e.feedAdverts[p];case"feedGroup":return u=(l=e.feedGroups)&&l[p],(0,a._)((0,i._)({},u),{list:u.list.map(function(t){return k(e,{id:t})})});default:return t}}catch(e){(0,d.isBrowser)()&&window.Raven.captureException(e,{level:"warning",extra:t})}return null}(n,t,e)}).filter(Boolean)})})};P("follow"),P("followWonderful"),P("recommend"),(0,R.P1)(function(e){var t=e.topstory.guestFeeds||O;return{isFetching:t.isFetching,isDrained:t.isDrained,items:t.items}},function(e){return e.entities},function(e,t){return(0,a._)((0,i._)({},e),{items:e.items.map(function(e){return k(t,e)}).filter(Boolean)})});var D=w},48825:function(e,t,n){"use strict";n.d(t,{Ix:function(){return h},ZP:function(){return f},x1:function(){return p}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(74135),s=n(71746),l=n(77440),u=(0,n(39288).FH)("upload",["IMAGE","VIDEO"]);function d(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0;return(0,o._)({NOTIFICATION:"default"!==n&&{failure:"上传失败"},uploadId:n},(t=new FormData,"string"==typeof e?t.append("url",e):t.append("picture",e),r&&t.append("source",r),{API:{types:u.IMAGE,endpoint:"/uploaded_images",method:"POST",body:t,headers:{Accept:"application/json"},fetchOptions:{credentials:"include"}}}))}var p=(0,l.aF)(s.Z,!0),h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;return function(i){return"string"!=typeof e?p(e,{source:r,autoRotate:o}).then(function(e){return i({type:u.IMAGE.success,uploadId:t,payload:(0,c.camelizeKeys)(e)})},function(o){if(n.g.raven){var c=Error(o.message);c.name="UploadError",n.g.raven.captureException(c),n.g.raven.captureException(o)}return(0,l.aF)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i(d.apply(void 0,(0,a._)(t)))})(e,t,r)}):(0,l.aF)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i(d.apply(void 0,(0,a._)(t)))})(e,t,r)}};function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.IMAGE.request:case u.IMAGE.failure:return(0,i._)((0,o._)({},e),(0,r._)({},t.uploadId,null));case u.IMAGE.success:return(0,i._)((0,o._)({},e),(0,r._)({},t.uploadId,{url:t.payload.src,rawWidth:t.payload.dataRawwidth,rawHeight:t.payload.dataRawheight,id:t.payload.hash}));case u.VIDEO.request:case u.VIDEO.failure:return(0,i._)((0,o._)({},e),{video:null});case u.VIDEO.success:return(0,i._)((0,o._)({},e),{video:t.payload});default:return e}}},96354:function(e,t,n){"use strict";n.d(t,{Yr:function(){return c},ZP:function(){return u},nh:function(){return s}});var r=n(55164),o=n(57477),i=n(39288),a=(0,r._)({},(0,i.FH)("userProfit",["GET_MEMBER_STATUS","UPDATE_MEMBER_STATUS","GET_USER_PROFIT_PERMISSION","GET_LINK_CARD_LIMIT"]));function c(){return{API:{types:a.GET_USER_PROFIT_PERMISSION,endpoint:"mcn/permission/profit"}}}function s(){return{API:{types:a.GET_LINK_CARD_LIMIT,endpoint:"mcn/v2/limit/linkcard"}}}var l={permission:{permissionStatus:{zhiZixuan:0,recommend:-1,task:0,plugin:0,infinity:0},visible:!1},linkCardLimit:0};function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;return t.type===a.GET_USER_PROFIT_PERMISSION.success?(0,o._)((0,r._)({},e),{permission:t.payload}):t.type===a.GET_LINK_CARD_LIMIT.success?(0,o._)((0,r._)({},e),{linkCardLimit:t.payload.data}):e}},28814:function(e,t,n){"use strict";n.d(t,{KX:function(){return d},cw:function(){return l},np:function(){return u}});var r=n(87320),o=n(84),i=n(28953),a=n(39288),c=n(67927),s=n(66263),l=(0,a.FH)("user",["UPDATE_FOLLOWERS","LOAD_USER_DMP_CROWD","RECOMMEND_FOLLOW_PEOPLE_TOPSTORY"]),u=function(e,t){var n=t.urlToken,r=t.id,o=e.entities.users,i=void 0===o?{}:o;return i[n||r]||i[Object.keys(i).find(function(e){return i[e].id===r})]};function d(e,t){return function(n,o){var i,a,u=o(),d=u.entities.users,p=u.currentUser,h=d[e]||{};if(h.isBlocked)return n((0,c.c0)(s.T$.blocked,"red"));var f=d[p],_=t?1:-1;return n({urlToken:p,userUrlToken:e,expect:t,API:{types:l.UPDATE_FOLLOWERS,endpoint:"members/".concat(e,"/followers"),method:t?"POST":"DELETE"},UPDATE:{request:{users:(i={},(0,r._)(i,h.urlToken,{followerCount:h.followerCount+_,isFollowing:t}),(0,r._)(i,f.urlToken,{followingCount:f.followingCount+_}),i)},failure:{users:(a={},(0,r._)(a,h.urlToken,h),(0,r._)(a,f.urlToken,f),a)},success:function(e){return{users:(0,r._)({},h.urlToken,e)}}}})}}new o.fK.Array(new o.fK.Object({actor:i.l.USER}))},37209:function(e,t,n){"use strict";n.d(t,{Ty:function(){return p},ZP:function(){return f},hK:function(){return d},o2:function(){return u}});var r=n(87320),o=n(55164),i=n(57477);n(74351);var a=n(80714),c=n(39288),s="".concat(a.Z.fetchRoot.lens,"/api"),l=(0,o._)({},(0,c.FH)("VIDEO",["GET","GET_DETAILS","CREATE","GET_VIDEO_DEFAULT_COVER"]));function u(e){return{id:e,API:{types:l.GET,root:s,endpoint:"/embedded_videos/".concat(e)}}}function d(e){return{id:e,API:{types:l.GET_DETAILS,root:"".concat(a.Z.fetchRoot.lens,"/api/v4"),endpoint:"/videos/".concat(e)}}}function p(e){return{API:{types:l.CREATE,root:s,endpoint:"/embedded_videos",method:"POST",body:{url:e}}}}var h={data:{},shareVideoDetail:{},last:{}};function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l.GET.success:return(0,i._)((0,o._)({},e),{data:(0,i._)((0,o._)({},e.data),(0,r._)({},t.id,t.payload))});case l.CREATE.success:return(0,i._)((0,o._)({},e),{data:(0,i._)((0,o._)({},e.data),(0,r._)({},t.payload.id,t.payload)),last:t.payload});case l.GET_DETAILS.success:return(0,i._)((0,o._)({},e),{shareVideoDetail:t.payload});default:return e}}},4773:function(e,t,n){"use strict";n.d(t,{gq:function(){return b},ZP:function(){return x},EB:function(){return w},KQ:function(){return Z},ry:function(){return I},Xg:function(){return E},ub:function(){return C},nL:function(){return S},GC:function(){return y},__:function(){return R},O:function(){return N},uw:function(){return A},cF:function(){return _.cF},fh:function(){return _.fh},oL:function(){return _.oL}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(74135),s=n(44808),l=n(93206),u=n(92769),d=n.n(u),p=n(42029),h=n.n(p),f=n(39288),_=n(21220),m=n(84),v=new m.fK.Entity("zvideoContributions",{},{processStrategy:function(e){return(0,i._)((0,o._)({},e),{abnormalReason:e.abnormalReason||null})}}),g=new m.fK.Array(v),T=(0,o._)({},(0,f.FH)("zvideoContribution",["LOAD_CONFIG","LOAD_CONTRIBUTION_LIST","LOAD_RECOMMEND_QUESTIONS","LOAD_QUESTION_SEARCH_RESULT","CREATE_CONTRIBUTION","LOAD_CONTRIBUTION","UPDATE_CONTRIBUTION","DELETE_CONTRIBUTION_DRAFT","DELETE_CONTRIBUTED_ANSWER","PUBLISH_CONTRIBUTIONS"]),(0,f.co)("zvideoContribution",["SELECT_CONTRIBUTION","SET_CAMPAIGN"])),E=function(e){var t=e.zvideoId,n=e.target,r=e.duration;return{meta:{zvideoId:t},API:{types:T.LOAD_CONFIG,endpoint:"/zvideo-contribute/zvideos/".concat(t,"/status"),query:(0,o._)({target:void 0===n?"answer":n},r&&{full_duration_millis:r})}}},C=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";return{meta:{zvideoId:e},API:{types:T.LOAD_CONTRIBUTION_LIST,endpoint:"zvideo-contribute/zvideos/".concat(e,"/contributions"),query:{scene:t}},schema:g}},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.zvideoId,n=e.title,r=e.description,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(e,a){var c=a().zvideos.contribution.recommendQuestions.paging.next,s=!!c&&!i;e({meta:{reload:i},API:(0,o._)({types:T.LOAD_RECOMMEND_QUESTIONS,endpoint:s?c:"/zvideo-contribute/contribute/question/recommend"},!s&&{query:{zvideo_id:t,title:n,description:r,limit:20}})})}},S=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var i=r().zvideos.contribution.questionSearchResults.paging.next,a=!!i&&!t;n({meta:{reload:t},API:(0,o._)({types:T.LOAD_QUESTION_SEARCH_RESULT,endpoint:a?i:"/zvideo-contribute/contribute/question/search"},!a&&{query:{query:e,limit:20}})})}},I=function(e){return{API:{types:T.LOAD_CONTRIBUTION,endpoint:"/zvideo-contribute/contribute/".concat(e)},schema:v}},b=function(e,t,n){return{meta:{zvideoId:e},API:{types:T.CREATE_CONTRIBUTION,endpoint:"/zvideo-contribute/contribute",method:"POST",body:(0,c.decamelizeKeys)((0,o._)({zvideoId:e},d()(t,["target.parentObject.title"]),n&&{full_duration_millis:n}))},UPDATE:{success:function(e){var n=e.id;return{zvideoContributions:(0,r._)({},n,(0,o._)({status:0,id:n},t))}}}}},A=function(e,t){return{API:{types:T.UPDATE_CONTRIBUTION,endpoint:"/zvideo-contribute/contribute/".concat(e),method:"PUT",body:(0,c.decamelizeKeys)(t)},UPDATE:{success:{zvideoContributions:(0,r._)({},e,t)}}}},Z=function(e,t){return{meta:{zvideoId:e,contributionId:t},API:{types:T.DELETE_CONTRIBUTION_DRAFT,endpoint:"/zvideo-contribute/contribute/".concat(t),method:"DELETE"}}},w=function(e,t,n){return{meta:{zvideoId:e,contributionId:t},API:{types:T.DELETE_CONTRIBUTED_ANSWER,endpoint:"/answers/".concat(n),method:"DELETE"}}},R=function(e){return function(t,n){var r,o=null===(r=(0,_.JG)(n(),e))||void 0===r?void 0:r.filter(function(e){return 0===e.status}).map(function(e){return e.id});return(null==o?void 0:o.length)?t({API:{types:T.PUBLISH_CONTRIBUTIONS,endpoint:"/zvideo-contribute/contribute/publish",method:"POST",body:{ids:o}}}):Promise.resolve()}},N=function(e){return{type:T.SELECT_CONTRIBUTION,payload:e}},k={isLoading:!0,paging:{isEnd:!1,isStart:!0,totals:0},data:[]},O=function(e,t){return(0,s.ZP)(function(n,r){var o=r.type,i=r.payload,c=r.meta;if(o===e.success){var s,l=t?t(i.data):i.data;n.isLoading=!1,n.paging=i.paging,(s=n.data).push.apply(s,(0,a._)(l))}o===e.failure&&(n.isLoading=!1,n.paging.isEnd=!0),o===e.request&&(n.isLoading=!0,c.reload&&Object.assign(n,k))},k)},x=(0,l.combineReducers)({selectedContribution:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===T.SELECT_CONTRIBUTION?r:e},campaign:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===T.SET_CAMPAIGN?r:e},configs:(0,s.ZP)(function(e,t){var n=t.payload,r=t.type,o=t.meta;r===T.LOAD_CONFIG.success&&(e[o.zvideoId]=n)},{}),contributionLists:(0,s.ZP)(function(e,t){var n=t.payload,r=t.type,o=t.meta,i=void 0===o?{}:o,a=i.zvideoId,c=i.contributionId,s=t.result;r===T.LOAD_CONTRIBUTION_LIST.success&&(e[a]=s),r===T.CREATE_CONTRIBUTION.success&&(e[a]?e[a].push(n.id):e[a]=[n.id]),(r===T.DELETE_CONTRIBUTION_DRAFT.success||r===T.DELETE_CONTRIBUTED_ANSWER.success)&&h()(e[a],c)},{}),recommendQuestions:O(T.LOAD_RECOMMEND_QUESTIONS),questionSearchResults:O(T.LOAD_QUESTION_SEARCH_RESULT,function(e){return e.map(function(e){return(0,i._)((0,o._)({},e.object),{highlight:e.highlight})})})})},21220:function(e,t,n){"use strict";n.d(t,{JG:function(){return c},cF:function(){return u},fh:function(){return d},hX:function(){return p},oL:function(){return h}});var r=n(36695),o=[],i={},a=function(e,t){return e.entities.zvideoContributions[t]},c=function(e,t){var n,r;return(null===(n=null===(r=e.zvideos)||void 0===r?void 0:r.contribution.contributionLists[t])||void 0===n?void 0:n.map(function(t){return a(e,t)}))||o},s=function(e,t){var n,r;return null===(n=e.entities.zvideos[t])||void 0===n?void 0:null===(r=n.chapters)||void 0===r?void 0:r.map(function(e){var t=e.text;return{start_time:e.startTime,text:t}})},l=function(e){var t,n=null===(t=e.zvideos)||void 0===t?void 0:t.contribution.selectedContribution;return n?a(e,n):null},u=function(e){return(0,r.useSelector)(function(t){var n;return(null===(n=t.zvideos)||void 0===n?void 0:n.contribution.configs[e])||i})},d=function(e){return(0,r.useSelector)(function(t){return c(t,e)})},p=function(e){return(0,r.useSelector)(function(t){return s(t,e)})},h=function(){return(0,r.useSelector)(l)}},41492:function(e,t,n){"use strict";n.d(t,{l0:function(){return W},ER:function(){return w},P6:function(){return H},ZP:function(){return j},B$:function(){return K},b_:function(){return V},eJ:function(){return L},My:function(){return X},XT:function(){return q},zg:function(){return z},Hi:function(){return N},SL:function(){return Z},jl:function(){return F},Fn:function(){return S},SM:function(){return D},DQ:function(){return x},Es:function(){return P},dc:function(){return b},oi:function(){return U},KB:function(){return M},W2:function(){return k},MM:function(){return R},XD:function(){return B},qO:function(){return A}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(74135),s=n(54463),l=n.n(s),u=n(84);n(36695);var d=n(93206),p=n(28953),h=n(84054),f=n.n(h),_=n(80714),m=n(39288),v=n(4773),g=(0,o._)({},(0,m.FH)("zvideoRecruit",["GET_FORM","POST_FORM"])),T={form:{platform:"",nickname:"",followerCount:"",domain:"",contact:""},submited:!1,ranking:[]},E=(0,o._)({},(0,m.FH)("zvideo",["GET","GET_INSERTABLE_ZVIDEOS","VOTE","LIKE","CHANGE_COMMENT_PERMISSION","TOGGLE_VISIBLE_STATUS","GET_DELETE_PROMPT_TEXT","REMOVE","GET_RECOMMENDATIONS","GET_CAMPAIGN","GET_CAMPAIGN_VIDEO","GET_CAMPAIGN_DETAIL","GET_CAMPAIGN_VIDEO_LIST","GET_TAGORE_CATEGORY","GET_TAGORE_RECOMMEND_CATEGORY","GET_MATCH_TOPIC","GET_CONTRIBUTABLE_ZVIDEO_CAMPAIGN","CREATE_DRAFT","GET_DRAFT","UPDATE_DRAFT","REMOVE_DRAFT","PUBLISH_DRAFT","PUBLISH_SCHEDULED_DRAFT","GET_ZVIDEO_BANNERS","UPDATE_ZVIDEO_UPLOAD_FEEDBACK","GET_QY_ACTIVITY","GET_TALK_ACTIVITY","GET_PARTY2022_ACTIVITY","GET_BATCHVIDEOS","GET_PUBLISH_LIMIT","LOAD_CREATION_REFERENCES","GET_SIMILAR_ZVIDEOS","GET_ZVIDEO_COLLECTION_LIST","GET_STICKY_PAGE_CONTENT","TOGGLE_ALLOW_STATUS","GET_COOP_AUTH","GET_IS_READ_PROTOCOL","AGREE_COOP_PROTOCOL","GET_COLLECT_LIST","CHECK_STICKY_LINK","GET_VIDEO_SOURCE"])),C=new u.fK.Union({answer:p.l.ANSWER,zvideo:p.l.ZVIDEO},function(e){var t=e.type;return(0,c.camelize)(t)}),y=new u.fK.Array(C);function S(){return function(e,t){var n=(t().zvideos.insertable||{}).paging;return e({API:{types:E.GET_INSERTABLE_ZVIDEOS,endpoint:(null==n?void 0:n.next)||"/zvideos/insertable"}})}}var I=new u.fK.Entity("zvideos",{author:p.l.USER,creationRelationship:{coCreation:{refTo:{contents:[{answer:{author:p.l.USER},article:{author:p.l.USER}}]}}}},{idAttribute:function(e){return"zvideo_answer"===e.type?"zvideo_answer:".concat(e.id,":").concat(e.video.videoId):"zvideo_article"===e.type?"zvideo_article:".concat(e.id,":").concat(e.video.videoId):e.id?e.id:e.zvideoId}});function b(e){return{API:{types:E.GET,endpoint:"zvideos/".concat(e),query:{include:f()({reaction_instruction:!0,contribute:!0,creation_relationship:!0,ip_info:!0})}},schema:I}}function A(e,t){return function(n,a){var c={API:{types:E.VOTE,method:"POST",endpoint:"zvideos/".concat(e,"/voters"),body:{voting:t},fetchOptions:{zsSignature:!0}}},s=a().entities.zvideos[e];if(s){var l,u=1===t?1:1===s.voting?-1:0;c=(0,i._)((0,o._)({},c),{UPDATE:{success:{zvideos:(0,r._)({},e,{voting:t,voteupCount:(null!==(l=s.voteupCount)&&void 0!==l?l:s.voteCount)+u})}}})}return n(c)}}function Z(e,t){return function(n,a){var c={API:{types:E.LIKE,method:t?"POST":"DELETE",endpoint:"zvideos/".concat(e,"/likers"),fetchOptions:{zsSignature:!0}}},s=a().entities.zvideos[e];return s&&(c=(0,i._)((0,o._)({},c),{UPDATE:{success:{zvideos:(0,r._)({},e,{isLiked:t,likedCount:s.likedCount+t?1:0})}}})),n(c)}}function w(e,t){return function(n,a){var s,l={API:{types:E.CHANGE_COMMENT_PERMISSION,method:"PUT",endpoint:"zvideos/".concat(e,"/comment_permission"),body:(0,c.decamelizeKeys)({commentPermission:t}),fetchOptions:{zsSignature:!0}}};return(null===(s=a().entities.zvideos)||void 0===s?void 0:s[e])&&(l=(0,i._)((0,o._)({},l),{UPDATE:{success:{zvideos:(0,r._)({},e,{commentPermission:t})}}})),n(l)}}function R(e){return function(t,n){var a=n().entities.zvideos[e],s=!a.isVisible,l={API:{types:E.TOGGLE_VISIBLE_STATUS,method:"PUT",endpoint:"zvideos/".concat(e,"/is_visible"),body:(0,c.decamelizeKeys)({isVisible:s}),fetchOptions:{zsSignature:!0}}};return a&&(l=(0,i._)((0,o._)({},l),{UPDATE:{success:{zvideos:(0,r._)({},e,{isVisible:s})}}})),t(l)}}function N(e){return{API:{types:E.GET_DELETE_PROMPT_TEXT,endpoint:"zvideos/".concat(e,"/delete-prompt")},FAILSAFE:!0}}function k(e){return{API:{types:E.REMOVE,method:"DELETE",endpoint:"zvideos/".concat(e),fetchOptions:{zsSignature:!0}}}}var O=[{title:"热门",name:"hot"},{title:"最新",name:"latest"}];function x(){return{API:{types:E.GET_TAGORE_CATEGORY,endpoint:"/tagore/categories/tree"}}}function P(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,n=e.title,r=e.content;return{API:{types:E.GET_TAGORE_RECOMMEND_CATEGORY,endpoint:"/tagore/categories/recommend",query:(0,c.decamelizeKeys)({type:t,title:n,content:r})}}}function D(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,n=e.text,r=e.offset,o=e.limit,i=e.firstLevelCategoryId,a=e.secondLevelCategoryId;return{API:{types:E.GET_MATCH_TOPIC,endpoint:"/recommendations/match-topics",query:(0,c.decamelizeKeys)({type:t,text:n,offset:void 0===r?0:r,limit:o,firstLevelCategoryId:i,secondLevelCategoryId:a})}}}function L(e){return{API:{types:E.GET_DRAFT,endpoint:"zvideos/drafts/".concat(e),method:"GET"}}}function B(e,t){return{API:{types:E.UPDATE_DRAFT,endpoint:"zvideos/drafts/".concat(e),method:"PATCH",body:(0,c.decamelizeKeys)(t)}}}function U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{API:{types:E.PUBLISH_DRAFT,endpoint:"zvideos/".concat(e,"/actions/publish"),method:"POST",body:(0,c.decamelizeKeys)(t)}}}function M(e,t){return{API:{types:E.PUBLISH_SCHEDULED_DRAFT,endpoint:"auto-publish/".concat(e,"/zvideo"),method:"POST",body:(0,c.decamelizeKeys)({publishAt:t})}}}var G=new u.fK.Object({authors:new u.fK.Array(new u.fK.Object({author:p.l.USER}))}),F=function(e){return{meta:{id:e},API:{types:E.LOAD_CREATION_REFERENCES,endpoint:"zvideos/".concat(e,"/creation-references")},schema:G}};function z(e){return function(t,n){var r=e.collection_id,o=(n().zvideos.zvideoCollection[r]||{}).paging;return t({meta:{id:r},API:{types:E.GET_ZVIDEO_COLLECTION_LIST,method:"POST",body:e,endpoint:(null==o?void 0:o.next)||"zvideo-collections/feeds",query:{limit:6,include:"answer"}},schema:y})}}var H=function(e){return{API:{types:E.CHECK_STICKY_LINK,method:"GET",endpoint:"/creation-relationship/content/qualification/v2",query:{text:e}}}},q=function(e){var t=e.type,n=e.id,r="",i="",a={};return"article"===t?(r="articles/".concat(n),i=_.Z.fetchRoot.zhuanlan,a={fetchOptions:{credentials:"include"}}):"answer"===t&&(r="answers/".concat(n),i="/api/v4/",a={query:{include:"thumbnail_info,is_visible,paid_info,paid_info_content,admin_closed_comment,reward_info,annotation_action,annotation_detail,collapse_reason,is_normal,is_sticky,collapsed_by,suggest_edit,comment_count,can_comment,content,editable_content,voteup_count,reshipment_settings,comment_permission,created_time,updated_time,review_info,relevant_info,question,excerpt,attachment,relationship.is_authorized,voting,is_thanked,is_author,is_nothelp,is_labeled;author.vip_info,badge[*].topics;settings.table_of_content.enabled"}}),{API:(0,o._)({types:E.GET_STICKY_PAGE_CONTENT,endpoint:r,root:i},a)}};function V(){return{API:{types:E.GET_COOP_AUTH,endpoint:"creation-relationship/creator/qualification",method:"GET"}}}function X(){return{API:{types:E.GET_IS_READ_PROTOCOL,endpoint:"creation-relationship/cocreation/agreement",method:"GET"}}}function W(){return{API:{types:E.AGREE_COOP_PROTOCOL,endpoint:"creation-relationship/cocreation/set/agree",method:"POST"}}}function K(e){return function(t,n){if(0===n().zvideos.collectData.list.length&&!e||e)return t({API:{types:E.GET_COLLECT_LIST,method:"GET",endpoint:e||"creation-relationship/fav-list?".concat(new URLSearchParams({offset:0,limit:10}).toString())}})}}var j=(0,d.combineReducers)({campaignVideoList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===E.GET_CAMPAIGN_DETAIL.success){var n=t.meta.id,c=t.payload.tabList;return(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},t.payload),{zvideos:c.reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t.tabId,{isLoading:!1,paging:{isEnd:!1,next:null},data:[]}))},{})})))}if(t.type===E.GET_CAMPAIGN_VIDEO_LIST.request||t.type===E.GET_CAMPAIGN_VIDEO_LIST.failure){var s=t.meta,l=s.id,u=s.tabId,d=t.type===E.GET_CAMPAIGN_VIDEO_LIST.request;return(0,i._)((0,o._)({},e),(0,r._)({},l,(0,i._)((0,o._)({},e[l]),{zvideos:(0,i._)((0,o._)({},e[l].zvideos),(0,r._)({},u,(0,i._)((0,o._)({},e[l].zvideos[u]),{isLoading:d})))})))}if(t.type===E.GET_CAMPAIGN_VIDEO_LIST.success){var p=t.meta,h=p.id,f=p.tabId,_=t.payload,m=_.paging,v=_.data;return(0,i._)((0,o._)({},e),(0,r._)({},h,(0,i._)((0,o._)({},e[h]),{zvideos:(0,i._)((0,o._)({},e[h].zvideos),(0,r._)({},f,(0,i._)((0,o._)({},e[h].zvideos[f]),{isLoading:!1,paging:m,data:(0,a._)(e[h].zvideos[f].data).concat((0,a._)(v))})))})))}return e},campaigns:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===E.GET_CAMPAIGN.success){var n=t.meta.id;return(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},t.payload),{zvideos:O.reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t.name,{isLoading:!1,paging:{isEnd:!1,next:null},data:[]}))},{})})))}if(t.type===E.GET_CAMPAIGN_VIDEO.request||t.type===E.GET_CAMPAIGN_VIDEO.failure){var c=t.meta,s=c.id,l=c.typeName,u=t.type===E.GET_CAMPAIGN_VIDEO.request;return(0,i._)((0,o._)({},e),(0,r._)({},s,(0,i._)((0,o._)({},e[s]),{zvideos:(0,i._)((0,o._)({},e[s].zvideos),(0,r._)({},l,(0,i._)((0,o._)({},e[s].zvideos[l]),{isLoading:u})))})))}if(t.type===E.GET_CAMPAIGN_VIDEO.success){var d=t.meta,p=d.id,h=d.typeName,f=t.payload,_=f.paging,m=f.data;return(0,i._)((0,o._)({},e),(0,r._)({},p,(0,i._)((0,o._)({},e[p]),{zvideos:(0,i._)((0,o._)({},e[p].zvideos),(0,r._)({},h,(0,i._)((0,o._)({},e[p].zvideos[h]),{isLoading:!1,paging:_,data:(0,a._)(e[p].zvideos[h].data).concat((0,a._)(m))})))})))}return e},tagoreCategory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(t.type===E.GET_TAGORE_CATEGORY.success){var n=t.payload.data;return Array.isArray(n)?n:[]}return e},recommendations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E.GET_RECOMMENDATIONS.request:return(0,i._)((0,o._)({},e),(0,r._)({},t.key,(0,i._)((0,o._)({},e[t.key]),{isLoading:!0})));case E.GET_RECOMMENDATIONS.success:return(0,i._)((0,o._)({},e),(0,r._)({},t.key,(0,i._)((0,o._)({},e[t.key]),{isLoading:!1,paging:t.payload.paging,data:(0,a._)(e[t.key].data||[]).concat((0,a._)(t.payload.data))})));case E.GET_RECOMMENDATIONS.failure:return(0,i._)((0,o._)({},e),(0,r._)({},t.key,(0,i._)((0,o._)({},e[t.key]),{isLoading:!1})));default:return e}},insertable:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E.GET_INSERTABLE_ZVIDEOS.request:case E.GET_INSERTABLE_ZVIDEOS.failure:return(0,i._)((0,o._)({},e),{isLoading:t.type===E.GET_INSERTABLE_ZVIDEOS.request});case E.GET_INSERTABLE_ZVIDEOS.success:return(0,i._)((0,o._)({},e),{isLoading:!1,paging:t.payload.paging,data:l()(e.data,t.payload.data,"id")});default:return e}},recruit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;if(t.type===g.GET_FORM.success){var n=t.payload;e=(0,i._)((0,o._)({},e),{form:(0,o._)({},e.form,n),submited:!0})}return e},qyActivityData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===E.GET_QY_ACTIVITY.success?(0,o._)({},e,t.payload):e},talkActivityData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===E.GET_TALK_ACTIVITY.success?(0,o._)({},e,t.payload):e},party2022ActivityData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===E.GET_PARTY2022_ACTIVITY.success?(0,o._)({},e,t.payload):e},batchVideos:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.meta,a=t.payload;return t.type===E.GET_BATCHVIDEOS.success?(0,i._)((0,o._)({},e),(0,r._)({},n,a)):e},contribution:v.ZP,creationReferences:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===E.LOAD_CREATION_REFERENCES.success?(0,i._)((0,o._)({},e),(0,r._)({},t.meta.id,t.result)):e},zvideoCollection:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===E.GET_ZVIDEO_COLLECTION_LIST.request||t.type===E.GET_ZVIDEO_COLLECTION_LIST.failure){var n=t.meta.id,c=e[n]||{};return(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},c),{isLoading:t.type===E.GET_ZVIDEO_COLLECTION_LIST.request})))}if(t.type===E.GET_ZVIDEO_COLLECTION_LIST.success){var s=t.meta.id,l=t.payload.paging,u=t.result,d=e[s]||{},p=d.items||[];return(0,i._)((0,o._)({},e),(0,r._)({},s,(0,i._)((0,o._)({},d),{paging:l,items:(0,a._)(p).concat((0,a._)(u)),isLoading:!1})))}return e},zvideoGrant:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===E.TOGGLE_ALLOW_STATUS.success?(0,o._)({},e,t.payload):e},collectData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,list:[]},t=arguments.length>1?arguments[1]:void 0;return t.type===E.GET_COLLECT_LIST.success?(0,o._)((0,i._)((0,o._)({},e),{isFetching:!1,list:e.list.concat(t.payload.data)}),t.payload.paging):t.type===E.GET_COLLECT_LIST.request||t.type===E.GET_COLLECT_LIST.failure?(0,i._)((0,o._)({},e),{isFetching:!0}):e},videoSource:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isLoaded:!1},t=arguments.length>1?arguments[1]:void 0;if(t.type===E.GET_VIDEO_SOURCE.success){var n=t.payload,r=n.topic,a=n.title;return r&&r.length>0&&r.map(function(e){return(0,i._)((0,o._)({},e),{urlToken:e.id})}),{isLoaded:!0,zvideoType:"original",title:a,topics:r}}return e}})},15408:function(e,t,n){"use strict";n.d(t,{Z:function(){return S}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(71728),u=n(85626),d=n(85879),p=n(54231),h=n(87363),f=n(36695),_=n(43384),m=n(35374),v=n(4607),g=n(57477),T=n(50373);function E(){return n.e(3433).then(n.bind(n,53433))}function C(e){return(0,d.tZ)(T.Z,(0,g._)((0,s._)({},e),{getComponent:E}))}var y=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(e){var i;return(0,o._)(this,n),i=t.call(this,e),(0,a._)((0,r._)(i),"handleSignFlowModalOpen",function(e){i.setState({signFlowModalType:e,signFlowModalShown:!0}),p.ZP.increment("logIn.modal.show.count",.001)}),(0,a._)((0,r._)(i),"handleSignFlowModalClose",function(){var e=i.props.onClose;i.setState({signFlowModalShown:!1},function(){"function"==typeof e&&e()}),p.ZP.increment("logIn.modal.close.count",.001)}),(0,a._)((0,r._)(i),"handleLogin",function(e){var t=i.props.loginButton,n=void 0===t?{}:t,r=n.props&&n.props.onClick;"function"==typeof r&&r(e),i.handleSignFlowModalOpen("login")}),(0,a._)((0,r._)(i),"handleRegister",function(e){var t=i.props.registerButton,n=t.props&&t.props.onClick;"function"==typeof n&&n(e),i.handleSignFlowModalOpen("register")}),e.defaultType?i.state={signFlowModalType:e.defaultType,signFlowModalShown:!0}:(i.state={signFlowModalType:"initial",signFlowModalShown:!1},p.ZP.increment("logIn.modal.show.count",.001)),i}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.signFlowModalType,r=t.signFlowModalShown,o=this.props,i=o.loginButton,a=o.loginButtonWithZa,c=o.registerButton,u=o.children,p=o.wrapperClassName,f=(0,l._)(o,["loginButton","loginButtonWithZa","registerButton","children","wrapperClassName"]),v=(0,d.BX)(d.HY,{children:[(0,d.tZ)(C,(0,s._)({signType:n,onClose:this.handleSignFlowModalClose},f)),(0,d.tZ)(m.A6,{})]});return(0,d.BX)("div",{className:p,children:[a&&(0,h.cloneElement)(a,{onClick:this.handleLogin}),i&&(0,d.tZ)(_.Wi,{zaType:"Button",zaText:"login",as:(0,h.forwardRef)(function(t,n){return(0,h.cloneElement)(i,{onClick:e.handleLogin,ref:n})})}),c&&(0,h.cloneElement)(c,{onClick:this.handleRegister}),u,r&&v]})}}]),n}(h.Component),S=(0,v.x)((0,f.connect)(function(){return{showQrcodeFirst:!1}},null)(y))},69140:function(e,t,n){"use strict";n.r(t),n.d(t,{BIND_PHONE:function(){return $},CONFIRM_BIND_PHONE:function(){return J},CONFIRM_UNBIND:function(){return en},LOGIN_WITH_PHONE:function(){return ee},NEED_UNBIND:function(){return et},SAFETY_VERIFICATION:function(){return er},default:function(){return ei}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),l=n(85879),u=n(14168),d=n.n(u),p=n(87363),h=n(36695),f=n(93206),_=n(11786),m=n(45842),v=n(6366),g=n(58909),T=n(66263),E=n(67927),C=n(55164),y=n(57477),S=n(51679),I=n(90763),b=n(69383),A=n(43384),Z=n(74128),w=n(38889),R=n(16850),N=n(65357),k=n(71670),O=n(87843),x=n(80487),P=n(71728),D=n(79065),L=n(49899),B=n(7407),U=n(25773),M=n(25669),G=n(34150);function F(){var e=(0,D._)(["","s 后可重发"]);return F=function(){return e},e}var z=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.countDownEvent,n=e.startAtOnce,r=e.interceptTime,o=e.resetText,i=e.manualValidateError,a=e.onChange,c=e.validations,s=e.countDownEndEvent,u=e.reStartTime,d=e.isIOS,p=e.isMobile,h=e.maxLength,f=void 0===h?T.Bg:h,_=(0,P._)(e,["countDownEvent","startAtOnce","interceptTime","resetText","manualValidateError","onChange","validations","countDownEndEvent","reStartTime","isIOS","isMobile","maxLength"]);return(0,l.BX)("div",{className:"SignFlow SignFlow-smsBindPhoneInputContainer",children:[(0,l.tZ)(G.Z,(0,C._)({name:"digits",className:"SignFlow-smsBindPhoneInput",type:d?"tel":"number",errorMessageClassName:p?"SignFlow-smsBindPhoneInputErrorMask-Mobile":"SignFlow-smsBindPhoneInputErrorMask",maxLength:f,placeholder:"输入 ".concat(f," 位验证码"),manualValidateError:i,onChange:a,validations:[{type:"required",message:"请填写验证码",className:"SignFlow-smsInputBindPhoneRequiredErrorMask"}].concat((0,L._)(c||[]))},_)),(0,l.tZ)(U.Z,{className:"SignFlow-smsBindPhoneInputButton",preset:"plain",initialText:"发送验证码",resetText:o,countingText:(0,M.Z)(F(),"count"),startAtOnce:n,event:t,countDownEndEvent:s,interceptTime:r,reStartTime:u})]})}}]),n}(p.Component);(0,a._)(z,"propTypes",{countDownEvent:d().func.isRequired,startAtOnce:d().bool,interceptTime:d().number,resetText:d().string,manualValidateError:d().string}),(0,a._)(z,"defaultProps",{startAtOnce:!1,resetText:"重发验证码"});var H=(0,h.connect)(function(e){return{isIOS:e.env.userAgent.iOS,isMobile:(0,B.Hu)(e)}})(z),q=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"zaRef",(0,p.createRef)()),(0,a._)((0,r._)(e),"state",{selectedCountry:{code:"+86",name:"中国"},phoneNo:null,smsInputInterceptTime:-1,manualError:null,showFooter:!1,sendValidationCodeButtonText:"发送验证码",identifyingCodeError:null}),(0,a._)((0,r._)(e),"testPhoneNo",function(){var t=e.state,n=t.selectedCountry.code,r=t.phoneNo;return"+86"!==n||/^\d{11}$/.test(r)}),(0,a._)((0,r._)(e),"handleChange",function(t){return function(n){e.setState((0,a._)({},t,n))}}),(0,a._)((0,r._)(e),"handleSendDigits",function(t){var n=e.props.isMobile;e.zaRef.current.trackEvent({eventType:"Click",elementLocation:{type:"Button",moduleId:e.isSocialRegister?"reg_mobile_verification_code_button":""}});var r=e.props,o=r.requestPhoneVerificationCode,i=r.onVipUnbind,a=e.state,c=a.selectedCountry.code,s=a.phoneNo,l=a.manualError;if(b.Z.trackEvent(t.target,{action:"GetCaptcha"}),e.testPhoneNo())return o("".concat(c).concat(s)).then(function(){e.setState({manualError:null})}).catch(function(t){var n=t.payload,r=void 0===n?{}:n,o=r.message;if(!(r.code===T.W0&&"function"==typeof i&&i({phoneNo:s})))return e.setState({manualError:o,smsInputInterceptTime:Date.now()})});var u=n?"手机号错误":"请输入正确的手机号";return e.setState({manualError:l===u?" ".concat(u):u,smsInputInterceptTime:Date.now()})}),(0,a._)((0,r._)(e),"trackSubmitResult",function(t){e.zaRef.current.trackEvent({eventType:"Click",elementLocation:{type:"Button",moduleId:e.isSocialRegister?"reg_mobile_setting_confirm_button":""}},{configMap:{bindResult:t?"1":"0"}})}),(0,a._)((0,r._)(e),"handleSubmit",function(t){var n=t.phoneNo,r=t.digits,o=e.props,i=o.updatePhoneNumber,a=o.onSuccess,c=o.onNeedUnbind,s=e.state,l=s.selectedCountry.code,u=s.identifyingCodeError;i("".concat(l).concat(n),r).then(function(t){var r=t.payload,o=r.data,i=r.success;return(e.trackSubmitResult(i),i)?a():c({phoneNumber:n,bindName:o.bindedAccountFullname,requiredName:o.requestAccountFullname})}).catch(function(t){e.trackSubmitResult(!1);var n=t.payload,r=void 0===n?{}:n,o=r.code,i=r.message;o===T.o7&&e.setState({identifyingCodeError:u===i?" ".concat(i):i})})}),(0,a._)((0,r._)(e),"handleZaOK",function(e){b.Z.trackEvent(e.target,{action:"Ok"})}),(0,a._)((0,r._)(e),"renderContent",function(){var t=e.state,n=t.smsInputInterceptTime,r=t.manualError,o=t.sendValidationCodeButtonText,i=t.identifyingCodeError,a=e.props.isMobile;return(0,l.BX)(A.Wi,{zaType:"Popup",zaModuleId:e.isSocialRegister?"reg_mobile_setting_popup":"",ref:function(t){e.container=t},children:[(0,l.tZ)(A.pS,{ref:e.zaRef}),a&&(0,l.tZ)("div",{css:function(e){return{color:e.colors.GBK03A,fontWeight:"bold",fontSize:17,lineHeight:"24px",padding:"0 24px",marginTop:-18}},children:"绑定手机号，享受知乎完整功能 ~"}),(0,l.BX)(O.Z,{className:"SignFlow BindPhoneForm",onSubmit:e.handleSubmit,style:a?{marginTop:0,padding:"0 24px"}:{},children:[(0,l.tZ)(k.l,{selectClassName:"BindPhone-select",children:(0,l.tZ)(x.Z,{type:"register",supportedCountriesShown:!0,manualValidateError:r,onSelect:e.handleChange("selectedCountry"),onChange:e.handleChange("phoneNo")})}),(0,l.tZ)(H,{resetText:o,interceptTime:n,countDownEvent:e.handleSendDigits,manualValidateError:i},"sms-input"),!a&&(0,l.tZ)("div",{className:"BindPhone-helpWrapper",children:(0,l.tZ)(w.ZP,{className:"BindPhone-helpText",preset:"link",onClick:function(){e.setState({showFooter:!0})},children:"需要帮助？"})}),a?(0,l.tZ)(S.Z,{css:{marginTop:60},children:(0,l.tZ)(A.$U,{zaType:"Button",zaModuleId:"bind_enter_zhihu_button",as:I.z,colorPreset:"primary",type:"submit",label:"确认",size:"l",children:"确认"})}):(0,l.tZ)(w.ZP,{css:{display:"block",width:"220px",margin:"55px auto 0"},preset:"primary",color:"blue",type:"submit",onClick:e.handleZaOK,children:"确认"})]})]})}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){b.Z.setModule(this.container,{module:"BindPhoneForm"}),b.Z.trackCardShow(this.container)}},{key:"isSocialRegister",get:function(){return(0,N.wb)()}},{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.modalProps,r=void 0===n?{}:n,o=e.isMobile,i=this.state.showFooter;return(0,l.tZ)(Z.Z,(0,y._)((0,C._)({title:o?null:"设置手机号",subtitle:o?null:"绑定手机号后，您可以解锁知乎的提问、回答、评论等更多功能。",footer:i?"如需要帮助，请联系 i@zhihu.com，我们会尽快帮你解决":null,onClose:t,size:o?"fullPage":"default"},r),{children:this.renderContent()}))}}]),n}(p.Component);(0,a._)(q,"propTypes",{requestPhoneVerificationCode:d().func.isRequired,updatePhoneNumber:d().func.isRequired,onClose:d().func.isRequired,onSuccess:d().func.isRequired,onNeedUnbind:d().func.isRequired,isMobile:d().bool.isRequired});var V=(0,R.$)()(q),X=n(80714),W=n(31142),K=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"zaKnowMore",function(e){b.Z.trackEvent(e.target,{action:"OpenUrl",name:"了解更多"})}),(0,a._)((0,r._)(e),"toBindPhone",function(t){var n=e.props.onBindPhone;b.Z.trackEvent(t.target,{action:"OpenUrl",name:"去绑定手机"}),n()}),(0,a._)((0,r._)(e),"handleClose",function(t){var n=e.props,r=n.onClose,o=n.config.canWrite;b.Z.trackEvent(t.target,{action:"Cancel",name:o?"暂不绑定":"取消"}),r()}),(0,a._)((0,r._)(e),"renderContent",function(){var t=e.props.config,n=t.tip,r=t.canWrite;return(0,l.BX)("div",{ref:function(t){e.container=t},children:[(0,l.BX)("p",{children:[n,(0,l.tZ)(W.Z,{preset:"link",target:"_blank",href:"https://zhuanlan.zhihu.com/p/27257715",onClick:e.zaKnowMore,children:"了解更多"})]}),(0,l.BX)("div",{className:"BindPhone-buttonSection",children:[(0,l.tZ)(W.Z,{className:"BindPhone-button",onClick:e.handleClose,children:r?"暂不绑定":"取消"}),(0,l.tZ)(w.ZP,{className:"BindPhone-button",preset:"primary",color:"blue",onClick:e.toBindPhone,children:"去绑定手机"})]})]})}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){b.Z.setModule(this.container,{module:"BindPhoneForm"}),b.Z.trackCardShow(this.container)}},{key:"render",value:function(){var e=this.props.onClose;return(0,l.tZ)(Z.Z,{className:X.Z.isMobileEntry&&"BindPhoneMobileModal",title:"绑定手机",onClose:e,size:X.Z.isMobileEntry?"small":"default",children:this.renderContent()})}}]),n}(p.Component);(0,a._)(K,"propTypes",{config:d().object,onClose:d().func,onBindPhone:d().func});var j=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleUnbind",function(t){var n=e.props,r=n.onSuccess,o=n.monopolizePhoneNumber,i=n.showNotification;b.Z.trackEvent(t.target,{action:"Click",name:"确认解绑"}),o().then(function(){return i("绑定成功！","white"),r()})}),(0,a._)((0,r._)(e),"handleCancel",function(t){var n=e.props.onCancel;b.Z.trackEvent(t.target,{action:"Click",name:"暂不绑定"}),n()}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){b.Z.setModule(this.container,{module:"BindPhoneVerifyForm"}),b.Z.trackCardShow(this.container)}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,r=t.bindName;return(0,l.tZ)(Z.Z,{className:X.Z.isMobileEntry&&"ConfirmUnbindMobileModal",title:"解绑手机",onClose:n,size:X.Z.isMobileEntry?"small":"default",children:(0,l.BX)("div",{ref:function(t){e.container=t},children:[(0,l.tZ)("p",{children:(0,l.tZ)("b",{children:"解绑操作无法撤销。"})}),X.Z.isMobileEntry&&(0,l.tZ)("br",{}),(0,l.BX)("p",{children:["如果你没有其他登录方式，你将无法再使用账号「",r,"」。"]}),(0,l.BX)("div",{className:"BindPhone-buttonSection",children:[(0,l.tZ)(w.ZP,{className:"BindPhone-button",onClick:this.handleUnbind,children:"确认解绑"}),(0,l.tZ)(w.ZP,{className:"BindPhone-button",preset:"primary",color:"blue",onClick:this.handleCancel,children:"暂不绑定"})]})]})})}}]),n}(p.Component);(0,a._)(j,"propTypes",{onClose:d().func.isRequired,onSuccess:d().func.isRequired,onCancel:d().func.isRequired,bindName:d().string.isRequired,showNotification:d().func.isRequired,monopolizePhoneNumber:d().string.isRequired});var Y=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleCancel",function(t){var n=e.props.onClose;b.Z.trackEvent(t.target,{action:"Cancel",name:"不绑定"}),n()}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){b.Z.setModule(this.container,{module:"BindMailForm"}),b.Z.trackCardShow(this.container)}},{key:"render",value:function(){var e=this,t=this.props.onClose;return(0,l.tZ)(Z.Z,{className:X.Z.isMobileEntry&&"LoginWithPhoneMobileModal",title:"手机号绑定成功",onClose:t,size:X.Z.isMobileEntry?"small":"default",children:(0,l.BX)("div",{ref:function(t){e.container=t},children:[(0,l.tZ)("p",{children:"由于你此前绑定的邮箱未经验证，未来请使用手机号登录知乎。"}),(0,l.tZ)(w.ZP,{className:"BindPhone-remindLoginWithPhoneButton",onClick:this.handleCancel,preset:"primary",color:"blue",children:"知道了"})]})})}}]),n}(p.Component);(0,a._)(Y,"propTypes",{onClose:d().func});var Q=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleCancel",function(t){var n=e.props.onCancel;b.Z.trackEvent(t.target,{action:"Click",name:"暂不绑定"}),n()}),(0,a._)((0,r._)(e),"handleConfirm",function(t){var n=e.props.onConfirm;b.Z.trackEvent(t.target,{action:"Click",name:"确认解绑"}),n()}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){b.Z.setModule(this.container,{module:"BindPhoneFailForm"}),b.Z.trackCardShow(this.container)}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,r=t.phoneNumber,o=t.bindName,i=t.requiredName;return(0,l.tZ)(Z.Z,{className:X.Z.isMobileEntry&&"NeedUnbindMobileModal",title:"绑定失败",onClose:n,size:X.Z.isMobileEntry?"small":"default",children:(0,l.BX)("div",{ref:function(t){e.container=t},children:[(0,l.BX)("p",{children:["你所输入的手机号 ",r," 已经被绑定到账号「",o,"」。"]}),X.Z.isMobileEntry&&(0,l.tZ)("br",{}),(0,l.BX)("p",{children:["你可以选择将该手机号从该账号中解绑，并绑定至当前账号「",i,"」。"]}),X.Z.isMobileEntry&&(0,l.tZ)("br",{}),(0,l.tZ)("p",{children:(0,l.BX)("b",{children:["解绑后，你将无法再通过手机号登录原账号「",o,"」。"]})}),(0,l.BX)("div",{className:"BindPhone-buttonSection",children:[(0,l.tZ)(w.ZP,{className:"BindPhone-button",onClick:this.handleConfirm,children:"确认解绑"}),(0,l.tZ)(w.ZP,{className:"BindPhone-button",preset:"primary",color:"blue",onClick:this.handleCancel,children:"暂不绑定"})]})]})})}}]),n}(p.Component);(0,a._)(Q,"propTypes",{onClose:d().func.isRequired,onCancel:d().func.isRequired,onConfirm:d().func.isRequired,phoneNumber:d().string.isRequired,bindName:d().string.isRequired,requiredName:d().string.isRequired});var J="CONFIRM_BIND_PHONE",$="BIND_PHONE",ee="LOGIN_WITH_PHONE",et="NEED_UNBIND",en="CONFIRM_UNBIND",er="SAFETY_VERIFICATION",eo=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{}),(0,a._)((0,r._)(e),"handleBindPhoneSuccess",function(){var t=e.props,n=t.needShowLoginWithPhoneNumber,r=t.showNotification,o=t.onToggle,i=t.onSuccess;return(null==i||i(),n)?e.goToStep(ee)():(r("绑定成功！","white"),setTimeout(function(){return location.reload()},2e3),o())}),(0,a._)((0,r._)(e),"handleNeedUnbind",function(t){var n=t.bindName,r=t.phoneNumber,o=t.requiredName;return e.setState({bindName:n,phoneNumber:r,requiredName:o,step:et})}),(0,a._)((0,r._)(e),"goToStep",function(t){return function(){return e.setState({step:t})}}),(0,a._)((0,r._)(e),"handleCloseWithReload",function(){return location.reload()}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){(0,this.props.fillCurrentUserIfNeeded)(["email","isActive","isBindPhone"])}},{key:"componentDidUpdate",value:function(e){e.currentStep!==this.props.currentStep&&this.goToStep(this.props.currentStep)()}},{key:"render",value:function(){var e=this,t=this.props,n=t.shown,r=t.requestPhoneVerificationCode,o=t.updatePhoneNumber,i=t.monopolizePhoneNumber,a=t.showNotification,c=t.config,s=t.account,u=t.unlockTicketByDigits,d=t.requestUnlockTicket,p=t.unlockTicketByPassword,h=t.onToggle,f=t.isBindPhone,m=t.isZombie,v=t.onSuccess,g=this.state,T=g.step,E=g.bindName,C=g.phoneNumber,y=g.requiredName;return n?T===J?(0,l.tZ)(K,{onBindPhone:this.goToStep(er),onClose:h,config:c}):T===$?(0,l.tZ)(V,{onClose:h,onSuccess:this.handleBindPhoneSuccess,onNeedUnbind:this.handleNeedUnbind,requestPhoneVerificationCode:r,updatePhoneNumber:o}):T===ee?(0,l.tZ)(Y,{onClose:this.handleCloseWithReload}):T===et?(0,l.tZ)(Q,{onClose:h,onCancel:this.goToStep($),onConfirm:this.goToStep(en),bindName:E,phoneNumber:C,requiredName:y}):T===en?(0,l.tZ)(j,{onClose:h,onSuccess:this.handleBindPhoneSuccess,onCancel:this.goToStep($),bindName:E,monopolizePhoneNumber:i,showNotification:a}):T===er?(0,l.tZ)(_.c,{isShown:!0,account:s,unlockTicketByDigits:u,requestUnlockTicket:d,unlockTicketByPassword:p,onClose:h,onSuccess:function(){m&&f||e.goToStep($)(),null==v||v()},zaModuleName:"BindMailForm"}):null:null}}]),n}(p.Component);(0,a._)(eo,"propTypes",{shown:d().bool.isRequired,onToggle:d().func.isRequired,needShowLoginWithPhoneNumber:d().bool.isRequired,config:d().object.isRequired,requestPhoneVerificationCode:d().func.isRequired,updatePhoneNumber:d().func.isRequired,monopolizePhoneNumber:d().func.isRequired,onSuccess:d().func});var ei=(0,f.compose)(m.Z,(0,h.connect)(function(e,t){var n=e.account,r=t.currentUser,o=r.isActive,i=r.email,a=r.isZombie,c=r.isBindPhone;return{account:n,hasActiveEmail:o&&i,needShowLoginWithPhoneNumber:!o&&!!i,config:T.xR,isZombie:a,isBindPhone:c}},{requestPhoneVerificationCode:v.L3,updatePhoneNumber:v.Rv,monopolizePhoneNumber:v.t_,showNotification:E.c0,getUnlockRequest:v.F4,unlockTicketByDigits:v.LC,requestUnlockTicket:v.MM,unlockTicketByPassword:v.Hr,fillCurrentUserIfNeeded:g.sF}))(eo)},65357:function(e,t,n){"use strict";n.d(t,{Ww:function(){return a},o$:function(){return s},wb:function(){return c}});var r=n(67516),o=n.n(r),i="ftasl";function a(){o().set(i,"1")}function c(){return o().get(i)||!1}function s(){o().delete(i)}},82865:function(e,t,n){"use strict";n.d(t,{Eh:function(){return l},Fu:function(){return s},dq:function(){return c}});var r=n(67516),o=n.n(r),i=n(54231),a="vIsZ";function c(e){e&&(o().set(a,null==e?void 0:e.isZombie),i.ZP.increment("logIn.zombieStatus.write.count"))}function s(){o().delete(a),i.ZP.increment("logIn.zombieStatus.delete.count")}function l(){return o().get(a)||!1}},90381:function(e,t,n){"use strict";n.d(t,{Ho:function(){return m},w:function(){return T},ru:function(){return I}});var r=n(85879),o=n(87363),i=n(74128),a=n(89174),c=n(80714),s=function(e){var t=e.onClose,n=e.shown,s=(0,o.useCallback)(function(){location.href="https://".concat(c.Z.wwwHost,"/authenticate/intro")},[]);return(0,r.tZ)(i.Z,{title:"账号实名制认证",onClose:t,size:c.Z.isMobileEntry?"fullPage":"default",children:n&&(0,r.BX)("div",{className:"RealNameModal",children:[(0,r.tZ)("p",{children:"根据相关法律法规，您需要完成真实身份核验后方可使用提问、回答、评论等功能。"}),(0,r.tZ)("p",{children:"你可以通过以下方式完成实名制认证。"}),(0,r.BX)("p",{children:["如有其它问题可私信联系"," ",(0,r.tZ)("a",{href:"https://www.zhihu.com/messages/-10029",children:"知乎管理员"})," ","进行咨询沟通"]}),(0,r.tZ)("div",{className:"RealNameModal-buttonGroup",children:(0,r.tZ)(a.ZP,{preset:"primary",color:"blue",onClick:s,children:"身份证件信息认证"})})]})})},l=n(94009),u=n(49899),d=n(91850),p=n(65733),h=n(79446),f=(0,o.createContext)({}),_=function(e){var t=e.children,n=(0,h.Z)(["isRealname"]),i=(0,l._)((0,d.Z)(!1),2),a=i[0],c=i[1],s=(0,p.Z)(function(e){return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(n||{}).isRealname?e.apply(void 0,(0,u._)(r)):c.on()}}),_=(0,p.Z)(function(){return c.off()}),m=(0,o.useMemo)(function(){return{realNameRequired:s,realNameModalShown:a,closeRealNameModal:_}},[a]);return(0,r.tZ)(f.Provider,{value:m,children:t})},m=function(e){var t=e.path,n=e.children;return(0,o.useMemo)(function(){return!(t.match(/\/story\/\d+$/)||t.match(/\/authorize$/)||"errorpage"===c.Z.currentEntry)},[t])?(0,r.tZ)(_,{children:n}):n},v=n(19076),g=function(){var e=(0,h.Z)(["isRealname"]),t=(0,o.useContext)(f),n=t.closeRealNameModal,i=t.realNameModalShown,a=(e||{}).isRealname;return(0,r.tZ)(r.HY,{children:!1===a&&(0,r.tZ)(s,{onClose:n,shown:i})})},T=(0,v.withRouter)(function(e){var t=e.location.pathname;return(0,o.useMemo)(function(){return!(t.match(/\/story\/\d+$/)||t.match(/\/authorize$/)||"errorpage"===c.Z.currentEntry)},[t])?(0,r.tZ)(g,{}):null}),E=n(55164),C=n(57477),y=n(84871),S=n.n(y),I=function(e){return S()(function(t){var n=(0,o.useContext)(f).realNameRequired;return(0,r.tZ)(e,(0,C._)((0,E._)({},t),{realNameRequired:n}))},e)}},80487:function(e,t,n){"use strict";n.d(t,{Z:function(){return Z}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(57477),u=n(71728),d=n(85626),p=n(85879),h=n(92769),f=n.n(h),_=n(14168),m=n.n(_),v=n(87363),g=n(45001),T=n(80714),E=n(4607),C=n(71670),y=n(34150),S=n(94009),I=n(83921),b=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleChange",function(t){var n=(0,S._)(t.target.value.match(/\+\d+/),1)[0];e.codeDiv.innerHTML=n;var r=e.props.items.findIndex(function(e){return e.code===n});e.props.onChange(t.target.value,r)}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.props.items;return(0,p.BX)("div",{className:"MobileContriesSelect",children:[(0,p.BX)("div",{className:"MobileContriesSelect-content",children:[(0,p.tZ)("div",{ref:function(t){e.codeDiv=t},children:"+ 86"}),(0,p.tZ)("select",{onChange:this.handleChange,children:t.map(function(e,t){var n=e.name,r=e.code;return(0,p.tZ)("option",{value:"".concat(n," ").concat(r),children:"".concat(n," ").concat(r)},t)})})]}),(0,p.tZ)(I.ji,{})]})}}]),n}(v.Component),A=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{selectedCountry:null}),(0,a._)((0,r._)(e),"handleSelect",function(t,n){var r=e.props,o=r.supportedCountries,i=r.onSelect,a=o[n];e.setState({selectedCountry:a}),i(a)}),e}return(0,i._)(n,[{key:"render",value:function(){var e=f()(this.props,["getSupportedCountries","onSelect"]),t=e.supportedCountries,n=e.onChange,r=e.defaultPhoneNo,o=e.type,i=e.defaultSelectedCountry,a=e.supportedCountriesShown,c=e.placeholderPrefix,l=void 0===c?"":c,d=e.getPlaceholder,h=e.selectClassName,_=(0,u._)(e,["supportedCountries","onChange","defaultPhoneNo","type","defaultSelectedCountry","supportedCountriesShown","placeholderPrefix","getPlaceholder","selectClassName"]),m=this.state.selectedCountry||i,v=m.name,E=m.code,C=!!(a&&t&&t.length);return(0,p.BX)("div",{className:"SignFlow-account",children:[C&&(0,p.BX)(p.HY,{children:[(0,p.tZ)("div",{className:"SignFlow-supportedCountriesSelectContainer",children:!!t&&!!t.length&&(T.Z.isMobileEntry?(0,p.tZ)(b,{items:t,onChange:this.handleSelect}):(0,p.tZ)(g.Z,{plain:!0,targetClassName:h,text:"".concat(v," ").concat(E),onChange:this.handleSelect,children:t.map(function(e,t){var n=e.name,r=e.code;return(0,p.tZ)(g.W,{value:"".concat(n," ").concat(r)},t)})}))}),(0,p.tZ)("span",{className:"SignFlow-accountSeperator",children:"\xa0"})]}),(0,p.tZ)(y.Z,(0,s._)({className:"SignFlow-accountInputContainer",name:"register"===o?"phoneNo":"username",inputClassName:"SignFlow-accountInput",placeholder:d(o,l),onChange:n,defaultValue:r,validations:[{type:"required",message:d(o,"请输入")}],type:"digits"===o||"register"===o?"tel":"text"},_))]})}}]),n}(v.Component);(0,a._)(A,"propTypes",{defaultPhoneNo:m().string,defaultSelectedCountry:m().object,supportedCountries:m().array,onSelect:m().func,onChange:m().func,type:m().oneOf(["register","digits","password"]).isRequired,supportedCountriesShown:m().bool,placeholderPrefix:m().string,getPlaceholder:m().func}),(0,a._)(A,"defaultProps",{defaultPhoneNo:"",defaultSelectedCountry:{name:"中国",code:"+86"},supportedCountriesShown:!0,getPlaceholder:function(e,t){return"".concat(t).concat("digits"===e||"register"===e?"手机号":"手机号或邮箱")}});var Z=(0,E.x)(function(e){var t=(0,C.h)().selectClassName;return(0,p.tZ)(A,(0,l._)((0,s._)({},e),{selectClassName:t}))})},34150:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(71728),u=n(85626),d=n(85879),p=n(67814),h=n.n(p),f=n(92769),_=n.n(f),m=n(14168),v=n.n(m),g=n(87363),T=n(95377),E=n(87843),C=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleErrorHide",function(){e.getValidationMessage()&&e.setState({errorMaskShown:!1},function(){e.clearValidations({errorMaskShown:!0},function(){return e.inputEl.focus()})})}),(0,a._)((0,r._)(e),"handleKeyUp",function(t){(8===t.keyCode||9===t.keyCode)&&e.clearValidations()}),(0,a._)((0,r._)(e),"handleChange",function(t){var n=t.target.value,r=e.props.onChange;e.setValue(n),"function"==typeof r&&r(n)}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){var e=this.props.defaultValue;e&&this.setValue(e),this.setState({errorMaskShown:!0})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.manualValidateError,r=t.type,o=t.smsType,i=e.manualValidateError,a=e.type,c=e.defaultValue,s=e.smsType;!n&&i||"string"==typeof n&&n!==i?this.addManualValidation(i):n&&!i&&this.clearValidations({errorMaskShown:!0}),(r!==a||o!==s)&&(this.setValue(c),this.clearValidations({errorMaskShown:!0}))}},{key:"render",value:function(){var e,t=this,n=_()(this.props,["validations","defaultValue","onChange","smsType","manualValidateError","dispatch"]),r=n.className,o=n.inputClassName,i=n.errorMessageClassName,c=(0,l._)(n,["className","inputClassName","errorMessageClassName"]),u=(this.state||{}).errorMaskShown,p=this.getValue(),f=this.getValidationMessage();return(0,d.BX)("div",{className:h()("SignFlowInput",r),children:[(0,d.tZ)(T.Z,(0,s._)({onRef:function(e){t.inputEl=e},value:p,onChange:this.handleChange,onKeyUp:this.handleKeyUp,onClick:this.handleErrorHide,onBlur:function(){return t.validate()},className:o},c)),(0,d.tZ)("div",{className:h()("SignFlowInput-errorMask",this.getValidationClassName(),(e={},(0,a._)(e,i,f),(0,a._)(e,"SignFlowInput-requiredErrorMask",!p),(0,a._)(e,"SignFlowInput-errorMask--hidden",!f||!u),e)),onClick:this.handleErrorHide,children:f})]})}}]),n}(g.Component);(0,a._)(C,"propTypes",{inputClassName:v().string,errorMessageClassName:v().string,manualValidateError:v().node}),t.Z=(0,E.$)()(C)},29065:function(e,t,n){"use strict";var r=n(55164),o=n(36907),i=n.n(o),a=n(23768);t.Z=function(e,t){var n=Date.now(),o="com.zhihu.web",c=new(i())("SHA-1","TEXT");return c.setHMACKey("d1b964811afb40118a12068ff74a12f4","TEXT"),c.update(e),c.update(a.ym),c.update(o),c.update(String(n)),(0,r._)({clientId:a.ym,grantType:e,timestamp:n,source:o,signature:c.getHMAC("HEX")},t)}},72925:function(e,t,n){"use strict";n.d(t,{N:function(){return a},g:function(){return i}});var r=n(67516),o=n.n(r);function i(){return o().get("lastuser")||o().get("lastuser:email")}function a(e){o().set("lastuser",e)}},76295:function(e,t,n){"use strict";n.d(t,{ZP:function(){return o}});var r=n(59590);function o(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?void r.Z.supportsAction("account/showLoginDialog").then(function(e){e?(0,r.Z)("account/showLoginDialog").dispatch({next:location.href}):location.href="zhihu://".concat(t?"signup":"signin","?next=").concat(encodeURIComponent(location.pathname+location.search))}):void(location.href="".concat(t?"/signup":"/signin","?next=").concat(encodeURIComponent(location.pathname+location.search)))}},45471:function(e,t,n){"use strict";n.d(t,{uq:function(){return C},Vy:function(){return r.Z},$7:function(){return I},t:function(){return Z},gl:function(){return w.g}});var r=n(15408),o=n(20857),i=n(22107),a=n(94707),c=n(87320),s=n(86325),l=n(55164),u=n(57477),d=n(85626),p=n(85879),h=n(82644),f=n(67814),_=n.n(f),m=n(87363),v=n(74128),g=n(38889),T=n(80714),E=n(76295),C=function(e){(0,s._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),(0,c._)((0,o._)(e),"handleSignUp",function(){(0,E.ZP)(e.props.isAppView,!0)}),(0,c._)((0,o._)(e),"handleSignIn",function(){(0,E.ZP)(e.props.isAppView)}),e}return(0,a._)(n,[{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.isAppView;return(0,p.tZ)(v.Z,{title:"注册/登录后即可继续操作",size:T.Z.isMobileEntry?"small":"default",className:_()("AppAuthentication",{"AppAuthentication--appView":n}),closeButton:!1,onClose:t,children:(0,p.BX)("div",{className:"AppAuthentication-buttonContainer",children:[!n&&(0,p.tZ)(g.ZP,{preset:"plain",className:"AppAuthentication-closeButton",onClick:t,"aria-label":"关闭",children:(0,p.tZ)(h.HN,{size:16,name:"remove"})}),!T.Z.isMobileEntry&&(0,p.tZ)(g.ZP,{className:"AppAuthentication-button",color:"blue",preset:"primary",onClick:this.handleSignUp,children:"注册"}),(0,p.BX)(g.ZP,(0,u._)((0,l._)({className:"AppAuthentication-button",onClick:this.handleSignIn},T.Z.isMobileEntry?{color:"blue",preset:"primary"}:{}),{children:[T.Z.isMobileEntry?"注册或":"","登录"]}))]})})}}]),n}(m.Component);n(90381);var y=n(14168),S=n.n(y),I=function(e){(0,s._)(n,e);var t=(0,d._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return(0,a._)(n,[{key:"render",value:function(){var e=this.context.handleBindPhoneModalToggle;return(0,p.tZ)(g.ZP,{css:{display:"inline-block",border:"none"},preset:"link",onClick:e,children:"激活账号"})}}]),n}(m.Component);(0,c._)(I,"contextTypes",{handleBindPhoneModalToggle:S().func});var b=n(50373),A=function(){return Promise.resolve().then(n.bind(n,69140))},Z=function(e){(0,s._)(n,e);var t=(0,d._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return(0,a._)(n,[{key:"render",value:function(){return(0,p.tZ)(b.Z,(0,l._)({getComponent:A},this.props))}}]),n}(m.Component),w=n(72925)},71670:function(e,t,n){"use strict";n.d(t,{h:function(){return l},l:function(){return u}});var r=n(85879),o=n(87363),i=n(88329),a=n.n(i),c=function(e){return console.error("该组件没有设置 LoginV2ContextProvider，使用的是默认 Context value。"),e},s=(0,o.createContext)({get captchaNeeded(){return c(!1)},get captchaV2(){return c(void 0)},get captchaV2Ref(){return c({current:null})},get continueActionRef(){return c({current:null})},get handleChange(){return c(a())},get handleChangeType(){return c(a())},get handleSendDigits(){return c(a())},get selectClassName(){return c("")},get setState(){return c(a())},get testPhoneNo(){return c(a())}}),l=function(){return(0,o.useContext)(s)},u=function(e){var t=e.handleChangeType,n=e.setState,i=e.handleChange,a=e.testPhoneNo,c=e.handleSendDigits,l=e.continueActionRef,u=e.captchaV2Ref,d=e.captchaNeeded,p=e.selectClassName,h=e.captchaV2,f=e.children,_=(0,o.useMemo)(function(){return{handleChangeType:t,handleChange:i,testPhoneNo:a,handleSendDigits:c,selectClassName:p,setState:n,continueActionRef:l,captchaV2Ref:u,captchaNeeded:d,captchaV2:h}},[t,i,a,c,p,n,l,u,d,h]);return(0,r.tZ)(s.Provider,{value:_,children:f})}},71981:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(1733),s=n(16e3);t.Z=function(e){var t=e.checked,n=e.children,l=(0,i._)(e,["checked","children"]);return(0,a.BX)(c.sN,(0,o._)((0,r._)({},l),{children:[(0,a.tZ)("span",{css:{display:"inline-block",width:24,marginLeft:-24},children:t&&(0,a.tZ)(s.Y,{text:!0,center:!0})}),n]}))}},62880:function(e,t,n){"use strict";n.d(t,{Yi:function(){return l},dh:function(){return u}});var r=n(79065),o=n(85879),i=n(41402);n(87363);var a=n(36695);function c(){var e=(0,r._)(["\n        height: constant(safe-area-inset-top);\n        height: env(safe-area-inset-top);\n        ","\n      "]);return c=function(){return e},e}function s(){var e=(0,r._)(["\n        height: constant(safe-area-inset-bottom);\n        height: env(safe-area-inset-bottom);\n        ","\n      "]);return s=function(){return e},e}var l=function(e){var t=e.minHeight,n=(0,a.useSelector)(function(e){return e.env.conf.xSafeAreaInsetTop});return(0,o.tZ)("div",{css:(0,i.iv)(c(),n?"height: ".concat(n,"px;"):""),style:{minHeight:t}})},u=function(e){var t=e.minHeight,n=(0,a.useSelector)(function(e){return e.env.conf.xSafeAreaInsetBottom});return(0,o.tZ)("div",{css:(0,i.iv)(s(),n?"height: ".concat(n,"px;"):""),style:{minHeight:t}})}},1606:function(e,t,n){"use strict";n.d(t,{Ib:function(){return g}});var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(91850),s=n(75798),l=n(65733),u=n(84871),d=n.n(u),p=n(87363),h=n(43384),f=function(e){return void 0!==e},_=function(){if(f(document.visibilityState));else if(f(document.webkitVisibilityState))return"webkit";else if(f(document.mozVisibilityState))return"moz";return""},m=function(e){var t=_(),n="".concat(t,"visibilitychange"),r="".concat(t).concat(t?"V":"v","isibilityState"),o=function(){e(document[r])};return document.addEventListener(n,o),function(){return document.removeEventListener(n,o)}},v=function(e){var t=e.children,n=e.index,r=e.itemComponentProps.onToggleExpand,o=(0,i._)((0,c.Z)(!1),2),u=o[0],d=o[1],f=(0,i._)((0,s.Z)(),2),_=f[0],v=f[1],g=(0,p.useRef)(0),T=(0,h.Q4)().UNSAFE_trackEventWithoutDyeing,E=(0,l.Z)(function(){v&&u&&(g.current=Date.now())}),C=(0,l.Z)(function(){if(0!==g.current){var e=Date.now()-g.current;g.current=0,T({action:"ModuleDisappear",elementLocation:{type:"Card",moduleId:"content_card",moduleIndex:n}},{configMap:{module_duration:String(e)}})}}),y=(0,l.Z)(function(e){null==r||r(e),e&&!u?d.on():!e&&u&&d.off()});(0,p.useEffect)(function(){if(0===g.current){E();return}(v&&!u||!v&&u)&&C()},[C,E,v,u]);var S=(0,l.Z)(function(){v&&u&&C()});(0,p.useEffect)(function(){return S},[S]);var I=(0,l.Z)(function(){E()}),b=(0,l.Z)(function(){u&&C()}),A=(0,l.Z)(function(e){"hidden"===e?b():"visible"===e&&I()});return(0,p.useEffect)(function(){var e=m(A);return window.addEventListener("blur",b),window.addEventListener("focus",I),function(){e(),window.removeEventListener("blur",b),window.removeEventListener("focus",I)}},[]),(0,a.tZ)("div",{ref:_,children:(0,p.cloneElement)(t,{onToggleExpand:y})})},g=function(e){return function(t){return d()(function(n){var i=n.zaInfos,c=void 0===i?{}:i,s=n.shouldTrackReadDuration,l=n.index;return(0,a.tZ)(h.eV,(0,o._)((0,r._)({},"function"==typeof e?e(n):e),{children:(0,a.tZ)(h.KC,(0,o._)((0,r._)({zaType:"Card"},void 0!==c.index&&{view:{elementLocation:{card:{index:Number(c.index)}}}}),{zaModuleId:c.moduleId,zaModuleIndex:c.moduleIndex,shouldTrackClick:c.shouldTrackClick,shouldTrackShow:!0,children:void 0!==s&&s?(0,a.tZ)(v,{itemComponentProps:n,index:l||(null==c?void 0:c.index),children:(0,a.tZ)(t,(0,r._)({},n))}):(0,a.tZ)(t,(0,r._)({},n))}))}))},t)}}},56062:function(e,t,n){"use strict";e.exports=n.p+"assets/pin-guideV3.9d810fcb.png"},63848:function(e,t,n){"use strict";e.exports=n.p+"assets/superLikeDialog.15ed4552.png"},36695:function(e,t,n){e.exports=n(15001)(2450)},93206:function(e,t,n){e.exports=n(15001)(4944)},19076:function(e,t,n){e.exports=n(15001)(7094)},59449:function(e,t,n){e.exports=n(15001)(7729)},87363:function(e){"use strict";e.exports=React},61533:function(e){"use strict";e.exports=ReactDOM},37831:function(e){"use strict";e.exports=ReactDOMServer},15001:function(e){"use strict";e.exports=vendor_b2043823c211547b094b},12787:function(){},64824:function(){}},function(e){e.O(0,[6754,2850,8885,3550,7749,887,6272,7050,620,6670,1907],function(){return e(e.s=86045)}),e.O()}]);
//# sourceMappingURL=column.app.b14fe13639a65f8c96c4.js.map